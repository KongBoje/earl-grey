var $218=function(type$220){var f$223;(f$223=type$220["::check"]);if((f$223===(void 0))){return function(value$228){return (value$228 instanceof type$220);};}else{return function(value$231){return f$223.call(type$220,value$231);};}};
var $233=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $234=function(dest$236,values$237){var k$242;(k$242=null);$240:for(k$242 in values$237){if(values$237.hasOwnProperty(k$242)){(dest$236[k$242]=values$237[k$242]);}}return dest$236;};
var $249=function($250$252){var ph$256;(ph$256=$250$252);var $254$261;($254$261=ph$256);var bridge$255$266;var x$270;(bridge$255$266=$254$261);if((((typeof(bridge$255$266)==="string")&&((x$270=bridge$255$266),true))||((typeof(bridge$255$266)==="number")&&((x$270=bridge$255$266),true)))){return ["value",x$270];}else{var other$280;(other$280=$254$261);return other$280["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);var $33$45;($33$45=ph$35);var bridge$34$50;(bridge$34$50=$33$45);if(((typeof(bridge$34$50)==="string")||(typeof(bridge$34$50)==="number"))){return obj$30[msg$36];}else{var other$61;(other$61=$33$45);return obj$30["::send"](msg$36);}});(Array[":::project"]=function($66$68){var ph$71;var value$72;var t0$74;(t0$74=$66$68);(value$72=t0$74);(ph$71=t0$74);var $70$81;($70$81=ph$71);if($218(Array)($70$81)){return [true,value$72];}else{$70$81;return [true,[value$72]];}});(Array.prototype["::check"]=function(value$98){if((value$98 instanceof Array)){var i$103;(i$103=0);$101:for(;(i$103<this.length);(i$103++)){if(($233(this,i$103)!==$233(value$98,i$103))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $234(this.slice(0),this);});(Array.prototype[":::project"]=function(value$120){if((value$120 instanceof Array)){var i$125;(i$125=0);$123:for(;(i$125<this.length);(i$125++)){if(($233(this,i$125)!==$233(value$120,i$125))){return [true,[value$120]];}}return [true,value$120.slice(this.length)];}else{return [true,[value$120]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($249));});(RegExp.prototype["::check"]=function($141$143){var ph$146;(ph$146=$141$143);var $145$151;($145$151=ph$146);var value$159;if((typeof($145$151)==="string")){(value$159=$145$151);if(value$159.match(this)){return true;}else{return false;}}else{var other$164;(other$164=$145$151);return false;}});(RegExp.prototype[":::project"]=function($169$171){var ph$174;(ph$174=$169$171);var $173$179;($173$179=ph$174);var value$187;if((typeof($173$179)==="string")){(value$187=$173$179);var $190$192;($190$192=value$187.match(this));var m$200;if(($190$192===null)){(m$200=$190$192);return [false,null];}else{var m$205;(m$205=$190$192);return [true,m$205];}}else{var other$209;(other$209=$173$179);return [false,null];}});(Function.prototype["::send"]=function(args$215){return this.apply(this,args$215);});
var $1114=function(type$1116){return function(value$1119){var f$1122;(f$1122=type$1116[":::project"]);if((f$1122===(void 0))){(f$1122=type$1116["::project"]);if((f$1122===(void 0))){return [true,type$1116(value$1119)];}else{var rval$1131;(rval$1131=false);try{(rval$1131=[true,f$1122(value$1119)]);}catch(excv$1140){var e$1146;(e$1146=excv$1140);(rval$1131=[false,null]);}return rval$1131;}}else{return f$1122.call(type$1116,value$1119);}};};
var $1363=function(arr$1365){var results$1369;var l$1370;(results$1369=[]);(l$1370=arr$1365.length);var i$1378;(i$1378=0);$1368:for(;(i$1378<l$1370);(i$1378++)){results$1369.push([i$1378,$233(arr$1365,i$1378)]);}return results$1369;};
var $1167=function(){var $1168$1170;($1168$1170=function(tags$1174){var it$0$1177;(it$0$1177=function(){if((!$218($1168$1170)(this))){return Object.create($1168$1170.prototype);}else{return this;}}());(it$0$1177["tags"]=tags$1174);return it$0$1177;});($1168$1170.prototype["create"]=function(){var $1189$1191;($1189$1191=arguments);var t0$1196;var message$1200;var args$1201;(t0$1196=$1189$1191.length);if((t0$1196>=0)){(message$1200=function(){if((0>=t0$1196)){return "";}else{return $1189$1191[0];}}());(args$1201=Array.prototype.slice.call($1189$1191,1));var it$0$1208;(it$0$1208=this);var self$1213;(self$1213=this);var e$1218;(e$1218=Error(message$1200));(e$1218["::tags"]=it$0$1208.tags);(e$1218["args"]=args$1201);var temp$1232;(temp$1232=$1363(args$1201));var $length$1237;($length$1237=temp$1232.length);var $index$1242;($index$1242=0);$1219:for(;($index$1242<$length$1237);($index$1242++)){var m$1250;(m$1250=temp$1232[$index$1242]);var t0$1255;var t1$1256;var i$1260;var arg$1261;(t0$1255=m$1250);if(((t0$1255 instanceof Array)&&(((t1$1256=t0$1255.length)),(t1$1256===2)))){(i$1260=t0$1255[0]);(arg$1261=t0$1255[1]);(e$1218[i$1260]=arg$1261);}else{$1151(m$1250);}}(e$1218["length"]=args$1201.length);(e$1218["name"]=["E"].concat(it$0$1208.tags).join("."));return e$1218;}else{$1151($1189$1191);}});($1168$1170.prototype["::check"]=function(e$1287){var it$0$1290;(it$0$1290=this);var self$1295;(self$1295=this);var tags$1300;if(((!e$1287)||(!$218(Error)(e$1287)))){return false;}(tags$1300=(e$1287["::tags"]||[]));var temp$1309;(temp$1309=it$0$1290.tags);var $length$1314;($length$1314=temp$1309.length);var $index$1319;($index$1319=0);$1301:for(;($index$1319<$length$1314);($index$1319++)){var m$1327;(m$1327=temp$1309[$index$1319]);var tag$1335;(tag$1335=m$1327);if((tags$1300.indexOf(tag$1335)===-1)){return false;}else{false;}}return true;});($1168$1170.prototype["::deconstruct"]=function(e$1343){var it$0$1346;(it$0$1346=this);var self$1351;(self$1351=this);return e$1343.args;});$234($1168$1170,$234(function(){var accum$1356;(accum$1356=({}));(accum$1356["::name"]="$1168");return accum$1356;}(),function(){var accum$1360;(accum$1360=({}));(accum$1360["::egclass"]=true);return accum$1360;}()));return $1168$1170;}();
var $1151=function(value$1153,url$1154,start$1155,end$1156){var err$1159;(err$1159=$1167(["match"]).create("Could not find a match for value",({"value":value$1153})));if(url$1154){(err$1159["location"]=["location",url$1154,start$1155,end$1156]);}throw err$1159;};
var $975=function(){var $976$978;($976$978=function($981$984,$982$985){var classes$987;var children$988;var t0$990;(t0$990=$1114(Array)($981$984));if(t0$990[0]){(classes$987=t0$990[1]);}else{$1151($981$984);}var t0$998;(t0$998=$1114(Array)($982$985));if(t0$998[0]){(children$988=t0$998[1]);}else{$1151($982$985);}var it$0$1006;(it$0$1006=function(){if((!$218($976$978)(this))){return Object.create($976$978.prototype);}else{return this;}}());(it$0$1006["classes"]=classes$987.sort());(it$0$1006["children"]=children$988);return it$0$1006;});$234(function(){var accum$1020;(accum$1020=({}));(accum$1020["::check"]=function(x$1024){return ((x$1024&&x$1024.classes)&&x$1024.children);});return accum$1020;}(),$234(function(){var accum$1027;(accum$1027=({}));(accum$1027["::deconstruct"]=function(x$1031){return [x$1031.classes,x$1031.children];});return accum$1027;}(),$234(function(){var accum$1034;(accum$1034=({}));(accum$1034["::name"]="$976");return accum$1034;}(),function(){var accum$1038;(accum$1038=({}));(accum$1038["::egclass"]=true);return accum$1038;}())));($976$978.prototype["::check"]=function(n$1044){var it$0$1047;(it$0$1047=this);var self$1052;(self$1052=this);var temp$1061;(temp$1061=it$0$1047.classes);var $length$1066;($length$1066=temp$1061.length);var $index$1071;($index$1071=0);$1057:for(;($index$1071<$length$1066);($index$1071++)){var m$1079;(m$1079=temp$1061[$index$1071]);var c$1087;(c$1087=m$1079);if((n$1044.classes.indexOf(c$1087)===-1)){return false;}else{false;}}return true;});$234($976$978,$234(function(){var accum$1093;(accum$1093=({}));(accum$1093["::check"]=function(x$1097){return ((x$1097&&x$1097.classes)&&x$1097.children);});return accum$1093;}(),$234(function(){var accum$1100;(accum$1100=({}));(accum$1100["::deconstruct"]=function(x$1104){return [x$1104.classes,x$1104.children];});return accum$1100;}(),$234(function(){var accum$1107;(accum$1107=({}));(accum$1107["::name"]="$976");return accum$1107;}(),function(){var accum$1111;(accum$1111=({}));(accum$1111["::egclass"]=true);return accum$1111;}()))));return $976$978;}();
var $1385=function(obj$1387){var results$1391;(results$1391=[]);var k$1396;(k$1396=null);$1390:for(k$1396 in obj$1387){if(Object.prototype.hasOwnProperty.call(obj$1387,k$1396)){results$1391.push([k$1396,$233(obj$1387,k$1396)]);}}return results$1391;};
var $1400=function($1401$1403,key$1404){var ph$1408;(ph$1408=$1401$1403);var $1406$1413;($1406$1413=ph$1408);var bridge$1407$1418;(bridge$1407$1418=$1406$1413);if(((bridge$1407$1418===null)||(bridge$1407$1418===(void 0)))){return false;}else{var x$1429;if((typeof($1406$1413)==="string")){(x$1429=$1406$1413);return (key$1404 in String.prototype);}else{var x$1434;if((typeof($1406$1413)==="number")){(x$1434=$1406$1413);return (key$1404 in Number.prototype);}else{var x$1439;(x$1439=$1406$1413);return (key$1404 in x$1439);}}}};var pr_terminus$284;var pr$285;var __lt____gt__$286;var repr$287;var escape_html$288;var quotify$289;var HTML$290;(pr_terminus$284=function(node$294){var r$297;var pre$298;var post$299;(r$297=HTML$290(node$294,"span"));(pre$298=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));(post$299=("</div>"+String.fromCharCode(7)));return console.log(((pre$298+r$297)+post$299));});(pr$285=function($312$314,r$315){var x$336;var n$331;var $317$323;var ph$318;(ph$318=$312$314);($317$323=ph$318);if($218($975)($317$323)){(n$331=$317$323);return pr_terminus$284(n$331);}else{(x$336=$317$323);return pr_terminus$284((r$315||repr$287)(x$336));}});(__lt____gt__$286=function($341$343,x$344){if(($341$343===null)){}else{$1151($341$343);}return pr$285(x$344);});(repr$287=function(){var $index$441;var $length$436;var temp$431;var acc$426;var $index$486;var $length$481;var temp$476;var acc$471;var other$520;var entries$417;var $356$390;var t0$388;var x$369;var recur$370;var $355$371;var t0$363;var t1$364;var t2$365;var $354$358;($354$358=arguments);(t0$363=$354$358.length);if((((t0$363>=1)&&(t0$363<=2))&&(((t1$364=$354$358[0])),((x$369=t1$364),(($355$371=t1$364),(((t2$365=function(){if((1>=t0$363)){return repr$287;}else{return $354$358[1];}}())),$218(Function)(t2$365))))))){(recur$370=t2$365);if(($355$371===true)){return $975(["special","true"],"true");}else{if(($355$371===false)){return $975(["special","false"],"false");}else{if(($355$371===null)){return $975(["special","nil"],"null");}else{if(($355$371===(void 0))){return $975(["special","nil"],"undefined");}else{if((typeof($355$371)==="number")){return $975(["num"],String(x$369));}else{if((typeof($355$371)==="string")){return $975(["str"],x$369);}else{(t0$388=$355$371);if($218(Array)(t0$388)){(entries$417=t0$388);return $975(["sequence"],(((acc$426=[])),(((temp$431=entries$417)),((($length$436=temp$431.length)),((($index$441=0)),function(){$423:for(;($index$441<$length$436);($index$441++)){var x$457;var m$449;(m$449=temp$431[$index$441]);(x$457=m$449);acc$426.push(recur$370(x$457,repr$287));}}()))),acc$426));}else{$355$371;if(x$369["::repr"]){return x$369["::repr"](recur$370);}else{if((Object.getPrototypeOf(x$369)===Object.prototype)){return $975(["+table","object"],(((acc$471=[])),(((temp$476=$1385(x$369))),((($length$481=temp$476.length)),((($index$486=0)),function(){$468:for(;($index$486<$length$481);($index$486++)){var k$504;var v$505;var t0$499;var t1$500;var m$494;(m$494=temp$476[$index$486]);(t0$499=m$494);if(((t0$499 instanceof Array)&&(((t1$500=t0$499.length)),(t1$500===2)))){(k$504=t0$499[0]);(v$505=t0$499[1]);acc$471.push($975(["+tr"],[$975(["+th"],recur$370(k$504,repr$287)),$975(["+td"],recur$370(v$505,repr$287))]));}else{$1151(m$494,"/home/olivier/git/earl-grey/test/pp2.eg",914,1244);}}}()))),acc$471));}else{(other$520=$355$371);return $975(["unknown"],other$520.toString());}}}}}}}}}}else{$1151($354$358);}});(escape_html$288=function($527$529){var t0$533;var repl$541;var s$531;(t0$533=[true,String($527$529)]);if(t0$533[0]){(s$531=t0$533[1]);}else{$1151($527$529);}(repl$541=({"&":"&amp;","<":"&lt;",">":"&gt;"}));return s$531.replace(RegExp("[&<>]","g"),function(x$546){return $233(repl$541,x$546);});});(quotify$289=function($551$553){var t0$557;var s$555;(t0$557=[true,String($551$553)]);if(t0$557[0]){(s$555=t0$557[1]);}else{$1151($551$553);}return s$555.replace(RegExp("[\"\\\\]","g"),function(x$565){return ("\\"+x$565);});});(HTML$290=function($570$572,default_tag$573){var $index$616;var $length$611;var temp$606;var acc$601;var $index$683;var $length$678;var temp$673;var $index$799;var $length$794;var temp$789;var acc$784;var $index$866;var $length$861;var temp$856;var acc$851;var $index$917;var $length$912;var temp$907;var acc$902;var other$897;var $836$838;var x$953;var other$950;var $643$938;var tag$644;var _classes$645;var id$646;var kv$647;var sub$648;var accum$649;var children2$650;var other$959;var classes$637;var children$638;var children$594;var s$589;var $575$581;var ph$576;(ph$576=$570$572);($575$581=ph$576);if((typeof($575$581)==="string")){(s$589=$575$581);return escape_html$288(s$589);}else{if($218(Array)($575$581)){(children$594=$575$581);return (((acc$601=[])),(((temp$606=children$594)),((($length$611=temp$606.length)),((($index$616=0)),function(){$598:for(;($index$616<$length$611);($index$616++)){var child$632;var m$624;(m$624=temp$606[$index$616]);(child$632=m$624);acc$601.push(HTML$290(child$632,default_tag$573));}}()))),acc$601).join("");}else{if(($218($975)($575$581)&&($1400($575$581,"classes")&&((classes$637=$575$581.classes),$1400($575$581,"children"))))){(children$638=$575$581.children);(tag$644=(default_tag$573||"span"));(_classes$645=[]);(id$646=null);(kv$647=[]);(sub$648=[]);(temp$673=classes$637);($length$678=temp$673.length);($index$683=0);$651:for(;($index$683<$length$678);($index$683++)){var s$761;var m$742;var m$723;var k$718;var k$705;var v$706;var $653$700;var $654$701;var $655$702;var t0$696;var t1$697;var t2$698;var m$691;(m$691=temp$673[$index$683]);(t0$696=m$691);if((($654$701=(t0$696 instanceof Array))&&(((t1$697=t0$696.length)),((t1$697===3)&&(t0$696[0]==="assoc"))))){(k$705=t0$696[1]);(v$706=t0$696[2]);kv$647.push([k$705,v$706]);}else{if(($654$701&&((t1$697===2)&&(t0$696[0]==="assoc")))){(k$718=t0$696[1]);kv$647.push([k$718,(void 0)]);}else{(t0$696=$1114(RegExp("(?:^\\+((?:.*)))",""))(m$691));if((t0$696[0]&&(((t1$697=t0$696[1])),(((t2$698=t1$697.length)),(t2$698===2))))){t1$697[0];(m$723=t1$697[1]);(tag$644=m$723);}else{(t0$696=$1114(RegExp("(?:^#((?:.*)))",""))(m$691));if((t0$696[0]&&(((t1$697=t0$696[1])),(((t2$698=t1$697.length)),(t2$698===2))))){t1$697[0];(m$742=t1$697[1]);(id$646=m$742);}else{(t0$696=m$691);if((typeof(t0$696)==="string")){(s$761=t0$696);_classes$645.push(s$761);}else{$1151(m$691,"/home/olivier/git/earl-grey/test/pp2.eg",1823,2150);}}}}}}(accum$649=function(){if((tag$644==="raw")){return [];}else{return ["<",tag$644];}}());if(id$646){(accum$649=accum$649.concat(" id=\"",id$646,"\""));}if(_classes$645.length){(accum$649=accum$649.concat(" class=\"",quotify$289(_classes$645.join(" ")),"\""));}if(kv$647){(acc$784=[]);(temp$789=kv$647);($length$794=temp$789.length);($index$799=0);$781:for(;($index$799<$length$794);($index$799++)){var k$817;var v$818;var t0$812;var t1$813;var m$807;(m$807=temp$789[$index$799]);(t0$812=m$807);if(((t0$812 instanceof Array)&&(((t1$813=t0$812.length)),(t1$813===2)))){(k$817=t0$812[0]);(v$818=t0$812[1]);acc$784.push(((accum$649=accum$649.concat(function(){if((v$818!==null)){return [" ",k$817,"=\"",quotify$289(v$818),"\""];}else{return [" ",k$817];}}()))));}else{$1151(m$807,"/home/olivier/git/earl-grey/test/pp2.eg",2414,2614);}}acc$784;}(children2$650=((($836$838=tag$644)),function(){if(($836$838==="raw")){(acc$851=[]);(temp$856=children$638);($length$861=temp$856.length);($index$866=0);$848:for(;($index$866<$length$861);($index$866++)){var c$892;var s$883;var t0$879;var m$874;(m$874=temp$856[$index$866]);(t0$879=m$874);if((typeof(t0$879)==="string")){(s$883=t0$879);acc$851.push(s$883);}else{(c$892=m$874);acc$851.push(HTML$290(c$892,default_tag$573));}}return acc$851;}else{(other$897=$836$838);(acc$902=[]);(temp$907=children$638);($length$912=temp$907.length);($index$917=0);$899:for(;($index$917<$length$912);($index$917++)){var c$933;var m$925;(m$925=temp$907[$index$917]);(c$933=m$925);acc$902.push(HTML$290(c$933,default_tag$573));}return acc$902;}}()));($643$938=tag$644);if(($643$938==="raw")){return accum$649.concat(children2$650).join("");}else{(other$950=$643$938);(x$953=[">"].concat(children2$650).concat(["</",tag$644,">"]));return accum$649.concat(x$953).join("");}}else{(other$959=$575$581);return HTML$290([true,String(other$959)][1],default_tag$573);}}}});(exports["pr_terminus"]=pr_terminus$284);(exports["pr"]=pr$285);(exports["<>"]=__lt____gt__$286);(exports["repr"]=repr$287);
