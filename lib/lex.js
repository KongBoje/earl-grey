var $5961=(function(type$5964){var f$5968;(f$5968=type$5964["::check"]);if((f$5968===(void 0))){return (function(value$5974){return (value$5974 instanceof type$5964);});}else{return (function(value$5978){return f$5968.call(type$5964,value$5978);});}});
var $5980=(function(dest$5983,values$5984){var k$5989;(k$5989=null);$5987:for(k$5989 in values$5984){if(values$5984.hasOwnProperty(k$5989)){(dest$5983[k$5989]=values$5984[k$5989]);}}return dest$5983;});
var $5997=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5998=(function($6000$6003){var ph$6009;(ph$6009=$6000$6003);var $6005$6015;($6005$6015=ph$6009);var bridge$6007$6020;var x$6024;(bridge$6007$6020=$6005$6015);if((((typeof(bridge$6007$6020)==="string")&&((x$6024=bridge$6007$6020),true))||((typeof(bridge$6007$6020)==="number")&&((x$6024=bridge$6007$6020),true)))){return ["value",x$6024];}else{var other$6035;(other$6035=$6005$6015);return other$6035["::serialize_ast"]();}});
var $6037=(function(obj$6040){var results$6045;(results$6045=[]);var k$6050;(k$6050=null);$6044:for(k$6050 in obj$6040){if(Object.prototype.hasOwnProperty.call(obj$6040,k$6050)){results$6045.push([k$6050,$5997(obj$6040,k$6050)]);}}return results$6045;});
var $6306=(function(arr$6309){var results$6315;var l$6316;(results$6315=[]);(l$6316=arr$6309.length);var i$6325;(i$6325=0);$6314:for(;(i$6325<l$6316);(i$6325++)){results$6315.push([i$6325,$5997(arr$6309,i$6325)]);}return results$6315;});
var $6073=(function(){var $6074$6080;($6074$6080=(function(tags$6085){var it$0$6088;(it$0$6088=(function(){if((!$5961($6074$6080)(this))){return Object.create($6074$6080.prototype);}else{return this;}})());(it$0$6088["tags"]=tags$6085);return it$0$6088;}));($6074$6080.prototype["create"]=(function(){var it$0$6108;var self$6109;(it$0$6108=this);(self$6109=this);var $6106$6118;($6106$6118=arguments);var t0$6123;var message$6127;var args$6128;(t0$6123=$6106$6118.length);if((t0$6123>=0)){(message$6127=(function(){if((0>=t0$6123)){return "";}else{return $6106$6118[0];}})());(args$6128=Array.prototype.slice.call($6106$6118,1));var e$6141;(e$6141=Error(message$6127));(e$6141["::tags"]=it$0$6108.tags);(e$6141["args"]=args$6128);var temp$6157;(temp$6157=$6306(args$6128));var $length$6163;($length$6163=temp$6157.length);var $index$6169;($index$6169=0);$6142:for(;($index$6169<$length$6163);($index$6169++)){var m$6178;(m$6178=temp$6157[$index$6169]);var t0$6183;var t1$6184;var i$6188;var arg$6189;(t0$6183=m$6178);if(((t0$6183 instanceof Array)&&(((t1$6184=t0$6183.length)),(t1$6184===2)))){(i$6188=t0$6183[0]);(arg$6189=t0$6183[1]);(e$6141[i$6188]=arg$6189);}else{$6054(m$6178);}}(e$6141["length"]=args$6128.length);(e$6141["name"]=["E"].concat(it$0$6108.tags).join("."));return e$6141;}else{$6054($6106$6118);}}));($6074$6080.prototype["::check"]=(function(e$6219){var it$0$6223;var self$6224;(it$0$6223=this);(self$6224=this);var tags$6234;if(((!e$6219)||(!$5961(Error)(e$6219)))){return false;}(tags$6234=(e$6219["::tags"]||[]));var temp$6245;(temp$6245=it$0$6223.tags);var $length$6251;($length$6251=temp$6245.length);var $index$6257;($index$6257=0);$6235:for(;($index$6257<$length$6251);($index$6257++)){var m$6266;(m$6266=temp$6245[$index$6257]);var tag$6274;(tag$6274=m$6266);if((tags$6234.indexOf(tag$6274)===-1)){return false;}else{false;}}return true;}));($6074$6080.prototype["::deconstruct"]=(function(e$6283){var it$0$6287;var self$6288;(it$0$6287=this);(self$6288=this);return e$6283.args;}));$5980($6074$6080,$5980((function(){var accum$6299;(accum$6299=({}));(accum$6299["::name"]="$6074");return accum$6299;})(),(function(){var accum$6303;(accum$6303=({}));(accum$6303["::egclass"]=true);return accum$6303;})()));return $6074$6080;})();
var $6054=(function(value$6057,url$6058,start$6059,end$6060){var err$6064;(err$6064=$6073(["match"]).create("Could not find a match for value",({"value":value$6057})));if(url$6058){(err$6064["location"]=["location",url$6058,start$6059,end$6060]);}throw err$6064;});
var send$5606;var __array_methods$5607;var __re_methods$5608;(send$5606=(function(obj$5621,$5618$5622){var ph$5628;var msg$5629;var t0$5631;(t0$5631=$5618$5622);(msg$5629=t0$5631);(ph$5628=t0$5631);var $5624$5640;($5624$5640=ph$5628);var bridge$5626$5645;(bridge$5626$5645=$5624$5640);if(((typeof(bridge$5626$5645)==="string")||(typeof(bridge$5626$5645)==="number"))){return obj$5621[msg$5629];}else{var other$5657;(other$5657=$5624$5640);return obj$5621["::send"](msg$5629);}}));(Array[":::project"]=(function($5663$5666){var ph$5671;var value$5672;var t0$5674;(t0$5674=$5663$5666);(value$5672=t0$5674);(ph$5671=t0$5674);var $5668$5683;($5668$5683=ph$5671);if($5961(Array)($5668$5683)){return [true,value$5672];}else{$5668$5683;return [true,[value$5672]];}}));(__array_methods$5607=$5980((function(){var accum$5704;(accum$5704=({}));(accum$5704["::check"]=(function(value$5709){if((value$5709 instanceof Array)){var i$5715;(i$5715=0);$5712:for(;(i$5715<this.length);(i$5715++)){if(($5997(this,i$5715)!==$5997(value$5709,i$5715))){return false;}}return true;}else{return false;}}));return accum$5704;})(),$5980((function(){var accum$5724;(accum$5724=({}));(accum$5724["::clone"]=(function(){return $5980(this.slice(0),this);}));return accum$5724;})(),$5980((function(){var accum$5731;(accum$5731=({}));(accum$5731[":::project"]=(function(value$5736){if((value$5736 instanceof Array)){var i$5742;(i$5742=0);$5739:for(;(i$5742<this.length);(i$5742++)){if(($5997(this,i$5742)!==$5997(value$5736,i$5742))){return [true,this.concat([value$5736])];}}return [true,value$5736];}else{return [true,this.concat([value$5736])];}}));return accum$5731;})(),(function(){var accum$5751;(accum$5751=({}));(accum$5751["::serialize_ast"]=(function(){return ["array"].concat(this.map($5998));}));return accum$5751;})()))));var temp$5761;(temp$5761=$6037(__array_methods$5607));var $length$5767;($length$5767=temp$5761.length);var $index$5773;($index$5773=0);$5609:for(;($index$5773<$length$5767);($index$5773++)){var m$5782;(m$5782=temp$5761[$index$5773]);var t0$5787;var t1$5788;var k$5792;var v$5793;(t0$5787=m$5782);if(((t0$5787 instanceof Array)&&(((t1$5788=t0$5787.length)),(t1$5788===2)))){(k$5792=t0$5787[0]);(v$5793=t0$5787[1]);if((!$5997(Array.prototype,k$5792))){Object.defineProperty(Array.prototype,k$5792,({"enumerable":false,"value":v$5793}));}}else{$6054(m$5782);}}(__re_methods$5608=$5980((function(){var accum$5813;(accum$5813=({}));(accum$5813["::check"]=(function($5817$5820){var ph$5825;(ph$5825=$5817$5820);var $5822$5831;($5822$5831=ph$5825);var value$5839;if((typeof($5822$5831)==="string")){(value$5839=$5822$5831);if(value$5839.match(this)){return true;}else{return false;}}else{var other$5844;(other$5844=$5822$5831);return false;}}));return accum$5813;})(),(function(){var accum$5847;(accum$5847=({}));(accum$5847[":::project"]=(function($5851$5854){var ph$5859;(ph$5859=$5851$5854);var $5856$5865;($5856$5865=ph$5859);var value$5873;if((typeof($5856$5865)==="string")){(value$5873=$5856$5865);var $5876$5881;($5876$5881=value$5873.match(this));var m$5889;if(($5876$5881===null)){(m$5889=$5876$5881);return [false,null];}else{var m$5894;(m$5894=$5876$5881);return [true,m$5894];}}else{var other$5898;(other$5898=$5856$5865);return [false,null];}}));return accum$5847;})()));var temp$5904;(temp$5904=$6037(__re_methods$5608));var $length$5910;($length$5910=temp$5904.length);var $index$5916;($index$5916=0);$5612:for(;($index$5916<$length$5910);($index$5916++)){var m$5925;(m$5925=temp$5904[$index$5916]);var t0$5930;var t1$5931;var k$5935;var v$5936;(t0$5930=m$5925);if(((t0$5930 instanceof Array)&&(((t1$5931=t0$5930.length)),(t1$5931===2)))){(k$5935=t0$5930[0]);(v$5936=t0$5930[1]);if((!$5997(RegExp.prototype,k$5935))){Object.defineProperty(RegExp.prototype,k$5935,({"enumerable":false,"value":v$5936}));}}else{$6054(m$5925);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$5980(({"enumerable":false}),(function(){var accum$5954;(accum$5954=({}));(accum$5954["value"]=(function(args$5959){return this.apply(this,args$5959);}));return accum$5954;})()));}
var $8117=(function(type$8120){return (function(value$8124){var f$8128;(f$8128=type$8120[":::project"]);if((f$8128===(void 0))){(f$8128=type$8120["::project"]);if((f$8128===(void 0))){return [true,type$8120(value$8124)];}else{var rval$8141;(rval$8141=false);try{(rval$8141=[true,f$8128(value$8124)]);}catch(excv$8152){var e$8158;(e$8158=excv$8152);(rval$8141=[false,null]);}return rval$8141;}}else{return f$8128.call(type$8120,value$8124);}});});
var $8270=(function($8272$8275,key$8276){var ph$8284;(ph$8284=$8272$8275);var $8278$8290;($8278$8290=ph$8284);var bridge$8280$8295;(bridge$8280$8295=$8278$8290);if(((bridge$8280$8295===null)||(bridge$8280$8295===(void 0)))){return false;}else{var x$8307;if((typeof($8278$8290)==="string")){(x$8307=$8278$8290);return (key$8276 in String.prototype);}else{var x$8312;if((typeof($8278$8290)==="number")){(x$8312=$8278$8290);return (key$8276 in Number.prototype);}else{var x$8317;(x$8317=$8278$8290);return (key$8276 in x$8317);}}}});
var $8186=(function($8188$8191){var ph$8201;var x$8202;var t0$8204;(t0$8204=$8188$8191);(x$8202=t0$8204);(ph$8201=t0$8204);var $8193$8213;($8193$8213=ph$8201);var bridge$8195$8218;(bridge$8195$8218=$8193$8213);if(((function(){var bridge$8196$8228;(bridge$8196$8228=bridge$8195$8218);return ((function(){var bridge$8197$8235;(bridge$8197$8235=bridge$8196$8228);return ((bridge$8197$8235===(void 0))||(bridge$8197$8235===null));})()||(typeof(bridge$8196$8228)==="string"));})()||(typeof(bridge$8195$8218)==="number"))){return x$8202;}else{if($8270($8193$8213,"::clone")){$8193$8213["::clone"];return x$8202["::clone"]();}else{$8193$8213;if((Object.getPrototypeOf(x$8202)===Object.prototype)){var dest$8253;(dest$8253=({}));var k$8258;(k$8258=null);$8252:for(k$8258 in x$8202){if(Object.prototype.hasOwnProperty.call(x$8202,k$8258)){(dest$8253[k$8258]=x$8202[k$8258]);}}return dest$8253;}else{var other$8268;(other$8268=$8193$8213);throw $6073(["clone"]).create("Object cannot be cloned",({"obj":x$8202}));}}}});
var $8164=(function(a$8167,b$8168){var dest$8173;(dest$8173=$8186(a$8167));var k$8178;(k$8178=null);$8172:for(k$8178 in b$8168){if(Object.prototype.hasOwnProperty.call(b$8168,k$8178)){(dest$8173[k$8178]=b$8168[k$8178]);}}return dest$8173;});var id$6399;var id_f$6400;var numr$6401;var numr_f$6402;var num$6403;var num_f$6404;var str$6405;var str_f$6406;var op$6407;var op2$6408;var op3$6409;var op4$6410;var op_f$6411;var indent$6412;var indent_f$6413;var indent2$6414;var indent2_f$6415;var cmnt$6416;var cmnt_f$6417;var unkn$6418;var unkn_f$6419;var $6334$6349;var Location$6350;var __lt____lt____colon__$6351;var special_ops$6352;var regexps$6353;var ws_re$6354;var eol_re$6355;var produce$6356;var indent_tracker$6357;var process_indent$6358;var disambiguate_fixity$6359;var alternate_operators$6360;var fill_locations$6361;var tokenize$6362;($6334$6349=require("./location"));(Location$6350=$6334$6349.Location);(__lt____lt____colon__$6351=$6334$6349["<<:"]);(special_ops$6352=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));(regexps$6353=(((id$6399=RegExp("(?:^(?:\\.\\.\\.|(?:(?:[a-zA-Z$_]|(?:\\\\_.))(?:(?:[a-zA-Z$_0-9]|(?:\\\\_.))*))))",""))),((id_f$6400=(function(m$6427){return ["ID",m$6427[0].replace(RegExp("\\\\_(.)","g"),(function($6430$6433,x$6434){$6430$6433;return x$6434;}))];}))),((numr$6401=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$6402=(function(m$6447){var t0$6457;var t1$6458;var frac$6478;var radix$6452;var intp$6453;var frac$6454;var value$6455;(t0$6457=m$6447);if(((t0$6457 instanceof Array)&&(((t1$6458=t0$6457.length)),(t1$6458===4)))){t0$6457[0];(radix$6452=t0$6457[1]);(intp$6453=t0$6457[2]);(frac$6454=t0$6457[3]);}else{$6054(m$6447,"/home/olivier/git/earl-grey/src/lex.eg",1192,1193);}(value$6455=parseInt(intp$6453.replace(RegExp("_","g"),""),radix$6452));if(frac$6454){(frac$6478=frac$6454.replace(RegExp("_","g"),""));(value$6455=(value$6455+(parseInt(frac$6454,radix$6452)/Math.pow(radix$6452,frac$6454.length))));}return ["NUM",value$6455];}))),((num$6403=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$6404=(function(m$6493){return ["NUM",parseFloat(m$6493[0].replace(RegExp("_","g"),""))];}))),((str$6405=RegExp("(?:^\"((?:(?:(?:\\\\.)|[^\"])*))\")",""))),((str_f$6406=(function(m$6503){var rx$6518;var f$6519;var repl$6508;var r$6509;(repl$6508=({"b":String.fromCharCode(8),"f":String.fromCharCode(12),"n":"\n","r":String.fromCharCode(13),"t":String.fromCharCode(9)}));(r$6509=(((rx$6518=RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\.","g"))),((f$6519=(function($6526$6529){var chr$6570;var digits$6551;var t0$6545;var t1$6546;var t2$6547;var $6531$6540;var ph$6534;(ph$6534=$6526$6529);($6531$6540=ph$6534);(t0$6545=$8117(RegExp("^(?:\\\\u|\\\\x)(.*)",""))($6531$6540));if((t0$6545[0]&&(((t1$6546=t0$6545[1])),(((t2$6547=t1$6546.length)),(t2$6547===2))))){t1$6546[0];(digits$6551=t1$6546[1]);return String.fromCharCode(parseInt(digits$6551,16));}else{(t0$6545=$8117(RegExp("^.(.)",""))($6531$6540));if((t0$6545[0]&&(((t1$6546=t0$6545[1])),(((t2$6547=t1$6546.length)),(t2$6547===2))))){t1$6546[0];(chr$6570=t1$6546[1]);return ($5997(repl$6508,chr$6570)||chr$6570);}else{$6054($6531$6540);}}}))),m$6503[1].replace(rx$6518,f$6519)));return ["STR",r$6509];}))),((op$6407=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$6408=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$6409=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$6410=RegExp("(?:^`((?:[A-Za-z0-9_$]+))`)",""))),((op_f$6411=(function(m$6608,column$6609){var fixity$6641;var otherwise$6647;var $6617$6630;var $6613$6624;var op$6618;(op$6618=(m$6608[1]||m$6608[0]));($6613$6624=null);$6613$6624;if((op$6618==="|")){return ["INDENT",(column$6609-1)];}else{if((op$6618 in special_ops$6352)){(fixity$6641=$5997(special_ops$6352,op$6618));return ["OP",fixity$6641,op$6618];}else{(otherwise$6647=$6613$6624);return ["OP","?FX",op$6618];}}}))),((indent$6412=RegExp("(?:^(?:(?:\n(?: *);(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$6413=(function(m$6657){var ilen$6661;(ilen$6661=m$6657[1].length);return ["INDENT",ilen$6661];}))),((indent2$6414=RegExp("(?:^\\\\\\\\)",""))),((indent2_f$6415=(function(m$6673,column$6674){return ["INDENT",(column$6674-2)];}))),((cmnt$6416=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$6417=(function(m$6684){return ["IGNORE"];}))),((unkn$6418=RegExp("(?:^.)",""))),((unkn_f$6419=(function(m$6694){return ["ILLEGAL",m$6694[0]];}))),[[op3$6409,op_f$6411],[id$6399,id_f$6400],[numr$6401,numr_f$6402],[num$6403,num_f$6404],[str$6405,str_f$6406],[op$6407,op_f$6411],[op2$6408,op_f$6411],[op4$6410,op_f$6411],[indent$6412,indent_f$6413],[indent2$6414,indent2_f$6415],[cmnt$6416,cmnt_f$6417],[unkn$6418,unkn_f$6419]]));(ws_re$6354=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\ (?: *))*))",""));(eol_re$6355=RegExp("(?:^(?: *)(?:\n|$))",""));(produce$6356=(function(src$6708){var text$6717;var results$6718;var wsb$6719;var pos$6720;var column$6721;(text$6717=src$6708.text);(results$6718=[]);(wsb$6719=text$6717.match(ws_re$6354)[0].length);(text$6717=text$6717.slice(wsb$6719));(pos$6720=wsb$6719);(column$6721=0);$6740:while(text$6717){var i$6746;(i$6746=0);$6743:for(;(i$6746<regexps$6353.length);(++i$6746)){var t0$6760;var t1$6761;var splits$6810;var skip$6793;var endpos$6794;var wsa$6795;var eol$6796;var bwsb$6797;var bwsa$6798;var token$6799;var re$6756;var fn$6757;var m$6758;(t0$6760=$5997(regexps$6353,i$6746));if(((t0$6760 instanceof Array)&&(((t1$6761=t0$6760.length)),(t1$6761===2)))){(re$6756=t0$6760[0]);(fn$6757=t0$6760[1]);}else{$6054($5997(regexps$6353,i$6746),"/home/olivier/git/earl-grey/src/lex.eg",4328,4338);}(m$6758=text$6717.match(re$6756));if(m$6758){(skip$6793=m$6758[0].length);(endpos$6794=(pos$6720+skip$6793));(column$6721=(((splits$6810=m$6758[0].split("\n"))),(function(){if((splits$6810.length>1)){return $5997(splits$6810,(splits$6810.length-1)).length;}else{return (column$6721+skip$6793);}})()));(text$6717=text$6717.slice(skip$6793));(wsa$6795=text$6717.match(ws_re$6354)[0].length);(eol$6796=(text$6717.match(eol_re$6355)&&true));(bwsb$6797=(wsb$6719>0));(bwsa$6798=(function(){if(eol$6796){return bwsb$6797;}else{return (wsa$6795>0);}})());(token$6799=fn$6757(m$6758,column$6721));(token$6799["wsb"]=bwsb$6797);(token$6799["wsa"]=bwsa$6798);(token$6799["location"]=Location$6350(src$6708,pos$6720,endpos$6794));results$6718.push(token$6799);(text$6717=text$6717.slice(wsa$6795));(column$6721=(column$6721+wsa$6795));(wsb$6719=wsa$6795);(pos$6720=(endpos$6794+wsa$6795));break $6743;}}}return results$6718;}));(indent_tracker$6357=(function(){var curr$6864;var stack$6865;var stacks$6866;(curr$6864=0);(stack$6865=[]);(stacks$6866=[stack$6865]);return (function($6862$6877){var t0$6900;var rval$6968;var $index$7048;var $length$7042;var temp$7036;var acc$7030;var rval$7022;var x$7079;var $index$7107;var $length$7101;var temp$7095;var acc$7089;var other$7128;var fixity$7009;var fixity$6989;var stuff$6984;var new_indent$6925;var $6881$6926;var $6893$6919;var $6894$6920;var $6895$6921;var $6896$6922;var t0$6914;var t1$6915;var bridge$6888$6916;var bridge$6890$6917;var $6879$6909;var ph$6897;var token$6898;(t0$6900=$6862$6877);(token$6898=t0$6900);(ph$6897=t0$6900);($6879$6909=ph$6897);if((($6893$6919=($6879$6909 instanceof Array))&&(((t0$6914=$6879$6909.length)),((t0$6914===2)&&($6879$6909[0]==="INDENT"))))){(t1$6915=$6879$6909[1]);(new_indent$6925=t1$6915);($6881$6926=t1$6915);$6881$6926;if((curr$6864===false)){(curr$6864=new_indent$6925);return [$8164(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6881$6926>curr$6864)){stack$6865.push(curr$6864);(curr$6864=new_indent$6925);return [$8164(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($6881$6926===curr$6864)){return [$8164(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6881$6926<curr$6864)){(rval$6968=[]);$6972:while(((stack$6865.length>0)&&(new_indent$6925<curr$6864))){(curr$6864=stack$6865.pop());rval$6968.push($8164(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$6968.push($8164(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$6968;}else{$6054($6881$6926,"/home/olivier/git/earl-grey/src/lex.eg",5705,5721);}}}}}else{if(($6893$6919&&((t0$6914>=1)&&($6879$6909[0]==="ID")))){(stuff$6984=Array.prototype.slice.call($6879$6909,1));return [token$6898];}else{if(($6893$6919&&(($6895$6921=(t0$6914===3))&&(($6896$6922=($6879$6909[0]==="OP"))&&((fixity$6989=$6879$6909[1]),(((bridge$6888$6916=$6879$6909[2])),((bridge$6888$6916==="[")||(bridge$6888$6916==="{")))))))){stack$6865.push(curr$6864);stacks$6866.push(stack$6865);(stack$6865=[]);(curr$6864=false);return [token$6898];}else{if(($6896$6922&&((fixity$7009=$6879$6909[1]),(((bridge$6890$6917=$6879$6909[2])),((bridge$6890$6917==="]")||(bridge$6890$6917==="}")))))){(rval$7022=(((acc$7030=[])),(((temp$7036=stack$6865)),((($length$7042=temp$7036.length)),((($index$7048=0)),(function(){$7025:for(;($index$7048<$length$7042);($index$7048++)){var m$7057;(m$7057=temp$7036[$index$7048]);m$7057;acc$7030.push($8164(["OP","SFX","]"],({"wsb":true,"wsa":true})));}})()))),acc$7030));(stack$6865=stacks$6866.pop());(curr$6864=stack$6865.pop());rval$7022.push(token$6898);return rval$7022;}else{if((((x$7079=$6879$6909)),((x$7079 instanceof Array)&&(x$7079[0]==="EOF")))){(acc$7089=[]);(temp$7095=stack$6865);($length$7101=temp$7095.length);($index$7107=0);$7084:for(;($index$7107<$length$7101);($index$7107++)){var m$7116;(m$7116=temp$7095[$index$7107]);m$7116;acc$7089.push($8164(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$7089;}else{(other$7128=$6879$6909);return [token$6898];}}}}}});}));(process_indent$6358=(function(stream$7135){var $index$7166;var $length$7160;var temp$7154;var tracker$7140;var results$7141;(tracker$7140=indent_tracker$6357());(results$7141=[]);(temp$7154=stream$7135);($length$7160=temp$7154.length);($index$7166=0);$7142:for(;($index$7166<$length$7160);($index$7166++)){var token$7183;var m$7175;(m$7175=temp$7154[$index$7166]);(token$7183=m$7175);(results$7141=results$7141.concat(tracker$7140(token$7183)));}return results$7141.concat(tracker$7140(["EOF"]));}));(disambiguate_fixity$6359=(function(stream$7190){var $index$7674;var $length$7668;var temp$7662;var __lt____lt____lt____colon__$7199;var collapse_operators$7200;var buffer$7201;var pfx$7202;var collapse$7203;var results$7204;(__lt____lt____lt____colon__$7199=(function(a$7220,b$7221){(a$7220["wsb"]=b$7221.wsb);(a$7220["wsa"]=b$7221.wsa);return __lt____lt____colon__$6351(a$7220,b$7221);}));(collapse_operators$7200=(function(){var msg$7341;var longer$7337;var token$7314;var fixity$7315;var name$7316;var t0$7308;var t1$7309;var t2$7310;var $7298$7303;var $index$7372;var $length$7366;var temp$7360;var acc$7354;var $index$7435;var $length$7429;var temp$7423;var acc$7417;var t0$7488;var t1$7489;var t2$7490;var t3$7491;var t0$7536;var t0$7543;var t0$7596;var t0$7603;var t1$7604;var t2$7605;var bridge$7577$7586;var $7575$7581;var t$7572;var results$7566;var $7480$7525;var $7481$7526;var $7482$7527;var bridge$7477$7522;var t0$7523;var $7475$7517;var first$7483;var fixity$7484;var name$7485;var rest$7486;var n$7278;var $7245$7272;var $7246$7273;var $7247$7274;var $7248$7275;var t0$7269;var t1$7270;var buffer$7260;var $7239$7261;var t0$7256;var $7237$7251;($7237$7251=arguments);(t0$7256=$7237$7251.length);if((t0$7256>=1)){(buffer$7260=$7237$7251[0]);($7239$7261=Array.prototype.slice.call($7237$7251,1));(n$7278=buffer$7260.length);$7239$7261;if((!buffer$7260.length)){return [];}else{(t0$7269=$7239$7261);(t1$7270=t0$7269.length);if((($7247$7274=(t1$7270===2))&&(($7248$7275=t0$7269[0])&&t0$7269[1]))){($7298$7303=buffer$7260);if((($7298$7303 instanceof Array)&&(((t0$7308=$7298$7303.length)),((t0$7308===1)&&(((t1$7309=$7298$7303[0])),((token$7314=t1$7309),((t1$7309 instanceof Array)&&(((t2$7310=t1$7309.length)),((t2$7310===3)&&(t1$7309[0]==="OP")))))))))){(fixity$7315=t1$7309[1]);(name$7316=t1$7309[2]);return [__lt____lt____lt____colon__$7199(["ID",name$7316],token$7314)];}else{(longer$7337=$7298$7303);(msg$7341="Too many consecutive operators were found here.");throw $6073(["syntax","nullary"]).create(msg$7341,({"operators":buffer$7260}));}}else{if($7248$7275){t0$7269[1];(acc$7354=[]);(temp$7360=buffer$7260);($length$7366=temp$7360.length);($index$7372=0);$7349:for(;($index$7372<$length$7366);($index$7372++)){var token$7391;var name$7392;var t0$7386;var t1$7387;var m$7381;(m$7381=temp$7360[$index$7372]);(t0$7386=m$7381);(token$7391=t0$7386);if(((t0$7386 instanceof Array)&&(((t1$7387=t0$7386.length)),((t1$7387===3)&&(t0$7386[0]==="OP"))))){t0$7386[1];(name$7392=t0$7386[2]);acc$7354.push(__lt____lt____lt____colon__$7199(["OP","PFX",name$7392],token$7391));}else{$6054(m$7381,"/home/olivier/git/earl-grey/src/lex.eg",8076,8160);}}return acc$7354;}else{if(($7247$7274&&(t0$7269[0],t0$7269[1]))){(acc$7417=[]);(temp$7423=buffer$7260);($length$7429=temp$7423.length);($index$7435=0);$7412:for(;($index$7435<$length$7429);($index$7435++)){var token$7454;var name$7455;var t0$7449;var t1$7450;var m$7444;(m$7444=temp$7423[$index$7435]);(t0$7449=m$7444);(token$7454=t0$7449);if(((t0$7449 instanceof Array)&&(((t1$7450=t0$7449.length)),((t1$7450===3)&&(t0$7449[0]==="OP"))))){t0$7449[1];(name$7455=t0$7449[2]);acc$7417.push(__lt____lt____lt____colon__$7199(["OP","SFX",name$7455],token$7454));}else{$6054(m$7444,"/home/olivier/git/earl-grey/src/lex.eg",8183,8267);}}return acc$7417;}else{$7239$7261;(t0$7488=buffer$7260);if(((t0$7488 instanceof Array)&&(((t1$7489=t0$7488.length)),((t1$7489>=1)&&(((t2$7490=t0$7488[0])),((first$7483=t2$7490),((t2$7490 instanceof Array)&&(((t3$7491=t2$7490.length)),((t3$7491===3)&&(t2$7490[0]==="OP")))))))))){(fixity$7484=t2$7490[1]);(name$7485=t2$7490[2]);(rest$7486=Array.prototype.slice.call(t0$7488,1));}else{$6054(buffer$7260,"/home/olivier/git/earl-grey/src/lex.eg",8320,8326);}($7475$7517=[first$7483.wsb,first$7483.wsa]);(bridge$7477$7522=$7475$7517);if((((bridge$7477$7522 instanceof Array)&&(((t0$7536=bridge$7477$7522.length)),((t0$7536===2)&&((!bridge$7477$7522[0])&&(!bridge$7477$7522[1])))))||((bridge$7477$7522 instanceof Array)&&(((t0$7543=bridge$7477$7522.length)),((t0$7543===2)&&(bridge$7477$7522[0]&&bridge$7477$7522[1])))))){return [__lt____lt____lt____colon__$7199(["OP","IFX",name$7485],first$7483)].concat(collapse_operators$7200(rest$7486,true,false));}else{if((($7480$7525=($7475$7517 instanceof Array))&&(((t0$7523=$7475$7517.length)),(($7482$7527=(t0$7523===2))&&$7475$7517[0])))){$7475$7517[1];return [__lt____lt____lt____colon__$7199(["OP","PFX",name$7485],first$7483)].concat(collapse_operators$7200(rest$7486,true,false));}else{if(($7482$7527&&($7475$7517[0],$7475$7517[1]))){(results$7566=collapse_operators$7200(rest$7486,false,false));(t$7572=((($7575$7581=results$7566)),(((bridge$7577$7586=$7575$7581)),(function(){if((((bridge$7577$7586 instanceof Array)&&(((t0$7596=bridge$7577$7586.length)),(t0$7596===0)))||((bridge$7577$7586 instanceof Array)&&(((t0$7603=bridge$7577$7586.length)),((t0$7603>=1)&&(((t1$7604=bridge$7577$7586[0])),((t1$7604 instanceof Array)&&(((t2$7605=t1$7604.length)),((t2$7605>=2)&&((t1$7604[0]==="OP")&&((t1$7604[1]==="PFX")&&(Array.prototype.slice.call(t1$7604,2),(Array.prototype.slice.call(bridge$7577$7586,1),true))))))))))))){return ["OP","IFX",name$7485];}else{$7575$7581;return ["OP","SFX",name$7485];}})())));return [__lt____lt____lt____colon__$7199(t$7572,first$7483)].concat(results$7566);}else{$6054($7475$7517);}}}}}}}}else{$6054($7237$7251);}}));(buffer$7201=[]);(pfx$7202=true);(collapse$7203=(function(sfx$7643){var rval$7648;(rval$7648=collapse_operators$7200(buffer$7201,pfx$7202,sfx$7643));(buffer$7201=[]);return rval$7648;}));(results$7204=[]);(temp$7662=stream$7190);($length$7668=temp$7662.length);($index$7674=0);$7205:for(;($index$7674<$length$7668);($index$7674++)){var other$7755;var name$7705;var $7210$7706;var t0$7700;var t1$7701;var token$7692;var $7208$7693;var t0$7688;var m$7683;(m$7683=temp$7662[$index$7674]);(t0$7688=m$7683);(token$7692=t0$7688);($7208$7693=t0$7688);(t0$7700=$7208$7693);if(((t0$7700 instanceof Array)&&(((t1$7701=t0$7700.length)),((t1$7701===3)&&(t0$7700[0]==="OP"))))){($7210$7706=t0$7700[1]);(name$7705=t0$7700[2]);if(($7210$7706==="?FX")){buffer$7201.push(token$7692);}else{if(($7210$7706==="IFX")){(results$7204=results$7204.concat(collapse$7203(true)));results$7204.push(token$7692);(pfx$7202=true);}else{if(($7210$7706==="PFX")){(results$7204=results$7204.concat(collapse$7203(false)));results$7204.push(token$7692);(pfx$7202=true);}else{if(($7210$7706==="SFX")){(results$7204=results$7204.concat(collapse$7203(true)));results$7204.push(token$7692);(pfx$7202=false);}else{$6054($7210$7706,"/home/olivier/git/earl-grey/src/lex.eg",9136,9141);}}}}}else{(other$7755=$7208$7693);(results$7204=results$7204.concat(collapse$7203(false)));results$7204.push(token$7692);(pfx$7202=false);}}return results$7204.concat(collapse$7203(true));}));(alternate_operators$6360=(function(stream$7767){var $index$7811;var $length$7805;var temp$7799;var W$7773;var last_op$7774;var results$7775;(W$7773=(function(x$7787){if(x$7787){return "wide";}else{return "short";}}));(last_op$7774=true);(results$7775=[]);(temp$7799=stream$7767);($length$7805=temp$7799.length);($index$7811=0);$7776:for(;($index$7811<$length$7805);($index$7811++)){var x$7845;var $7866$7873;var token$7911;var fixity$7852;var name$7853;var t0$7837;var t1$7838;var token$7829;var $7779$7830;var t0$7825;var m$7820;(m$7820=temp$7799[$index$7811]);(t0$7825=m$7820);(token$7829=t0$7825);($7779$7830=t0$7825);if((((x$7845=$7779$7830)),((x$7845 instanceof Array)&&(x$7845[0]==="IGNORE")))){null;}else{(t0$7837=$7779$7830);if(((t0$7837 instanceof Array)&&(((t1$7838=t0$7837.length)),((t1$7838===3)&&(t0$7837[0]==="OP"))))){(fixity$7852=t0$7837[1]);(name$7853=t0$7837[2]);if(last_op$7774){results$7775.push(["VOID"]);}($7866$7873=fixity$7852);if(($7866$7873==="IFX")){results$7775.push(__lt____lt____colon__$6351(["IFX",W$7773((token$7829.wsa||token$7829.wsb)),name$7853],token$7829));(last_op$7774=true);}else{if(($7866$7873==="PFX")){if((!last_op$7774)){results$7775.push(["IFX",W$7773(token$7829.wsb),"WHITE"],["VOID"]);}results$7775.push(__lt____lt____colon__$6351(["PFX",W$7773(token$7829.wsa),name$7853],token$7829));(last_op$7774=true);}else{if(($7866$7873==="SFX")){results$7775.push(__lt____lt____colon__$6351(["SFX",W$7773(token$7829.wsb),name$7853],token$7829),["VOID"]);(last_op$7774=false);}else{$6054($7866$7873);}}}}else{(token$7911=$7779$7830);if((!last_op$7774)){results$7775.push(["IFX",W$7773(token$7911.wsb),"WHITE"]);}results$7775.push(token$7911);(last_op$7774=false);}}}if(last_op$7774){results$7775.push(["VOID"]);}return results$7775;}));(fill_locations$6361=(function(source$7925,stream$7926){var $index$8023;var $length$8017;var temp$8011;var to_fill$7932;var start$7933;var fill$7934;(to_fill$7932=[]);(start$7933=0);(fill$7934=(function(end$7949){var $index$7972;var $length$7966;var temp$7960;(temp$7960=to_fill$7932);($length$7966=temp$7960.length);($index$7972=0);$7953:for(;($index$7972<$length$7966);($index$7972++)){var token$7998;var token$7989;var m$7981;(m$7981=temp$7960[$index$7972]);(token$7989=m$7981);if(($index$7972===0)){(token$7989["location"]=Location$6350(source$7925,start$7933,end$7949));}else{(token$7998=m$7981);(token$7998["location"]=Location$6350(source$7925,end$7949,end$7949));}}(to_fill$7932=[]);}));(temp$8011=stream$7926);($length$8017=temp$8011.length);($index$8023=0);$7935:for(;($index$8023<$length$8017);($index$8023++)){var other$8056;var location$8041;var t0$8037;var m$8032;(m$8032=temp$8011[$index$8023]);(t0$8037=m$8032);if(($8270(t0$8037,"location")&&((location$8041=t0$8037.location),location$8041))){fill$7934(location$8041.start);(start$7933=location$8041.end);}else{(other$8056=m$8032);to_fill$7932.push(other$8056);}}fill$7934(source$7925.text.length);return stream$7926;}));(tokenize$6362=(function(src$8063){var it$0$8091;var it$0$8085;var it$0$8079;var it$0$8073;var it$0$8067;(it$0$8067=src$8063);(it$0$8073=produce$6356(it$0$8067));(it$0$8079=process_indent$6358(it$0$8073));(it$0$8085=disambiguate_fixity$6359(it$0$8079));(it$0$8091=alternate_operators$6360(it$0$8085));return fill_locations$6361(src$8063,it$0$8091);}));(exports["tokenize"]=tokenize$6362);(exports["process_indent"]=process_indent$6358);(exports["disambiguate_fixity"]=disambiguate_fixity$6359);(exports["alternate_operators"]=alternate_operators$6360);(exports["fill_locations"]=fill_locations$6361);
