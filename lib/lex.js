var $5911=(function(type$5914){var f$5918;(f$5918=type$5914["::check"]);if((f$5918===(void 0))){return (function(value$5924){return (value$5924 instanceof type$5914);});}else{return (function(value$5928){return f$5918.call(type$5914,value$5928);});}});
var $5930=(function(dest$5933,values$5934){var k$5939;(k$5939=null);$5937:for(k$5939 in values$5934){if(values$5934.hasOwnProperty(k$5939)){(dest$5933[k$5939]=values$5934[k$5939]);}}return dest$5933;});
var $5947=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5948=(function($5950$5953){var ph$5959;(ph$5959=$5950$5953);var $5955$5965;($5955$5965=ph$5959);var bridge$5957$5970;var x$5974;(bridge$5957$5970=$5955$5965);if((((typeof(bridge$5957$5970)==="string")&&((x$5974=bridge$5957$5970),true))||((typeof(bridge$5957$5970)==="number")&&((x$5974=bridge$5957$5970),true)))){return ["value",x$5974];}else{var other$5985;(other$5985=$5955$5965);return other$5985["::serialize_ast"]();}});
var $5987=(function(obj$5990){var results$5995;(results$5995=[]);var k$6000;(k$6000=null);$5994:for(k$6000 in obj$5990){if(Object.prototype.hasOwnProperty.call(obj$5990,k$6000)){results$5995.push([k$6000,$5947(obj$5990,k$6000)]);}}return results$5995;});
var $6256=(function(arr$6259){var results$6265;var l$6266;(results$6265=[]);(l$6266=arr$6259.length);var i$6275;(i$6275=0);$6264:for(;(i$6275<l$6266);(i$6275++)){results$6265.push([i$6275,$5947(arr$6259,i$6275)]);}return results$6265;});
var $6023=(function(){var $6024$6030;($6024$6030=(function(tags$6035){var it$0$6038;(it$0$6038=(function(){if((!$5911($6024$6030)(this))){return Object.create($6024$6030.prototype);}else{return this;}})());(it$0$6038["tags"]=tags$6035);return it$0$6038;}));($6024$6030.prototype["create"]=(function(){var it$0$6058;var self$6059;(it$0$6058=this);(self$6059=this);var $6056$6068;($6056$6068=arguments);var t0$6073;var message$6077;var args$6078;(t0$6073=$6056$6068.length);if((t0$6073>=0)){(message$6077=(function(){if((0>=t0$6073)){return "";}else{return $6056$6068[0];}})());(args$6078=Array.prototype.slice.call($6056$6068,1));var e$6091;(e$6091=Error(message$6077));(e$6091["::tags"]=it$0$6058.tags);(e$6091["args"]=args$6078);var temp$6107;(temp$6107=$6256(args$6078));var $length$6113;($length$6113=temp$6107.length);var $index$6119;($index$6119=0);$6092:for(;($index$6119<$length$6113);($index$6119++)){var m$6128;(m$6128=temp$6107[$index$6119]);var t0$6133;var t1$6134;var i$6138;var arg$6139;(t0$6133=m$6128);if(((t0$6133 instanceof Array)&&(((t1$6134=t0$6133.length)),(t1$6134===2)))){(i$6138=t0$6133[0]);(arg$6139=t0$6133[1]);(e$6091[i$6138]=arg$6139);}else{$6004(m$6128);}}(e$6091["length"]=args$6078.length);(e$6091["name"]=["E"].concat(it$0$6058.tags).join("."));return e$6091;}else{$6004($6056$6068);}}));($6024$6030.prototype["::check"]=(function(e$6169){var it$0$6173;var self$6174;(it$0$6173=this);(self$6174=this);var tags$6184;if(((!e$6169)||(!$5911(Error)(e$6169)))){return false;}(tags$6184=(e$6169["::tags"]||[]));var temp$6195;(temp$6195=it$0$6173.tags);var $length$6201;($length$6201=temp$6195.length);var $index$6207;($index$6207=0);$6185:for(;($index$6207<$length$6201);($index$6207++)){var m$6216;(m$6216=temp$6195[$index$6207]);var tag$6224;(tag$6224=m$6216);if((tags$6184.indexOf(tag$6224)===-1)){return false;}else{false;}}return true;}));($6024$6030.prototype["::deconstruct"]=(function(e$6233){var it$0$6237;var self$6238;(it$0$6237=this);(self$6238=this);return e$6233.args;}));$5930($6024$6030,$5930((function(){var accum$6249;(accum$6249=({}));(accum$6249["::name"]="$6024");return accum$6249;})(),(function(){var accum$6253;(accum$6253=({}));(accum$6253["::egclass"]=true);return accum$6253;})()));return $6024$6030;})();
var $6004=(function(value$6007,url$6008,start$6009,end$6010){var err$6014;(err$6014=$6023(["match"]).create("Could not find a match for value",({"value":value$6007})));if(url$6008){(err$6014["location"]=["location",url$6008,start$6009,end$6010]);}throw err$6014;});
var send$5556;var __array_methods$5557;var __re_methods$5558;(send$5556=(function(obj$5571,$5568$5572){var ph$5578;var msg$5579;var t0$5581;(t0$5581=$5568$5572);(msg$5579=t0$5581);(ph$5578=t0$5581);var $5574$5590;($5574$5590=ph$5578);var bridge$5576$5595;(bridge$5576$5595=$5574$5590);if(((typeof(bridge$5576$5595)==="string")||(typeof(bridge$5576$5595)==="number"))){return obj$5571[msg$5579];}else{var other$5607;(other$5607=$5574$5590);return obj$5571["::send"](msg$5579);}}));(Array[":::project"]=(function($5613$5616){var ph$5621;var value$5622;var t0$5624;(t0$5624=$5613$5616);(value$5622=t0$5624);(ph$5621=t0$5624);var $5618$5633;($5618$5633=ph$5621);if($5911(Array)($5618$5633)){return [true,value$5622];}else{$5618$5633;return [true,[value$5622]];}}));(__array_methods$5557=$5930((function(){var accum$5654;(accum$5654=({}));(accum$5654["::check"]=(function(value$5659){if((value$5659 instanceof Array)){var i$5665;(i$5665=0);$5662:for(;(i$5665<this.length);(i$5665++)){if(($5947(this,i$5665)!==$5947(value$5659,i$5665))){return false;}}return true;}else{return false;}}));return accum$5654;})(),$5930((function(){var accum$5674;(accum$5674=({}));(accum$5674["::clone"]=(function(){return $5930(this.slice(0),this);}));return accum$5674;})(),$5930((function(){var accum$5681;(accum$5681=({}));(accum$5681[":::project"]=(function(value$5686){if((value$5686 instanceof Array)){var i$5692;(i$5692=0);$5689:for(;(i$5692<this.length);(i$5692++)){if(($5947(this,i$5692)!==$5947(value$5686,i$5692))){return [true,this.concat([value$5686])];}}return [true,value$5686];}else{return [true,this.concat([value$5686])];}}));return accum$5681;})(),(function(){var accum$5701;(accum$5701=({}));(accum$5701["::serialize_ast"]=(function(){return ["array"].concat(this.map($5948));}));return accum$5701;})()))));var temp$5711;(temp$5711=$5987(__array_methods$5557));var $length$5717;($length$5717=temp$5711.length);var $index$5723;($index$5723=0);$5559:for(;($index$5723<$length$5717);($index$5723++)){var m$5732;(m$5732=temp$5711[$index$5723]);var t0$5737;var t1$5738;var k$5742;var v$5743;(t0$5737=m$5732);if(((t0$5737 instanceof Array)&&(((t1$5738=t0$5737.length)),(t1$5738===2)))){(k$5742=t0$5737[0]);(v$5743=t0$5737[1]);if((!$5947(Array.prototype,k$5742))){Object.defineProperty(Array.prototype,k$5742,({"enumerable":false,"value":v$5743}));}}else{$6004(m$5732);}}(__re_methods$5558=$5930((function(){var accum$5763;(accum$5763=({}));(accum$5763["::check"]=(function($5767$5770){var ph$5775;(ph$5775=$5767$5770);var $5772$5781;($5772$5781=ph$5775);var value$5789;if((typeof($5772$5781)==="string")){(value$5789=$5772$5781);if(value$5789.match(this)){return true;}else{return false;}}else{var other$5794;(other$5794=$5772$5781);return false;}}));return accum$5763;})(),(function(){var accum$5797;(accum$5797=({}));(accum$5797[":::project"]=(function($5801$5804){var ph$5809;(ph$5809=$5801$5804);var $5806$5815;($5806$5815=ph$5809);var value$5823;if((typeof($5806$5815)==="string")){(value$5823=$5806$5815);var $5826$5831;($5826$5831=value$5823.match(this));var m$5839;if(($5826$5831===null)){(m$5839=$5826$5831);return [false,null];}else{var m$5844;(m$5844=$5826$5831);return [true,m$5844];}}else{var other$5848;(other$5848=$5806$5815);return [false,null];}}));return accum$5797;})()));var temp$5854;(temp$5854=$5987(__re_methods$5558));var $length$5860;($length$5860=temp$5854.length);var $index$5866;($index$5866=0);$5562:for(;($index$5866<$length$5860);($index$5866++)){var m$5875;(m$5875=temp$5854[$index$5866]);var t0$5880;var t1$5881;var k$5885;var v$5886;(t0$5880=m$5875);if(((t0$5880 instanceof Array)&&(((t1$5881=t0$5880.length)),(t1$5881===2)))){(k$5885=t0$5880[0]);(v$5886=t0$5880[1]);if((!$5947(RegExp.prototype,k$5885))){Object.defineProperty(RegExp.prototype,k$5885,({"enumerable":false,"value":v$5886}));}}else{$6004(m$5875);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$5930(({"enumerable":false}),(function(){var accum$5904;(accum$5904=({}));(accum$5904["value"]=(function(args$5909){return this.apply(this,args$5909);}));return accum$5904;})()));}
var $8042=(function(type$8045){return (function(value$8049){var f$8053;(f$8053=type$8045[":::project"]);if((f$8053===(void 0))){(f$8053=type$8045["::project"]);if((f$8053===(void 0))){return [true,type$8045(value$8049)];}else{var rval$8066;(rval$8066=false);try{(rval$8066=[true,f$8053(value$8049)]);}catch(excv$8077){var e$8083;(e$8083=excv$8077);(rval$8066=[false,null]);}return rval$8066;}}else{return f$8053.call(type$8045,value$8049);}});});
var $8195=(function($8197$8200,key$8201){var ph$8209;(ph$8209=$8197$8200);var $8203$8215;($8203$8215=ph$8209);var bridge$8205$8220;(bridge$8205$8220=$8203$8215);if(((bridge$8205$8220===null)||(bridge$8205$8220===(void 0)))){return false;}else{var x$8232;if((typeof($8203$8215)==="string")){(x$8232=$8203$8215);return (key$8201 in String.prototype);}else{var x$8237;if((typeof($8203$8215)==="number")){(x$8237=$8203$8215);return (key$8201 in Number.prototype);}else{var x$8242;(x$8242=$8203$8215);return (key$8201 in x$8242);}}}});
var $8111=(function($8113$8116){var ph$8126;var x$8127;var t0$8129;(t0$8129=$8113$8116);(x$8127=t0$8129);(ph$8126=t0$8129);var $8118$8138;($8118$8138=ph$8126);var bridge$8120$8143;(bridge$8120$8143=$8118$8138);if(((function(){var bridge$8121$8153;(bridge$8121$8153=bridge$8120$8143);return ((function(){var bridge$8122$8160;(bridge$8122$8160=bridge$8121$8153);return ((bridge$8122$8160===(void 0))||(bridge$8122$8160===null));})()||(typeof(bridge$8121$8153)==="string"));})()||(typeof(bridge$8120$8143)==="number"))){return x$8127;}else{if($8195($8118$8138,"::clone")){$8118$8138["::clone"];return x$8127["::clone"]();}else{$8118$8138;if((Object.getPrototypeOf(x$8127)===Object.prototype)){var dest$8178;(dest$8178=({}));var k$8183;(k$8183=null);$8177:for(k$8183 in x$8127){if(Object.prototype.hasOwnProperty.call(x$8127,k$8183)){(dest$8178[k$8183]=x$8127[k$8183]);}}return dest$8178;}else{var other$8193;(other$8193=$8118$8138);throw $6023(["clone"]).create("Object cannot be cloned",({"obj":x$8127}));}}}});
var $8089=(function(a$8092,b$8093){var dest$8098;(dest$8098=$8111(a$8092));var k$8103;(k$8103=null);$8097:for(k$8103 in b$8093){if(Object.prototype.hasOwnProperty.call(b$8093,k$8103)){(dest$8098[k$8103]=b$8093[k$8103]);}}return dest$8098;});var id$6347;var id_f$6348;var numr$6349;var numr_f$6350;var num$6351;var num_f$6352;var str$6353;var str_f$6354;var op$6355;var op2$6356;var op3$6357;var op4$6358;var op_f$6359;var indent$6360;var indent_f$6361;var cmnt$6362;var cmnt_f$6363;var unkn$6364;var unkn_f$6365;var $6284$6299;var Location$6300;var __lt____lt____colon__$6301;var special_ops$6302;var regexps$6303;var ws_re$6304;var eol_re$6305;var produce$6306;var indent_tracker$6307;var process_indent$6308;var disambiguate_fixity$6309;var alternate_operators$6310;var fill_locations$6311;var tokenize$6312;($6284$6299=require("./location"));(Location$6300=$6284$6299.Location);(__lt____lt____colon__$6301=$6284$6299["<<:"]);(special_ops$6302=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));(regexps$6303=(((id$6347=RegExp("(?:^(?:(?:[a-zA-Z$_](?:[a-zA-Z$_0-9]*))|\\.\\.\\.))",""))),((id_f$6348=(function(m$6373){return ["ID",m$6373[0]];}))),((numr$6349=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$6350=(function(m$6383){var t0$6393;var t1$6394;var frac$6414;var radix$6388;var intp$6389;var frac$6390;var value$6391;(t0$6393=m$6383);if(((t0$6393 instanceof Array)&&(((t1$6394=t0$6393.length)),(t1$6394===4)))){t0$6393[0];(radix$6388=t0$6393[1]);(intp$6389=t0$6393[2]);(frac$6390=t0$6393[3]);}else{$6004(m$6383,"/home/olivier/git/earl-grey/src/lex.eg",1082,1083);}(value$6391=parseInt(intp$6389.replace(RegExp("_","g"),""),radix$6388));if(frac$6390){(frac$6414=frac$6390.replace(RegExp("_","g"),""));(value$6391=(value$6391+(parseInt(frac$6390,radix$6388)/Math.pow(radix$6388,frac$6390.length))));}return ["NUM",value$6391];}))),((num$6351=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$6352=(function(m$6429){return ["NUM",parseFloat(m$6429[0].replace(RegExp("_","g"),""))];}))),((str$6353=RegExp("(?:^\"((?:(?:(?:\\\\.)|[^\"])*))\")",""))),((str_f$6354=(function(m$6439){var rx$6454;var f$6455;var repl$6444;var r$6445;(repl$6444=({"b":String.fromCharCode(8),"f":String.fromCharCode(12),"n":"\n","r":String.fromCharCode(13),"t":String.fromCharCode(9)}));(r$6445=(((rx$6454=RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\.","g"))),((f$6455=(function($6462$6465){var chr$6506;var digits$6487;var t0$6481;var t1$6482;var t2$6483;var $6467$6476;var ph$6470;(ph$6470=$6462$6465);($6467$6476=ph$6470);(t0$6481=$8042(RegExp("^(?:\\\\u|\\\\x)(.*)",""))($6467$6476));if((t0$6481[0]&&(((t1$6482=t0$6481[1])),(((t2$6483=t1$6482.length)),(t2$6483===2))))){t1$6482[0];(digits$6487=t1$6482[1]);return String.fromCharCode(parseInt(digits$6487,16));}else{(t0$6481=$8042(RegExp("^.(.)",""))($6467$6476));if((t0$6481[0]&&(((t1$6482=t0$6481[1])),(((t2$6483=t1$6482.length)),(t2$6483===2))))){t1$6482[0];(chr$6506=t1$6482[1]);return ($5947(repl$6444,chr$6506)||chr$6506);}else{$6004($6467$6476);}}}))),m$6439[1].replace(rx$6454,f$6455)));return ["STR",r$6445];}))),((op$6355=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$6356=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$6357=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$6358=RegExp("(?:^`((?:[A-Za-z0-9_$]+))`)",""))),((op_f$6359=(function(m$6544,column$6545){var fixity$6577;var otherwise$6583;var $6553$6566;var $6549$6560;var op$6554;(op$6554=(m$6544[1]||m$6544[0]));($6549$6560=null);$6549$6560;if((op$6554==="|")){return ["INDENT",(column$6545-1)];}else{if((op$6554 in special_ops$6302)){(fixity$6577=$5947(special_ops$6302,op$6554));return ["OP",fixity$6577,op$6554];}else{(otherwise$6583=$6549$6560);return ["OP","?FX",op$6554];}}}))),((indent$6360=RegExp("(?:^(?:(?:\n(?: *);(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$6361=(function(m$6593){var ilen$6597;(ilen$6597=m$6593[1].length);return ["INDENT",ilen$6597];}))),((cmnt$6362=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$6363=(function(m$6609){return ["IGNORE"];}))),((unkn$6364=RegExp("(?:^.)",""))),((unkn_f$6365=(function(m$6619){return ["ILLEGAL",m$6619[0]];}))),[[op3$6357,op_f$6359],[id$6347,id_f$6348],[numr$6349,numr_f$6350],[num$6351,num_f$6352],[str$6353,str_f$6354],[op$6355,op_f$6359],[op2$6356,op_f$6359],[op4$6358,op_f$6359],[indent$6360,indent_f$6361],[cmnt$6362,cmnt_f$6363],[unkn$6364,unkn_f$6365]]));(ws_re$6304=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));(eol_re$6305=RegExp("(?:^(?: *)(?:\n|$))",""));(produce$6306=(function(src$6633){var text$6642;var results$6643;var wsb$6644;var pos$6645;var column$6646;(text$6642=src$6633.text);(results$6643=[]);(wsb$6644=text$6642.match(ws_re$6304)[0].length);(text$6642=text$6642.slice(wsb$6644));(pos$6645=wsb$6644);(column$6646=0);$6665:while(text$6642){var i$6671;(i$6671=0);$6668:for(;(i$6671<regexps$6303.length);(++i$6671)){var t0$6685;var t1$6686;var splits$6735;var skip$6718;var endpos$6719;var wsa$6720;var eol$6721;var bwsb$6722;var bwsa$6723;var token$6724;var re$6681;var fn$6682;var m$6683;(t0$6685=$5947(regexps$6303,i$6671));if(((t0$6685 instanceof Array)&&(((t1$6686=t0$6685.length)),(t1$6686===2)))){(re$6681=t0$6685[0]);(fn$6682=t0$6685[1]);}else{$6004($5947(regexps$6303,i$6671),"/home/olivier/git/earl-grey/src/lex.eg",4103,4113);}(m$6683=text$6642.match(re$6681));if(m$6683){(skip$6718=m$6683[0].length);(endpos$6719=(pos$6645+skip$6718));(column$6646=(((splits$6735=m$6683[0].split("\n"))),(function(){if((splits$6735.length>1)){return $5947(splits$6735,(splits$6735.length-1)).length;}else{return (column$6646+skip$6718);}})()));(text$6642=text$6642.slice(skip$6718));(wsa$6720=text$6642.match(ws_re$6304)[0].length);(eol$6721=(text$6642.match(eol_re$6305)&&true));(bwsb$6722=(wsb$6644>0));(bwsa$6723=(function(){if(eol$6721){return bwsb$6722;}else{return (wsa$6720>0);}})());(token$6724=fn$6682(m$6683,column$6646));(token$6724["wsb"]=bwsb$6722);(token$6724["wsa"]=bwsa$6723);(token$6724["location"]=Location$6300(src$6633,pos$6645,endpos$6719));results$6643.push(token$6724);(text$6642=text$6642.slice(wsa$6720));(column$6646=(column$6646+wsa$6720));(wsb$6644=wsa$6720);(pos$6645=(endpos$6719+wsa$6720));break $6668;}}}return results$6643;}));(indent_tracker$6307=(function(){var curr$6789;var stack$6790;var stacks$6791;(curr$6789=0);(stack$6790=[]);(stacks$6791=[stack$6790]);return (function($6787$6802){var t0$6825;var rval$6893;var $index$6973;var $length$6967;var temp$6961;var acc$6955;var rval$6947;var x$7004;var $index$7032;var $length$7026;var temp$7020;var acc$7014;var other$7053;var fixity$6934;var fixity$6914;var stuff$6909;var new_indent$6850;var $6806$6851;var $6818$6844;var $6819$6845;var $6820$6846;var $6821$6847;var t0$6839;var t1$6840;var bridge$6813$6841;var bridge$6815$6842;var $6804$6834;var ph$6822;var token$6823;(t0$6825=$6787$6802);(token$6823=t0$6825);(ph$6822=t0$6825);($6804$6834=ph$6822);if((($6818$6844=($6804$6834 instanceof Array))&&(((t0$6839=$6804$6834.length)),((t0$6839===2)&&($6804$6834[0]==="INDENT"))))){(t1$6840=$6804$6834[1]);(new_indent$6850=t1$6840);($6806$6851=t1$6840);$6806$6851;if((curr$6789===false)){(curr$6789=new_indent$6850);return [$8089(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6806$6851>curr$6789)){stack$6790.push(curr$6789);(curr$6789=new_indent$6850);return [$8089(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($6806$6851===curr$6789)){return [$8089(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6806$6851<curr$6789)){(rval$6893=[]);$6897:while(((stack$6790.length>0)&&(new_indent$6850<curr$6789))){(curr$6789=stack$6790.pop());rval$6893.push($8089(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$6893.push($8089(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$6893;}else{$6004($6806$6851,"/home/olivier/git/earl-grey/src/lex.eg",5480,5496);}}}}}else{if(($6818$6844&&((t0$6839>=1)&&($6804$6834[0]==="ID")))){(stuff$6909=Array.prototype.slice.call($6804$6834,1));return [token$6823];}else{if(($6818$6844&&(($6820$6846=(t0$6839===3))&&(($6821$6847=($6804$6834[0]==="OP"))&&((fixity$6914=$6804$6834[1]),(((bridge$6813$6841=$6804$6834[2])),((bridge$6813$6841==="[")||(bridge$6813$6841==="{")))))))){stack$6790.push(curr$6789);stacks$6791.push(stack$6790);(stack$6790=[]);(curr$6789=false);return [token$6823];}else{if(($6821$6847&&((fixity$6934=$6804$6834[1]),(((bridge$6815$6842=$6804$6834[2])),((bridge$6815$6842==="]")||(bridge$6815$6842==="}")))))){(rval$6947=(((acc$6955=[])),(((temp$6961=stack$6790)),((($length$6967=temp$6961.length)),((($index$6973=0)),(function(){$6950:for(;($index$6973<$length$6967);($index$6973++)){var m$6982;(m$6982=temp$6961[$index$6973]);m$6982;acc$6955.push($8089(["OP","SFX","]"],({"wsb":true,"wsa":true})));}})()))),acc$6955));(stack$6790=stacks$6791.pop());(curr$6789=stack$6790.pop());rval$6947.push(token$6823);return rval$6947;}else{if((((x$7004=$6804$6834)),((x$7004 instanceof Array)&&(x$7004[0]==="EOF")))){(acc$7014=[]);(temp$7020=stack$6790);($length$7026=temp$7020.length);($index$7032=0);$7009:for(;($index$7032<$length$7026);($index$7032++)){var m$7041;(m$7041=temp$7020[$index$7032]);m$7041;acc$7014.push($8089(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$7014;}else{(other$7053=$6804$6834);return [token$6823];}}}}}});}));(process_indent$6308=(function(stream$7060){var $index$7091;var $length$7085;var temp$7079;var tracker$7065;var results$7066;(tracker$7065=indent_tracker$6307());(results$7066=[]);(temp$7079=stream$7060);($length$7085=temp$7079.length);($index$7091=0);$7067:for(;($index$7091<$length$7085);($index$7091++)){var token$7108;var m$7100;(m$7100=temp$7079[$index$7091]);(token$7108=m$7100);(results$7066=results$7066.concat(tracker$7065(token$7108)));}return results$7066.concat(tracker$7065(["EOF"]));}));(disambiguate_fixity$6309=(function(stream$7115){var $index$7599;var $length$7593;var temp$7587;var __lt____lt____lt____colon__$7124;var collapse_operators$7125;var buffer$7126;var pfx$7127;var collapse$7128;var results$7129;(__lt____lt____lt____colon__$7124=(function(a$7145,b$7146){(a$7145["wsb"]=b$7146.wsb);(a$7145["wsa"]=b$7146.wsa);return __lt____lt____colon__$6301(a$7145,b$7146);}));(collapse_operators$7125=(function(){var msg$7266;var longer$7262;var token$7239;var fixity$7240;var name$7241;var t0$7233;var t1$7234;var t2$7235;var $7223$7228;var $index$7297;var $length$7291;var temp$7285;var acc$7279;var $index$7360;var $length$7354;var temp$7348;var acc$7342;var t0$7413;var t1$7414;var t2$7415;var t3$7416;var t0$7461;var t0$7468;var t0$7521;var t0$7528;var t1$7529;var t2$7530;var bridge$7502$7511;var $7500$7506;var t$7497;var results$7491;var $7405$7450;var $7406$7451;var $7407$7452;var bridge$7402$7447;var t0$7448;var $7400$7442;var first$7408;var fixity$7409;var name$7410;var rest$7411;var n$7203;var $7170$7197;var $7171$7198;var $7172$7199;var $7173$7200;var t0$7194;var t1$7195;var buffer$7185;var $7164$7186;var t0$7181;var $7162$7176;($7162$7176=arguments);(t0$7181=$7162$7176.length);if((t0$7181>=1)){(buffer$7185=$7162$7176[0]);($7164$7186=Array.prototype.slice.call($7162$7176,1));(n$7203=buffer$7185.length);$7164$7186;if((!buffer$7185.length)){return [];}else{(t0$7194=$7164$7186);(t1$7195=t0$7194.length);if((($7172$7199=(t1$7195===2))&&(($7173$7200=t0$7194[0])&&t0$7194[1]))){($7223$7228=buffer$7185);if((($7223$7228 instanceof Array)&&(((t0$7233=$7223$7228.length)),((t0$7233===1)&&(((t1$7234=$7223$7228[0])),((token$7239=t1$7234),((t1$7234 instanceof Array)&&(((t2$7235=t1$7234.length)),((t2$7235===3)&&(t1$7234[0]==="OP")))))))))){(fixity$7240=t1$7234[1]);(name$7241=t1$7234[2]);return [__lt____lt____lt____colon__$7124(["ID",name$7241],token$7239)];}else{(longer$7262=$7223$7228);(msg$7266="Too many consecutive operators were found here.");throw $6023(["syntax","nullary"]).create(msg$7266,({"operators":buffer$7185}));}}else{if($7173$7200){t0$7194[1];(acc$7279=[]);(temp$7285=buffer$7185);($length$7291=temp$7285.length);($index$7297=0);$7274:for(;($index$7297<$length$7291);($index$7297++)){var token$7316;var name$7317;var t0$7311;var t1$7312;var m$7306;(m$7306=temp$7285[$index$7297]);(t0$7311=m$7306);(token$7316=t0$7311);if(((t0$7311 instanceof Array)&&(((t1$7312=t0$7311.length)),((t1$7312===3)&&(t0$7311[0]==="OP"))))){t0$7311[1];(name$7317=t0$7311[2]);acc$7279.push(__lt____lt____lt____colon__$7124(["OP","PFX",name$7317],token$7316));}else{$6004(m$7306,"/home/olivier/git/earl-grey/src/lex.eg",7851,7935);}}return acc$7279;}else{if(($7172$7199&&(t0$7194[0],t0$7194[1]))){(acc$7342=[]);(temp$7348=buffer$7185);($length$7354=temp$7348.length);($index$7360=0);$7337:for(;($index$7360<$length$7354);($index$7360++)){var token$7379;var name$7380;var t0$7374;var t1$7375;var m$7369;(m$7369=temp$7348[$index$7360]);(t0$7374=m$7369);(token$7379=t0$7374);if(((t0$7374 instanceof Array)&&(((t1$7375=t0$7374.length)),((t1$7375===3)&&(t0$7374[0]==="OP"))))){t0$7374[1];(name$7380=t0$7374[2]);acc$7342.push(__lt____lt____lt____colon__$7124(["OP","SFX",name$7380],token$7379));}else{$6004(m$7369,"/home/olivier/git/earl-grey/src/lex.eg",7958,8042);}}return acc$7342;}else{$7164$7186;(t0$7413=buffer$7185);if(((t0$7413 instanceof Array)&&(((t1$7414=t0$7413.length)),((t1$7414>=1)&&(((t2$7415=t0$7413[0])),((first$7408=t2$7415),((t2$7415 instanceof Array)&&(((t3$7416=t2$7415.length)),((t3$7416===3)&&(t2$7415[0]==="OP")))))))))){(fixity$7409=t2$7415[1]);(name$7410=t2$7415[2]);(rest$7411=Array.prototype.slice.call(t0$7413,1));}else{$6004(buffer$7185,"/home/olivier/git/earl-grey/src/lex.eg",8095,8101);}($7400$7442=[first$7408.wsb,first$7408.wsa]);(bridge$7402$7447=$7400$7442);if((((bridge$7402$7447 instanceof Array)&&(((t0$7461=bridge$7402$7447.length)),((t0$7461===2)&&((!bridge$7402$7447[0])&&(!bridge$7402$7447[1])))))||((bridge$7402$7447 instanceof Array)&&(((t0$7468=bridge$7402$7447.length)),((t0$7468===2)&&(bridge$7402$7447[0]&&bridge$7402$7447[1])))))){return [__lt____lt____lt____colon__$7124(["OP","IFX",name$7410],first$7408)].concat(collapse_operators$7125(rest$7411,true,false));}else{if((($7405$7450=($7400$7442 instanceof Array))&&(((t0$7448=$7400$7442.length)),(($7407$7452=(t0$7448===2))&&$7400$7442[0])))){$7400$7442[1];return [__lt____lt____lt____colon__$7124(["OP","PFX",name$7410],first$7408)].concat(collapse_operators$7125(rest$7411,true,false));}else{if(($7407$7452&&($7400$7442[0],$7400$7442[1]))){(results$7491=collapse_operators$7125(rest$7411,false,false));(t$7497=((($7500$7506=results$7491)),(((bridge$7502$7511=$7500$7506)),(function(){if((((bridge$7502$7511 instanceof Array)&&(((t0$7521=bridge$7502$7511.length)),(t0$7521===0)))||((bridge$7502$7511 instanceof Array)&&(((t0$7528=bridge$7502$7511.length)),((t0$7528>=1)&&(((t1$7529=bridge$7502$7511[0])),((t1$7529 instanceof Array)&&(((t2$7530=t1$7529.length)),((t2$7530>=2)&&((t1$7529[0]==="OP")&&((t1$7529[1]==="PFX")&&(Array.prototype.slice.call(t1$7529,2),(Array.prototype.slice.call(bridge$7502$7511,1),true))))))))))))){return ["OP","IFX",name$7410];}else{$7500$7506;return ["OP","SFX",name$7410];}})())));return [__lt____lt____lt____colon__$7124(t$7497,first$7408)].concat(results$7491);}else{$6004($7400$7442);}}}}}}}}else{$6004($7162$7176);}}));(buffer$7126=[]);(pfx$7127=true);(collapse$7128=(function(sfx$7568){var rval$7573;(rval$7573=collapse_operators$7125(buffer$7126,pfx$7127,sfx$7568));(buffer$7126=[]);return rval$7573;}));(results$7129=[]);(temp$7587=stream$7115);($length$7593=temp$7587.length);($index$7599=0);$7130:for(;($index$7599<$length$7593);($index$7599++)){var other$7680;var name$7630;var $7135$7631;var t0$7625;var t1$7626;var token$7617;var $7133$7618;var t0$7613;var m$7608;(m$7608=temp$7587[$index$7599]);(t0$7613=m$7608);(token$7617=t0$7613);($7133$7618=t0$7613);(t0$7625=$7133$7618);if(((t0$7625 instanceof Array)&&(((t1$7626=t0$7625.length)),((t1$7626===3)&&(t0$7625[0]==="OP"))))){($7135$7631=t0$7625[1]);(name$7630=t0$7625[2]);if(($7135$7631==="?FX")){buffer$7126.push(token$7617);}else{if(($7135$7631==="IFX")){(results$7129=results$7129.concat(collapse$7128(true)));results$7129.push(token$7617);(pfx$7127=true);}else{if(($7135$7631==="PFX")){(results$7129=results$7129.concat(collapse$7128(false)));results$7129.push(token$7617);(pfx$7127=true);}else{if(($7135$7631==="SFX")){(results$7129=results$7129.concat(collapse$7128(true)));results$7129.push(token$7617);(pfx$7127=false);}else{$6004($7135$7631,"/home/olivier/git/earl-grey/src/lex.eg",8911,8916);}}}}}else{(other$7680=$7133$7618);(results$7129=results$7129.concat(collapse$7128(false)));results$7129.push(token$7617);(pfx$7127=false);}}return results$7129.concat(collapse$7128(true));}));(alternate_operators$6310=(function(stream$7692){var $index$7736;var $length$7730;var temp$7724;var W$7698;var last_op$7699;var results$7700;(W$7698=(function(x$7712){if(x$7712){return "wide";}else{return "short";}}));(last_op$7699=true);(results$7700=[]);(temp$7724=stream$7692);($length$7730=temp$7724.length);($index$7736=0);$7701:for(;($index$7736<$length$7730);($index$7736++)){var x$7770;var $7791$7798;var token$7836;var fixity$7777;var name$7778;var t0$7762;var t1$7763;var token$7754;var $7704$7755;var t0$7750;var m$7745;(m$7745=temp$7724[$index$7736]);(t0$7750=m$7745);(token$7754=t0$7750);($7704$7755=t0$7750);if((((x$7770=$7704$7755)),((x$7770 instanceof Array)&&(x$7770[0]==="IGNORE")))){null;}else{(t0$7762=$7704$7755);if(((t0$7762 instanceof Array)&&(((t1$7763=t0$7762.length)),((t1$7763===3)&&(t0$7762[0]==="OP"))))){(fixity$7777=t0$7762[1]);(name$7778=t0$7762[2]);if(last_op$7699){results$7700.push(["VOID"]);}($7791$7798=fixity$7777);if(($7791$7798==="IFX")){results$7700.push(__lt____lt____colon__$6301(["IFX",W$7698((token$7754.wsa||token$7754.wsb)),name$7778],token$7754));(last_op$7699=true);}else{if(($7791$7798==="PFX")){if((!last_op$7699)){results$7700.push(["IFX",W$7698(token$7754.wsb),"WHITE"],["VOID"]);}results$7700.push(__lt____lt____colon__$6301(["PFX",W$7698(token$7754.wsa),name$7778],token$7754));(last_op$7699=true);}else{if(($7791$7798==="SFX")){results$7700.push(__lt____lt____colon__$6301(["SFX",W$7698(token$7754.wsb),name$7778],token$7754),["VOID"]);(last_op$7699=false);}else{$6004($7791$7798);}}}}else{(token$7836=$7704$7755);if((!last_op$7699)){results$7700.push(["IFX",W$7698(token$7836.wsb),"WHITE"]);}results$7700.push(token$7836);(last_op$7699=false);}}}if(last_op$7699){results$7700.push(["VOID"]);}return results$7700;}));(fill_locations$6311=(function(source$7850,stream$7851){var $index$7948;var $length$7942;var temp$7936;var to_fill$7857;var start$7858;var fill$7859;(to_fill$7857=[]);(start$7858=0);(fill$7859=(function(end$7874){var $index$7897;var $length$7891;var temp$7885;(temp$7885=to_fill$7857);($length$7891=temp$7885.length);($index$7897=0);$7878:for(;($index$7897<$length$7891);($index$7897++)){var token$7923;var token$7914;var m$7906;(m$7906=temp$7885[$index$7897]);(token$7914=m$7906);if(($index$7897===0)){(token$7914["location"]=Location$6300(source$7850,start$7858,end$7874));}else{(token$7923=m$7906);(token$7923["location"]=Location$6300(source$7850,end$7874,end$7874));}}(to_fill$7857=[]);}));(temp$7936=stream$7851);($length$7942=temp$7936.length);($index$7948=0);$7860:for(;($index$7948<$length$7942);($index$7948++)){var other$7981;var location$7966;var t0$7962;var m$7957;(m$7957=temp$7936[$index$7948]);(t0$7962=m$7957);if(($8195(t0$7962,"location")&&((location$7966=t0$7962.location),location$7966))){fill$7859(location$7966.start);(start$7858=location$7966.end);}else{(other$7981=m$7957);to_fill$7857.push(other$7981);}}fill$7859(source$7850.text.length);return stream$7851;}));(tokenize$6312=(function(src$7988){var it$0$8016;var it$0$8010;var it$0$8004;var it$0$7998;var it$0$7992;(it$0$7992=src$7988);(it$0$7998=produce$6306(it$0$7992));(it$0$8004=process_indent$6308(it$0$7998));(it$0$8010=disambiguate_fixity$6309(it$0$8004));(it$0$8016=alternate_operators$6310(it$0$8010));return fill_locations$6311(src$7988,it$0$8016);}));(exports["tokenize"]=tokenize$6312);(exports["process_indent"]=process_indent$6308);(exports["disambiguate_fixity"]=disambiguate_fixity$6309);(exports["alternate_operators"]=alternate_operators$6310);(exports["fill_locations"]=fill_locations$6311);
