var $5216=function(type$5219){var f$5223;(f$5223=type$5219["::check"]);if((f$5223===(void 0))){return function(value$5229){return (value$5229 instanceof type$5219);};}else{return function(value$5233){return f$5223.call(type$5219,value$5233);};}};
var $5235=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5236=function(dest$5239,values$5240){var k$5245;(k$5245=null);$5243:for(k$5245 in values$5240){if(values$5240.hasOwnProperty(k$5245)){(dest$5239[k$5245]=values$5240[k$5245]);}}return dest$5239;};
var $5253=function($5255$5258){var ph$5264;(ph$5264=$5255$5258);var $5260$5270;($5260$5270=ph$5264);var bridge$5262$5275;var x$5279;(bridge$5262$5275=$5260$5270);if((((typeof(bridge$5262$5275)==="string")&&((x$5279=bridge$5262$5275),true))||((typeof(bridge$5262$5275)==="number")&&((x$5279=bridge$5262$5275),true)))){return ["value",x$5279];}else{var other$5290;(other$5290=$5260$5270);return other$5290["::serialize_ast"]();}};
var send$4990;(send$4990=function(obj$4997,$4994$4998){var ph$5004;var msg$5005;var t0$5007;(t0$5007=$4994$4998);(msg$5005=t0$5007);(ph$5004=t0$5007);var $5000$5016;($5000$5016=ph$5004);var bridge$5002$5021;(bridge$5002$5021=$5000$5016);if(((typeof(bridge$5002$5021)==="string")||(typeof(bridge$5002$5021)==="number"))){return obj$4997[msg$5005];}else{var other$5033;(other$5033=$5000$5016);return obj$4997["::send"](msg$5005);}});(Array[":::project"]=function($5039$5042){var ph$5047;var value$5048;var t0$5050;(t0$5050=$5039$5042);(value$5048=t0$5050);(ph$5047=t0$5050);var $5044$5059;($5044$5059=ph$5047);if($5216(Array)($5044$5059)){return [true,value$5048];}else{$5044$5059;return [true,[value$5048]];}});(Array.prototype["::check"]=function(value$5077){if((value$5077 instanceof Array)){var i$5083;(i$5083=0);$5080:for(;(i$5083<this.length);(i$5083++)){if(($5235(this,i$5083)!==$5235(value$5077,i$5083))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $5236(this.slice(0),this);});(Array.prototype[":::project"]=function(value$5102){if((value$5102 instanceof Array)){var i$5108;(i$5108=0);$5105:for(;(i$5108<this.length);(i$5108++)){if(($5235(this,i$5108)!==$5235(value$5102,i$5108))){return [true,[value$5102]];}}return [true,value$5102.slice(this.length)];}else{return [true,[value$5102]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($5253));});(RegExp.prototype["::check"]=function($5126$5129){var ph$5134;(ph$5134=$5126$5129);var $5131$5140;($5131$5140=ph$5134);var value$5148;if((typeof($5131$5140)==="string")){(value$5148=$5131$5140);if(value$5148.match(this)){return true;}else{return false;}}else{var other$5153;(other$5153=$5131$5140);return false;}});(RegExp.prototype[":::project"]=function($5159$5162){var ph$5167;(ph$5167=$5159$5162);var $5164$5173;($5164$5173=ph$5167);var value$5181;if((typeof($5164$5173)==="string")){(value$5181=$5164$5173);var $5184$5189;($5184$5189=value$5181.match(this));var m$5197;if(($5184$5189===null)){(m$5197=$5184$5189);return [false,null];}else{var m$5202;(m$5202=$5184$5189);return [true,m$5202];}}else{var other$5206;(other$5206=$5164$5173);return [false,null];}});(Function.prototype["::send"]=function(args$5213){return this.apply(this,args$5213);});
var $7299=function(arr$7302){var results$7308;var l$7309;(results$7308=[]);(l$7309=arr$7302.length);var i$7318;(i$7318=0);$7307:for(;(i$7318<l$7309);(i$7318++)){results$7308.push([i$7318,$5235(arr$7302,i$7318)]);}return results$7308;};
var $7066=function(){var $7067$7073;($7067$7073=function(tags$7078){var it$0$7081;(it$0$7081=function(){if((!$5216($7067$7073)(this))){return Object.create($7067$7073.prototype);}else{return this;}}());(it$0$7081["tags"]=tags$7078);return it$0$7081;});($7067$7073.prototype["create"]=function(){var it$0$7101;var self$7102;(it$0$7101=this);(self$7102=this);var $7099$7111;($7099$7111=arguments);var t0$7116;var message$7120;var args$7121;(t0$7116=$7099$7111.length);if((t0$7116>=0)){(message$7120=function(){if((0>=t0$7116)){return "";}else{return $7099$7111[0];}}());(args$7121=Array.prototype.slice.call($7099$7111,1));var e$7134;(e$7134=Error(message$7120));(e$7134["::tags"]=it$0$7101.tags);(e$7134["args"]=args$7121);var temp$7150;(temp$7150=$7299(args$7121));var $length$7156;($length$7156=temp$7150.length);var $index$7162;($index$7162=0);$7135:for(;($index$7162<$length$7156);($index$7162++)){var m$7171;(m$7171=temp$7150[$index$7162]);var t0$7176;var t1$7177;var i$7181;var arg$7182;(t0$7176=m$7171);if(((t0$7176 instanceof Array)&&(((t1$7177=t0$7176.length)),(t1$7177===2)))){(i$7181=t0$7176[0]);(arg$7182=t0$7176[1]);(e$7134[i$7181]=arg$7182);}else{$7047(m$7171);}}(e$7134["length"]=args$7121.length);(e$7134["name"]=["E"].concat(it$0$7101.tags).join("."));return e$7134;}else{$7047($7099$7111);}});($7067$7073.prototype["::check"]=function(e$7212){var it$0$7216;var self$7217;(it$0$7216=this);(self$7217=this);var tags$7227;if(((!e$7212)||(!$5216(Error)(e$7212)))){return false;}(tags$7227=(e$7212["::tags"]||[]));var temp$7238;(temp$7238=it$0$7216.tags);var $length$7244;($length$7244=temp$7238.length);var $index$7250;($index$7250=0);$7228:for(;($index$7250<$length$7244);($index$7250++)){var m$7259;(m$7259=temp$7238[$index$7250]);var tag$7267;(tag$7267=m$7259);if((tags$7227.indexOf(tag$7267)===-1)){return false;}else{false;}}return true;});($7067$7073.prototype["::deconstruct"]=function(e$7276){var it$0$7280;var self$7281;(it$0$7280=this);(self$7281=this);return e$7276.args;});$5236($7067$7073,$5236(function(){var accum$7292;(accum$7292=({}));(accum$7292["::name"]="$7067");return accum$7292;}(),function(){var accum$7296;(accum$7296=({}));(accum$7296["::egclass"]=true);return accum$7296;}()));return $7067$7073;}();
var $7047=function(value$7050,url$7051,start$7052,end$7053){var err$7057;(err$7057=$7066(["match"]).create("Could not find a match for value",({"value":value$7050})));if(url$7051){(err$7057["location"]=["location",url$7051,start$7052,end$7053]);}throw err$7057;};
var $7325=function(type$7328){return function(value$7332){var f$7336;(f$7336=type$7328[":::project"]);if((f$7336===(void 0))){(f$7336=type$7328["::project"]);if((f$7336===(void 0))){return [true,type$7328(value$7332)];}else{var rval$7349;(rval$7349=false);try{(rval$7349=[true,f$7336(value$7332)]);}catch(excv$7360){var e$7366;(e$7366=excv$7360);(rval$7349=[false,null]);}return rval$7349;}}else{return f$7336.call(type$7328,value$7332);}};};
var $7478=function($7480$7483,key$7484){var ph$7492;(ph$7492=$7480$7483);var $7486$7498;($7486$7498=ph$7492);var bridge$7488$7503;(bridge$7488$7503=$7486$7498);if(((bridge$7488$7503===null)||(bridge$7488$7503===(void 0)))){return false;}else{var x$7515;if((typeof($7486$7498)==="string")){(x$7515=$7486$7498);return (key$7484 in String.prototype);}else{var x$7520;if((typeof($7486$7498)==="number")){(x$7520=$7486$7498);return (key$7484 in Number.prototype);}else{var x$7525;(x$7525=$7486$7498);return (key$7484 in x$7525);}}}};
var $7394=function($7396$7399){var ph$7409;var x$7410;var t0$7412;(t0$7412=$7396$7399);(x$7410=t0$7412);(ph$7409=t0$7412);var $7401$7421;($7401$7421=ph$7409);var bridge$7403$7426;(bridge$7403$7426=$7401$7421);if((function(){var bridge$7404$7436;(bridge$7404$7436=bridge$7403$7426);return (function(){var bridge$7405$7443;(bridge$7405$7443=bridge$7404$7436);return ((bridge$7405$7443===(void 0))||(bridge$7405$7443===null));}()||(typeof(bridge$7404$7436)==="string"));}()||(typeof(bridge$7403$7426)==="number"))){return x$7410;}else{if($7478($7401$7421,"::clone")){$7401$7421["::clone"];return x$7410["::clone"]();}else{$7401$7421;if((Object.getPrototypeOf(x$7410)===Object.prototype)){var dest$7461;(dest$7461=({}));var k$7466;(k$7466=null);$7460:for(k$7466 in x$7410){if(Object.prototype.hasOwnProperty.call(x$7410,k$7466)){(dest$7461[k$7466]=x$7410[k$7466]);}}return dest$7461;}else{var other$7476;(other$7476=$7401$7421);throw $7066(["clone"]).create("Object cannot be cloned",({"obj":x$7410}));}}}};
var $7372=function(a$7375,b$7376){var dest$7381;(dest$7381=$7394(a$7375));var k$7386;(k$7386=null);$7380:for(k$7386 in b$7376){if(Object.prototype.hasOwnProperty.call(b$7376,k$7386)){(dest$7381[k$7386]=b$7376[k$7386]);}}return dest$7381;};var id$5357;var id_f$5358;var numr$5359;var numr_f$5360;var num$5361;var num_f$5362;var str$5363;var str_f$5364;var op$5365;var op2$5366;var op3$5367;var op4$5368;var op_f$5369;var indent$5370;var indent_f$5371;var cmnt$5372;var cmnt_f$5373;var unkn$5374;var unkn_f$5375;var $5294$5309;var Location$5310;var __lt____lt____colon__$5311;var special_ops$5312;var regexps$5313;var ws_re$5314;var eol_re$5315;var produce$5316;var indent_tracker$5317;var process_indent$5318;var disambiguate_fixity$5319;var alternate_operators$5320;var fill_locations$5321;var tokenize$5322;($5294$5309=require("./location"));(Location$5310=$5294$5309.Location);(__lt____lt____colon__$5311=$5294$5309["<<:"]);(special_ops$5312=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));(regexps$5313=(((id$5357=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$5358=function(m$5383){return ["ID",m$5383[0]];})),((numr$5359=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$5360=function(m$5393){var t0$5403;var t1$5404;var frac$5424;var radix$5398;var intp$5399;var frac$5400;var value$5401;(t0$5403=m$5393);if(((t0$5403 instanceof Array)&&(((t1$5404=t0$5403.length)),(t1$5404===4)))){t0$5403[0];(radix$5398=t0$5403[1]);(intp$5399=t0$5403[2]);(frac$5400=t0$5403[3]);}else{$7047(m$5393,"/home/olivier/git/earl-grey/src/lex.eg",993,994);}(value$5401=parseInt(intp$5399.replace(RegExp("_","g"),""),radix$5398));if(frac$5400){(frac$5424=frac$5400.replace(RegExp("_","g"),""));(value$5401=(value$5401+(parseInt(frac$5400,radix$5398)/Math.pow(radix$5398,frac$5400.length))));}return ["NUM",value$5401];})),((num$5361=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$5362=function(m$5439){return ["NUM",parseFloat(m$5439[0].replace(RegExp("_","g"),""))];})),((str$5363=RegExp("(?:^\"((?:(?:(?:\\\\.)|[^\"])*))\")",""))),((str_f$5364=function(m$5449){var rx$5464;var f$5465;var repl$5454;var r$5455;(repl$5454=({"b":String.fromCharCode(8),"f":String.fromCharCode(12),"n":"\n","r":String.fromCharCode(13),"t":String.fromCharCode(9)}));(r$5455=(((rx$5464=RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\.","g"))),((f$5465=function($5472$5475){var chr$5516;var digits$5497;var t0$5491;var t1$5492;var t2$5493;var $5477$5486;var ph$5480;(ph$5480=$5472$5475);($5477$5486=ph$5480);(t0$5491=$7325(RegExp("^(?:\\\\u|\\\\x)(.*)",""))($5477$5486));if((t0$5491[0]&&(((t1$5492=t0$5491[1])),(((t2$5493=t1$5492.length)),(t2$5493===2))))){t1$5492[0];(digits$5497=t1$5492[1]);return String.fromCharCode(parseInt(digits$5497,16));}else{(t0$5491=$7325(RegExp("^.(.)",""))($5477$5486));if((t0$5491[0]&&(((t1$5492=t0$5491[1])),(((t2$5493=t1$5492.length)),(t2$5493===2))))){t1$5492[0];(chr$5516=t1$5492[1]);return ($5235(repl$5454,chr$5516)||chr$5516);}else{$7047($5477$5486);}}})),m$5449[1].replace(rx$5464,f$5465)));return ["STR",r$5455];})),((op$5365=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$5366=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$5367=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$5368=RegExp("(?:^`((?:[A-Za-z0-9_$]+))`)",""))),((op_f$5369=function(m$5554,column$5555){var fixity$5587;var otherwise$5593;var $5563$5576;var $5559$5570;var op$5564;(op$5564=(m$5554[1]||m$5554[0]));($5559$5570=null);$5559$5570;if((op$5564==="|")){return ["INDENT",(column$5555-1)];}else{if((op$5564 in special_ops$5312)){(fixity$5587=$5235(special_ops$5312,op$5564));return ["OP",fixity$5587,op$5564];}else{(otherwise$5593=$5559$5570);return ["OP","?FX",op$5564];}}})),((indent$5370=RegExp("(?:^(?:(?:\n(?: *);(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$5371=function(m$5603){var ilen$5607;(ilen$5607=m$5603[1].length);return ["INDENT",ilen$5607];})),((cmnt$5372=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$5373=function(m$5619){return ["IGNORE"];})),((unkn$5374=RegExp("(?:^.)",""))),((unkn_f$5375=function(m$5629){return ["ILLEGAL",m$5629[0]];})),[[op3$5367,op_f$5369],[id$5357,id_f$5358],[numr$5359,numr_f$5360],[num$5361,num_f$5362],[str$5363,str_f$5364],[op$5365,op_f$5369],[op2$5366,op_f$5369],[op4$5368,op_f$5369],[indent$5370,indent_f$5371],[cmnt$5372,cmnt_f$5373],[unkn$5374,unkn_f$5375]]));(ws_re$5314=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));(eol_re$5315=RegExp("(?:^(?: *)(?:\n|$))",""));(produce$5316=function(src$5643){var text$5652;var results$5653;var wsb$5654;var pos$5655;var column$5656;(text$5652=src$5643.text);(results$5653=[]);(wsb$5654=text$5652.match(ws_re$5314)[0].length);(text$5652=text$5652.slice(wsb$5654));(pos$5655=wsb$5654);(column$5656=0);$5675:while(text$5652){var i$5681;(i$5681=0);$5678:for(;(i$5681<regexps$5313.length);(++i$5681)){var t0$5695;var t1$5696;var splits$5745;var skip$5728;var endpos$5729;var wsa$5730;var eol$5731;var bwsb$5732;var bwsa$5733;var token$5734;var re$5691;var fn$5692;var m$5693;(t0$5695=$5235(regexps$5313,i$5681));if(((t0$5695 instanceof Array)&&(((t1$5696=t0$5695.length)),(t1$5696===2)))){(re$5691=t0$5695[0]);(fn$5692=t0$5695[1]);}else{$7047($5235(regexps$5313,i$5681),"/home/olivier/git/earl-grey/src/lex.eg",4024,4044);}(m$5693=text$5652.match(re$5691));if(m$5693){(skip$5728=m$5693[0].length);(endpos$5729=(pos$5655+skip$5728));(column$5656=(((splits$5745=m$5693[0].split("\n"))),function(){if((splits$5745.length>1)){return $5235(splits$5745,(splits$5745.length-1)).length;}else{return (column$5656+skip$5728);}}()));(text$5652=text$5652.slice(skip$5728));(wsa$5730=text$5652.match(ws_re$5314)[0].length);(eol$5731=(text$5652.match(eol_re$5315)&&true));(bwsb$5732=(wsb$5654>0));(bwsa$5733=function(){if(eol$5731){return bwsb$5732;}else{return (wsa$5730>0);}}());(token$5734=fn$5692(m$5693,column$5656));(token$5734["wsb"]=bwsb$5732);(token$5734["wsa"]=bwsa$5733);(token$5734["location"]=Location$5310(src$5643,pos$5655,endpos$5729));results$5653.push(token$5734);(text$5652=text$5652.slice(wsa$5730));(column$5656=(column$5656+wsa$5730));(wsb$5654=wsa$5730);(pos$5655=(endpos$5729+wsa$5730));break $5678;}}}return results$5653;});(indent_tracker$5317=function(){var curr$5799;var stack$5800;var stacks$5801;(curr$5799=0);(stack$5800=[]);(stacks$5801=[stack$5800]);return function($5797$5812){var t0$5835;var rval$5903;var $index$5983;var $length$5977;var temp$5971;var acc$5965;var rval$5957;var x$6014;var $index$6042;var $length$6036;var temp$6030;var acc$6024;var other$6063;var fixity$5944;var fixity$5924;var stuff$5919;var new_indent$5860;var $5816$5861;var $5828$5854;var $5829$5855;var $5830$5856;var $5831$5857;var t0$5849;var t1$5850;var bridge$5823$5851;var bridge$5825$5852;var $5814$5844;var ph$5832;var token$5833;(t0$5835=$5797$5812);(token$5833=t0$5835);(ph$5832=t0$5835);($5814$5844=ph$5832);if((($5828$5854=($5814$5844 instanceof Array))&&(((t0$5849=$5814$5844.length)),((t0$5849===2)&&($5814$5844[0]==="INDENT"))))){(t1$5850=$5814$5844[1]);(new_indent$5860=t1$5850);($5816$5861=t1$5850);$5816$5861;if((curr$5799===false)){(curr$5799=new_indent$5860);return [$7372(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($5816$5861>curr$5799)){stack$5800.push(curr$5799);(curr$5799=new_indent$5860);return [$7372(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($5816$5861===curr$5799)){return [$7372(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($5816$5861<curr$5799)){(rval$5903=[]);$5907:while(((stack$5800.length>0)&&(new_indent$5860<curr$5799))){(curr$5799=stack$5800.pop());rval$5903.push($7372(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$5903.push($7372(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$5903;}else{$7047($5816$5861,"/home/olivier/git/earl-grey/src/lex.eg",5401,5417);}}}}}else{if(($5828$5854&&((t0$5849>=1)&&($5814$5844[0]==="ID")))){(stuff$5919=Array.prototype.slice.call($5814$5844,1));return [token$5833];}else{if(($5828$5854&&(($5830$5856=(t0$5849===3))&&(($5831$5857=($5814$5844[0]==="OP"))&&((fixity$5924=$5814$5844[1]),(((bridge$5823$5851=$5814$5844[2])),((bridge$5823$5851==="[")||(bridge$5823$5851==="{")))))))){stack$5800.push(curr$5799);stacks$5801.push(stack$5800);(stack$5800=[]);(curr$5799=false);return [token$5833];}else{if(($5831$5857&&((fixity$5944=$5814$5844[1]),(((bridge$5825$5852=$5814$5844[2])),((bridge$5825$5852==="]")||(bridge$5825$5852==="}")))))){(rval$5957=(((acc$5965=[])),(((temp$5971=stack$5800)),((($length$5977=temp$5971.length)),((($index$5983=0)),function(){$5960:for(;($index$5983<$length$5977);($index$5983++)){var m$5992;(m$5992=temp$5971[$index$5983]);m$5992;acc$5965.push($7372(["OP","SFX","]"],({"wsb":true,"wsa":true})));}}()))),acc$5965));(stack$5800=stacks$5801.pop());(curr$5799=stack$5800.pop());rval$5957.push(token$5833);return rval$5957;}else{if((((x$6014=$5814$5844)),((x$6014 instanceof Array)&&(x$6014[0]==="EOF")))){(acc$6024=[]);(temp$6030=stack$5800);($length$6036=temp$6030.length);($index$6042=0);$6019:for(;($index$6042<$length$6036);($index$6042++)){var m$6051;(m$6051=temp$6030[$index$6042]);m$6051;acc$6024.push($7372(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$6024;}else{(other$6063=$5814$5844);return [token$5833];}}}}}};});(process_indent$5318=function(stream$6070){var $index$6101;var $length$6095;var temp$6089;var tracker$6075;var results$6076;(tracker$6075=indent_tracker$5317());(results$6076=[]);(temp$6089=stream$6070);($length$6095=temp$6089.length);($index$6101=0);$6077:for(;($index$6101<$length$6095);($index$6101++)){var token$6118;var m$6110;(m$6110=temp$6089[$index$6101]);(token$6118=m$6110);(results$6076=results$6076.concat(tracker$6075(token$6118)));}return results$6076.concat(tracker$6075(["EOF"]));});(disambiguate_fixity$5319=function(stream$6125){var $index$6609;var $length$6603;var temp$6597;var __lt____lt____lt____colon__$6134;var collapse_operators$6135;var buffer$6136;var pfx$6137;var collapse$6138;var results$6139;(__lt____lt____lt____colon__$6134=function(a$6155,b$6156){(a$6155["wsb"]=b$6156.wsb);(a$6155["wsa"]=b$6156.wsa);return __lt____lt____colon__$5311(a$6155,b$6156);});(collapse_operators$6135=function(){var msg$6276;var longer$6272;var token$6249;var fixity$6250;var name$6251;var t0$6243;var t1$6244;var t2$6245;var $6233$6238;var $index$6307;var $length$6301;var temp$6295;var acc$6289;var $index$6370;var $length$6364;var temp$6358;var acc$6352;var t0$6423;var t1$6424;var t2$6425;var t3$6426;var t0$6471;var t0$6478;var t0$6531;var t0$6538;var t1$6539;var t2$6540;var bridge$6512$6521;var $6510$6516;var t$6507;var results$6501;var $6415$6460;var $6416$6461;var $6417$6462;var bridge$6412$6457;var t0$6458;var $6410$6452;var first$6418;var fixity$6419;var name$6420;var rest$6421;var n$6213;var $6180$6207;var $6181$6208;var $6182$6209;var $6183$6210;var t0$6204;var t1$6205;var buffer$6195;var $6174$6196;var t0$6191;var $6172$6186;($6172$6186=arguments);(t0$6191=$6172$6186.length);if((t0$6191>=1)){(buffer$6195=$6172$6186[0]);($6174$6196=Array.prototype.slice.call($6172$6186,1));(n$6213=buffer$6195.length);$6174$6196;if((!buffer$6195.length)){return [];}else{(t0$6204=$6174$6196);(t1$6205=t0$6204.length);if((($6182$6209=(t1$6205===2))&&(($6183$6210=t0$6204[0])&&t0$6204[1]))){($6233$6238=buffer$6195);if((($6233$6238 instanceof Array)&&(((t0$6243=$6233$6238.length)),((t0$6243===1)&&(((t1$6244=$6233$6238[0])),((token$6249=t1$6244),((t1$6244 instanceof Array)&&(((t2$6245=t1$6244.length)),((t2$6245===3)&&(t1$6244[0]==="OP")))))))))){(fixity$6250=t1$6244[1]);(name$6251=t1$6244[2]);return [__lt____lt____lt____colon__$6134(["ID",name$6251],token$6249)];}else{(longer$6272=$6233$6238);(msg$6276="Too many consecutive operators were found here.");throw $7066(["syntax","nullary"]).create(msg$6276,({"operators":buffer$6195}));}}else{if($6183$6210){t0$6204[1];(acc$6289=[]);(temp$6295=buffer$6195);($length$6301=temp$6295.length);($index$6307=0);$6284:for(;($index$6307<$length$6301);($index$6307++)){var token$6326;var name$6327;var t0$6321;var t1$6322;var m$6316;(m$6316=temp$6295[$index$6307]);(t0$6321=m$6316);(token$6326=t0$6321);if(((t0$6321 instanceof Array)&&(((t1$6322=t0$6321.length)),((t1$6322===3)&&(t0$6321[0]==="OP"))))){t0$6321[1];(name$6327=t0$6321[2]);acc$6289.push(__lt____lt____lt____colon__$6134(["OP","PFX",name$6327],token$6326));}else{$7047(m$6316,"/home/olivier/git/earl-grey/src/lex.eg",7762,7856);}}return acc$6289;}else{if(($6182$6209&&(t0$6204[0],t0$6204[1]))){(acc$6352=[]);(temp$6358=buffer$6195);($length$6364=temp$6358.length);($index$6370=0);$6347:for(;($index$6370<$length$6364);($index$6370++)){var token$6389;var name$6390;var t0$6384;var t1$6385;var m$6379;(m$6379=temp$6358[$index$6370]);(t0$6384=m$6379);(token$6389=t0$6384);if(((t0$6384 instanceof Array)&&(((t1$6385=t0$6384.length)),((t1$6385===3)&&(t0$6384[0]==="OP"))))){t0$6384[1];(name$6390=t0$6384[2]);acc$6352.push(__lt____lt____lt____colon__$6134(["OP","SFX",name$6390],token$6389));}else{$7047(m$6379,"/home/olivier/git/earl-grey/src/lex.eg",7869,7963);}}return acc$6352;}else{$6174$6196;(t0$6423=buffer$6195);if(((t0$6423 instanceof Array)&&(((t1$6424=t0$6423.length)),((t1$6424>=1)&&(((t2$6425=t0$6423[0])),((first$6418=t2$6425),((t2$6425 instanceof Array)&&(((t3$6426=t2$6425.length)),((t3$6426===3)&&(t2$6425[0]==="OP")))))))))){(fixity$6419=t2$6425[1]);(name$6420=t2$6425[2]);(rest$6421=Array.prototype.slice.call(t0$6423,1));}else{$7047(buffer$6195,"/home/olivier/git/earl-grey/src/lex.eg",8016,8022);}($6410$6452=[first$6418.wsb,first$6418.wsa]);(bridge$6412$6457=$6410$6452);if((((bridge$6412$6457 instanceof Array)&&(((t0$6471=bridge$6412$6457.length)),((t0$6471===2)&&((!bridge$6412$6457[0])&&(!bridge$6412$6457[1])))))||((bridge$6412$6457 instanceof Array)&&(((t0$6478=bridge$6412$6457.length)),((t0$6478===2)&&(bridge$6412$6457[0]&&bridge$6412$6457[1])))))){return [__lt____lt____lt____colon__$6134(["OP","IFX",name$6420],first$6418)].concat(collapse_operators$6135(rest$6421,true,false));}else{if((($6415$6460=($6410$6452 instanceof Array))&&(((t0$6458=$6410$6452.length)),(($6417$6462=(t0$6458===2))&&$6410$6452[0])))){$6410$6452[1];return [__lt____lt____lt____colon__$6134(["OP","PFX",name$6420],first$6418)].concat(collapse_operators$6135(rest$6421,true,false));}else{if(($6417$6462&&($6410$6452[0],$6410$6452[1]))){(results$6501=collapse_operators$6135(rest$6421,false,false));(t$6507=((($6510$6516=results$6501)),(((bridge$6512$6521=$6510$6516)),function(){if((((bridge$6512$6521 instanceof Array)&&(((t0$6531=bridge$6512$6521.length)),(t0$6531===0)))||((bridge$6512$6521 instanceof Array)&&(((t0$6538=bridge$6512$6521.length)),((t0$6538>=1)&&(((t1$6539=bridge$6512$6521[0])),((t1$6539 instanceof Array)&&(((t2$6540=t1$6539.length)),((t2$6540>=2)&&((t1$6539[0]==="OP")&&((t1$6539[1]==="PFX")&&(Array.prototype.slice.call(t1$6539,2),(Array.prototype.slice.call(bridge$6512$6521,1),true))))))))))))){return ["OP","IFX",name$6420];}else{$6510$6516;return ["OP","SFX",name$6420];}}())));return [__lt____lt____lt____colon__$6134(t$6507,first$6418)].concat(results$6501);}else{$7047($6410$6452);}}}}}}}}else{$7047($6172$6186);}});(buffer$6136=[]);(pfx$6137=true);(collapse$6138=function(sfx$6578){var rval$6583;(rval$6583=collapse_operators$6135(buffer$6136,pfx$6137,sfx$6578));(buffer$6136=[]);return rval$6583;});(results$6139=[]);(temp$6597=stream$6125);($length$6603=temp$6597.length);($index$6609=0);$6140:for(;($index$6609<$length$6603);($index$6609++)){var other$6690;var name$6640;var $6145$6641;var t0$6635;var t1$6636;var token$6627;var $6143$6628;var t0$6623;var m$6618;(m$6618=temp$6597[$index$6609]);(t0$6623=m$6618);(token$6627=t0$6623);($6143$6628=t0$6623);(t0$6635=$6143$6628);if(((t0$6635 instanceof Array)&&(((t1$6636=t0$6635.length)),((t1$6636===3)&&(t0$6635[0]==="OP"))))){($6145$6641=t0$6635[1]);(name$6640=t0$6635[2]);if(($6145$6641==="?FX")){buffer$6136.push(token$6627);}else{if(($6145$6641==="IFX")){(results$6139=results$6139.concat(collapse$6138(true)));results$6139.push(token$6627);(pfx$6137=true);}else{if(($6145$6641==="PFX")){(results$6139=results$6139.concat(collapse$6138(false)));results$6139.push(token$6627);(pfx$6137=true);}else{if(($6145$6641==="SFX")){(results$6139=results$6139.concat(collapse$6138(true)));results$6139.push(token$6627);(pfx$6137=false);}else{$7047($6145$6641,"/home/olivier/git/earl-grey/src/lex.eg",8832,8837);}}}}}else{(other$6690=$6143$6628);(results$6139=results$6139.concat(collapse$6138(false)));results$6139.push(token$6627);(pfx$6137=false);}}return results$6139.concat(collapse$6138(true));});(alternate_operators$5320=function(stream$6702){var $index$6747;var $length$6741;var temp$6735;var W$6708;var last_op$6709;var results$6710;(W$6708=function(x$6723){if(x$6723){return "wide";}else{return "short";}});(last_op$6709=true);(results$6710=[]);(temp$6735=stream$6702);($length$6741=temp$6735.length);($index$6747=0);$6711:for(;($index$6747<$length$6741);($index$6747++)){var x$6781;var $6802$6809;var x$6850;var token$6857;var fixity$6788;var name$6789;var t0$6773;var t1$6774;var token$6765;var $6714$6766;var t0$6761;var m$6756;(m$6756=temp$6735[$index$6747]);(t0$6761=m$6756);(token$6765=t0$6761);($6714$6766=t0$6761);if((((x$6781=$6714$6766)),((x$6781 instanceof Array)&&(x$6781[0]==="IGNORE")))){null;}else{(t0$6773=$6714$6766);if(((t0$6773 instanceof Array)&&(((t1$6774=t0$6773.length)),((t1$6774===3)&&(t0$6773[0]==="OP"))))){(fixity$6788=t0$6773[1]);(name$6789=t0$6773[2]);if(last_op$6709){results$6710.push(["VOID"]);}($6802$6809=fixity$6788);if(($6802$6809==="IFX")){results$6710.push(__lt____lt____colon__$5311(["IFX",W$6708((token$6765.wsa||token$6765.wsb)),name$6789],token$6765));(last_op$6709=true);}else{if(($6802$6809==="PFX")){if((!last_op$6709)){results$6710.push(["IFX",W$6708(token$6765.wsb),"WHITE"],["VOID"]);}results$6710.push(__lt____lt____colon__$5311(["PFX",W$6708(token$6765.wsa),name$6789],token$6765));(last_op$6709=true);}else{if(($6802$6809==="SFX")){results$6710.push(__lt____lt____colon__$5311(["SFX",W$6708(token$6765.wsb),name$6789],token$6765),["VOID"]);(last_op$6709=false);}else{$7047($6802$6809);}}}}else{if((((x$6850=$6714$6766)),((x$6850 instanceof Array)&&(x$6850[0]==="ILLEGAL")))){throw $7066(["syntax","illegal"]).create("unknown character",({"chr":token$6765}));}else{(token$6857=$6714$6766);if((!last_op$6709)){results$6710.push(["IFX",W$6708(token$6857.wsb),"WHITE"]);}results$6710.push(token$6857);(last_op$6709=false);}}}}if(last_op$6709){results$6710.push(["VOID"]);}return results$6710;});(fill_locations$5321=function(source$6871,stream$6872){var $index$6969;var $length$6963;var temp$6957;var to_fill$6878;var start$6879;var fill$6880;(to_fill$6878=[]);(start$6879=0);(fill$6880=function(end$6895){var $index$6918;var $length$6912;var temp$6906;(temp$6906=to_fill$6878);($length$6912=temp$6906.length);($index$6918=0);$6899:for(;($index$6918<$length$6912);($index$6918++)){var token$6944;var token$6935;var m$6927;(m$6927=temp$6906[$index$6918]);(token$6935=m$6927);if(($index$6918===0)){(token$6935["location"]=Location$5310(source$6871,start$6879,end$6895));}else{(token$6944=m$6927);(token$6944["location"]=Location$5310(source$6871,end$6895,end$6895));}}(to_fill$6878=[]);});(temp$6957=stream$6872);($length$6963=temp$6957.length);($index$6969=0);$6881:for(;($index$6969<$length$6963);($index$6969++)){var other$7002;var location$6987;var t0$6983;var m$6978;(m$6978=temp$6957[$index$6969]);(t0$6983=m$6978);if(($7478(t0$6983,"location")&&((location$6987=t0$6983.location),location$6987))){fill$6880(location$6987.start);(start$6879=location$6987.end);}else{(other$7002=m$6978);to_fill$6878.push(other$7002);}}fill$6880(source$6871.text.length);return stream$6872;});(tokenize$5322=function(src$7009){var it$0$7037;var it$0$7031;var it$0$7025;var it$0$7019;var it$0$7013;(it$0$7013=src$7009);(it$0$7019=produce$5316(it$0$7013));(it$0$7025=process_indent$5318(it$0$7019));(it$0$7031=disambiguate_fixity$5319(it$0$7025));(it$0$7037=alternate_operators$5320(it$0$7031));return fill_locations$5321(src$7009,it$0$7037);});(exports["tokenize"]=tokenize$5322);
