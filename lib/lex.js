var $5911=(function(type$5914){var f$5918;(f$5918=type$5914["::check"]);if((f$5918===(void 0))){return (function(value$5924){return (value$5924 instanceof type$5914);});}else{return (function(value$5928){return f$5918.call(type$5914,value$5928);});}});
var $5930=(function(dest$5933,values$5934){var k$5939;(k$5939=null);$5937:for(k$5939 in values$5934){if(values$5934.hasOwnProperty(k$5939)){(dest$5933[k$5939]=values$5934[k$5939]);}}return dest$5933;});
var $5947=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5948=(function($5950$5953){var ph$5959;(ph$5959=$5950$5953);var $5955$5965;($5955$5965=ph$5959);var bridge$5957$5970;var x$5974;(bridge$5957$5970=$5955$5965);if((((typeof(bridge$5957$5970)==="string")&&((x$5974=bridge$5957$5970),true))||((typeof(bridge$5957$5970)==="number")&&((x$5974=bridge$5957$5970),true)))){return ["value",x$5974];}else{var other$5985;(other$5985=$5955$5965);return other$5985["::serialize_ast"]();}});
var $5987=(function(obj$5990){var results$5995;(results$5995=[]);var k$6000;(k$6000=null);$5994:for(k$6000 in obj$5990){if(Object.prototype.hasOwnProperty.call(obj$5990,k$6000)){results$5995.push([k$6000,$5947(obj$5990,k$6000)]);}}return results$5995;});
var $6256=(function(arr$6259){var results$6265;var l$6266;(results$6265=[]);(l$6266=arr$6259.length);var i$6275;(i$6275=0);$6264:for(;(i$6275<l$6266);(i$6275++)){results$6265.push([i$6275,$5947(arr$6259,i$6275)]);}return results$6265;});
var $6023=(function(){var $6024$6030;($6024$6030=(function(tags$6035){var it$0$6038;(it$0$6038=(function(){if((!$5911($6024$6030)(this))){return Object.create($6024$6030.prototype);}else{return this;}})());(it$0$6038["tags"]=tags$6035);return it$0$6038;}));($6024$6030.prototype["create"]=(function(){var it$0$6058;var self$6059;(it$0$6058=this);(self$6059=this);var $6056$6068;($6056$6068=arguments);var t0$6073;var message$6077;var args$6078;(t0$6073=$6056$6068.length);if((t0$6073>=0)){(message$6077=(function(){if((0>=t0$6073)){return "";}else{return $6056$6068[0];}})());(args$6078=Array.prototype.slice.call($6056$6068,1));var e$6091;(e$6091=Error(message$6077));(e$6091["::tags"]=it$0$6058.tags);(e$6091["args"]=args$6078);var temp$6107;(temp$6107=$6256(args$6078));var $length$6113;($length$6113=temp$6107.length);var $index$6119;($index$6119=0);$6092:for(;($index$6119<$length$6113);($index$6119++)){var m$6128;(m$6128=temp$6107[$index$6119]);var t0$6133;var t1$6134;var i$6138;var arg$6139;(t0$6133=m$6128);if(((t0$6133 instanceof Array)&&(((t1$6134=t0$6133.length)),(t1$6134===2)))){(i$6138=t0$6133[0]);(arg$6139=t0$6133[1]);(e$6091[i$6138]=arg$6139);}else{$6004(m$6128);}}(e$6091["length"]=args$6078.length);(e$6091["name"]=["E"].concat(it$0$6058.tags).join("."));return e$6091;}else{$6004($6056$6068);}}));($6024$6030.prototype["::check"]=(function(e$6169){var it$0$6173;var self$6174;(it$0$6173=this);(self$6174=this);var tags$6184;if(((!e$6169)||(!$5911(Error)(e$6169)))){return false;}(tags$6184=(e$6169["::tags"]||[]));var temp$6195;(temp$6195=it$0$6173.tags);var $length$6201;($length$6201=temp$6195.length);var $index$6207;($index$6207=0);$6185:for(;($index$6207<$length$6201);($index$6207++)){var m$6216;(m$6216=temp$6195[$index$6207]);var tag$6224;(tag$6224=m$6216);if((tags$6184.indexOf(tag$6224)===-1)){return false;}else{false;}}return true;}));($6024$6030.prototype["::deconstruct"]=(function(e$6233){var it$0$6237;var self$6238;(it$0$6237=this);(self$6238=this);return e$6233.args;}));$5930($6024$6030,$5930((function(){var accum$6249;(accum$6249=({}));(accum$6249["::name"]="$6024");return accum$6249;})(),(function(){var accum$6253;(accum$6253=({}));(accum$6253["::egclass"]=true);return accum$6253;})()));return $6024$6030;})();
var $6004=(function(value$6007,url$6008,start$6009,end$6010){var err$6014;(err$6014=$6023(["match"]).create("Could not find a match for value",({"value":value$6007})));if(url$6008){(err$6014["location"]=["location",url$6008,start$6009,end$6010]);}throw err$6014;});
var send$5556;var __array_methods$5557;var __re_methods$5558;(send$5556=(function(obj$5571,$5568$5572){var ph$5578;var msg$5579;var t0$5581;(t0$5581=$5568$5572);(msg$5579=t0$5581);(ph$5578=t0$5581);var $5574$5590;($5574$5590=ph$5578);var bridge$5576$5595;(bridge$5576$5595=$5574$5590);if(((typeof(bridge$5576$5595)==="string")||(typeof(bridge$5576$5595)==="number"))){return obj$5571[msg$5579];}else{var other$5607;(other$5607=$5574$5590);return obj$5571["::send"](msg$5579);}}));(Array[":::project"]=(function($5613$5616){var ph$5621;var value$5622;var t0$5624;(t0$5624=$5613$5616);(value$5622=t0$5624);(ph$5621=t0$5624);var $5618$5633;($5618$5633=ph$5621);if($5911(Array)($5618$5633)){return [true,value$5622];}else{$5618$5633;return [true,[value$5622]];}}));(__array_methods$5557=$5930((function(){var accum$5654;(accum$5654=({}));(accum$5654["::check"]=(function(value$5659){if((value$5659 instanceof Array)){var i$5665;(i$5665=0);$5662:for(;(i$5665<this.length);(i$5665++)){if(($5947(this,i$5665)!==$5947(value$5659,i$5665))){return false;}}return true;}else{return false;}}));return accum$5654;})(),$5930((function(){var accum$5674;(accum$5674=({}));(accum$5674["::clone"]=(function(){return $5930(this.slice(0),this);}));return accum$5674;})(),$5930((function(){var accum$5681;(accum$5681=({}));(accum$5681[":::project"]=(function(value$5686){if((value$5686 instanceof Array)){var i$5692;(i$5692=0);$5689:for(;(i$5692<this.length);(i$5692++)){if(($5947(this,i$5692)!==$5947(value$5686,i$5692))){return [true,this.concat([value$5686])];}}return [true,value$5686];}else{return [true,this.concat([value$5686])];}}));return accum$5681;})(),(function(){var accum$5701;(accum$5701=({}));(accum$5701["::serialize_ast"]=(function(){return ["array"].concat(this.map($5948));}));return accum$5701;})()))));var temp$5711;(temp$5711=$5987(__array_methods$5557));var $length$5717;($length$5717=temp$5711.length);var $index$5723;($index$5723=0);$5559:for(;($index$5723<$length$5717);($index$5723++)){var m$5732;(m$5732=temp$5711[$index$5723]);var t0$5737;var t1$5738;var k$5742;var v$5743;(t0$5737=m$5732);if(((t0$5737 instanceof Array)&&(((t1$5738=t0$5737.length)),(t1$5738===2)))){(k$5742=t0$5737[0]);(v$5743=t0$5737[1]);if((!$5947(Array.prototype,k$5742))){Object.defineProperty(Array.prototype,k$5742,({"enumerable":false,"value":v$5743}));}}else{$6004(m$5732);}}(__re_methods$5558=$5930((function(){var accum$5763;(accum$5763=({}));(accum$5763["::check"]=(function($5767$5770){var ph$5775;(ph$5775=$5767$5770);var $5772$5781;($5772$5781=ph$5775);var value$5789;if((typeof($5772$5781)==="string")){(value$5789=$5772$5781);if(value$5789.match(this)){return true;}else{return false;}}else{var other$5794;(other$5794=$5772$5781);return false;}}));return accum$5763;})(),(function(){var accum$5797;(accum$5797=({}));(accum$5797[":::project"]=(function($5801$5804){var ph$5809;(ph$5809=$5801$5804);var $5806$5815;($5806$5815=ph$5809);var value$5823;if((typeof($5806$5815)==="string")){(value$5823=$5806$5815);var $5826$5831;($5826$5831=value$5823.match(this));var m$5839;if(($5826$5831===null)){(m$5839=$5826$5831);return [false,null];}else{var m$5844;(m$5844=$5826$5831);return [true,m$5844];}}else{var other$5848;(other$5848=$5806$5815);return [false,null];}}));return accum$5797;})()));var temp$5854;(temp$5854=$5987(__re_methods$5558));var $length$5860;($length$5860=temp$5854.length);var $index$5866;($index$5866=0);$5562:for(;($index$5866<$length$5860);($index$5866++)){var m$5875;(m$5875=temp$5854[$index$5866]);var t0$5880;var t1$5881;var k$5885;var v$5886;(t0$5880=m$5875);if(((t0$5880 instanceof Array)&&(((t1$5881=t0$5880.length)),(t1$5881===2)))){(k$5885=t0$5880[0]);(v$5886=t0$5880[1]);if((!$5947(RegExp.prototype,k$5885))){Object.defineProperty(RegExp.prototype,k$5885,({"enumerable":false,"value":v$5886}));}}else{$6004(m$5875);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$5930(({"enumerable":false}),(function(){var accum$5904;(accum$5904=({}));(accum$5904["value"]=(function(args$5909){return this.apply(this,args$5909);}));return accum$5904;})()));}
var $8067=(function(type$8070){return (function(value$8074){var f$8078;(f$8078=type$8070[":::project"]);if((f$8078===(void 0))){(f$8078=type$8070["::project"]);if((f$8078===(void 0))){return [true,type$8070(value$8074)];}else{var rval$8091;(rval$8091=false);try{(rval$8091=[true,f$8078(value$8074)]);}catch(excv$8102){var e$8108;(e$8108=excv$8102);(rval$8091=[false,null]);}return rval$8091;}}else{return f$8078.call(type$8070,value$8074);}});});
var $8220=(function($8222$8225,key$8226){var ph$8234;(ph$8234=$8222$8225);var $8228$8240;($8228$8240=ph$8234);var bridge$8230$8245;(bridge$8230$8245=$8228$8240);if(((bridge$8230$8245===null)||(bridge$8230$8245===(void 0)))){return false;}else{var x$8257;if((typeof($8228$8240)==="string")){(x$8257=$8228$8240);return (key$8226 in String.prototype);}else{var x$8262;if((typeof($8228$8240)==="number")){(x$8262=$8228$8240);return (key$8226 in Number.prototype);}else{var x$8267;(x$8267=$8228$8240);return (key$8226 in x$8267);}}}});
var $8136=(function($8138$8141){var ph$8151;var x$8152;var t0$8154;(t0$8154=$8138$8141);(x$8152=t0$8154);(ph$8151=t0$8154);var $8143$8163;($8143$8163=ph$8151);var bridge$8145$8168;(bridge$8145$8168=$8143$8163);if(((function(){var bridge$8146$8178;(bridge$8146$8178=bridge$8145$8168);return ((function(){var bridge$8147$8185;(bridge$8147$8185=bridge$8146$8178);return ((bridge$8147$8185===(void 0))||(bridge$8147$8185===null));})()||(typeof(bridge$8146$8178)==="string"));})()||(typeof(bridge$8145$8168)==="number"))){return x$8152;}else{if($8220($8143$8163,"::clone")){$8143$8163["::clone"];return x$8152["::clone"]();}else{$8143$8163;if((Object.getPrototypeOf(x$8152)===Object.prototype)){var dest$8203;(dest$8203=({}));var k$8208;(k$8208=null);$8202:for(k$8208 in x$8152){if(Object.prototype.hasOwnProperty.call(x$8152,k$8208)){(dest$8203[k$8208]=x$8152[k$8208]);}}return dest$8203;}else{var other$8218;(other$8218=$8143$8163);throw $6023(["clone"]).create("Object cannot be cloned",({"obj":x$8152}));}}}});
var $8114=(function(a$8117,b$8118){var dest$8123;(dest$8123=$8136(a$8117));var k$8128;(k$8128=null);$8122:for(k$8128 in b$8118){if(Object.prototype.hasOwnProperty.call(b$8118,k$8128)){(dest$8123[k$8128]=b$8118[k$8128]);}}return dest$8123;});var id$6349;var id_f$6350;var numr$6351;var numr_f$6352;var num$6353;var num_f$6354;var str$6355;var str_f$6356;var op$6357;var op2$6358;var op3$6359;var op4$6360;var op_f$6361;var indent$6362;var indent_f$6363;var indent2$6364;var indent2_f$6365;var cmnt$6366;var cmnt_f$6367;var unkn$6368;var unkn_f$6369;var $6284$6299;var Location$6300;var __lt____lt____colon__$6301;var special_ops$6302;var regexps$6303;var ws_re$6304;var eol_re$6305;var produce$6306;var indent_tracker$6307;var process_indent$6308;var disambiguate_fixity$6309;var alternate_operators$6310;var fill_locations$6311;var tokenize$6312;($6284$6299=require("./location"));(Location$6300=$6284$6299.Location);(__lt____lt____colon__$6301=$6284$6299["<<:"]);(special_ops$6302=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));(regexps$6303=(((id$6349=RegExp("(?:^(?:\\.\\.\\.|(?:(?:[a-zA-Z$_]|(?:\\\\_.))(?:(?:[a-zA-Z$_0-9]|(?:\\\\_.))*))))",""))),((id_f$6350=(function(m$6377){return ["ID",m$6377[0].replace(RegExp("\\\\_(.)","g"),(function($6380$6383,x$6384){$6380$6383;return x$6384;}))];}))),((numr$6351=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$6352=(function(m$6397){var t0$6407;var t1$6408;var frac$6428;var radix$6402;var intp$6403;var frac$6404;var value$6405;(t0$6407=m$6397);if(((t0$6407 instanceof Array)&&(((t1$6408=t0$6407.length)),(t1$6408===4)))){t0$6407[0];(radix$6402=t0$6407[1]);(intp$6403=t0$6407[2]);(frac$6404=t0$6407[3]);}else{$6004(m$6397,"/home/olivier/git/earl-grey/src/lex.eg",1192,1193);}(value$6405=parseInt(intp$6403.replace(RegExp("_","g"),""),radix$6402));if(frac$6404){(frac$6428=frac$6404.replace(RegExp("_","g"),""));(value$6405=(value$6405+(parseInt(frac$6404,radix$6402)/Math.pow(radix$6402,frac$6404.length))));}return ["NUM",value$6405];}))),((num$6353=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$6354=(function(m$6443){return ["NUM",parseFloat(m$6443[0].replace(RegExp("_","g"),""))];}))),((str$6355=RegExp("(?:^\"((?:(?:(?:\\\\.)|[^\"])*))\")",""))),((str_f$6356=(function(m$6453){var rx$6468;var f$6469;var repl$6458;var r$6459;(repl$6458=({"b":String.fromCharCode(8),"f":String.fromCharCode(12),"n":"\n","r":String.fromCharCode(13),"t":String.fromCharCode(9)}));(r$6459=(((rx$6468=RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\.","g"))),((f$6469=(function($6476$6479){var chr$6520;var digits$6501;var t0$6495;var t1$6496;var t2$6497;var $6481$6490;var ph$6484;(ph$6484=$6476$6479);($6481$6490=ph$6484);(t0$6495=$8067(RegExp("^(?:\\\\u|\\\\x)(.*)",""))($6481$6490));if((t0$6495[0]&&(((t1$6496=t0$6495[1])),(((t2$6497=t1$6496.length)),(t2$6497===2))))){t1$6496[0];(digits$6501=t1$6496[1]);return String.fromCharCode(parseInt(digits$6501,16));}else{(t0$6495=$8067(RegExp("^.(.)",""))($6481$6490));if((t0$6495[0]&&(((t1$6496=t0$6495[1])),(((t2$6497=t1$6496.length)),(t2$6497===2))))){t1$6496[0];(chr$6520=t1$6496[1]);return ($5947(repl$6458,chr$6520)||chr$6520);}else{$6004($6481$6490);}}}))),m$6453[1].replace(rx$6468,f$6469)));return ["STR",r$6459];}))),((op$6357=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$6358=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$6359=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$6360=RegExp("(?:^`((?:[A-Za-z0-9_$]+))`)",""))),((op_f$6361=(function(m$6558,column$6559){var fixity$6591;var otherwise$6597;var $6567$6580;var $6563$6574;var op$6568;(op$6568=(m$6558[1]||m$6558[0]));($6563$6574=null);$6563$6574;if((op$6568==="|")){return ["INDENT",(column$6559-1)];}else{if((op$6568 in special_ops$6302)){(fixity$6591=$5947(special_ops$6302,op$6568));return ["OP",fixity$6591,op$6568];}else{(otherwise$6597=$6563$6574);return ["OP","?FX",op$6568];}}}))),((indent$6362=RegExp("(?:^(?:(?:\n(?: *);(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$6363=(function(m$6607){var ilen$6611;(ilen$6611=m$6607[1].length);return ["INDENT",ilen$6611];}))),((indent2$6364=RegExp("(?:^\\\\\\\\)",""))),((indent2_f$6365=(function(m$6623,column$6624){return ["INDENT",(column$6624-2)];}))),((cmnt$6366=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$6367=(function(m$6634){return ["IGNORE"];}))),((unkn$6368=RegExp("(?:^.)",""))),((unkn_f$6369=(function(m$6644){return ["ILLEGAL",m$6644[0]];}))),[[op3$6359,op_f$6361],[id$6349,id_f$6350],[numr$6351,numr_f$6352],[num$6353,num_f$6354],[str$6355,str_f$6356],[op$6357,op_f$6361],[op2$6358,op_f$6361],[op4$6360,op_f$6361],[indent$6362,indent_f$6363],[indent2$6364,indent2_f$6365],[cmnt$6366,cmnt_f$6367],[unkn$6368,unkn_f$6369]]));(ws_re$6304=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\ (?: *))*))",""));(eol_re$6305=RegExp("(?:^(?: *)(?:\n|$))",""));(produce$6306=(function(src$6658){var text$6667;var results$6668;var wsb$6669;var pos$6670;var column$6671;(text$6667=src$6658.text);(results$6668=[]);(wsb$6669=text$6667.match(ws_re$6304)[0].length);(text$6667=text$6667.slice(wsb$6669));(pos$6670=wsb$6669);(column$6671=0);$6690:while(text$6667){var i$6696;(i$6696=0);$6693:for(;(i$6696<regexps$6303.length);(++i$6696)){var t0$6710;var t1$6711;var splits$6760;var skip$6743;var endpos$6744;var wsa$6745;var eol$6746;var bwsb$6747;var bwsa$6748;var token$6749;var re$6706;var fn$6707;var m$6708;(t0$6710=$5947(regexps$6303,i$6696));if(((t0$6710 instanceof Array)&&(((t1$6711=t0$6710.length)),(t1$6711===2)))){(re$6706=t0$6710[0]);(fn$6707=t0$6710[1]);}else{$6004($5947(regexps$6303,i$6696),"/home/olivier/git/earl-grey/src/lex.eg",4328,4338);}(m$6708=text$6667.match(re$6706));if(m$6708){(skip$6743=m$6708[0].length);(endpos$6744=(pos$6670+skip$6743));(column$6671=(((splits$6760=m$6708[0].split("\n"))),(function(){if((splits$6760.length>1)){return $5947(splits$6760,(splits$6760.length-1)).length;}else{return (column$6671+skip$6743);}})()));(text$6667=text$6667.slice(skip$6743));(wsa$6745=text$6667.match(ws_re$6304)[0].length);(eol$6746=(text$6667.match(eol_re$6305)&&true));(bwsb$6747=(wsb$6669>0));(bwsa$6748=(function(){if(eol$6746){return bwsb$6747;}else{return (wsa$6745>0);}})());(token$6749=fn$6707(m$6708,column$6671));(token$6749["wsb"]=bwsb$6747);(token$6749["wsa"]=bwsa$6748);(token$6749["location"]=Location$6300(src$6658,pos$6670,endpos$6744));results$6668.push(token$6749);(text$6667=text$6667.slice(wsa$6745));(column$6671=(column$6671+wsa$6745));(wsb$6669=wsa$6745);(pos$6670=(endpos$6744+wsa$6745));break $6693;}}}return results$6668;}));(indent_tracker$6307=(function(){var curr$6814;var stack$6815;var stacks$6816;(curr$6814=0);(stack$6815=[]);(stacks$6816=[stack$6815]);return (function($6812$6827){var t0$6850;var rval$6918;var $index$6998;var $length$6992;var temp$6986;var acc$6980;var rval$6972;var x$7029;var $index$7057;var $length$7051;var temp$7045;var acc$7039;var other$7078;var fixity$6959;var fixity$6939;var stuff$6934;var new_indent$6875;var $6831$6876;var $6843$6869;var $6844$6870;var $6845$6871;var $6846$6872;var t0$6864;var t1$6865;var bridge$6838$6866;var bridge$6840$6867;var $6829$6859;var ph$6847;var token$6848;(t0$6850=$6812$6827);(token$6848=t0$6850);(ph$6847=t0$6850);($6829$6859=ph$6847);if((($6843$6869=($6829$6859 instanceof Array))&&(((t0$6864=$6829$6859.length)),((t0$6864===2)&&($6829$6859[0]==="INDENT"))))){(t1$6865=$6829$6859[1]);(new_indent$6875=t1$6865);($6831$6876=t1$6865);$6831$6876;if((curr$6814===false)){(curr$6814=new_indent$6875);return [$8114(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6831$6876>curr$6814)){stack$6815.push(curr$6814);(curr$6814=new_indent$6875);return [$8114(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($6831$6876===curr$6814)){return [$8114(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6831$6876<curr$6814)){(rval$6918=[]);$6922:while(((stack$6815.length>0)&&(new_indent$6875<curr$6814))){(curr$6814=stack$6815.pop());rval$6918.push($8114(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$6918.push($8114(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$6918;}else{$6004($6831$6876,"/home/olivier/git/earl-grey/src/lex.eg",5705,5721);}}}}}else{if(($6843$6869&&((t0$6864>=1)&&($6829$6859[0]==="ID")))){(stuff$6934=Array.prototype.slice.call($6829$6859,1));return [token$6848];}else{if(($6843$6869&&(($6845$6871=(t0$6864===3))&&(($6846$6872=($6829$6859[0]==="OP"))&&((fixity$6939=$6829$6859[1]),(((bridge$6838$6866=$6829$6859[2])),((bridge$6838$6866==="[")||(bridge$6838$6866==="{")))))))){stack$6815.push(curr$6814);stacks$6816.push(stack$6815);(stack$6815=[]);(curr$6814=false);return [token$6848];}else{if(($6846$6872&&((fixity$6959=$6829$6859[1]),(((bridge$6840$6867=$6829$6859[2])),((bridge$6840$6867==="]")||(bridge$6840$6867==="}")))))){(rval$6972=(((acc$6980=[])),(((temp$6986=stack$6815)),((($length$6992=temp$6986.length)),((($index$6998=0)),(function(){$6975:for(;($index$6998<$length$6992);($index$6998++)){var m$7007;(m$7007=temp$6986[$index$6998]);m$7007;acc$6980.push($8114(["OP","SFX","]"],({"wsb":true,"wsa":true})));}})()))),acc$6980));(stack$6815=stacks$6816.pop());(curr$6814=stack$6815.pop());rval$6972.push(token$6848);return rval$6972;}else{if((((x$7029=$6829$6859)),((x$7029 instanceof Array)&&(x$7029[0]==="EOF")))){(acc$7039=[]);(temp$7045=stack$6815);($length$7051=temp$7045.length);($index$7057=0);$7034:for(;($index$7057<$length$7051);($index$7057++)){var m$7066;(m$7066=temp$7045[$index$7057]);m$7066;acc$7039.push($8114(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$7039;}else{(other$7078=$6829$6859);return [token$6848];}}}}}});}));(process_indent$6308=(function(stream$7085){var $index$7116;var $length$7110;var temp$7104;var tracker$7090;var results$7091;(tracker$7090=indent_tracker$6307());(results$7091=[]);(temp$7104=stream$7085);($length$7110=temp$7104.length);($index$7116=0);$7092:for(;($index$7116<$length$7110);($index$7116++)){var token$7133;var m$7125;(m$7125=temp$7104[$index$7116]);(token$7133=m$7125);(results$7091=results$7091.concat(tracker$7090(token$7133)));}return results$7091.concat(tracker$7090(["EOF"]));}));(disambiguate_fixity$6309=(function(stream$7140){var $index$7624;var $length$7618;var temp$7612;var __lt____lt____lt____colon__$7149;var collapse_operators$7150;var buffer$7151;var pfx$7152;var collapse$7153;var results$7154;(__lt____lt____lt____colon__$7149=(function(a$7170,b$7171){(a$7170["wsb"]=b$7171.wsb);(a$7170["wsa"]=b$7171.wsa);return __lt____lt____colon__$6301(a$7170,b$7171);}));(collapse_operators$7150=(function(){var msg$7291;var longer$7287;var token$7264;var fixity$7265;var name$7266;var t0$7258;var t1$7259;var t2$7260;var $7248$7253;var $index$7322;var $length$7316;var temp$7310;var acc$7304;var $index$7385;var $length$7379;var temp$7373;var acc$7367;var t0$7438;var t1$7439;var t2$7440;var t3$7441;var t0$7486;var t0$7493;var t0$7546;var t0$7553;var t1$7554;var t2$7555;var bridge$7527$7536;var $7525$7531;var t$7522;var results$7516;var $7430$7475;var $7431$7476;var $7432$7477;var bridge$7427$7472;var t0$7473;var $7425$7467;var first$7433;var fixity$7434;var name$7435;var rest$7436;var n$7228;var $7195$7222;var $7196$7223;var $7197$7224;var $7198$7225;var t0$7219;var t1$7220;var buffer$7210;var $7189$7211;var t0$7206;var $7187$7201;($7187$7201=arguments);(t0$7206=$7187$7201.length);if((t0$7206>=1)){(buffer$7210=$7187$7201[0]);($7189$7211=Array.prototype.slice.call($7187$7201,1));(n$7228=buffer$7210.length);$7189$7211;if((!buffer$7210.length)){return [];}else{(t0$7219=$7189$7211);(t1$7220=t0$7219.length);if((($7197$7224=(t1$7220===2))&&(($7198$7225=t0$7219[0])&&t0$7219[1]))){($7248$7253=buffer$7210);if((($7248$7253 instanceof Array)&&(((t0$7258=$7248$7253.length)),((t0$7258===1)&&(((t1$7259=$7248$7253[0])),((token$7264=t1$7259),((t1$7259 instanceof Array)&&(((t2$7260=t1$7259.length)),((t2$7260===3)&&(t1$7259[0]==="OP")))))))))){(fixity$7265=t1$7259[1]);(name$7266=t1$7259[2]);return [__lt____lt____lt____colon__$7149(["ID",name$7266],token$7264)];}else{(longer$7287=$7248$7253);(msg$7291="Too many consecutive operators were found here.");throw $6023(["syntax","nullary"]).create(msg$7291,({"operators":buffer$7210}));}}else{if($7198$7225){t0$7219[1];(acc$7304=[]);(temp$7310=buffer$7210);($length$7316=temp$7310.length);($index$7322=0);$7299:for(;($index$7322<$length$7316);($index$7322++)){var token$7341;var name$7342;var t0$7336;var t1$7337;var m$7331;(m$7331=temp$7310[$index$7322]);(t0$7336=m$7331);(token$7341=t0$7336);if(((t0$7336 instanceof Array)&&(((t1$7337=t0$7336.length)),((t1$7337===3)&&(t0$7336[0]==="OP"))))){t0$7336[1];(name$7342=t0$7336[2]);acc$7304.push(__lt____lt____lt____colon__$7149(["OP","PFX",name$7342],token$7341));}else{$6004(m$7331,"/home/olivier/git/earl-grey/src/lex.eg",8076,8160);}}return acc$7304;}else{if(($7197$7224&&(t0$7219[0],t0$7219[1]))){(acc$7367=[]);(temp$7373=buffer$7210);($length$7379=temp$7373.length);($index$7385=0);$7362:for(;($index$7385<$length$7379);($index$7385++)){var token$7404;var name$7405;var t0$7399;var t1$7400;var m$7394;(m$7394=temp$7373[$index$7385]);(t0$7399=m$7394);(token$7404=t0$7399);if(((t0$7399 instanceof Array)&&(((t1$7400=t0$7399.length)),((t1$7400===3)&&(t0$7399[0]==="OP"))))){t0$7399[1];(name$7405=t0$7399[2]);acc$7367.push(__lt____lt____lt____colon__$7149(["OP","SFX",name$7405],token$7404));}else{$6004(m$7394,"/home/olivier/git/earl-grey/src/lex.eg",8183,8267);}}return acc$7367;}else{$7189$7211;(t0$7438=buffer$7210);if(((t0$7438 instanceof Array)&&(((t1$7439=t0$7438.length)),((t1$7439>=1)&&(((t2$7440=t0$7438[0])),((first$7433=t2$7440),((t2$7440 instanceof Array)&&(((t3$7441=t2$7440.length)),((t3$7441===3)&&(t2$7440[0]==="OP")))))))))){(fixity$7434=t2$7440[1]);(name$7435=t2$7440[2]);(rest$7436=Array.prototype.slice.call(t0$7438,1));}else{$6004(buffer$7210,"/home/olivier/git/earl-grey/src/lex.eg",8320,8326);}($7425$7467=[first$7433.wsb,first$7433.wsa]);(bridge$7427$7472=$7425$7467);if((((bridge$7427$7472 instanceof Array)&&(((t0$7486=bridge$7427$7472.length)),((t0$7486===2)&&((!bridge$7427$7472[0])&&(!bridge$7427$7472[1])))))||((bridge$7427$7472 instanceof Array)&&(((t0$7493=bridge$7427$7472.length)),((t0$7493===2)&&(bridge$7427$7472[0]&&bridge$7427$7472[1])))))){return [__lt____lt____lt____colon__$7149(["OP","IFX",name$7435],first$7433)].concat(collapse_operators$7150(rest$7436,true,false));}else{if((($7430$7475=($7425$7467 instanceof Array))&&(((t0$7473=$7425$7467.length)),(($7432$7477=(t0$7473===2))&&$7425$7467[0])))){$7425$7467[1];return [__lt____lt____lt____colon__$7149(["OP","PFX",name$7435],first$7433)].concat(collapse_operators$7150(rest$7436,true,false));}else{if(($7432$7477&&($7425$7467[0],$7425$7467[1]))){(results$7516=collapse_operators$7150(rest$7436,false,false));(t$7522=((($7525$7531=results$7516)),(((bridge$7527$7536=$7525$7531)),(function(){if((((bridge$7527$7536 instanceof Array)&&(((t0$7546=bridge$7527$7536.length)),(t0$7546===0)))||((bridge$7527$7536 instanceof Array)&&(((t0$7553=bridge$7527$7536.length)),((t0$7553>=1)&&(((t1$7554=bridge$7527$7536[0])),((t1$7554 instanceof Array)&&(((t2$7555=t1$7554.length)),((t2$7555>=2)&&((t1$7554[0]==="OP")&&((t1$7554[1]==="PFX")&&(Array.prototype.slice.call(t1$7554,2),(Array.prototype.slice.call(bridge$7527$7536,1),true))))))))))))){return ["OP","IFX",name$7435];}else{$7525$7531;return ["OP","SFX",name$7435];}})())));return [__lt____lt____lt____colon__$7149(t$7522,first$7433)].concat(results$7516);}else{$6004($7425$7467);}}}}}}}}else{$6004($7187$7201);}}));(buffer$7151=[]);(pfx$7152=true);(collapse$7153=(function(sfx$7593){var rval$7598;(rval$7598=collapse_operators$7150(buffer$7151,pfx$7152,sfx$7593));(buffer$7151=[]);return rval$7598;}));(results$7154=[]);(temp$7612=stream$7140);($length$7618=temp$7612.length);($index$7624=0);$7155:for(;($index$7624<$length$7618);($index$7624++)){var other$7705;var name$7655;var $7160$7656;var t0$7650;var t1$7651;var token$7642;var $7158$7643;var t0$7638;var m$7633;(m$7633=temp$7612[$index$7624]);(t0$7638=m$7633);(token$7642=t0$7638);($7158$7643=t0$7638);(t0$7650=$7158$7643);if(((t0$7650 instanceof Array)&&(((t1$7651=t0$7650.length)),((t1$7651===3)&&(t0$7650[0]==="OP"))))){($7160$7656=t0$7650[1]);(name$7655=t0$7650[2]);if(($7160$7656==="?FX")){buffer$7151.push(token$7642);}else{if(($7160$7656==="IFX")){(results$7154=results$7154.concat(collapse$7153(true)));results$7154.push(token$7642);(pfx$7152=true);}else{if(($7160$7656==="PFX")){(results$7154=results$7154.concat(collapse$7153(false)));results$7154.push(token$7642);(pfx$7152=true);}else{if(($7160$7656==="SFX")){(results$7154=results$7154.concat(collapse$7153(true)));results$7154.push(token$7642);(pfx$7152=false);}else{$6004($7160$7656,"/home/olivier/git/earl-grey/src/lex.eg",9136,9141);}}}}}else{(other$7705=$7158$7643);(results$7154=results$7154.concat(collapse$7153(false)));results$7154.push(token$7642);(pfx$7152=false);}}return results$7154.concat(collapse$7153(true));}));(alternate_operators$6310=(function(stream$7717){var $index$7761;var $length$7755;var temp$7749;var W$7723;var last_op$7724;var results$7725;(W$7723=(function(x$7737){if(x$7737){return "wide";}else{return "short";}}));(last_op$7724=true);(results$7725=[]);(temp$7749=stream$7717);($length$7755=temp$7749.length);($index$7761=0);$7726:for(;($index$7761<$length$7755);($index$7761++)){var x$7795;var $7816$7823;var token$7861;var fixity$7802;var name$7803;var t0$7787;var t1$7788;var token$7779;var $7729$7780;var t0$7775;var m$7770;(m$7770=temp$7749[$index$7761]);(t0$7775=m$7770);(token$7779=t0$7775);($7729$7780=t0$7775);if((((x$7795=$7729$7780)),((x$7795 instanceof Array)&&(x$7795[0]==="IGNORE")))){null;}else{(t0$7787=$7729$7780);if(((t0$7787 instanceof Array)&&(((t1$7788=t0$7787.length)),((t1$7788===3)&&(t0$7787[0]==="OP"))))){(fixity$7802=t0$7787[1]);(name$7803=t0$7787[2]);if(last_op$7724){results$7725.push(["VOID"]);}($7816$7823=fixity$7802);if(($7816$7823==="IFX")){results$7725.push(__lt____lt____colon__$6301(["IFX",W$7723((token$7779.wsa||token$7779.wsb)),name$7803],token$7779));(last_op$7724=true);}else{if(($7816$7823==="PFX")){if((!last_op$7724)){results$7725.push(["IFX",W$7723(token$7779.wsb),"WHITE"],["VOID"]);}results$7725.push(__lt____lt____colon__$6301(["PFX",W$7723(token$7779.wsa),name$7803],token$7779));(last_op$7724=true);}else{if(($7816$7823==="SFX")){results$7725.push(__lt____lt____colon__$6301(["SFX",W$7723(token$7779.wsb),name$7803],token$7779),["VOID"]);(last_op$7724=false);}else{$6004($7816$7823);}}}}else{(token$7861=$7729$7780);if((!last_op$7724)){results$7725.push(["IFX",W$7723(token$7861.wsb),"WHITE"]);}results$7725.push(token$7861);(last_op$7724=false);}}}if(last_op$7724){results$7725.push(["VOID"]);}return results$7725;}));(fill_locations$6311=(function(source$7875,stream$7876){var $index$7973;var $length$7967;var temp$7961;var to_fill$7882;var start$7883;var fill$7884;(to_fill$7882=[]);(start$7883=0);(fill$7884=(function(end$7899){var $index$7922;var $length$7916;var temp$7910;(temp$7910=to_fill$7882);($length$7916=temp$7910.length);($index$7922=0);$7903:for(;($index$7922<$length$7916);($index$7922++)){var token$7948;var token$7939;var m$7931;(m$7931=temp$7910[$index$7922]);(token$7939=m$7931);if(($index$7922===0)){(token$7939["location"]=Location$6300(source$7875,start$7883,end$7899));}else{(token$7948=m$7931);(token$7948["location"]=Location$6300(source$7875,end$7899,end$7899));}}(to_fill$7882=[]);}));(temp$7961=stream$7876);($length$7967=temp$7961.length);($index$7973=0);$7885:for(;($index$7973<$length$7967);($index$7973++)){var other$8006;var location$7991;var t0$7987;var m$7982;(m$7982=temp$7961[$index$7973]);(t0$7987=m$7982);if(($8220(t0$7987,"location")&&((location$7991=t0$7987.location),location$7991))){fill$7884(location$7991.start);(start$7883=location$7991.end);}else{(other$8006=m$7982);to_fill$7882.push(other$8006);}}fill$7884(source$7875.text.length);return stream$7876;}));(tokenize$6312=(function(src$8013){var it$0$8041;var it$0$8035;var it$0$8029;var it$0$8023;var it$0$8017;(it$0$8017=src$8013);(it$0$8023=produce$6306(it$0$8017));(it$0$8029=process_indent$6308(it$0$8023));(it$0$8035=disambiguate_fixity$6309(it$0$8029));(it$0$8041=alternate_operators$6310(it$0$8035));return fill_locations$6311(src$8013,it$0$8041);}));(exports["tokenize"]=tokenize$6312);(exports["process_indent"]=process_indent$6308);(exports["disambiguate_fixity"]=disambiguate_fixity$6309);(exports["alternate_operators"]=alternate_operators$6310);(exports["fill_locations"]=fill_locations$6311);
