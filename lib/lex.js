var $5894=(function(type$5897){var f$5901;(f$5901=type$5897["::check"]);if((f$5901===(void 0))){return (function(value$5907){return (value$5907 instanceof type$5897);});}else{return (function(value$5911){return f$5901.call(type$5897,value$5911);});}});
var $5913=(function(dest$5916,values$5917){var k$5922;(k$5922=null);$5920:for(k$5922 in values$5917){if(values$5917.hasOwnProperty(k$5922)){(dest$5916[k$5922]=values$5917[k$5922]);}}return dest$5916;});
var $5930=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5931=(function($5933$5936){var ph$5942;(ph$5942=$5933$5936);var $5938$5948;($5938$5948=ph$5942);var bridge$5940$5953;var x$5957;(bridge$5940$5953=$5938$5948);if((((typeof(bridge$5940$5953)==="string")&&((x$5957=bridge$5940$5953),true))||((typeof(bridge$5940$5953)==="number")&&((x$5957=bridge$5940$5953),true)))){return ["value",x$5957];}else{var other$5968;(other$5968=$5938$5948);return other$5968["::serialize_ast"]();}});
var $5970=(function(obj$5973){var results$5978;(results$5978=[]);var k$5983;(k$5983=null);$5977:for(k$5983 in obj$5973){if(Object.prototype.hasOwnProperty.call(obj$5973,k$5983)){results$5978.push([k$5983,$5930(obj$5973,k$5983)]);}}return results$5978;});
var $6239=(function(arr$6242){var results$6248;var l$6249;(results$6248=[]);(l$6249=arr$6242.length);var i$6258;(i$6258=0);$6247:for(;(i$6258<l$6249);(i$6258++)){results$6248.push([i$6258,$5930(arr$6242,i$6258)]);}return results$6248;});
var $6006=(function(){var $6007$6013;($6007$6013=(function(tags$6018){var it$0$6021;(it$0$6021=(function(){if((!$5894($6007$6013)(this))){return Object.create($6007$6013.prototype);}else{return this;}})());(it$0$6021["tags"]=tags$6018);return it$0$6021;}));($6007$6013.prototype["create"]=(function(){var it$0$6041;var self$6042;(it$0$6041=this);(self$6042=this);var $6039$6051;($6039$6051=arguments);var t0$6056;var message$6060;var args$6061;(t0$6056=$6039$6051.length);if((t0$6056>=0)){(message$6060=(function(){if((0>=t0$6056)){return "";}else{return $6039$6051[0];}})());(args$6061=Array.prototype.slice.call($6039$6051,1));var e$6074;(e$6074=Error(message$6060));(e$6074["::tags"]=it$0$6041.tags);(e$6074["args"]=args$6061);var temp$6090;(temp$6090=$6239(args$6061));var $length$6096;($length$6096=temp$6090.length);var $index$6102;($index$6102=0);$6075:for(;($index$6102<$length$6096);($index$6102++)){var m$6111;(m$6111=temp$6090[$index$6102]);var t0$6116;var t1$6117;var i$6121;var arg$6122;(t0$6116=m$6111);if(((t0$6116 instanceof Array)&&(((t1$6117=t0$6116.length)),(t1$6117===2)))){(i$6121=t0$6116[0]);(arg$6122=t0$6116[1]);(e$6074[i$6121]=arg$6122);}else{$5987(m$6111);}}(e$6074["length"]=args$6061.length);(e$6074["name"]=["E"].concat(it$0$6041.tags).join("."));return e$6074;}else{$5987($6039$6051);}}));($6007$6013.prototype["::check"]=(function(e$6152){var it$0$6156;var self$6157;(it$0$6156=this);(self$6157=this);var tags$6167;if(((!e$6152)||(!$5894(Error)(e$6152)))){return false;}(tags$6167=(e$6152["::tags"]||[]));var temp$6178;(temp$6178=it$0$6156.tags);var $length$6184;($length$6184=temp$6178.length);var $index$6190;($index$6190=0);$6168:for(;($index$6190<$length$6184);($index$6190++)){var m$6199;(m$6199=temp$6178[$index$6190]);var tag$6207;(tag$6207=m$6199);if((tags$6167.indexOf(tag$6207)===-1)){return false;}else{false;}}return true;}));($6007$6013.prototype["::deconstruct"]=(function(e$6216){var it$0$6220;var self$6221;(it$0$6220=this);(self$6221=this);return e$6216.args;}));$5913($6007$6013,$5913((function(){var accum$6232;(accum$6232=({}));(accum$6232["::name"]="$6007");return accum$6232;})(),(function(){var accum$6236;(accum$6236=({}));(accum$6236["::egclass"]=true);return accum$6236;})()));return $6007$6013;})();
var $5987=(function(value$5990,url$5991,start$5992,end$5993){var err$5997;(err$5997=$6006(["match"]).create("Could not find a match for value",({"value":value$5990})));if(url$5991){(err$5997["location"]=["location",url$5991,start$5992,end$5993]);}throw err$5997;});
var send$5539;var __array_methods$5540;var __re_methods$5541;(send$5539=(function(obj$5554,$5551$5555){var ph$5561;var msg$5562;var t0$5564;(t0$5564=$5551$5555);(msg$5562=t0$5564);(ph$5561=t0$5564);var $5557$5573;($5557$5573=ph$5561);var bridge$5559$5578;(bridge$5559$5578=$5557$5573);if(((typeof(bridge$5559$5578)==="string")||(typeof(bridge$5559$5578)==="number"))){return obj$5554[msg$5562];}else{var other$5590;(other$5590=$5557$5573);return obj$5554["::send"](msg$5562);}}));(Array[":::project"]=(function($5596$5599){var ph$5604;var value$5605;var t0$5607;(t0$5607=$5596$5599);(value$5605=t0$5607);(ph$5604=t0$5607);var $5601$5616;($5601$5616=ph$5604);if($5894(Array)($5601$5616)){return [true,value$5605];}else{$5601$5616;return [true,[value$5605]];}}));(__array_methods$5540=$5913((function(){var accum$5637;(accum$5637=({}));(accum$5637["::check"]=(function(value$5642){if((value$5642 instanceof Array)){var i$5648;(i$5648=0);$5645:for(;(i$5648<this.length);(i$5648++)){if(($5930(this,i$5648)!==$5930(value$5642,i$5648))){return false;}}return true;}else{return false;}}));return accum$5637;})(),$5913((function(){var accum$5657;(accum$5657=({}));(accum$5657["::clone"]=(function(){return $5913(this.slice(0),this);}));return accum$5657;})(),$5913((function(){var accum$5664;(accum$5664=({}));(accum$5664[":::project"]=(function(value$5669){if((value$5669 instanceof Array)){var i$5675;(i$5675=0);$5672:for(;(i$5675<this.length);(i$5675++)){if(($5930(this,i$5675)!==$5930(value$5669,i$5675))){return [true,this.concat([value$5669])];}}return [true,value$5669];}else{return [true,this.concat([value$5669])];}}));return accum$5664;})(),(function(){var accum$5684;(accum$5684=({}));(accum$5684["::serialize_ast"]=(function(){return ["array"].concat(this.map($5931));}));return accum$5684;})()))));var temp$5694;(temp$5694=$5970(__array_methods$5540));var $length$5700;($length$5700=temp$5694.length);var $index$5706;($index$5706=0);$5542:for(;($index$5706<$length$5700);($index$5706++)){var m$5715;(m$5715=temp$5694[$index$5706]);var t0$5720;var t1$5721;var k$5725;var v$5726;(t0$5720=m$5715);if(((t0$5720 instanceof Array)&&(((t1$5721=t0$5720.length)),(t1$5721===2)))){(k$5725=t0$5720[0]);(v$5726=t0$5720[1]);if((!$5930(Array.prototype,k$5725))){Object.defineProperty(Array.prototype,k$5725,({"enumerable":false,"value":v$5726}));}}else{$5987(m$5715);}}(__re_methods$5541=$5913((function(){var accum$5746;(accum$5746=({}));(accum$5746["::check"]=(function($5750$5753){var ph$5758;(ph$5758=$5750$5753);var $5755$5764;($5755$5764=ph$5758);var value$5772;if((typeof($5755$5764)==="string")){(value$5772=$5755$5764);if(value$5772.match(this)){return true;}else{return false;}}else{var other$5777;(other$5777=$5755$5764);return false;}}));return accum$5746;})(),(function(){var accum$5780;(accum$5780=({}));(accum$5780[":::project"]=(function($5784$5787){var ph$5792;(ph$5792=$5784$5787);var $5789$5798;($5789$5798=ph$5792);var value$5806;if((typeof($5789$5798)==="string")){(value$5806=$5789$5798);var $5809$5814;($5809$5814=value$5806.match(this));var m$5822;if(($5809$5814===null)){(m$5822=$5809$5814);return [false,null];}else{var m$5827;(m$5827=$5809$5814);return [true,m$5827];}}else{var other$5831;(other$5831=$5789$5798);return [false,null];}}));return accum$5780;})()));var temp$5837;(temp$5837=$5970(__re_methods$5541));var $length$5843;($length$5843=temp$5837.length);var $index$5849;($index$5849=0);$5545:for(;($index$5849<$length$5843);($index$5849++)){var m$5858;(m$5858=temp$5837[$index$5849]);var t0$5863;var t1$5864;var k$5868;var v$5869;(t0$5863=m$5858);if(((t0$5863 instanceof Array)&&(((t1$5864=t0$5863.length)),(t1$5864===2)))){(k$5868=t0$5863[0]);(v$5869=t0$5863[1]);if((!$5930(RegExp.prototype,k$5868))){Object.defineProperty(RegExp.prototype,k$5868,({"enumerable":false,"value":v$5869}));}}else{$5987(m$5858);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$5913(({"enumerable":false}),(function(){var accum$5887;(accum$5887=({}));(accum$5887["value"]=(function(args$5892){return this.apply(this,args$5892);}));return accum$5887;})()));}
var $8025=(function(type$8028){return (function(value$8032){var f$8036;(f$8036=type$8028[":::project"]);if((f$8036===(void 0))){(f$8036=type$8028["::project"]);if((f$8036===(void 0))){return [true,type$8028(value$8032)];}else{var rval$8049;(rval$8049=false);try{(rval$8049=[true,f$8036(value$8032)]);}catch(excv$8060){var e$8066;(e$8066=excv$8060);(rval$8049=[false,null]);}return rval$8049;}}else{return f$8036.call(type$8028,value$8032);}});});
var $8178=(function($8180$8183,key$8184){var ph$8192;(ph$8192=$8180$8183);var $8186$8198;($8186$8198=ph$8192);var bridge$8188$8203;(bridge$8188$8203=$8186$8198);if(((bridge$8188$8203===null)||(bridge$8188$8203===(void 0)))){return false;}else{var x$8215;if((typeof($8186$8198)==="string")){(x$8215=$8186$8198);return (key$8184 in String.prototype);}else{var x$8220;if((typeof($8186$8198)==="number")){(x$8220=$8186$8198);return (key$8184 in Number.prototype);}else{var x$8225;(x$8225=$8186$8198);return (key$8184 in x$8225);}}}});
var $8094=(function($8096$8099){var ph$8109;var x$8110;var t0$8112;(t0$8112=$8096$8099);(x$8110=t0$8112);(ph$8109=t0$8112);var $8101$8121;($8101$8121=ph$8109);var bridge$8103$8126;(bridge$8103$8126=$8101$8121);if(((function(){var bridge$8104$8136;(bridge$8104$8136=bridge$8103$8126);return ((function(){var bridge$8105$8143;(bridge$8105$8143=bridge$8104$8136);return ((bridge$8105$8143===(void 0))||(bridge$8105$8143===null));})()||(typeof(bridge$8104$8136)==="string"));})()||(typeof(bridge$8103$8126)==="number"))){return x$8110;}else{if($8178($8101$8121,"::clone")){$8101$8121["::clone"];return x$8110["::clone"]();}else{$8101$8121;if((Object.getPrototypeOf(x$8110)===Object.prototype)){var dest$8161;(dest$8161=({}));var k$8166;(k$8166=null);$8160:for(k$8166 in x$8110){if(Object.prototype.hasOwnProperty.call(x$8110,k$8166)){(dest$8161[k$8166]=x$8110[k$8166]);}}return dest$8161;}else{var other$8176;(other$8176=$8101$8121);throw $6006(["clone"]).create("Object cannot be cloned",({"obj":x$8110}));}}}});
var $8072=(function(a$8075,b$8076){var dest$8081;(dest$8081=$8094(a$8075));var k$8086;(k$8086=null);$8080:for(k$8086 in b$8076){if(Object.prototype.hasOwnProperty.call(b$8076,k$8086)){(dest$8081[k$8086]=b$8076[k$8086]);}}return dest$8081;});var id$6330;var id_f$6331;var numr$6332;var numr_f$6333;var num$6334;var num_f$6335;var str$6336;var str_f$6337;var op$6338;var op2$6339;var op3$6340;var op4$6341;var op_f$6342;var indent$6343;var indent_f$6344;var cmnt$6345;var cmnt_f$6346;var unkn$6347;var unkn_f$6348;var $6267$6282;var Location$6283;var __lt____lt____colon__$6284;var special_ops$6285;var regexps$6286;var ws_re$6287;var eol_re$6288;var produce$6289;var indent_tracker$6290;var process_indent$6291;var disambiguate_fixity$6292;var alternate_operators$6293;var fill_locations$6294;var tokenize$6295;($6267$6282=require("./location"));(Location$6283=$6267$6282.Location);(__lt____lt____colon__$6284=$6267$6282["<<:"]);(special_ops$6285=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));(regexps$6286=(((id$6330=RegExp("(?:^(?:(?:[a-zA-Z$_](?:[a-zA-Z$_0-9]*))|\\.\\.\\.))",""))),((id_f$6331=(function(m$6356){return ["ID",m$6356[0]];}))),((numr$6332=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$6333=(function(m$6366){var t0$6376;var t1$6377;var frac$6397;var radix$6371;var intp$6372;var frac$6373;var value$6374;(t0$6376=m$6366);if(((t0$6376 instanceof Array)&&(((t1$6377=t0$6376.length)),(t1$6377===4)))){t0$6376[0];(radix$6371=t0$6376[1]);(intp$6372=t0$6376[2]);(frac$6373=t0$6376[3]);}else{$5987(m$6366,"/home/olivier/git/earl-grey/src/lex.eg",1082,1083);}(value$6374=parseInt(intp$6372.replace(RegExp("_","g"),""),radix$6371));if(frac$6373){(frac$6397=frac$6373.replace(RegExp("_","g"),""));(value$6374=(value$6374+(parseInt(frac$6373,radix$6371)/Math.pow(radix$6371,frac$6373.length))));}return ["NUM",value$6374];}))),((num$6334=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$6335=(function(m$6412){return ["NUM",parseFloat(m$6412[0].replace(RegExp("_","g"),""))];}))),((str$6336=RegExp("(?:^\"((?:(?:(?:\\\\.)|[^\"])*))\")",""))),((str_f$6337=(function(m$6422){var rx$6437;var f$6438;var repl$6427;var r$6428;(repl$6427=({"b":String.fromCharCode(8),"f":String.fromCharCode(12),"n":"\n","r":String.fromCharCode(13),"t":String.fromCharCode(9)}));(r$6428=(((rx$6437=RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\.","g"))),((f$6438=(function($6445$6448){var chr$6489;var digits$6470;var t0$6464;var t1$6465;var t2$6466;var $6450$6459;var ph$6453;(ph$6453=$6445$6448);($6450$6459=ph$6453);(t0$6464=$8025(RegExp("^(?:\\\\u|\\\\x)(.*)",""))($6450$6459));if((t0$6464[0]&&(((t1$6465=t0$6464[1])),(((t2$6466=t1$6465.length)),(t2$6466===2))))){t1$6465[0];(digits$6470=t1$6465[1]);return String.fromCharCode(parseInt(digits$6470,16));}else{(t0$6464=$8025(RegExp("^.(.)",""))($6450$6459));if((t0$6464[0]&&(((t1$6465=t0$6464[1])),(((t2$6466=t1$6465.length)),(t2$6466===2))))){t1$6465[0];(chr$6489=t1$6465[1]);return ($5930(repl$6427,chr$6489)||chr$6489);}else{$5987($6450$6459);}}}))),m$6422[1].replace(rx$6437,f$6438)));return ["STR",r$6428];}))),((op$6338=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$6339=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$6340=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$6341=RegExp("(?:^`((?:[A-Za-z0-9_$]+))`)",""))),((op_f$6342=(function(m$6527,column$6528){var fixity$6560;var otherwise$6566;var $6536$6549;var $6532$6543;var op$6537;(op$6537=(m$6527[1]||m$6527[0]));($6532$6543=null);$6532$6543;if((op$6537==="|")){return ["INDENT",(column$6528-1)];}else{if((op$6537 in special_ops$6285)){(fixity$6560=$5930(special_ops$6285,op$6537));return ["OP",fixity$6560,op$6537];}else{(otherwise$6566=$6532$6543);return ["OP","?FX",op$6537];}}}))),((indent$6343=RegExp("(?:^(?:(?:\n(?: *);(?:[^\n]*))*)(?:(?:\n((?: *)))+))",""))),((indent_f$6344=(function(m$6576){var ilen$6580;(ilen$6580=m$6576[1].length);return ["INDENT",ilen$6580];}))),((cmnt$6345=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$6346=(function(m$6592){return ["IGNORE"];}))),((unkn$6347=RegExp("(?:^.)",""))),((unkn_f$6348=(function(m$6602){return ["ILLEGAL",m$6602[0]];}))),[[op3$6340,op_f$6342],[id$6330,id_f$6331],[numr$6332,numr_f$6333],[num$6334,num_f$6335],[str$6336,str_f$6337],[op$6338,op_f$6342],[op2$6339,op_f$6342],[op4$6341,op_f$6342],[indent$6343,indent_f$6344],[cmnt$6345,cmnt_f$6346],[unkn$6347,unkn_f$6348]]));(ws_re$6287=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));(eol_re$6288=RegExp("(?:^(?: *)(?:\n|$))",""));(produce$6289=(function(src$6616){var text$6625;var results$6626;var wsb$6627;var pos$6628;var column$6629;(text$6625=src$6616.text);(results$6626=[]);(wsb$6627=text$6625.match(ws_re$6287)[0].length);(text$6625=text$6625.slice(wsb$6627));(pos$6628=wsb$6627);(column$6629=0);$6648:while(text$6625){var i$6654;(i$6654=0);$6651:for(;(i$6654<regexps$6286.length);(++i$6654)){var t0$6668;var t1$6669;var splits$6718;var skip$6701;var endpos$6702;var wsa$6703;var eol$6704;var bwsb$6705;var bwsa$6706;var token$6707;var re$6664;var fn$6665;var m$6666;(t0$6668=$5930(regexps$6286,i$6654));if(((t0$6668 instanceof Array)&&(((t1$6669=t0$6668.length)),(t1$6669===2)))){(re$6664=t0$6668[0]);(fn$6665=t0$6668[1]);}else{$5987($5930(regexps$6286,i$6654),"/home/olivier/git/earl-grey/src/lex.eg",4103,4113);}(m$6666=text$6625.match(re$6664));if(m$6666){(skip$6701=m$6666[0].length);(endpos$6702=(pos$6628+skip$6701));(column$6629=(((splits$6718=m$6666[0].split("\n"))),(function(){if((splits$6718.length>1)){return $5930(splits$6718,(splits$6718.length-1)).length;}else{return (column$6629+skip$6701);}})()));(text$6625=text$6625.slice(skip$6701));(wsa$6703=text$6625.match(ws_re$6287)[0].length);(eol$6704=(text$6625.match(eol_re$6288)&&true));(bwsb$6705=(wsb$6627>0));(bwsa$6706=(function(){if(eol$6704){return bwsb$6705;}else{return (wsa$6703>0);}})());(token$6707=fn$6665(m$6666,column$6629));(token$6707["wsb"]=bwsb$6705);(token$6707["wsa"]=bwsa$6706);(token$6707["location"]=Location$6283(src$6616,pos$6628,endpos$6702));results$6626.push(token$6707);(text$6625=text$6625.slice(wsa$6703));(column$6629=(column$6629+wsa$6703));(wsb$6627=wsa$6703);(pos$6628=(endpos$6702+wsa$6703));break $6651;}}}return results$6626;}));(indent_tracker$6290=(function(){var curr$6772;var stack$6773;var stacks$6774;(curr$6772=0);(stack$6773=[]);(stacks$6774=[stack$6773]);return (function($6770$6785){var t0$6808;var rval$6876;var $index$6956;var $length$6950;var temp$6944;var acc$6938;var rval$6930;var x$6987;var $index$7015;var $length$7009;var temp$7003;var acc$6997;var other$7036;var fixity$6917;var fixity$6897;var stuff$6892;var new_indent$6833;var $6789$6834;var $6801$6827;var $6802$6828;var $6803$6829;var $6804$6830;var t0$6822;var t1$6823;var bridge$6796$6824;var bridge$6798$6825;var $6787$6817;var ph$6805;var token$6806;(t0$6808=$6770$6785);(token$6806=t0$6808);(ph$6805=t0$6808);($6787$6817=ph$6805);if((($6801$6827=($6787$6817 instanceof Array))&&(((t0$6822=$6787$6817.length)),((t0$6822===2)&&($6787$6817[0]==="INDENT"))))){(t1$6823=$6787$6817[1]);(new_indent$6833=t1$6823);($6789$6834=t1$6823);$6789$6834;if((curr$6772===false)){(curr$6772=new_indent$6833);return [$8072(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6789$6834>curr$6772)){stack$6773.push(curr$6772);(curr$6772=new_indent$6833);return [$8072(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($6789$6834===curr$6772)){return [$8072(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($6789$6834<curr$6772)){(rval$6876=[]);$6880:while(((stack$6773.length>0)&&(new_indent$6833<curr$6772))){(curr$6772=stack$6773.pop());rval$6876.push($8072(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$6876.push($8072(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$6876;}else{$5987($6789$6834,"/home/olivier/git/earl-grey/src/lex.eg",5480,5496);}}}}}else{if(($6801$6827&&((t0$6822>=1)&&($6787$6817[0]==="ID")))){(stuff$6892=Array.prototype.slice.call($6787$6817,1));return [token$6806];}else{if(($6801$6827&&(($6803$6829=(t0$6822===3))&&(($6804$6830=($6787$6817[0]==="OP"))&&((fixity$6897=$6787$6817[1]),(((bridge$6796$6824=$6787$6817[2])),((bridge$6796$6824==="[")||(bridge$6796$6824==="{")))))))){stack$6773.push(curr$6772);stacks$6774.push(stack$6773);(stack$6773=[]);(curr$6772=false);return [token$6806];}else{if(($6804$6830&&((fixity$6917=$6787$6817[1]),(((bridge$6798$6825=$6787$6817[2])),((bridge$6798$6825==="]")||(bridge$6798$6825==="}")))))){(rval$6930=(((acc$6938=[])),(((temp$6944=stack$6773)),((($length$6950=temp$6944.length)),((($index$6956=0)),(function(){$6933:for(;($index$6956<$length$6950);($index$6956++)){var m$6965;(m$6965=temp$6944[$index$6956]);m$6965;acc$6938.push($8072(["OP","SFX","]"],({"wsb":true,"wsa":true})));}})()))),acc$6938));(stack$6773=stacks$6774.pop());(curr$6772=stack$6773.pop());rval$6930.push(token$6806);return rval$6930;}else{if((((x$6987=$6787$6817)),((x$6987 instanceof Array)&&(x$6987[0]==="EOF")))){(acc$6997=[]);(temp$7003=stack$6773);($length$7009=temp$7003.length);($index$7015=0);$6992:for(;($index$7015<$length$7009);($index$7015++)){var m$7024;(m$7024=temp$7003[$index$7015]);m$7024;acc$6997.push($8072(["OP","SFX","]"],({"wsb":true,"wsa":true})));}return acc$6997;}else{(other$7036=$6787$6817);return [token$6806];}}}}}});}));(process_indent$6291=(function(stream$7043){var $index$7074;var $length$7068;var temp$7062;var tracker$7048;var results$7049;(tracker$7048=indent_tracker$6290());(results$7049=[]);(temp$7062=stream$7043);($length$7068=temp$7062.length);($index$7074=0);$7050:for(;($index$7074<$length$7068);($index$7074++)){var token$7091;var m$7083;(m$7083=temp$7062[$index$7074]);(token$7091=m$7083);(results$7049=results$7049.concat(tracker$7048(token$7091)));}return results$7049.concat(tracker$7048(["EOF"]));}));(disambiguate_fixity$6292=(function(stream$7098){var $index$7582;var $length$7576;var temp$7570;var __lt____lt____lt____colon__$7107;var collapse_operators$7108;var buffer$7109;var pfx$7110;var collapse$7111;var results$7112;(__lt____lt____lt____colon__$7107=(function(a$7128,b$7129){(a$7128["wsb"]=b$7129.wsb);(a$7128["wsa"]=b$7129.wsa);return __lt____lt____colon__$6284(a$7128,b$7129);}));(collapse_operators$7108=(function(){var msg$7249;var longer$7245;var token$7222;var fixity$7223;var name$7224;var t0$7216;var t1$7217;var t2$7218;var $7206$7211;var $index$7280;var $length$7274;var temp$7268;var acc$7262;var $index$7343;var $length$7337;var temp$7331;var acc$7325;var t0$7396;var t1$7397;var t2$7398;var t3$7399;var t0$7444;var t0$7451;var t0$7504;var t0$7511;var t1$7512;var t2$7513;var bridge$7485$7494;var $7483$7489;var t$7480;var results$7474;var $7388$7433;var $7389$7434;var $7390$7435;var bridge$7385$7430;var t0$7431;var $7383$7425;var first$7391;var fixity$7392;var name$7393;var rest$7394;var n$7186;var $7153$7180;var $7154$7181;var $7155$7182;var $7156$7183;var t0$7177;var t1$7178;var buffer$7168;var $7147$7169;var t0$7164;var $7145$7159;($7145$7159=arguments);(t0$7164=$7145$7159.length);if((t0$7164>=1)){(buffer$7168=$7145$7159[0]);($7147$7169=Array.prototype.slice.call($7145$7159,1));(n$7186=buffer$7168.length);$7147$7169;if((!buffer$7168.length)){return [];}else{(t0$7177=$7147$7169);(t1$7178=t0$7177.length);if((($7155$7182=(t1$7178===2))&&(($7156$7183=t0$7177[0])&&t0$7177[1]))){($7206$7211=buffer$7168);if((($7206$7211 instanceof Array)&&(((t0$7216=$7206$7211.length)),((t0$7216===1)&&(((t1$7217=$7206$7211[0])),((token$7222=t1$7217),((t1$7217 instanceof Array)&&(((t2$7218=t1$7217.length)),((t2$7218===3)&&(t1$7217[0]==="OP")))))))))){(fixity$7223=t1$7217[1]);(name$7224=t1$7217[2]);return [__lt____lt____lt____colon__$7107(["ID",name$7224],token$7222)];}else{(longer$7245=$7206$7211);(msg$7249="Too many consecutive operators were found here.");throw $6006(["syntax","nullary"]).create(msg$7249,({"operators":buffer$7168}));}}else{if($7156$7183){t0$7177[1];(acc$7262=[]);(temp$7268=buffer$7168);($length$7274=temp$7268.length);($index$7280=0);$7257:for(;($index$7280<$length$7274);($index$7280++)){var token$7299;var name$7300;var t0$7294;var t1$7295;var m$7289;(m$7289=temp$7268[$index$7280]);(t0$7294=m$7289);(token$7299=t0$7294);if(((t0$7294 instanceof Array)&&(((t1$7295=t0$7294.length)),((t1$7295===3)&&(t0$7294[0]==="OP"))))){t0$7294[1];(name$7300=t0$7294[2]);acc$7262.push(__lt____lt____lt____colon__$7107(["OP","PFX",name$7300],token$7299));}else{$5987(m$7289,"/home/olivier/git/earl-grey/src/lex.eg",7851,7935);}}return acc$7262;}else{if(($7155$7182&&(t0$7177[0],t0$7177[1]))){(acc$7325=[]);(temp$7331=buffer$7168);($length$7337=temp$7331.length);($index$7343=0);$7320:for(;($index$7343<$length$7337);($index$7343++)){var token$7362;var name$7363;var t0$7357;var t1$7358;var m$7352;(m$7352=temp$7331[$index$7343]);(t0$7357=m$7352);(token$7362=t0$7357);if(((t0$7357 instanceof Array)&&(((t1$7358=t0$7357.length)),((t1$7358===3)&&(t0$7357[0]==="OP"))))){t0$7357[1];(name$7363=t0$7357[2]);acc$7325.push(__lt____lt____lt____colon__$7107(["OP","SFX",name$7363],token$7362));}else{$5987(m$7352,"/home/olivier/git/earl-grey/src/lex.eg",7958,8042);}}return acc$7325;}else{$7147$7169;(t0$7396=buffer$7168);if(((t0$7396 instanceof Array)&&(((t1$7397=t0$7396.length)),((t1$7397>=1)&&(((t2$7398=t0$7396[0])),((first$7391=t2$7398),((t2$7398 instanceof Array)&&(((t3$7399=t2$7398.length)),((t3$7399===3)&&(t2$7398[0]==="OP")))))))))){(fixity$7392=t2$7398[1]);(name$7393=t2$7398[2]);(rest$7394=Array.prototype.slice.call(t0$7396,1));}else{$5987(buffer$7168,"/home/olivier/git/earl-grey/src/lex.eg",8095,8101);}($7383$7425=[first$7391.wsb,first$7391.wsa]);(bridge$7385$7430=$7383$7425);if((((bridge$7385$7430 instanceof Array)&&(((t0$7444=bridge$7385$7430.length)),((t0$7444===2)&&((!bridge$7385$7430[0])&&(!bridge$7385$7430[1])))))||((bridge$7385$7430 instanceof Array)&&(((t0$7451=bridge$7385$7430.length)),((t0$7451===2)&&(bridge$7385$7430[0]&&bridge$7385$7430[1])))))){return [__lt____lt____lt____colon__$7107(["OP","IFX",name$7393],first$7391)].concat(collapse_operators$7108(rest$7394,true,false));}else{if((($7388$7433=($7383$7425 instanceof Array))&&(((t0$7431=$7383$7425.length)),(($7390$7435=(t0$7431===2))&&$7383$7425[0])))){$7383$7425[1];return [__lt____lt____lt____colon__$7107(["OP","PFX",name$7393],first$7391)].concat(collapse_operators$7108(rest$7394,true,false));}else{if(($7390$7435&&($7383$7425[0],$7383$7425[1]))){(results$7474=collapse_operators$7108(rest$7394,false,false));(t$7480=((($7483$7489=results$7474)),(((bridge$7485$7494=$7483$7489)),(function(){if((((bridge$7485$7494 instanceof Array)&&(((t0$7504=bridge$7485$7494.length)),(t0$7504===0)))||((bridge$7485$7494 instanceof Array)&&(((t0$7511=bridge$7485$7494.length)),((t0$7511>=1)&&(((t1$7512=bridge$7485$7494[0])),((t1$7512 instanceof Array)&&(((t2$7513=t1$7512.length)),((t2$7513>=2)&&((t1$7512[0]==="OP")&&((t1$7512[1]==="PFX")&&(Array.prototype.slice.call(t1$7512,2),(Array.prototype.slice.call(bridge$7485$7494,1),true))))))))))))){return ["OP","IFX",name$7393];}else{$7483$7489;return ["OP","SFX",name$7393];}})())));return [__lt____lt____lt____colon__$7107(t$7480,first$7391)].concat(results$7474);}else{$5987($7383$7425);}}}}}}}}else{$5987($7145$7159);}}));(buffer$7109=[]);(pfx$7110=true);(collapse$7111=(function(sfx$7551){var rval$7556;(rval$7556=collapse_operators$7108(buffer$7109,pfx$7110,sfx$7551));(buffer$7109=[]);return rval$7556;}));(results$7112=[]);(temp$7570=stream$7098);($length$7576=temp$7570.length);($index$7582=0);$7113:for(;($index$7582<$length$7576);($index$7582++)){var other$7663;var name$7613;var $7118$7614;var t0$7608;var t1$7609;var token$7600;var $7116$7601;var t0$7596;var m$7591;(m$7591=temp$7570[$index$7582]);(t0$7596=m$7591);(token$7600=t0$7596);($7116$7601=t0$7596);(t0$7608=$7116$7601);if(((t0$7608 instanceof Array)&&(((t1$7609=t0$7608.length)),((t1$7609===3)&&(t0$7608[0]==="OP"))))){($7118$7614=t0$7608[1]);(name$7613=t0$7608[2]);if(($7118$7614==="?FX")){buffer$7109.push(token$7600);}else{if(($7118$7614==="IFX")){(results$7112=results$7112.concat(collapse$7111(true)));results$7112.push(token$7600);(pfx$7110=true);}else{if(($7118$7614==="PFX")){(results$7112=results$7112.concat(collapse$7111(false)));results$7112.push(token$7600);(pfx$7110=true);}else{if(($7118$7614==="SFX")){(results$7112=results$7112.concat(collapse$7111(true)));results$7112.push(token$7600);(pfx$7110=false);}else{$5987($7118$7614,"/home/olivier/git/earl-grey/src/lex.eg",8911,8916);}}}}}else{(other$7663=$7116$7601);(results$7112=results$7112.concat(collapse$7111(false)));results$7112.push(token$7600);(pfx$7110=false);}}return results$7112.concat(collapse$7111(true));}));(alternate_operators$6293=(function(stream$7675){var $index$7719;var $length$7713;var temp$7707;var W$7681;var last_op$7682;var results$7683;(W$7681=(function(x$7695){if(x$7695){return "wide";}else{return "short";}}));(last_op$7682=true);(results$7683=[]);(temp$7707=stream$7675);($length$7713=temp$7707.length);($index$7719=0);$7684:for(;($index$7719<$length$7713);($index$7719++)){var x$7753;var $7774$7781;var token$7819;var fixity$7760;var name$7761;var t0$7745;var t1$7746;var token$7737;var $7687$7738;var t0$7733;var m$7728;(m$7728=temp$7707[$index$7719]);(t0$7733=m$7728);(token$7737=t0$7733);($7687$7738=t0$7733);if((((x$7753=$7687$7738)),((x$7753 instanceof Array)&&(x$7753[0]==="IGNORE")))){null;}else{(t0$7745=$7687$7738);if(((t0$7745 instanceof Array)&&(((t1$7746=t0$7745.length)),((t1$7746===3)&&(t0$7745[0]==="OP"))))){(fixity$7760=t0$7745[1]);(name$7761=t0$7745[2]);if(last_op$7682){results$7683.push(["VOID"]);}($7774$7781=fixity$7760);if(($7774$7781==="IFX")){results$7683.push(__lt____lt____colon__$6284(["IFX",W$7681((token$7737.wsa||token$7737.wsb)),name$7761],token$7737));(last_op$7682=true);}else{if(($7774$7781==="PFX")){if((!last_op$7682)){results$7683.push(["IFX",W$7681(token$7737.wsb),"WHITE"],["VOID"]);}results$7683.push(__lt____lt____colon__$6284(["PFX",W$7681(token$7737.wsa),name$7761],token$7737));(last_op$7682=true);}else{if(($7774$7781==="SFX")){results$7683.push(__lt____lt____colon__$6284(["SFX",W$7681(token$7737.wsb),name$7761],token$7737),["VOID"]);(last_op$7682=false);}else{$5987($7774$7781);}}}}else{(token$7819=$7687$7738);if((!last_op$7682)){results$7683.push(["IFX",W$7681(token$7819.wsb),"WHITE"]);}results$7683.push(token$7819);(last_op$7682=false);}}}if(last_op$7682){results$7683.push(["VOID"]);}return results$7683;}));(fill_locations$6294=(function(source$7833,stream$7834){var $index$7931;var $length$7925;var temp$7919;var to_fill$7840;var start$7841;var fill$7842;(to_fill$7840=[]);(start$7841=0);(fill$7842=(function(end$7857){var $index$7880;var $length$7874;var temp$7868;(temp$7868=to_fill$7840);($length$7874=temp$7868.length);($index$7880=0);$7861:for(;($index$7880<$length$7874);($index$7880++)){var token$7906;var token$7897;var m$7889;(m$7889=temp$7868[$index$7880]);(token$7897=m$7889);if(($index$7880===0)){(token$7897["location"]=Location$6283(source$7833,start$7841,end$7857));}else{(token$7906=m$7889);(token$7906["location"]=Location$6283(source$7833,end$7857,end$7857));}}(to_fill$7840=[]);}));(temp$7919=stream$7834);($length$7925=temp$7919.length);($index$7931=0);$7843:for(;($index$7931<$length$7925);($index$7931++)){var other$7964;var location$7949;var t0$7945;var m$7940;(m$7940=temp$7919[$index$7931]);(t0$7945=m$7940);if(($8178(t0$7945,"location")&&((location$7949=t0$7945.location),location$7949))){fill$7842(location$7949.start);(start$7841=location$7949.end);}else{(other$7964=m$7940);to_fill$7840.push(other$7964);}}fill$7842(source$7833.text.length);return stream$7834;}));(tokenize$6295=(function(src$7971){var it$0$7999;var it$0$7993;var it$0$7987;var it$0$7981;var it$0$7975;(it$0$7975=src$7971);(it$0$7981=produce$6289(it$0$7975));(it$0$7987=process_indent$6291(it$0$7981));(it$0$7993=disambiguate_fixity$6292(it$0$7987));(it$0$7999=alternate_operators$6293(it$0$7993));return fill_locations$6294(src$7971,it$0$7999);}));(exports["tokenize"]=tokenize$6295);(exports["process_indent"]=process_indent$6291);(exports["disambiguate_fixity"]=disambiguate_fixity$6292);(exports["alternate_operators"]=alternate_operators$6293);(exports["fill_locations"]=fill_locations$6294);
