var $3490=function(type$3492){var f$3495;(f$3495=type$3492["::check"]);;if((f$3495===(void 0))){return function(value$3500){return (value$3500 instanceof type$3492);};}else{return function(value$3503){return f$3495.call(type$3492,value$3503);};}};
var $3505=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $3506=function($3507$3509){var ph$3513;(ph$3513=$3507$3509);;var $3511$3518;($3511$3518=ph$3513);;var bridge$3512$3523;var x$3527;(bridge$3512$3523=$3511$3518);if((((typeof(bridge$3512$3523)==="string")&&((x$3527=bridge$3512$3523),true))||((typeof(bridge$3512$3523)==="number")&&((x$3527=bridge$3512$3523),true)))){return ["value",x$3527];}else{var other$3534;(other$3534=$3511$3518);return other$3534["::serialize_ast"]();}};
var send$3330;(send$3330=function(obj$3335,$3333$3336){var ph$3340;var msg$3341;var t0$3343;(t0$3343=$3333$3336);(msg$3341=t0$3343);(ph$3340=t0$3343);;var $3338$3347;($3338$3347=ph$3340);;var bridge$3339$3352;(bridge$3339$3352=$3338$3347);if(((typeof(bridge$3339$3352)==="string")||(typeof(bridge$3339$3352)==="number"))){return obj$3335[msg$3341];}else{var other$3360;(other$3360=$3338$3347);return obj$3335["::send"](msg$3341);}});;(Array[":::project"]=function($3363$3365){var ph$3368;var value$3369;var t0$3371;(t0$3371=$3363$3365);(value$3369=t0$3371);(ph$3368=t0$3371);;var $3367$3375;($3367$3375=ph$3368);;if($3490(Array)($3367$3375)){return [true,value$3369];}else{$3367$3375;return [true,[value$3369]];}});(Array.prototype["::check"]=function(value$3389){if((value$3389 instanceof Array)){var i$3394;(i$3394=0);;$3392:for(;(i$3394<this.length);(i$3394++)){if(($3505(this,i$3394)!==$3505(value$3389,i$3394))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$3405){if((value$3405 instanceof Array)){var i$3410;(i$3410=0);;$3408:for(;(i$3410<this.length);(i$3410++)){if(($3505(this,i$3410)!==$3505(value$3405,i$3410))){return [true,[value$3405]];}}return [true,value$3405.slice(this.length)];}else{return [true,[value$3405]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($3506));});(RegExp.prototype["::check"]=function($3420$3422){var ph$3425;(ph$3425=$3420$3422);;var $3424$3430;($3424$3430=ph$3425);;var value$3438;if((typeof($3424$3430)==="string")){(value$3438=$3424$3430);if(value$3438.match(this)){return true;}else{return false;}}else{var other$3443;(other$3443=$3424$3430);return false;}});(RegExp.prototype[":::project"]=function($3445$3447){var ph$3450;(ph$3450=$3445$3447);;var $3449$3455;($3449$3455=ph$3450);;var value$3463;if((typeof($3449$3455)==="string")){(value$3463=$3449$3455);var $3466$3468;($3466$3468=value$3463.match(this));;var m$3476;if(($3466$3468===null)){(m$3476=$3466$3468);return [false,null];}else{var m$3481;(m$3481=$3466$3468);return [true,m$3481];}}else{var other$3485;(other$3485=$3449$3455);return [false,null];}});(Function.prototype["::send"]=function(args$3488){return this.apply(this,args$3488);});
var $4850=function(arr$4852){var results$4856;var l$4857;(results$4856=[]);;(l$4857=arr$4852.length);;var i$4865;(i$4865=0);;$4855:for(;(i$4865<l$4857);(i$4865++)){results$4856.push([i$4865,$3505(arr$4852,i$4865)]);}return results$4856;};
var $4872=function(dest$4874,values$4875){var k$4880;(k$4880=null);$4878:for(k$4880 in values$4875){if(values$4875.hasOwnProperty(k$4880)){(dest$4874[k$4880]=values$4875[k$4880]);}}return dest$4874;};
var $4681=function(){var $4682$4684;($4682$4684=function(tags$4688){var it$0$4691;(it$0$4691=function(){if((!$3490($4682$4684)(this))){return Object.create($4682$4684.prototype);}else{return this;}}());;(it$0$4691["tags"]=tags$4688);return it$0$4691;});;($4682$4684.prototype["create"]=function(){var $4700$4702;($4700$4702=arguments);;var t0$4707;var message$4711;var args$4712;(t0$4707=$4700$4702.length);if((t0$4707>=0)){(message$4711=function(){if((0>=t0$4707)){return "";}else{return $4700$4702[0];}}());(args$4712=Array.prototype.slice.call($4700$4702,1));var it$0$4716;(it$0$4716=this);;var self$4721;(self$4721=this);;var e$4726;(e$4726=Error(message$4711));;(e$4726["::tags"]=it$0$4716.tags);(e$4726["args"]=args$4712);var temp$4734;(temp$4734=$4850(args$4712));;var $length$4739;($length$4739=temp$4734.length);;var $index$4744;($index$4744=0);;$4727:for(;($index$4744<$length$4739);($index$4744++)){var m$4752;(m$4752=temp$4734[$index$4744]);;var t0$4757;var t1$4758;var i$4762;var arg$4763;(t0$4757=m$4752);if(((t0$4757 instanceof Array)&&((t1$4758=t0$4757.length),(t1$4758===2)))){(i$4762=t0$4757[0]);(arg$4763=t0$4757[1]);(e$4726[i$4762]=arg$4763);}else{$4668(m$4752);;}}(e$4726["length"]=args$4712.length);(e$4726["name"]=["E"].concat(it$0$4716.tags).join("."));return e$4726;}else{$4668($4700$4702);}});($4682$4684.prototype["::check"]=function(e$4774){var it$0$4777;(it$0$4777=this);;var self$4782;(self$4782=this);;var tags$4787;if(((!e$4774)||(!$3490(Error)(e$4774)))){return false;}(tags$4787=(e$4774["::tags"]||[]));;var temp$4796;(temp$4796=it$0$4777.tags);;var $length$4801;($length$4801=temp$4796.length);;var $index$4806;($index$4806=0);;$4788:for(;($index$4806<$length$4801);($index$4806++)){var m$4814;(m$4814=temp$4796[$index$4806]);;var tag$4822;(tag$4822=m$4814);if((tags$4787.indexOf(tag$4822)===-1)){return false;}else{false;;}}return true;});($4682$4684.prototype["::deconstruct"]=function(e$4830){var it$0$4833;(it$0$4833=this);;var self$4838;(self$4838=this);;return e$4830.args;});$4872($4682$4684,$4872(function(){var accum$4843;(accum$4843=({}));(accum$4843["::name"]="$4682");return accum$4843;}(),function(){var accum$4847;(accum$4847=({}));(accum$4847["::egclass"]=true);return accum$4847;}()));return $4682$4684;}();
var $4668=function(value$4670,url$4671,start$4672,end$4673){var err$4676;(err$4676=$4681(["match"]).create("Could not find a match for value",({"value":value$4670})));;if(url$4671){(err$4676["location"]=["location",url$4671,start$4672,end$4673]);}throw err$4676;};
var $4956=function($4957$4959,key$4960){var ph$4964;(ph$4964=$4957$4959);;var $4962$4969;($4962$4969=ph$4964);;var bridge$4963$4974;(bridge$4963$4974=$4962$4969);if(((bridge$4963$4974===null)||(bridge$4963$4974===(void 0)))){return false;}else{var x$4982;if((typeof($4962$4969)==="string")){(x$4982=$4962$4969);return (key$4960 in String.prototype);}else{var x$4987;if((typeof($4962$4969)==="number")){(x$4987=$4962$4969);return (key$4960 in Number.prototype);}else{var x$4992;(x$4992=$4962$4969);return (key$4960 in x$4992);}}}};
var $4900=function($4901$4903){var ph$4909;var x$4910;var t0$4912;(t0$4912=$4901$4903);(x$4910=t0$4912);(ph$4909=t0$4912);;var $4905$4916;($4905$4916=ph$4909);;var bridge$4906$4921;(bridge$4906$4921=$4905$4916);if((function(){var bridge$4907$4927;(bridge$4907$4927=bridge$4906$4921);return (function(){var bridge$4908$4930;(bridge$4908$4930=bridge$4907$4927);return ((bridge$4908$4930===(void 0))||(bridge$4908$4930===null));}()||(typeof(bridge$4907$4927)==="string"));}()||(typeof(bridge$4906$4921)==="number"))){return x$4910;}else{if($4956($4905$4916,"::clone")){$4905$4916["::clone"];return x$4910["::clone"]();}else{$4905$4916;if((Object.getPrototypeOf(x$4910)===Object.prototype)){var dest$4943;(dest$4943=({}));;var k$4948;(k$4948=null);$4942:for(k$4948 in x$4910){if(Object.prototype.hasOwnProperty.call(x$4910,k$4948)){(dest$4943[k$4948]=x$4910[k$4948]);}}return dest$4943;}else{var other$4954;(other$4954=$4905$4916);throw $4681(["clone"]).create("Object cannot be cloned",({"obj":x$4910}));}}}};
var $4884=function(a$4886,b$4887){var dest$4891;(dest$4891=$4900(a$4886));;var k$4896;(k$4896=null);$4890:for(k$4896 in b$4887){if(Object.prototype.hasOwnProperty.call(b$4887,k$4896)){(dest$4891[k$4896]=b$4887[k$4896]);}}return dest$4891;};var id$3567;var id_f$3568;var numr$3569;var numr_f$3570;var num$3571;var num_f$3572;var str$3573;var str_f$3574;var op$3575;var op2$3576;var op3$3577;var op4$3578;var op_f$3579;var indent$3580;var indent_f$3581;var cmnt$3582;var cmnt_f$3583;var unkn$3584;var unkn_f$3585;var $3537$3538;var Location$3539;var __lt____lt____colon__$3540;var special_ops$3541;var regexps$3542;var ws_re$3543;var eol_re$3544;var produce$3545;var indent_tracker$3546;var process_indent$3547;var disambiguate_fixity$3548;var alternate_operators$3549;var fill_locations$3550;var tokenize$3551;($3537$3538=require("./location"));;(Location$3539=$3537$3538.Location);;(__lt____lt____colon__$3540=$3537$3538["<<:"]);;(special_ops$3541=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",".":"PFX","'":"PFX","not":"PFX"}));;(regexps$3542=(((id$3567=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))",""))),((id_f$3568=function(m$3592){return ["ID",m$3592[0]];})),((numr$3569=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))",""))),((numr_f$3570=function(m$3601){var t0$3609;var t1$3610;var radix$3604;var intp$3605;var frac$3606;var value$3607;(t0$3609=m$3601);if(((t0$3609 instanceof Array)&&((t1$3610=t0$3609.length),(t1$3610===4)))){t0$3609[0];(radix$3604=t0$3609[1]);(intp$3605=t0$3609[2]);(frac$3606=t0$3609[3]);;}else{$4668(m$3601,"/home/olivier/git/earl-grey/src/lex.eg",993,994);}(value$3607=parseInt(intp$3605.replace(RegExp("_","g"),""),radix$3604));;if(frac$3606){(frac$3606=frac$3606.replace(RegExp("_","g"),""));(value$3607=(value$3607+(parseInt(frac$3606,radix$3604)/Math.pow(radix$3604,frac$3606.length))));}return ["ID","NUM",value$3607];})),((num$3571=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))",""))),((num_f$3572=function(m$3626){return ["NUM",parseFloat(m$3626[0].replace(RegExp("_","g"),""))];})),((str$3573=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")",""))),((str_f$3574=function(m$3635){var repl$3638;var r$3639;(repl$3638=({"\\\"":"\"","\\\\":"\\","\\n":"\n"}));;(r$3639=m$3635[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m$3646){return $3505(repl$3638,m$3646);}));;return ["STR",r$3639];})),((op$3575=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!@#.:']+))",""))),((op2$3576=RegExp("(?:^[\\[\\{\\}\\],])",""))),((op3$3577=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|mod)|each)|as)(?:(?:[+\\-*/~\\^<>=%&|?!@#.:']+)|\\b))",""))),((op4$3578=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)",""))),((op_f$3579=function(m$3665,column$3666){var fixity$3692;var otherwise$3698;var $3670$3682;var $3669$3676;var op$3671;(op$3671=(m$3665[1]||m$3665[0]));;($3669$3676=null);;$3669$3676;if((op$3671==="|")){return ["INDENT",(column$3666-1)];}else{if((op$3671 in special_ops$3541)){(fixity$3692=$3505(special_ops$3541,op$3671));;return ["OP",fixity$3692,op$3671];}else{(otherwise$3698=$3669$3676);return ["OP","?FX",op$3671];}}})),((indent$3580=RegExp("(?:^(?:(?:\n((?: *)))+))",""))),((indent_f$3581=function(m$3707){var ilen$3710;(ilen$3710=m$3707[1].length);;return ["INDENT",ilen$3710];})),((cmnt$3582=RegExp("(?:^;(?:[^\n]*))",""))),((cmnt_f$3583=function(m$3721){return ["IGNORE"];})),((unkn$3584=RegExp("(?:^.)",""))),((unkn_f$3585=function(m$3730){return ["ILLEGAL",m$3730[0]];})),[[op3$3577,op_f$3579],[id$3567,id_f$3568],[numr$3569,numr_f$3570],[num$3571,num_f$3572],[str$3573,str_f$3574],[op$3575,op_f$3579],[op2$3576,op_f$3579],[op4$3578,op_f$3579],[indent$3580,indent_f$3581],[cmnt$3582,cmnt_f$3583],[unkn$3584,unkn_f$3585]]));;(ws_re$3543=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))",""));;(eol_re$3544=RegExp("(?:^(?: *)(?:\n|$))",""));;(produce$3545=function(src$3743){var text$3746;var results$3747;var wsb$3748;var pos$3749;var column$3750;(text$3746=src$3743.text);;(results$3747=[]);;(wsb$3748=text$3746.match(ws_re$3543)[0].length);;(text$3746=text$3746.slice(wsb$3748));(pos$3749=wsb$3748);;(column$3750=0);;$3766:while(text$3746){var i$3771;(i$3771=0);;$3769:for(;(i$3771<regexps$3542.length);(++i$3771)){var t0$3783;var t1$3784;var splits$3807;var skip$3793;var endpos$3794;var wsa$3795;var eol$3796;var bwsb$3797;var bwsa$3798;var token$3799;var re$3779;var fn$3780;var m$3781;(t0$3783=$3505(regexps$3542,i$3771));if(((t0$3783 instanceof Array)&&((t1$3784=t0$3783.length),(t1$3784===2)))){(re$3779=t0$3783[0]);(fn$3780=t0$3783[1]);;}else{$4668($3505(regexps$3542,i$3771),"/home/olivier/git/earl-grey/src/lex.eg",3298,3318);}(m$3781=text$3746.match(re$3779));;if(m$3781){(skip$3793=m$3781[0].length);;(endpos$3794=(pos$3749+skip$3793));;(column$3750=(((splits$3807=m$3781[0].split("\n"))),function(){if((splits$3807.length>1)){return $3505(splits$3807,(splits$3807.length-1)).length;}else{return (column$3750+skip$3793);}}()));(text$3746=text$3746.slice(skip$3793));(wsa$3795=text$3746.match(ws_re$3543)[0].length);;(eol$3796=(text$3746.match(eol_re$3544)&&true));;(bwsb$3797=(wsb$3748>0));;(bwsa$3798=function(){if(eol$3796){return bwsb$3797;}else{return (wsa$3795>0);}}());;(token$3799=fn$3780(m$3781,column$3750));;(token$3799["wsb"]=bwsb$3797);(token$3799["wsa"]=bwsa$3798);(token$3799["location"]=Location$3539(src$3743,pos$3749,endpos$3794));results$3747.push(token$3799);(text$3746=text$3746.slice(wsa$3795));(column$3750=(column$3750+wsa$3795));(wsb$3748=wsa$3795);(pos$3749=(endpos$3794+wsa$3795));break $3769;}}}return results$3747;});;(indent_tracker$3546=function(){var curr$3833;var stack$3834;var stacks$3835;(curr$3833=false);;(stack$3834=[]);;(stacks$3835=[stack$3834]);;return function($3832$3846){var t0$3859;var rval$3905;var $index$3957;var $length$3952;var temp$3947;var acc$3942;var rval$3936;var other$3977;var fixity$3930;var fixity$3922;var stuff$3917;var new_indent$3879;var $3849$3880;var $3852$3873;var $3853$3874;var $3854$3875;var $3855$3876;var t0$3868;var t1$3869;var bridge$3850$3870;var bridge$3851$3871;var $3848$3863;var ph$3856;var token$3857;(t0$3859=$3832$3846);(token$3857=t0$3859);(ph$3856=t0$3859);;($3848$3863=ph$3856);;if((($3852$3873=($3848$3863 instanceof Array))&&((t0$3868=$3848$3863.length),((t0$3868===2)&&($3848$3863[0]==="INDENT"))))){(t1$3869=$3848$3863[1]);(new_indent$3879=t1$3869);($3849$3880=t1$3869);$3849$3880;if((curr$3833===false)){(curr$3833=new_indent$3879);return [$4884(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3849$3880>curr$3833)){$3505(stack$3834.push(curr$3833),(curr$3833=new_indent$3879));return [$4884(["OP","PFX","["],({"wsb":true,"wsa":true}))];}else{if(($3849$3880===curr$3833)){return [$4884(["OP","IFX",","],({"wsb":true,"wsa":true}))];}else{if(($3849$3880<curr$3833)){(rval$3905=[]);;$3909:while(((stack$3834.length>0)&&(new_indent$3879<curr$3833))){(curr$3833=stack$3834.pop());rval$3905.push($4884(["OP","SFX","]"],({"wsb":true,"wsa":true})));}rval$3905.push($4884(["OP","IFX",","],({"wsb":true,"wsa":true})));return rval$3905;}else{$4668($3849$3880,"/home/olivier/git/earl-grey/src/lex.eg",4651,4667);}}}}}else{if(($3852$3873&&((t0$3868>=1)&&($3848$3863[0]==="ID")))){(stuff$3917=Array.prototype.slice.call($3848$3863,1));return [token$3857];}else{if(($3852$3873&&(($3854$3875=(t0$3868===3))&&(($3855$3876=($3848$3863[0]==="OP"))&&((fixity$3922=$3848$3863[1]),((bridge$3850$3870=$3848$3863[2]),((bridge$3850$3870==="[")||(bridge$3850$3870==="{")))))))){stack$3834.push(curr$3833);stacks$3835.push(stack$3834);(stack$3834=[]);(curr$3833=false);return [token$3857];}else{if(($3855$3876&&((fixity$3930=$3848$3863[1]),((bridge$3851$3871=$3848$3863[2]),((bridge$3851$3871==="]")||(bridge$3851$3871==="}")))))){(rval$3936=(((acc$3942=[])),(((temp$3947=stack$3834)),((($length$3952=temp$3947.length)),((($index$3957=0)),function(){$3939:for(;($index$3957<$length$3952);($index$3957++)){var m$3965;(m$3965=temp$3947[$index$3957]);;m$3965;acc$3942.push($4884(["OP","SFX","]"],({"wsb":true,"wsa":true})));}}()))),acc$3942));;(stack$3834=stacks$3835.pop());(curr$3833=stack$3834.pop());rval$3936.push(token$3857);return rval$3936;}else{(other$3977=$3848$3863);return [token$3857];}}}}};});;(process_indent$3547=function(stream$3983){var $index$4008;var $length$4003;var temp$3998;var tracker$3986;var results$3987;(tracker$3986=indent_tracker$3546());;(results$3987=[]);;(temp$3998=stream$3983);;($length$4003=temp$3998.length);;($index$4008=0);;$3988:for(;($index$4008<$length$4003);($index$4008++)){var token$4024;var m$4016;(m$4016=temp$3998[$index$4008]);;(token$4024=m$4016);(results$3987=results$3987.concat(tracker$3986(token$4024)));}return results$3987;});;(disambiguate_fixity$3548=function(stream$4030){var $index$4354;var $length$4349;var temp$4344;var __lt____lt____lt____colon__$4033;var collapse_operators$4034;var buffer$4035;var pfx$4036;var collapse$4037;var results$4038;(__lt____lt____lt____colon__$4033=function(a$4046,b$4047){(a$4046["wsb"]=b$4047.wsb);(a$4046["wsa"]=b$4047.wsa);return __lt____lt____colon__$3540(a$4046,b$4047);});;(collapse_operators$4034=function(){var msg$4122;var longer$4119;var token$4108;var fixity$4109;var name$4110;var t0$4102;var t1$4103;var t2$4104;var $4095$4097;var $index$4148;var $length$4143;var temp$4138;var acc$4133;var $index$4196;var $length$4191;var temp$4186;var acc$4181;var t0$4235;var t1$4236;var t2$4237;var t3$4238;var t0$4262;var t0$4265;var t0$4301;var t0$4304;var t1$4305;var t2$4306;var bridge$4288$4295;var $4287$4290;var t$4284;var results$4279;var $4227$4255;var $4228$4256;var $4229$4257;var bridge$4226$4252;var t0$4253;var $4225$4247;var first$4230;var fixity$4231;var name$4232;var rest$4233;var n$4083;var $4056$4078;var $4057$4079;var $4058$4080;var $4059$4081;var t0$4075;var t1$4076;var buffer$4070;var $4055$4071;var t0$4066;var $4054$4061;($4054$4061=arguments);;(t0$4066=$4054$4061.length);if((t0$4066>=1)){(buffer$4070=$4054$4061[0]);($4055$4071=Array.prototype.slice.call($4054$4061,1));(n$4083=buffer$4070.length);;$4055$4071;if((!buffer$4070.length)){return [];}else{(t0$4075=$4055$4071);(t1$4076=t0$4075.length);if((($4058$4080=(t1$4076===2))&&(($4059$4081=t0$4075[0])&&t0$4075[1]))){($4095$4097=buffer$4070);;if((($4095$4097 instanceof Array)&&((t0$4102=$4095$4097.length),((t0$4102===1)&&((t1$4103=$4095$4097[0]),((token$4108=t1$4103),((t1$4103 instanceof Array)&&((t2$4104=t1$4103.length),((t2$4104===3)&&(t1$4103[0]==="OP")))))))))){(fixity$4109=t1$4103[1]);(name$4110=t1$4103[2]);return [__lt____lt____lt____colon__$4033(["ID",name$4110],token$4108)];}else{(longer$4119=$4095$4097);(msg$4122="Too many consecutive operators were found here.");;throw $4681(["syntax","nullary"]).create(msg$4122,({"operators":buffer$4070}));}}else{if($4059$4081){t0$4075[1];(acc$4133=[]);;(temp$4138=buffer$4070);;($length$4143=temp$4138.length);;($index$4148=0);;$4130:for(;($index$4148<$length$4143);($index$4148++)){var token$4166;var name$4167;var t0$4161;var t1$4162;var m$4156;(m$4156=temp$4138[$index$4148]);;(t0$4161=m$4156);(token$4166=t0$4161);if(((t0$4161 instanceof Array)&&((t1$4162=t0$4161.length),((t1$4162===3)&&(t0$4161[0]==="OP"))))){t0$4161[1];(name$4167=t0$4161[2]);acc$4133.push(__lt____lt____lt____colon__$4033(["OP","PFX",name$4167],token$4166));}else{$4668(m$4156,"/home/olivier/git/earl-grey/src/lex.eg",6879,6973);;}}return acc$4133;}else{if(($4058$4080&&(t0$4075[0],t0$4075[1]))){(acc$4181=[]);;(temp$4186=buffer$4070);;($length$4191=temp$4186.length);;($index$4196=0);;$4178:for(;($index$4196<$length$4191);($index$4196++)){var token$4214;var name$4215;var t0$4209;var t1$4210;var m$4204;(m$4204=temp$4186[$index$4196]);;(t0$4209=m$4204);(token$4214=t0$4209);if(((t0$4209 instanceof Array)&&((t1$4210=t0$4209.length),((t1$4210===3)&&(t0$4209[0]==="OP"))))){t0$4209[1];(name$4215=t0$4209[2]);acc$4181.push(__lt____lt____lt____colon__$4033(["OP","SFX",name$4215],token$4214));}else{$4668(m$4204,"/home/olivier/git/earl-grey/src/lex.eg",6986,7080);;}}return acc$4181;}else{$4055$4071;(t0$4235=buffer$4070);if(((t0$4235 instanceof Array)&&((t1$4236=t0$4235.length),((t1$4236>=1)&&((t2$4237=t0$4235[0]),((first$4230=t2$4237),((t2$4237 instanceof Array)&&((t3$4238=t2$4237.length),((t3$4238===3)&&(t2$4237[0]==="OP")))))))))){(fixity$4231=t2$4237[1]);(name$4232=t2$4237[2]);(rest$4233=Array.prototype.slice.call(t0$4235,1));;}else{$4668(buffer$4070,"/home/olivier/git/earl-grey/src/lex.eg",7133,7139);}($4225$4247=[first$4230.wsb,first$4230.wsa]);;(bridge$4226$4252=$4225$4247);if((((bridge$4226$4252 instanceof Array)&&((t0$4262=bridge$4226$4252.length),((t0$4262===2)&&((!bridge$4226$4252[0])&&(!bridge$4226$4252[1])))))||((bridge$4226$4252 instanceof Array)&&((t0$4265=bridge$4226$4252.length),((t0$4265===2)&&(bridge$4226$4252[0]&&bridge$4226$4252[1])))))){return [__lt____lt____lt____colon__$4033(["OP","IFX",name$4232],first$4230)].concat(collapse_operators$4034(rest$4233,true,false));}else{if((($4227$4255=($4225$4247 instanceof Array))&&((t0$4253=$4225$4247.length),(($4229$4257=(t0$4253===2))&&$4225$4247[0])))){$4225$4247[1];return [__lt____lt____lt____colon__$4033(["OP","PFX",name$4232],first$4230)].concat(collapse_operators$4034(rest$4233,true,false));}else{if(($4229$4257&&($4225$4247[0],$4225$4247[1]))){(results$4279=collapse_operators$4034(rest$4233,false,false));;(t$4284=((($4287$4290=results$4279)),((bridge$4288$4295=$4287$4290),function(){if((((bridge$4288$4295 instanceof Array)&&((t0$4301=bridge$4288$4295.length),(t0$4301===0)))||((bridge$4288$4295 instanceof Array)&&((t0$4304=bridge$4288$4295.length),((t0$4304>=1)&&((t1$4305=bridge$4288$4295[0]),((t1$4305 instanceof Array)&&((t2$4306=t1$4305.length),((t2$4306>=2)&&((t1$4305[0]==="OP")&&((t1$4305[1]==="PFX")&&(Array.prototype.slice.call(t1$4305,2),(Array.prototype.slice.call(bridge$4288$4295,1),true))))))))))))){return ["OP","IFX",name$4232];}else{$4287$4290;return ["OP","SFX",name$4232];}}())));;return [__lt____lt____lt____colon__$4033(t$4284,first$4230)].concat(results$4279);}else{$4668($4225$4247);}}}}}}}}else{$4668($4054$4061);}});;(buffer$4035=[]);;(pfx$4036=true);;(collapse$4037=function(sfx$4331){var rval$4334;(rval$4334=collapse_operators$4034(buffer$4035,pfx$4036,sfx$4331));;(buffer$4035=[]);return rval$4334;});;(results$4038=[]);;(temp$4344=stream$4030);;($length$4349=temp$4344.length);;($index$4354=0);;$4039:for(;($index$4354<$length$4349);($index$4354++)){var other$4410;var name$4380;var $4042$4381;var t0$4375;var t1$4376;var token$4371;var $4041$4372;var t0$4367;var m$4362;(m$4362=temp$4344[$index$4354]);;(t0$4367=m$4362);(token$4371=t0$4367);($4041$4372=t0$4367);(t0$4375=$4041$4372);if(((t0$4375 instanceof Array)&&((t1$4376=t0$4375.length),((t1$4376===3)&&(t0$4375[0]==="OP"))))){($4042$4381=t0$4375[1]);(name$4380=t0$4375[2]);if(($4042$4381==="?FX")){buffer$4035.push(token$4371);}else{if(($4042$4381==="IFX")){(results$4038=results$4038.concat(collapse$4037(true)));results$4038.push(token$4371);(pfx$4036=true);}else{if(($4042$4381==="PFX")){(results$4038=results$4038.concat(collapse$4037(false)));results$4038.push(token$4371);(pfx$4036=true);}else{if(($4042$4381==="SFX")){(results$4038=results$4038.concat(collapse$4037(true)));results$4038.push(token$4371);(pfx$4036=false);}else{$4668($4042$4381,"/home/olivier/git/earl-grey/src/lex.eg",7930,7935);;}}}}}else{(other$4410=$4041$4372);(results$4038=results$4038.concat(collapse$4037(false)));results$4038.push(token$4371);(pfx$4036=false);}}return results$4038.concat(collapse$4037(true));});;(alternate_operators$3549=function(stream$4417){var $index$4450;var $length$4445;var temp$4440;var W$4420;var last_op$4421;var results$4422;(W$4420=function(x$4429){if(x$4429){return "wide";}else{return "short";}});;(last_op$4421=true);;(results$4422=[]);;(temp$4440=stream$4417);;($length$4445=temp$4440.length);;($index$4450=0);;$4423:for(;($index$4450<$length$4445);($index$4450++)){var x$4478;var $4491$4494;var x$4522;var token$4529;var fixity$4485;var name$4486;var t0$4471;var t1$4472;var token$4467;var $4425$4468;var t0$4463;var m$4458;(m$4458=temp$4440[$index$4450]);;(t0$4463=m$4458);(token$4467=t0$4463);($4425$4468=t0$4463);if((((x$4478=$4425$4468)),((x$4478 instanceof Array)&&(x$4478[0]==="IGNORE")))){null;}else{(t0$4471=$4425$4468);if(((t0$4471 instanceof Array)&&((t1$4472=t0$4471.length),((t1$4472===3)&&(t0$4471[0]==="OP"))))){(fixity$4485=t0$4471[1]);(name$4486=t0$4471[2]);if(last_op$4421){results$4422.push(["VOID"]);}($4491$4494=fixity$4485);;if(($4491$4494==="IFX")){results$4422.push(__lt____lt____colon__$3540(["IFX",W$4420((token$4467.wsa||token$4467.wsb)),name$4486],token$4467));(last_op$4421=true);}else{if(($4491$4494==="PFX")){if((!last_op$4421)){results$4422.push(["IFX",W$4420(token$4467.wsb),"WHITE"],["VOID"]);}results$4422.push(__lt____lt____colon__$3540(["PFX",W$4420(token$4467.wsa),name$4486],token$4467));(last_op$4421=true);}else{if(($4491$4494==="SFX")){results$4422.push(__lt____lt____colon__$3540(["SFX",W$4420(token$4467.wsb),name$4486],token$4467),["VOID"]);(last_op$4421=false);}else{$4668($4491$4494);;}}}}else{if((((x$4522=$4425$4468)),((x$4522 instanceof Array)&&(x$4522[0]==="ILLEGAL")))){throw $4681(["syntax","illegal"]).create("unknown character",({"chr":token$4467}));}else{(token$4529=$4425$4468);if((!last_op$4421)){results$4422.push(["IFX",W$4420(token$4529.wsb),"WHITE"]);}results$4422.push(token$4529);(last_op$4421=false);}}}}if(last_op$4421){results$4422.push(["VOID"]);}return results$4422;});;(fill_locations$3550=function(source$4538,stream$4539){var $index$4609;var $length$4604;var temp$4599;var to_fill$4542;var start$4543;var fill$4544;(to_fill$4542=[]);;(start$4543=0);;(fill$4544=function(end$4556){var $index$4573;var $length$4568;var temp$4563;(temp$4563=to_fill$4542);;($length$4568=temp$4563.length);;($index$4573=0);;$4559:for(;($index$4573<$length$4568);($index$4573++)){var token$4594;var token$4589;var m$4581;(m$4581=temp$4563[$index$4573]);;(token$4589=m$4581);if(($index$4573===0)){(token$4589["location"]=Location$3539(source$4538,start$4543,end$4556));}else{(token$4594=m$4581);(token$4594["location"]=Location$3539(source$4538,end$4556,end$4556));}}return (to_fill$4542=[]);});;(temp$4599=stream$4539);;($length$4604=temp$4599.length);;($index$4609=0);;$4545:for(;($index$4609<$length$4604);($index$4609++)){var other$4633;var location$4626;var t0$4622;var m$4617;(m$4617=temp$4599[$index$4609]);;(t0$4622=m$4617);if(($4956(t0$4622,"location")&&((location$4626=t0$4622.location),location$4626))){fill$4544(location$4626.start);(start$4543=location$4626.end);}else{(other$4633=m$4617);to_fill$4542.push(other$4633);}}fill$4544(source$4538.text.length);return stream$4539;});;(tokenize$3551=function(src$4639){var it$0$4662;var it$0$4657;var it$0$4652;var it$0$4647;var it$0$4642;(it$0$4642=src$4639);;(it$0$4647=produce$3545(it$0$4642));;(it$0$4652=process_indent$3547(it$0$4647));;(it$0$4657=disambiguate_fixity$3548(it$0$4652));;(it$0$4662=alternate_operators$3549(it$0$4657));;return fill_locations$3550(src$4639,it$0$4662);});;(exports["tokenize"]=tokenize$3551);
