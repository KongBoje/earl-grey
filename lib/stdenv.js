var augment=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};var send=function(obj,__t94){var msg;var __t93;(msg=__t94);true;(__t93=__t94);var __t95=__t93;var other;if(((typeof(__t95)==="string")||(typeof(__t95)==="number"))){return obj[msg];}else{if(((other=__t95),true)){return obj["::send"](msg);}else{throw ["Could not find a match",__t95];}}};var patch_array=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};var range=function(from,to){var rval=[];for(var i=from;(i<=to);(i++)){rval.push(i);}return rval;};var ___checker=function(type){var __t96=type["::check"];var f;if((__t96===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=__t96),true)){return function(value){return f.call(type,value);};}else{throw ["Could not find a match",__t96];}}};var ___projector=function(type){return function(value){var __t97=type[":::project"];var f;if((__t97===(void 0))){var __t98=type["::project"];var f;if((__t98===(void 0))){return [true,type(value)];}else{if(((f=__t98),true)){var __t100;try{(__t100=[true,f(value)]);}catch(__t99){(__t100=[false,null]);}return __t100;}else{throw ["Could not find a match",__t98];}}}else{if(((f=__t97),true)){return f.call(type,value);}else{throw ["Could not find a match",__t97];}}};};var ___deconstructor=function(type){return function(value){var __t101=type[":::deconstruct"];var f;if((__t101===(void 0))){var __t102=type["::deconstruct"];var f;if((__t102===(void 0))){if((value instanceof Array)){return [true,value];}else{if(true){return [false,null];}else{return false;}}}else{if(((f=__t102),true)){var __t104;try{(__t104=[true,f.call(type,value)]);}catch(__t103){(__t104=[false,null]);}return __t104;}else{throw ["Could not find a match",__t102];}}}else{if(((f=__t101),true)){return f.call(type,value);}else{throw ["Could not find a match",__t101];}}};};(Array[":::project"]=function(__t106){var value;var __t105;(value=__t106);true;(__t105=__t106);var __t107=__t105;var _;if(___checker(Array)(__t107)){return [true,value];}else{if(((_=__t107),true)){return [true,[value]];}else{throw ["Could not find a match",__t107];}}});(Array.prototype["boink"]=function(){return this;});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return value.slice(this.length);});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var __t108=value.match(this);var m;var m;if(((__t108===null)&&((m=__t108),true))){return [false,null];}else{if(((m=__t108),true)){return [true,m];}else{throw ["Could not find a match",__t108];}}});(RegExp.prototype[":::deconstruct"]=function(value){var __t109=value.match(this);var m;var m;if(((__t109===null)&&((m=__t109),true))){return [false,null];}else{if(((m=__t109),true)){return [true,m];}else{throw ["Could not find a match",__t109];}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var ErrorFactory=function(tags){var __t87=function(){if((!___checker(ErrorFactory)(this))){return Object.create(ErrorFactory.prototype);}else{return this;}}();(__t87["tags"]=tags);return __t87;};augment(ErrorFactory,[]);(ErrorFactory.prototype["create"]=function(){var __t88=Array.prototype.slice.call(arguments,0);var __tp0;var message;var args;if(((__t88 instanceof Array)&&(((__tp0=__t88.length),true)&&((__tp0>=0)&&((message=function(){if((0>=__tp0)){return "";}else{return __t88[0];}}()),true,(args=__t88.slice(1)),true))))){var __t87=this;var e=Error(message);(e["::tags"]=__t87.tags);(e["args"]=args);(e["name"]=["E"].concat(__t87.tags).join("."));return e;}else{throw ["Could not find a match",__t88];}});(ErrorFactory.prototype["::check"]=function(e){var __t87=this;if(((!e)||(!___checker(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var __t89=__t87.tags;var __t90=__t89.length;for(var __t91=0;(__t91<__t90);(__t91++)){var __t92=__t89[__t91];var tag;var other;if(((tag=__t92),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=__t92),true)){false;}else{throw ["Could not find a match",__t92];}}}false;return true;});(ErrorFactory.prototype["::deconstruct"]=function(e){var __t87=this;return e.args;});ErrorFactory;
var __t364=require("./expand");var Env=__t364.Env;var nullenv=__t364.nullenv;var expand=__t364.expand;var __t365=require("./helpers");var aslist=__t365.aslist;var transform=__t365.transform;var __t366=require("./util");var enumerate=__t366.enumerate;var items=__t366.items;var stdenv=Env(nullenv);var __t367=items(({"+":"___plus","-":"___minus","*":"___times","/":"___div","mod":"___mod","^":"___binxor","&":"___binand","|":"___binor","&&":"___and","||":"___or","and":"___and","or":"___or","not":"___not","===":"___is","!==":"___isnt","!=":"___neq","<":"___lt",">":"___gt","<=":"___lte",">=":"___gte","<<":"___shl",">>":"___shr",">>>":"___shr2","in":"___in","instanceof":"___instanceof","--":"___minusminus"}));var __t368=__t367.length;for(var __t369=0;(__t369<__t368);(__t369++)){var __t370=__t367[__t369];var __tp0;var k;var v;var other;if(((__t370 instanceof Array)&&(((__tp0=__t370.length),true)&&((__tp0===2)&&((k=__t370[0]),true,(v=__t370[1]),true))))){stdenv.register(k,["symbol",v]);}else{if(((other=__t370),true)){false;}else{throw ["Could not find a match",__t370];}}}false;stdenv.register_macro("++",function(_,__t371){var __t372=__t371;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var x;var __tp0;var __tp1;var x;var __tp2;var __tp3;var __tp4;var __tp0;var __tp1;var x;var y;var __tp0;var __tp1;var __t373=false;var __t374=false;var __t375=false;var __t376=false;if(((__t373=(__t372 instanceof Array))&&((__t374=((__tp0=__t372.length),true))&&((__t375=(__tp0===3))&&((__t376=((__tp1=__t372[0]),(__tp1==="data")))&&(((__tp2=__t372[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&((x=__t372[2]),true)))))))))){return ["send",["symbol","___plusplus"],["data",["void"],x]];}else{if((__t376&&(((x=__t372[1]),true,(__tp2=__t372[2]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void"))))))){return ["send",["symbol","___plusplus"],["data",x,["void"]]];}else{if((__t376&&((x=__t372[1]),true,(y=__t372[2]),true))){return ["send",["send",x,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",y]];}else{if((__t374&&((__tp0===1)&&((__tp1=__t372[0]),(__tp1==="void"))))){return ["send",["symbol","->"],["data",["data",["symbol","x"],["symbol","y"]],["send",["send",["symbol","x"],["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",["symbol","y"]]]]];}else{throw ["Could not find a match",__t372];}}}}});stdenv.register_macro("..",function(_,__t377){var __t378=__t377;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var x;var __tp0;var __tp1;var x;var __tp2;var __tp3;var __tp4;var __tp0;var __tp1;var x;var y;var __tp0;var __tp1;var __t379=false;var __t380=false;var __t381=false;var __t382=false;if(((__t379=(__t378 instanceof Array))&&((__t380=((__tp0=__t378.length),true))&&((__t381=(__tp0===3))&&((__t382=((__tp1=__t378[0]),(__tp1==="data")))&&(((__tp2=__t378[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&((x=__t378[2]),true)))))))))){return ["send",["symbol","range"],["data",["value",1],x]];}else{if((__t382&&(((x=__t378[1]),true,(__tp2=__t378[2]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void"))))))){return ["send",["symbol","range"],["data",x]];}else{if((__t382&&((x=__t378[1]),true,(y=__t378[2]),true))){return ["send",["symbol","range"],["data",x,y]];}else{if((__t380&&((__tp0===1)&&((__tp1=__t378[0]),(__tp1==="void"))))){return ["symbol","range"];}else{throw ["Could not find a match",__t378];}}}}});var make_checker=function(value,op){return function(__t383,__t384){var __tp0;var context;var env;if(((__t383 instanceof Array)&&(((__tp0=__t383.length),true)&&((__tp0===2)&&((context=__t383[0]),true,(env=__t383[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var expr;if(((__t384 instanceof Array)&&(((__tp0=__t384.length),true)&&((__tp0===2)&&(((__tp1=__t384[0]),(__tp1==="data"))&&((expr=__t384[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",op,["data",expr,value]];};};stdenv.register_macro("**",function(__t385,__t386){var __tp0;var context;var env;if(((__t385 instanceof Array)&&(((__tp0=__t385.length),true)&&((__tp0===2)&&((context=__t385[0]),true,(env=__t385[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var a;var b;if(((__t386 instanceof Array)&&(((__tp0=__t386.length),true)&&((__tp0===3)&&(((__tp1=__t386[0]),(__tp1==="data"))&&((a=__t386[1]),true,(b=__t386[2]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","pow"]]]],["data",a,b]];});stdenv.register_macro("//",function(__t387,__t388){var __tp0;var context;var env;if(((__t387 instanceof Array)&&(((__tp0=__t387.length),true)&&((__tp0===2)&&((context=__t387[0]),true,(env=__t387[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var a;var b;if(((__t388 instanceof Array)&&(((__tp0=__t388.length),true)&&((__tp0===3)&&(((__tp1=__t388[0]),(__tp1==="data"))&&((a=__t388[1]),true,(b=__t388[2]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["send",["symbol","Math"],["send",["symbol","."],["data",["void"],["symbol","floor"]]]],["data",["send",["symbol","/"],["data",a,b]]]];});var errf_macro=function(tags){return function(__t390,__t389){var __tp0;var context;var env;if(((__t390 instanceof Array)&&(((__tp0=__t390.length),true)&&((__tp0===2)&&((context=__t390[0]),true,(env=__t390[1]),true))))){(void 0);}else{throw "a condition failed";}var __t391=__t389;var __tp0;var __tp1;var __tp0;var __tp1;var args;var other;var __t392=false;var __t393=false;if(((__t392=(__t391 instanceof Array))&&((__t393=((__tp0=__t391.length),true))&&((__tp0===1)&&((__tp1=__t391[0]),(__tp1==="void")))))){return ["send",["symbol","ErrorFactory"],["data",patch_array(["data"],tags)]];}else{if((__t393&&((__tp0>=1)&&(((__tp1=__t391[0]),(__tp1==="data"))&&((args=__t391.slice(1)),true))))){return ["send",["send",["send",["symbol","ErrorFactory"],["data",patch_array(["data"],tags)]],["send",["symbol","."],["data",["void"],["symbol","create"]]]],patch_array(["data"],args)];}else{if(((other=__t391),true)){return ["macro",errf_macro(tags.concat([other]))];}else{throw ["Could not find a match",__t391];}}}};};stdenv.register_macro("E",errf_macro([]));stdenv.register_macro("#",function(__t394,__t395){var __tp0;var context;var env;if(((__t394 instanceof Array)&&(((__tp0=__t394.length),true)&&((__tp0===2)&&((context=__t394[0]),true,(env=__t394[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var tag;if(((__t395 instanceof Array)&&(((__tp0=__t395.length),true)&&((__tp0===3)&&(((__tp1=__t395[0]),(__tp1==="data"))&&(((__tp2=__t395[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&(((__tp5=__t395[2]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===2)&&(((__tp7=__tp5[0]),(__tp7==="symbol"))&&((tag=__tp5[1]),true)))))))))))))){(void 0);}else{throw "a condition failed";}(tag=["value",tag]);var f=function(__t397,expr){var __tp0;var __t396;var env;if(((__t397 instanceof Array)&&(((__tp0=__t397.length),true)&&((__tp0===2)&&((__t396=__t397[0]),true,(env=__t397[1]),true))))){(void 0);}else{throw "a condition failed";}var __t398=__t396;var _;if((__t398==="pattern")){var checker_mac=function(){var f1=function(_,__t402){var __tp0;var __tp1;var expr;if(((__t402 instanceof Array)&&(((__tp0=__t402.length),true)&&((__tp0===2)&&(((__tp1=__t402[0]),(__tp1==="data"))&&((expr=__t402[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["symbol","instanceof"],["data",expr,["symbol","Array"]]];};var f2=function(_,__t403){var __tp0;var __tp1;var expr;if(((__t403 instanceof Array)&&(((__tp0=__t403.length),true)&&((__tp0===2)&&(((__tp1=__t403[0]),(__tp1==="data"))&&((expr=__t403[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["symbol","=="],["data",["send",expr,["value",0]],tag]];};return ["multi",["macro",f1],["macro",f2]];}();var __t399=expr;var __tp0;var __tp1;var subp;var __tp0;var __tp1;var other;var __t400=false;var __t401=false;if(((__t400=(__t399 instanceof Array))&&((__t401=((__tp0=__t399.length),true))&&((__tp0>=1)&&(((__tp1=__t399[0]),(__tp1==="data"))&&((subp=__t399.slice(1)),true)))))){return patch_array(["data",tag],subp);}else{if((__t401&&((__tp0===1)&&((__tp1=__t399[0]),(__tp1==="void"))))){return ["check",checker_mac,["ignore"]];}else{if(((other=__t399),true)){return ["check",checker_mac,expr];}else{throw ["Could not find a match",__t399];}}}}else{if(((_=__t398),true)){var __t404=expr;var __tp0;var __tp1;var __tp0;var __tp1;var args;var other;var __t405=false;var __t406=false;if(((__t405=(__t404 instanceof Array))&&((__t406=((__tp0=__t404.length),true))&&((__tp0===1)&&((__tp1=__t404[0]),(__tp1==="void")))))){return ["data",tag];}else{if((__t406&&((__tp0>=1)&&(((__tp1=__t404[0]),(__tp1==="data"))&&((args=__t404.slice(1)),true))))){return patch_array(["data",tag],args);}else{if(((other=__t404),true)){return ["send",["data",tag],other];}else{throw ["Could not find a match",__t404];}}}}else{throw ["Could not find a match",__t398];}}};return ["macro",f];});stdenv.register_macro("when",function(__t408,__t409){var __tp0;var context;var env;if(((__t408 instanceof Array)&&(((__tp0=__t408.length),true)&&((__tp0===2)&&((context=__t408[0]),true,(env=__t408[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __t407;var condition;if(((__t409 instanceof Array)&&(((__tp0=__t409.length),true)&&((__tp0===3)&&(((__tp1=__t409[0]),(__tp1==="data"))&&((__t407=__t409[1]),true,(condition=__t409[2]),true)))))){(void 0);}else{throw "a condition failed";}var __t410=__t407;var __tp0;var __tp1;var other;if(((__t410 instanceof Array)&&(((__tp0=__t410.length),true)&&((__tp0===1)&&((__tp1=__t410[0]),(__tp1==="void")))))){return ["test",condition,["ignore"]];}else{if(((other=__t410),true)){return ["test",condition,other];}else{throw ["Could not find a match",__t410];}}});var andf=function(__t411,expr){var __tp0;var context;var env;if(((__t411 instanceof Array)&&(((__tp0=__t411.length),true)&&((__tp0===2)&&((context=__t411[0]),true,(env=__t411[1]),true))))){(void 0);}else{throw "a condition failed";}var __t412=[context,expr];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var a;var b;var __tp0;var _;var __tp1;var __tp2;var __tp3;var other;var __t413=false;var __t414=false;var __t415=false;if(((__t413=(__t412 instanceof Array))&&((__t414=((__tp0=__t412.length),true))&&((__t415=(__tp0===2))&&(((__tp1=__t412[0]),(__tp1==="pattern"))&&(((__tp2=__t412[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&((a=__tp2[1]),true,(b=__tp2[2]),true)))))))))){return ["all",a,b];}else{if((__t415&&(((_=__t412[0]),true,(__tp1=__t412[1]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===1)&&((__tp3=__tp1[0]),(__tp3==="void"))))))){return ["symbol","___and"];}else{if(((other=__t412),true)){return ["send",["symbol","___and"],expr];}else{throw ["Could not find a match",__t412];}}}};stdenv.register_macro("&&",andf);stdenv.register_macro("and",andf);var orf=function(__t416,expr){var __tp0;var context;var env;if(((__t416 instanceof Array)&&(((__tp0=__t416.length),true)&&((__tp0===2)&&((context=__t416[0]),true,(env=__t416[1]),true))))){(void 0);}else{throw "a condition failed";}var __t417=[context,expr];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var a;var b;var __tp0;var _;var __tp1;var __tp2;var __tp3;var other;var __t418=false;var __t419=false;var __t420=false;if(((__t418=(__t417 instanceof Array))&&((__t419=((__tp0=__t417.length),true))&&((__t420=(__tp0===2))&&(((__tp1=__t417[0]),(__tp1==="pattern"))&&(((__tp2=__t417[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&((a=__tp2[1]),true,(b=__tp2[2]),true)))))))))){return ["any",a,b];}else{if((__t420&&(((_=__t417[0]),true,(__tp1=__t417[1]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===1)&&((__tp3=__tp1[0]),(__tp3==="void"))))))){return ["symbol","___or"];}else{if(((other=__t417),true)){return ["send",["symbol","___or"],expr];}else{throw ["Could not find a match",__t417];}}}};stdenv.register_macro("||",orf);stdenv.register_macro("or",orf);var partial_pattern=function(operator){(operator=["symbol",operator]);return function(__t421,expr){var __tp0;var context;var env;if(((__t421 instanceof Array)&&(((__tp0=__t421.length),true)&&((__tp0===2)&&((context=__t421[0]),true,(env=__t421[1]),true))))){(void 0);}else{throw "a condition failed";}var __t422=[context,expr];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var val;var __tp0;var _;var __tp1;var __tp2;var __tp3;var other;var __t423=false;var __t424=false;var __t425=false;if(((__t423=(__t422 instanceof Array))&&((__t424=((__tp0=__t422.length),true))&&((__t425=(__tp0===2))&&(((__tp1=__t422[0]),(__tp1==="pattern"))&&(((__tp2=__t422[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&(((__tp5=__tp2[1]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===1)&&(((__tp7=__tp5[0]),(__tp7==="void"))&&((val=__tp2[2]),true)))))))))))))){return ["check",["macro",make_checker(val,operator)],["ignore"]];}else{if((__t425&&(((_=__t422[0]),true,(__tp1=__t422[1]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===1)&&((__tp3=__tp1[0]),(__tp3==="void"))))))){return operator;}else{if(((other=__t422),true)){return ["send",operator,expr];}else{throw ["Could not find a match",__t422];}}}};};stdenv.register_macro("==",partial_pattern("___eq"));stdenv.register_macro("!=",partial_pattern("___neq"));stdenv.register_macro("<=",partial_pattern("___lte"));stdenv.register_macro(">=",partial_pattern("___gte"));stdenv.register_macro("<",partial_pattern("___lt"));stdenv.register_macro(">",partial_pattern("___gt"));stdenv.register_macro("*",function(__t426,expr){var __tp0;var context;var env;if(((__t426 instanceof Array)&&(((__tp0=__t426.length),true)&&((__tp0===2)&&((context=__t426[0]),true,(env=__t426[1]),true))))){(void 0);}else{throw "a condition failed";}var __t427=[context,expr];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var val;var __tp0;var _;var __tp1;var __tp2;var __tp3;var other;var __t428=false;var __t429=false;var __t430=false;if(((__t428=(__t427 instanceof Array))&&((__t429=((__tp0=__t427.length),true))&&((__t430=(__tp0===2))&&(((__tp1=__t427[0]),(__tp1==="pattern"))&&(((__tp2=__t427[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void")))))))))){return ["dynsplice",["ignore"]];}else{if((__t430&&(((__tp1=__t427[0]),((__tp1==="pattern")||(__tp1==="data")))&&(((__tp2=__t427[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&(((__tp5=__tp2[1]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===1)&&(((__tp7=__tp5[0]),(__tp7==="void"))&&((val=__tp2[2]),true)))))))))))){return ["dynsplice",val];}else{if((__t430&&(((_=__t427[0]),true,(__tp1=__t427[1]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===1)&&((__tp3=__tp1[0]),(__tp3==="void"))))))){return ["symbol","___times"];}else{if(((other=__t427),true)){return ["send",["symbol","___times"],expr];}else{throw ["Could not find a match",__t427];}}}}});stdenv.register_macro(".",function(__t432,__t431){var __tp0;var context;var env;if(((__t432 instanceof Array)&&(((__tp0=__t432.length),true)&&((__tp0===2)&&((context=__t432[0]),true,(env=__t432[1]),true))))){(void 0);}else{throw "a condition failed";}var __t433=__t431;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var s;var other;if(((__t433 instanceof Array)&&(((__tp0=__t433.length),true)&&((__tp0===3)&&(((__tp1=__t433[0]),(__tp1==="data"))&&(((__tp2=__t433[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&(((__tp5=__t433[2]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===2)&&(((__tp7=__tp5[0]),(__tp7==="symbol"))&&((s=__tp5[1]),true)))))))))))))){return ["value",s];}else{if(((other=__t433),true)){throw ErrorFactory(["syntax","dot"]).create("'.' macro was given an illegal argument",({"arg":other}));}else{throw ["Could not find a match",__t433];}}});stdenv.register_macro("where",function(__t435,__t434){var __tp0;var context;var env;if(((__t435 instanceof Array)&&(((__tp0=__t435.length),true)&&((__tp0===2)&&((context=__t435[0]),true,(env=__t435[1]),true))))){(void 0);}else{throw "a condition failed";}var __t436=__t434;var __tp0;var __tp1;var a;var b;var other;if(((__t436 instanceof Array)&&(((__tp0=__t436.length),true)&&((__tp0===3)&&(((__tp1=__t436[0]),(__tp1==="data"))&&((a=__t436[1]),true,(b=__t436[2]),true)))))){return ["send",["symbol","let"],["data",b,a]];}else{if(((other=__t436),true)){throw ErrorFactory(["syntax","where"]).create("'where' macro was given an illegal argument",({"arg":other}));}else{throw ["Could not find a match",__t436];}}});stdenv.register_macro("let",function(__t438,__t437){var __tp0;var context;var env;if(((__t438 instanceof Array)&&(((__tp0=__t438.length),true)&&((__tp0===2)&&((context=__t438[0]),true,(env=__t438[1]),true))))){(void 0);}else{throw "a condition failed";}var __t439=__t437;var __tp0;var __tp1;var a;var b;var other;if(((__t439 instanceof Array)&&(((__tp0=__t439.length),true)&&((__tp0===3)&&(((__tp1=__t439[0]),(__tp1==="data"))&&((a=__t439[1]),true,(b=__t439[2]),true)))))){var bindings=aslist(a);var body=aslist(b);return patch_array(["multi"],bindings,body);}else{if(((other=__t439),true)){throw ErrorFactory(["syntax","let"]).create("'let' macro was given an illegal argument",({"arg":other}));}else{throw ["Could not find a match",__t439];}}});stdenv.register_macro("->",function(__t440,__t441){var __tp0;var context;var env;if(((__t440 instanceof Array)&&(((__tp0=__t440.length),true)&&((__tp0===2)&&((context=__t440[0]),true,(env=__t440[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var args;var stmts;if(((__t441 instanceof Array)&&(((__tp0=__t441.length),true)&&((__tp0===3)&&(((__tp1=__t441[0]),(__tp1==="data"))&&((args=__t441[1]),true,(stmts=__t441[2]),true)))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var placeholder;var __tp2;var __tp3;var __tp4;var newargs;if((((__tp0=find_arrow(args)),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&(((placeholder=__tp0[0]),true,(__tp2=__tp0[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3>=1)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&((newargs=__tp2.slice(1)),true))))))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var fw;var bw;var keys;var dflt;var rest;if((((__tp0=lhs_parse_specs(env,newargs)),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===5)&&((fw=__tp0[0]),true,(bw=__tp0[1]),true,(keys=__tp0[2]),true,(dflt=__tp0[3]),true,(rest=__tp0[4]),true))))){(void 0);}else{throw "a condition failed";}if(((rest||dflt.length)||keys.length)){var body=["send",["symbol","match"],["data",["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",["symbol","arguments"],["value",0]]],["send",["symbol","->"],["data",args,stmts]]]];return ["lambda",[],body];}else{var body=["multi"];(newargs=function(){var __t442=[];var __t443=newargs;var __t444=__t443.length;for(var __t445=0;(__t445<__t444);(__t445++)){var __t446=__t443[__t445];var __tp0;var __tp1;var s;var other;var other;var __t447=false;if(((__t446 instanceof Array)&&(((__tp0=__t446.length),true)&&((__tp0===2)&&(((__tp1=__t446[0]),(__tp1==="symbol"))&&((s=__t446[1]),true)))))){__t442.push(["symbol",s]);}else{if((__t447=((other=__t446),true))){__t442.push(function(){var t=gensym();body.push(["send",["symbol","="],["data",other,t]]);return t;}());}else{if(__t447){false;}else{throw ["Could not find a match",__t446];}}}}return __t442;}());body.push(function(){if(placeholder){return ["send",["symbol","|>"],["data",placeholder,stmts]];}else{return stmts;}}());return ["lambda",newargs,body];}});var build_each=function(source,patterns,__t448,__t449,lvar){var __tp0;var prelude;if((((__tp0=___projector(aslist)(__t448)),__tp0[0])&&((prelude=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var __tp0;var tail;if((((__tp0=___projector(aslist)(__t449)),__tp0[0])&&((tail=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var temp=gensym();var len=gensym();(lvar=(lvar||gensym()));var stmts=patch_array(["multi"],prelude).concat([["send",["symbol","="],["data",temp,source]],["send",["symbol","="],["data",len,["send",temp,["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]]);var loop=function(){var a=["send",["symbol","="],["data",lvar,["value",0]]];var b=["send",["symbol","<"],["data",lvar,len]];var c=["send",["symbol","++"],["data",lvar,["void"]]];var body=["send",["symbol","|>"],["data",["send",["symbol","___js_fetch"],["data",temp,lvar]],patterns]];return ["js_for",a,b,c,body];}();stmts.push(loop);var stmts=stmts.concat(tail);return stmts;};stdenv.register_macro("each",function(__t451,__t452){var __tp0;var __t450;var env;if(((__t451 instanceof Array)&&(((__tp0=__t451.length),true)&&((__tp0===2)&&((__t450=__t451[0]),true,(env=__t451[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var arr;var __tp2;var __tp3;var patterns;if(((__t452 instanceof Array)&&(((__tp0=__t452.length),true)&&((__tp0===3)&&(((__tp1=__t452[0]),(__tp1==="data"))&&(((arr=__t452[1]),true,(__tp2=__t452[2]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((patterns=__tp3[1]),true))))))){(void 0);}else{throw "a condition failed";}var __t453=__t450;var other;if((__t453==="multi")){patterns.push(["send",["symbol","->"],["data",["symbol","other"],["symbol","false"]]]);return build_each(arr,patch_array(["multi"],patterns),["multi"],["symbol","false"]);}else{if(((other=__t453),true)){var res=gensym();(patterns=function(){var __t454=[];var __t455=patterns;var __t456=__t455.length;for(var __t457=0;(__t457<__t456);(__t457++)){var __t458=__t455[__t457];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var patt;var expr;var other;var other;var __t459=false;if(((__t458 instanceof Array)&&(((__tp0=__t458.length),true)&&((__tp0===3)&&(((__tp1=__t458[0]),(__tp1==="send"))&&(((__tp2=__t458[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="->"))&&(((__tp6=__t458[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((patt=__tp6[1]),true,(expr=__tp6[2]),true))))))))))))))){__t454.push(["send",["symbol","->"],["data",patt,["send",["send",res,["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",expr]]]]);}else{if((__t459=((other=__t458),true))){__t454.push(INVALID_PATTERN);}else{if(__t459){false;}else{throw ["Could not find a match",__t458];}}}}return __t454;}());patterns.push(["send",["symbol","->"],["data",["symbol","other"],["symbol","false"]]]);return build_each(arr,patch_array(["multi"],patterns),["send",["symbol","="],["data",res,["data"]]],res);}else{throw ["Could not find a match",__t453];}}});stdenv.register_macro("=>",function(__t461,__t462){var __tp0;var __t460;var env;if(((__t461 instanceof Array)&&(((__tp0=__t461.length),true)&&((__tp0===2)&&((__t460=__t461[0]),true,(env=__t461[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var binding;var value;if(((__t462 instanceof Array)&&(((__tp0=__t462.length),true)&&((__tp0===3)&&(((__tp1=__t462[0]),(__tp1==="data"))&&((binding=__t462[1]),true,(value=__t462[2]),true)))))){(void 0);}else{throw "a condition failed";}var __t463=__t460;var context;if(((__t463==="data")||(__t463==="pattern"))){var __t464=binding;var __tp0;var __tp1;var _;if(((__t464 instanceof Array)&&(((__tp0=__t464.length),true)&&((__tp0===1)&&((__tp1=__t464[0]),(__tp1==="void")))))){return ["assoc",value];}else{if(((_=__t464),true)){return ["assoc",binding,value];}else{throw ["Could not find a match",__t464];}}}else{if(((context=__t463),true)){throw (("Illegal context for '=>' ("+context)+")");}else{throw ["Could not find a match",__t463];}}});stdenv.register_macro("as",function(__t465,__t466){var __tp0;var context;var env;if(((__t465 instanceof Array)&&(((__tp0=__t465.length),true)&&((__tp0===2)&&((context=__t465[0]),true,(env=__t465[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var expr;var variable;if(((__t466 instanceof Array)&&(((__tp0=__t466.length),true)&&((__tp0===3)&&(((__tp1=__t466[0]),(__tp1==="data"))&&((expr=__t466[1]),true,(variable=__t466[2]),true)))))){(void 0);}else{throw "a condition failed";}var __t467=context;var _;if((__t467==="pattern")){return ["constant",expr,variable];}else{if(((_=__t467),true)){return ["send",["symbol","="],["data",variable,expr]];}else{throw ["Could not find a match",__t467];}}});stdenv.register_macro("=",function(__t468,expr){var __tp0;var context;var env;if(((__t468 instanceof Array)&&(((__tp0=__t468.length),true)&&((__tp0===2)&&((context=__t468[0]),true,(env=__t468[1]),true))))){(void 0);}else{throw "a condition failed";}var __t469=[context,expr];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var lhs;var rhs;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var f;var args;var value;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var b;var value;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var patt;var value;var other;var __t470=false;var __t471=false;var __t472=false;var __t473=false;var __t474=false;var __t475=false;var __t476=false;var __t477=false;if(((__t470=(__t469 instanceof Array))&&((__t471=((__tp0=__t469.length),true))&&((__t472=(__tp0===2))&&(((__tp1=__t469[0]),((__tp1==="multi")||(__tp1==="expr")))&&(((__tp2=__t469[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&((lhs=__tp2[1]),true,(rhs=__tp2[2]),true)))))))))){var __tp0;var __tp1;var __tp2;var __tp3;var vars;var clauses;var ph;if((((__tp0=parse_lhs(env,lhs,rhs)),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===3)&&(((__tp2=__tp0[0]),(__tp3=___projector(make_declarations)(__tp2)),__tp3[0])&&((vars=__tp3[1]),true,(clauses=__tp0[1]),true,(ph=__tp0[2]),true)))))){(void 0);}else{throw "a condition failed";}var r=patch_array(["splice"],vars);var mkif=function(x){return ["if",x,["value",undefined],["js_throw",["value","a condition failed"]]];};var __t478=clauses;var __tp0;var clause;var _;if(((__t478 instanceof Array)&&(((__tp0=__t478.length),true)&&((__tp0===1)&&((clause=__t478[0]),true))))){var __t479=send(clause,(clause.length-1));var __tp0;var __tp1;var __tp2;var other;if(((__t479 instanceof Array)&&(((__tp0=__t479.length),true)&&((__tp0===2)&&(((__tp1=__t479[0]),(__tp1==="value"))&&((__tp2=__t479[1]),(__tp2===true))))))){(r=function(){if(((vars.length===1)&&(clause.length===3))){return patch_array(["declare"],clause[1].slice(1));}else{return r.concat(clause.slice(1,(-1)));}}());}else{if(((other=__t479),true)){r.push(mkif(clause));}else{throw ["Could not find a match",__t479];}}}else{if(((_=__t478),true)){var ands=make_pattern_test(clauses);r.push(mkif(ands));}else{throw ["Could not find a match",__t478];}}return r;}else{if((__t472&&((__t473=((__tp1=__t469[0]),(__tp1==="data")))&&((__t474=((__tp2=__t469[1]),(__tp2 instanceof Array)))&&((__t475=((__tp3=__tp2.length),true))&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void")))))))){return ["assoc"];}else{if((__t475&&((__t476=(__tp3===3))&&((__t477=((__tp4=__tp2[0]),(__tp4==="data")))&&(((__tp5=__tp2[1]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===3)&&(((__tp7=__tp5[0]),(__tp7==="send"))&&((f=__tp5[1]),true,(args=__tp5[2]),true,(value=__tp2[2]),true))))))))){(f=function(){var __t480=f;var __tp0;var __tp1;var _;var __tp0;var __tp1;var z;var __t481=false;var __t482=false;var __t483=false;if(((__t481=(__t480 instanceof Array))&&((__t482=((__tp0=__t480.length),true))&&((__t483=(__tp0===2))&&(((__tp1=__t480[0]),(__tp1==="value"))&&((_=__t480[1]),true)))))){return f;}else{if((__t483&&(((__tp1=__t480[0]),(__tp1==="symbol"))&&((z=__t480[1]),true)))){return ["value",z];}else{throw ["Could not find a match",__t480];}}}());return ["assoc",f,["send",["symbol","->"],["data",args,value]]];}else{if((__t477&&((b=__tp2[1]),true,(value=__tp2[2]),true))){(b=function(){var __t484=b;var __tp0;var __tp1;var _;var __tp0;var __tp1;var z;var __t485=false;var __t486=false;var __t487=false;if(((__t485=(__t484 instanceof Array))&&((__t486=((__tp0=__t484.length),true))&&((__t487=(__tp0===2))&&(((__tp1=__t484[0]),(__tp1==="value"))&&((_=__t484[1]),true)))))){return b;}else{if((__t487&&(((__tp1=__t484[0]),(__tp1==="symbol"))&&((z=__t484[1]),true)))){return ["value",z];}else{throw ["Could not find a match",__t484];}}}());return ["assoc",b,value];}else{if((__t472&&(((__tp1=__t469[0]),(__tp1==="pattern"))&&(((__tp2=__t469[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="data"))&&((patt=__tp2[1]),true,(value=__tp2[2]),true)))))))){return ["default",patt,value];}else{if(((other=__t469),true)){throw (("Illegal context for '=' ("+context)+")");}else{throw ["Could not find a match",__t469];}}}}}}});var make_assigner=function(op){return function(__t488,__t489){var __tp0;var context;var env;if(((__t488 instanceof Array)&&(((__tp0=__t488.length),true)&&((__tp0===2)&&((context=__t488[0]),true,(env=__t488[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var a;var b;if(((__t489 instanceof Array)&&(((__tp0=__t489.length),true)&&((__tp0===3)&&(((__tp1=__t489[0]),(__tp1==="data"))&&((a=__t489[1]),true,(b=__t489[2]),true)))))){(void 0);}else{throw "a condition failed";}return ["assign",a,["send",["symbol",op],["data",a,b]]];};};stdenv.register_macro(":=",function(__t490,__t491){var __tp0;var context;var env;if(((__t490 instanceof Array)&&(((__tp0=__t490.length),true)&&((__tp0===2)&&((context=__t490[0]),true,(env=__t490[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var a;var b;if(((__t491 instanceof Array)&&(((__tp0=__t491.length),true)&&((__tp0===3)&&(((__tp1=__t491[0]),(__tp1==="data"))&&((a=__t491[1]),true,(b=__t491[2]),true)))))){(void 0);}else{throw "a condition failed";}return ["assign",a,b];});stdenv.register_macro("+=",make_assigner("+"));stdenv.register_macro("-=",make_assigner("-"));stdenv.register_macro("*=",make_assigner("*"));stdenv.register_macro("/=",make_assigner("/"));stdenv.register_macro("<<=",make_assigner("<<"));stdenv.register_macro(">>=",make_assigner(">>"));stdenv.register_macro(">>>=",make_assigner(">>>"));stdenv.register_macro("++=",make_assigner("++"));stdenv.register_macro("?=",make_assigner("match"));stdenv.register_macro("if",function(__t493,__t492){var __tp0;var context;var env;if(((__t493 instanceof Array)&&(((__tp0=__t493.length),true)&&((__tp0===2)&&((context=__t493[0]),true,(env=__t493[1]),true))))){(void 0);}else{throw "a condition failed";}var __t494=__t492;var __tp0;var __tp1;var test;var a;var b;var __tp0;var __tp1;var test;var __tp2;var __tp3;var __t495;var other;var __t496=false;var __t497=false;if(((__t496=(__t494 instanceof Array))&&((__t497=((__tp0=__t494.length),true))&&((__tp0===4)&&(((__tp1=__t494[0]),(__tp1==="data"))&&((test=__t494[1]),true,(a=__t494[2]),true,(b=__t494[3]),true)))))){return ["if",test,a,b];}else{if((__t497&&((__tp0===3)&&(((__tp1=__t494[0]),(__tp1==="data"))&&(((test=__t494[1]),true,(__tp2=__t494[2]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((__t495=__tp3[1]),true)))))){var __t498=__t495;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var s1;var __tp13;var __tp14;var __tp15;var __tp16;var __tp17;var __tp18;var __tp19;var __tp20;var __tp21;var __tp22;var __tp23;var __tp24;var s2;var __tp0;var s1;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var s2;var other;var __t499=false;var __t500=false;if(((__t499=(__t498 instanceof Array))&&((__t500=((__tp0=__t498.length),true))&&((__tp0===2)&&(((__tp1=__t498[0]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((__tp4=__tp1[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&(((__tp7=__tp4[1]),(__tp7==="then"))&&(((__tp8=__tp1[2]),(__tp8 instanceof Array))&&(((__tp9=__tp8.length),true)&&((__tp9===2)&&(((__tp10=__tp8[0]),(__tp10==="data"))&&(((__tp11=__tp8[1]),(__tp12=___projector(aslist)(__tp11)),__tp12[0])&&(((s1=__tp12[1]),true,(__tp13=__t498[1]),(__tp13 instanceof Array))&&(((__tp14=__tp13.length),true)&&((__tp14===3)&&(((__tp15=__tp13[0]),(__tp15==="send"))&&(((__tp16=__tp13[1]),(__tp16 instanceof Array))&&(((__tp17=__tp16.length),true)&&((__tp17===2)&&(((__tp18=__tp16[0]),(__tp18==="symbol"))&&(((__tp19=__tp16[1]),(__tp19==="else"))&&(((__tp20=__tp13[2]),(__tp20 instanceof Array))&&(((__tp21=__tp20.length),true)&&((__tp21===2)&&(((__tp22=__tp20[0]),(__tp22==="data"))&&(((__tp23=__tp20[1]),(__tp24=___projector(aslist)(__tp23)),__tp24[0])&&((s2=__tp24[1]),true))))))))))))))))))))))))))))))))){return ["if",test,patch_array(["multi"],s1),patch_array(["multi"],s2)];}else{if((__t500&&((__tp0>=1)&&(((s1=__t498.slice(0,-1)),true,(__tp1=send(__t498,(__tp0-1))),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((__tp4=__tp1[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&(((__tp7=__tp4[1]),(__tp7==="else"))&&(((__tp8=__tp1[2]),(__tp8 instanceof Array))&&(((__tp9=__tp8.length),true)&&((__tp9===2)&&(((__tp10=__tp8[0]),(__tp10==="data"))&&(((__tp11=__tp8[1]),(__tp12=___projector(aslist)(__tp11)),__tp12[0])&&((s2=__tp12[1]),true)))))))))))))))))){return ["if",test,patch_array(["multi"],s1),patch_array(["multi"],s2)];}else{if(((other=__t498),true)){return ["if",test,patch_array(["multi"],other),["value",null]];}else{throw ["Could not find a match",__t498];}}}}else{if(((other=__t494),true)){__lt____gt__(null,other);return send(raise,Error("error in if"));}else{throw ["Could not find a match",__t494];}}}});stdenv.register_macro("cond",function(__t501,__t502){var __tp0;var context;var env;if(((__t501 instanceof Array)&&(((__tp0=__t501.length),true)&&((__tp0===2)&&((context=__t501[0]),true,(env=__t501[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var clauses;if(((__t502 instanceof Array)&&(((__tp0=__t502.length),true)&&((__tp0===2)&&(((__tp1=__t502[0]),(__tp1==="data"))&&((clauses=__t502[1]),true)))))){(void 0);}else{throw "a condition failed";}var handle=function(xs){var __t503=xs;var __tp0;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var test;var body;var rest;var __t504=false;var __t505=false;if(((__t504=(__t503 instanceof Array))&&((__t505=((__tp0=__t503.length),true))&&(__tp0===0)))){return ["value",false];}else{if((__t505&&((__tp0>=1)&&(((__tp1=__t503[0]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((__tp4=__tp1[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&(((__tp7=__tp4[1]),(__tp7==="=>"))&&(((__tp8=__tp1[2]),(__tp8 instanceof Array))&&(((__tp9=__tp8.length),true)&&((__tp9===3)&&(((__tp10=__tp8[0]),(__tp10==="data"))&&((test=__tp8[1]),true,(body=__tp8[2]),true,(rest=__t503.slice(1)),true))))))))))))))))){(test=function(){var __t506=test;var __tp0;var __tp1;var __tp2;var _;if(((__t506 instanceof Array)&&(((__tp0=__t506.length),true)&&((__tp0===2)&&(((__tp1=__t506[0]),(__tp1==="symbol"))&&((__tp2=__t506[1]),(__tp2==="else"))))))){return ["value",true];}else{if(((_=__t506),true)){return test;}else{throw ["Could not find a match",__t506];}}}());return ["if",test,body,handle(rest)];}else{throw ["Could not find a match",__t503];}}};return handle(aslist(clauses));});stdenv.register_macro("while",function(__t507,expr){var __tp0;var context;var env;if(((__t507 instanceof Array)&&(((__tp0=__t507.length),true)&&((__tp0===2)&&((context=__t507[0]),true,(env=__t507[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var test;var body;if(((expr instanceof Array)&&(((__tp0=expr.length),true)&&((__tp0===3)&&(((__tp1=expr[0]),(__tp1==="data"))&&((test=expr[1]),true,(body=expr[2]),true)))))){(void 0);}else{throw "a condition failed";}return ["js_while",test,body];});stdenv.register_macro("for",function(__t509,__t508){var __tp0;var context;var env;if(((__t509 instanceof Array)&&(((__tp0=__t509.length),true)&&((__tp0===2)&&((context=__t509[0]),true,(env=__t509[1]),true))))){(void 0);}else{throw "a condition failed";}var __t510=__t508;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var a;var b;var c;var body;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var a;var b;var body;var __t511=false;var __t512=false;var __t513=false;var __t514=false;var __t515=false;var __t516=false;if(((__t511=(__t510 instanceof Array))&&((__t512=((__tp0=__t510.length),true))&&((__t513=(__tp0===3))&&((__t514=((__tp1=__t510[0]),(__tp1==="data")))&&((__t515=((__tp2=__t510[1]),(__tp2 instanceof Array)))&&((__t516=((__tp3=__tp2.length),true))&&((__tp3===4)&&(((__tp4=__tp2[0]),(__tp4==="multi"))&&((a=__tp2[1]),true,(b=__tp2[2]),true,(c=__tp2[3]),true,(body=__t510[2]),true)))))))))){return ["js_for",a,b,c,body];}else{if((__t516&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="send"))&&(((__tp5=__tp2[1]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===2)&&(((__tp7=__tp5[0]),(__tp7==="symbol"))&&(((__tp8=__tp5[1]),(__tp8==="in"))&&(((__tp9=__tp2[2]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===3)&&(((__tp11=__tp9[0]),(__tp11==="data"))&&((a=__tp9[1]),true,(b=__tp9[2]),true,(body=__t510[2]),true)))))))))))))){return ["js_for_in",a,b,body];}else{throw ["Could not find a match",__t510];}}});stdenv.register_macro("!!",function(__t518,__t519){var __tp0;var __t517;var env;if(((__t518 instanceof Array)&&(((__tp0=__t518.length),true)&&((__tp0===2)&&((__t517=__t518[0]),true,(env=__t518[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var expr;var matchers;if(((__t519 instanceof Array)&&(((__tp0=__t519.length),true)&&((__tp0===3)&&(((__tp1=__t519[0]),(__tp1==="data"))&&((expr=__t519[1]),true,(matchers=__t519[2]),true)))))){(void 0);}else{throw "a condition failed";}var __t520=__t517;var other;if((__t520==="multi")){var excv=gensym();var m=function(){var __t521=aslist(matchers);var ms;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var _;var x;if((((ms=__t521),true,(__t521 instanceof Array))&&(((__tp0=__t521.length),true)&&((__tp0>=1)&&(((__tp1=__t521[0]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((__tp4=__tp1[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&(((__tp7=__tp4[1]),(__tp7==="->"))&&((_=__tp1[2]),true,__t521.slice(1),true)))))))))))))){ms.push(["send",["symbol","->"],["data",["symbol","___exc"],["send",["symbol","throw"],["symbol","___exc"]]]]);return ["send",["symbol","|>"],["data",excv,patch_array(["multi"],ms)]];}else{if(((x=__t521),true)){return matchers;}else{throw ["Could not find a match",__t521];}}}();var f=["send",["symbol","->"],["data",["data",excv],m]];return ["multi",["js_try",expr,f,["void"]]];}else{if(((other=__t520),true)){var excv=gensym();var res=gensym();var m=function(){var __t522=aslist(matchers);var ms;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var _;var x;if((((ms=__t522),true,(__t522 instanceof Array))&&(((__tp0=__t522.length),true)&&((__tp0>=1)&&(((__tp1=__t522[0]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((__tp4=__tp1[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&(((__tp7=__tp4[1]),(__tp7==="->"))&&((_=__tp1[2]),true,__t522.slice(1),true)))))))))))))){ms.push(["send",["symbol","->"],["data",["symbol","___exc"],["send",["symbol","throw"],["symbol","___exc"]]]]);return ["send",["symbol","|>"],["data",excv,patch_array(["multi"],ms)]];}else{if(((x=__t522),true)){return matchers;}else{throw ["Could not find a match",__t522];}}}();var f=["send",["symbol","->"],["data",["data",excv],["send",["symbol",":="],["data",res,m]]]];return ["multi",["declare",res,["value",undefined]],["js_try",["assign",res,expr],f,["void"]],res];}else{throw ["Could not find a match",__t520];}}});stdenv.register_macro("new",function(_,expr){return ["js_new",expr];});stdenv.register_macro("return",function(_,expr){return ["js_return",expr];});stdenv.register_macro("delete",function(_,expr){return ["js_delete",expr];});stdenv.register_macro("throw",function(_,expr){return ["js_throw",expr];});stdenv.register_macro("break",function(_,expr){return ["js_break"];});stdenv.register_macro("continue",function(_,expr){return ["js_continue"];});var rx_wrap=function(x){return (("(?:"+x)+")");};var rx_quote=function(x){return x.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");};var rx_quote2=function(x){return x.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");};var rx_build2=function(__t523){var __t524=__t523;var __tp0;var __tp1;var __t525;var __tp0;var __tp1;var x;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var s;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __t526;var __tp5;var __tp6;var __tp7;var a;var b;var __tp0;var __tp1;var args;var __tp0;var __tp1;var args;var otherA;var __t527=false;var __t528=false;var __t529=false;var __t530=false;var __t531=false;var __t532=false;var __t533=false;var __t534=false;if(((__t527=(__t524 instanceof Array))&&((__t528=((__tp0=__t524.length),true))&&((__t529=(__tp0===2))&&(((__tp1=__t524[0]),(__tp1==="symbol"))&&((__t525=__t524[1]),true)))))){var __t535=__t525;if((__t535==="any")){return ".";}else{if((__t535==="start")){return "^";}else{if((__t535==="end")){return "$";}else{if((__t535==="alpha")){return "\\a";}else{if((__t535==="digit")){return "\\d";}else{if((__t535==="word")){return "\\w";}else{if((__t535==="space")){return "\\s";}else{if((__t535==="boundary")){return "\\b";}else{if((__t535==="a")){return "\\a";}else{if((__t535==="d")){return "\\d";}else{if((__t535==="w")){return "\\w";}else{if((__t535==="s")){return "\\s";}else{if((__t535==="b")){return "\\b";}else{throw ["Could not find a match",__t535];}}}}}}}}}}}}}}else{if((__t529&&(((__tp1=__t524[0]),(__tp1==="value"))&&((x=__t524[1]),true)))){return rx_quote(x);}else{if((__t528&&((__t529=(__tp0===3))&&((__t530=((__tp1=__t524[0]),(__tp1==="send")))&&((__t531=((__tp2=__t524[1]),(__tp2 instanceof Array)))&&((__t532=((__tp3=__tp2.length),true))&&((__t533=(__tp3===2))&&((__t534=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="raw"))&&(((__tp6=__t524[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===2)&&(((__tp8=__tp6[0]),(__tp8==="value"))&&((s=__tp6[1]),true)))))))))))))){return s;}else{if((__t534&&(((__t526=__tp2[1]),true,(__tp5=__t524[2]),(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===3)&&(((__tp7=__tp5[0]),(__tp7==="data"))&&((a=__tp5[1]),true,(b=__tp5[2]),true))))))){var __t536=__t526;if((__t536==="||")){return rx_wrap(((rx_build2(a)+"|")+rx_build2(b)));}else{if((__t536==="or")){return rx_wrap(((rx_build2(a)+"|")+rx_build2(b)));}else{if((__t536==="*")){var __tp0;var __tp1;if(((a instanceof Array)&&(((__tp0=a.length),true)&&((__tp0===1)&&((__tp1=a[0]),(__tp1==="void")))))){(void 0);}else{throw "a condition failed";}return rx_wrap((rx_build2(b)+"*"));}else{if((__t536==="+")){var __tp0;var __tp1;if(((a instanceof Array)&&(((__tp0=a.length),true)&&((__tp0===1)&&((__tp1=a[0]),(__tp1==="void")))))){(void 0);}else{throw "a condition failed";}return rx_wrap((rx_build2(b)+"+"));}else{if((__t536==="?")){var __tp0;var __tp1;if(((a instanceof Array)&&(((__tp0=a.length),true)&&((__tp0===1)&&((__tp1=a[0]),(__tp1==="void")))))){(void 0);}else{throw "a condition failed";}return rx_wrap((rx_build2(b)+"?"));}else{if((__t536==="in")){var __tp0;var __tp1;if(((a instanceof Array)&&(((__tp0=a.length),true)&&((__tp0===1)&&((__tp1=a[0]),(__tp1==="void")))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var v;if(((b instanceof Array)&&(((__tp0=b.length),true)&&((__tp0===2)&&(((__tp1=b[0]),(__tp1==="value"))&&((v=b[1]),true)))))){(void 0);}else{throw "a condition failed";}var x=rx_quote2(v);return (("["+x)+"]");}else{if((__t536==="not")){var __tp0;var __tp1;if(((a instanceof Array)&&(((__tp0=a.length),true)&&((__tp0===1)&&((__tp1=a[0]),(__tp1==="void")))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var __tp13;var __tp14;var v;if(((b instanceof Array)&&(((__tp0=b.length),true)&&((__tp0===3)&&(((__tp1=b[0]),(__tp1==="send"))&&(((__tp2=b[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="in"))&&(((__tp6=b[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&(((__tp12=__tp6[2]),(__tp12 instanceof Array))&&(((__tp13=__tp12.length),true)&&((__tp13===2)&&(((__tp14=__tp12[0]),(__tp14==="value"))&&((v=__tp12[1]),true))))))))))))))))))))))){(void 0);}else{throw "a condition failed";}var x=rx_quote2(v);return (("[^"+x)+"]");}else{throw ["Could not find a match",__t536];}}}}}}}}else{if((__t528&&((__t529=(__tp0>=1))&&(((__tp1=__t524[0]),(__tp1==="data"))&&((args=__t524.slice(1)),true))))){return (("("+args.map(rx_build2).join(""))+")");}else{if((__t529&&(((__tp1=__t524[0]),(__tp1==="multi"))&&((args=__t524.slice(1)),true)))){return (("(?:"+args.map(rx_build2).join(""))+")");}else{if(((otherA=__t524),true)){throw "OopsF";}else{throw ["Could not find a match",__t524];}}}}}}}};var mac=function(__t537,expr,flags){var __tp0;var context;var env;if(((__t537 instanceof Array)&&(((__tp0=__t537.length),true)&&((__tp0===2)&&((context=__t537[0]),true,(env=__t537[1]),true))))){(void 0);}else{throw "a condition failed";}(flags=(flags||""));var __t538=expr;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var __tp13;var __tp14;var flag;var __tp0;var __tp1;var __tp2;var v;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var arg;var __t539=false;var __t540=false;if(((__t539=(__t538 instanceof Array))&&((__t540=((__tp0=__t538.length),true))&&((__tp0===3)&&(((__tp1=__t538[0]),(__tp1==="send"))&&(((__tp2=__t538[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="."))&&(((__tp6=__t538[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&(((__tp12=__tp6[2]),(__tp12 instanceof Array))&&(((__tp13=__tp12.length),true)&&((__tp13===2)&&(((__tp14=__tp12[0]),(__tp14==="symbol"))&&((flag=__tp12[1]),true))))))))))))))))))))))){var m=function(ctx,x){return mac(ctx,x,(flags+flag));};return ["macro",m];}else{if((__t540&&((__tp0===2)&&(((__tp1=__t538[0]),(__tp1==="value"))&&(((__tp2=__t538[1]),(typeof(__tp2)==="string"))&&((v=__tp2),true)))))){return ["send",["symbol","RegExp"],["data",["value",v],["value",flags]]];}else{if((__t540&&((__tp0===3)&&(((__tp1=__t538[0]),(__tp1==="send"))&&(((__tp2=__t538[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="'"))&&(((__tp6=__t538[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((arg=__tp6[2]),true)))))))))))))))))){return ["send",["symbol","RegExp"],["data",["value",rx_build2(arg)],["value",flags]]];}else{throw ["Could not find a match",__t538];}}}};stdenv.register_macro("R",mac);stdenv.register_macro("?",function(__t542,__t541){var __tp0;var context;var env;if(((__t542 instanceof Array)&&(((__tp0=__t542.length),true)&&((__tp0===2)&&((context=__t542[0]),true,(env=__t542[1]),true))))){(void 0);}else{throw "a condition failed";}var __t543=__t541;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var expr;var __tp0;var __tp1;var expr;var __tp2;var __tp3;var __tp4;var __t544=false;var __t545=false;var __t546=false;var __t547=false;if(((__t544=(__t543 instanceof Array))&&((__t545=((__tp0=__t543.length),true))&&((__t546=(__tp0===3))&&((__t547=((__tp1=__t543[0]),(__tp1==="data")))&&(((__tp2=__t543[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&((expr=__t543[2]),true)))))))))){return ["send",["symbol","cond"],["data",expr]];}else{if((__t547&&(((expr=__t543[1]),true,(__tp2=__t543[2]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void"))))))){var orig_expr=expr;var checker=function(){var __t548=expr;var __tp0;var __tp1;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var other;var __t549=false;var __t550=false;var __t551=false;var __t552=false;if(((__t549=(__t548 instanceof Array))&&((__t550=((__tp0=__t548.length),true))&&((__tp0===1)&&((__tp1=__t548[0]),(__tp1==="void")))))){throw "can't use ? on its own";}else{if((__t550&&((__t551=(__tp0===2))&&((__t552=((__tp1=__t548[0]),(__tp1==="symbol")))&&((__tp2=__t548[1]),(__tp2==="String")))))){return ["macro",function(_,__t553){var __tp0;var __tp1;var expr;if(((__t553 instanceof Array)&&(((__tp0=__t553.length),true)&&((__tp0===2)&&(((__tp1=__t553[0]),(__tp1==="data"))&&((expr=__t553[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["symbol","=="],["data",["send",["symbol","typeof"],["data",expr]],["value","string"]]];}];}else{if((__t552&&((__tp2=__t548[1]),(__tp2==="Number")))){return ["macro",function(_,__t554){var __tp0;var __tp1;var expr;if(((__t554 instanceof Array)&&(((__tp0=__t554.length),true)&&((__tp0===2)&&(((__tp1=__t554[0]),(__tp1==="data"))&&((expr=__t554[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["symbol","=="],["data",["send",["symbol","typeof"],["data",expr]],["value","number"]]];}];}else{if((__t552&&((__tp2=__t548[1]),(__tp2==="true")))){return ["macro",function(_,__t555){var __tp0;var __tp1;var expr;if(((__t555 instanceof Array)&&(((__tp0=__t555.length),true)&&((__tp0===2)&&(((__tp1=__t555[0]),(__tp1==="data"))&&((expr=__t555[1]),true)))))){(void 0);}else{throw "a condition failed";}return expr;}];}else{if((__t552&&((__tp2=__t548[1]),(__tp2==="false")))){return ["macro",function(_,__t556){var __tp0;var __tp1;var expr;if(((__t556 instanceof Array)&&(((__tp0=__t556.length),true)&&((__tp0===2)&&(((__tp1=__t556[0]),(__tp1==="data"))&&((expr=__t556[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["send",["symbol","not"],["data",["void"],expr]];}];}else{if((__t552&&((__tp2=__t548[1]),(__tp2==="null")))){return ["macro",make_checker(["value",null],["symbol","___is"])];}else{if((__t552&&((__tp2=__t548[1]),(__tp2==="undefined")))){return ["macro",make_checker(["value",undefined],["symbol","___is"])];}else{if(((other=__t548),true)){return ["send",["symbol","___checker"],["data",expr]];}else{throw ["Could not find a match",__t548];}}}}}}}}}();var mac=function(__t558,expr){var __tp0;var __t557;var env;if(((__t558 instanceof Array)&&(((__tp0=__t558.length),true)&&((__tp0===2)&&((__t557=__t558[0]),true,(env=__t558[1]),true))))){(void 0);}else{throw "a condition failed";}var __t559=__t557;var other;if((__t559==="pattern")){var __t560=expr;var __tp0;var __tp1;var subp;var __tp0;var __tp1;var other;var __t561=false;var __t562=false;if(((__t561=(__t560 instanceof Array))&&((__t562=((__tp0=__t560.length),true))&&((__tp0>=1)&&(((__tp1=__t560[0]),(__tp1==="data"))&&((subp=__t560.slice(1)),true)))))){var projector=["send",["symbol","___deconstructor"],["data",orig_expr]];return ["check",checker,["project",projector,patch_array(["duck",0],subp)]];}else{if((__t562&&((__tp0===1)&&((__tp1=__t560[0]),(__tp1==="void"))))){return ["check",checker,["ignore"]];}else{if(((other=__t560),true)){return ["check",checker,expr];}else{throw ["Could not find a match",__t560];}}}}else{if(((other=__t559),true)){return ["send",checker,["data",expr]];}else{throw ["Could not find a match",__t559];}}};return ["macro",mac];}else{throw ["Could not find a match",__t543];}}});stdenv.register_macro("!",function(__t563,__t564){var __tp0;var context;var env;if(((__t563 instanceof Array)&&(((__tp0=__t563.length),true)&&((__tp0===2)&&((context=__t563[0]),true,(env=__t563[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var expr;var __tp2;var __tp3;var __tp4;if(((__t564 instanceof Array)&&(((__tp0=__t564.length),true)&&((__tp0===3)&&(((__tp1=__t564[0]),(__tp1==="data"))&&(((expr=__t564[1]),true,(__tp2=__t564[2]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&((__tp4=__tp2[0]),(__tp4==="void")))))))))){(void 0);}else{throw "a condition failed";}var projector=function(){var __t565=expr;var __tp0;var __tp1;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var other;var __t566=false;var __t567=false;var __t568=false;var __t569=false;if(((__t566=(__t565 instanceof Array))&&((__t567=((__tp0=__t565.length),true))&&((__tp0===1)&&((__tp1=__t565[0]),(__tp1==="void")))))){throw "can't use ! on its own";}else{if((__t567&&((__t568=(__tp0===2))&&((__t569=((__tp1=__t565[0]),(__tp1==="symbol")))&&((__tp2=__t565[1]),(__tp2==="String")))))){return ["macro",function(_,__t570){var __tp0;var __tp1;var expr;if(((__t570 instanceof Array)&&(((__tp0=__t570.length),true)&&((__tp0===2)&&(((__tp1=__t570[0]),(__tp1==="data"))&&((expr=__t570[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["data",["symbol","true"],["send",["symbol","String"],["data",expr]]];}];}else{if((__t569&&((__tp2=__t565[1]),(__tp2==="Number")))){return ["macro",function(_,__t571){var __tp0;var __tp1;var expr;if(((__t571 instanceof Array)&&(((__tp0=__t571.length),true)&&((__tp0===2)&&(((__tp1=__t571[0]),(__tp1==="data"))&&((expr=__t571[1]),true)))))){(void 0);}else{throw "a condition failed";}return ["data",["symbol","true"],["send",["symbol","parseFloat"],["data",expr]]];}];}else{if(((other=__t565),true)){return ["send",["symbol","___projector"],["data",expr]];}else{throw ["Could not find a match",__t565];}}}}}();var mac=function(__t573,expr){var __tp0;var __t572;var env;if(((__t573 instanceof Array)&&(((__tp0=__t573.length),true)&&((__tp0===2)&&((__t572=__t573[0]),true,(env=__t573[1]),true))))){(void 0);}else{throw "a condition failed";}var __t574=__t572;var other;if((__t574==="pattern")){var __t575=expr;var __tp0;var __tp1;var other;if(((__t575 instanceof Array)&&(((__tp0=__t575.length),true)&&((__tp0===1)&&((__tp1=__t575[0]),(__tp1==="void")))))){return ["project",projector,["ignore"]];}else{if(((other=__t575),true)){return ["project",projector,expr];}else{throw ["Could not find a match",__t575];}}}else{if(((other=__t574),true)){return ["send",["send",projector,["data",expr]],["value",1]];}else{throw ["Could not find a match",__t574];}}};return ["macro",mac];});var gensym_factory=function(prefix){(prefix=("__t"+prefix));var id=0;return function(){var name=(prefix+String(id));(id=(id+1));return ["symbol",name];};};var gensym=gensym_factory("");var is_symbol=function(__t576,env){var __t577=__t576;var __tp0;var __tp1;var s;var _;if(((__t577 instanceof Array)&&(((__tp0=__t577.length),true)&&((__tp0===2)&&(((__tp1=__t577[0]),(__tp1==="symbol"))&&((s=__t577[1]),true)))))){var __t578=env.resolve(s);var __tp0;var __tp1;var m;var _;if(((__t578 instanceof Array)&&(((__tp0=__t578.length),true)&&((__tp0===2)&&(((__tp1=__t578[0]),(__tp1==="macro"))&&((m=__t578[1]),true)))))){return false;}else{if(((_=__t578),true)){return true;}else{throw ["Could not find a match",__t578];}}}else{if(((_=__t577),true)){return false;}else{throw ["Could not find a match",__t577];}}};var lhs_parse_specs=function(env,specs){var fw=[];var bw=[];var keys=[];var defaults=[];var rest=undefined;(specs=specs.slice(0));while(specs.length){var x=specs.shift();var v=expand.step(["pattern",env],x);var __t579=v;var __tp0;var __tp1;var variable;var __tp0;var __tp1;var key;var __tp0;var __tp1;var key;var value;var __tp0;var __tp1;var variable;var value;var __t580;var otherwise;var __t581=false;var __t582=false;var __t583=false;if(((__t581=(__t579 instanceof Array))&&((__t582=((__tp0=__t579.length),true))&&((__t583=(__tp0===2))&&(((__tp1=__t579[0]),(__tp1==="dynsplice"))&&((variable=__t579[1]),true)))))){(rest=variable);}else{if((__t583&&(((__tp1=__t579[0]),(__tp1==="assoc"))&&((key=__t579[1]),true)))){keys.push([key,key]);}else{if((__t582&&((__t583=(__tp0===3))&&(((__tp1=__t579[0]),(__tp1==="assoc"))&&((key=__t579[1]),true,(value=__t579[2]),true))))){keys.push([key,value]);}else{if((__t583&&(((__tp1=__t579[0]),(__tp1==="default"))&&((variable=__t579[1]),true,(value=__t579[2]),true,(__t580=__t579),true)))){var __t584=__t580;var otherwise;if(rest){throw Error("no defaults after rest arg");}else{if(((otherwise=__t584),true)){defaults.push([variable,value]);}else{throw ["Could not find a match",__t584];}}}else{if((rest===undefined)){fw.push(v);}else{if(((otherwise=__t579),true)){bw.push(v);}else{throw ["Could not find a match",__t579];}}}}}}}return [fw,bw,keys,defaults,rest];};var parse_lhs=function(env,lhs,rhs,gen){(gen=(gen||gensym_factory("p")));var vars=[];var clauses=[];var current=["multi"];var placeholder=null;var mktemp=function(){var t=gen();vars.push(t);return t;};var newclause=function(){if((current.length>1)){clauses.push(current);}else{null;}return (current=["multi"]);};var maybe_temp=function(x){if(is_symbol(x,env)){return x;}else{var temp=mktemp();current.push(["assign",temp,x]);return temp;}};var helper=function(lhs,curr){return helper_noexpand(expand.step(["pattern",env],lhs),curr);};var helper_noexpand=function(lhs,curr){var helper_keys=function(temp,keys){var __t592=[];var __t593=keys;var __t594=__t593.length;for(var __t595=0;(__t595<__t594);(__t595++)){var __t596=__t593[__t595];var __tp0;var __tp1;var __t599;var __t600;var k;var __t597;var __t598;var k;var v;var other;if(((__t596 instanceof Array)&&(((__tp0=__t596.length),true)&&((__tp0===2)&&(((__tp1=__t596[0]),(((__tp1 instanceof Array)&&(((__t597=__tp1.length),true)&&((__t597===2)&&(((__t598=__tp1[0]),(__t598==="symbol"))&&((k=__tp1[1]),true)))))||((__tp1 instanceof Array)&&(((__t599=__tp1.length),true)&&((__t599===2)&&(((__t600=__tp1[0]),(__t600==="value"))&&((k=__tp1[1]),true)))))))&&((v=__t596[1]),true)))))){__t592.push(helper(v,["send",temp,["value",k]]));}else{if(((other=__t596),true)){false;}else{throw ["Could not find a match",__t596];}}}return __t592;};var helper_array=function(temp,specs,start){var __tp0;var fw;var bw;var keys;var dflt;var rest;if(((specs instanceof Array)&&(((__tp0=specs.length),true)&&((__tp0===5)&&((fw=specs[0]),true,(bw=specs[1]),true,(keys=specs[2]),true,(dflt=specs[3]),true,(rest=specs[4]),true))))){(void 0);}else{throw "a condition failed";}var nfw=fw.length;var nbw=bw.length;var ndflt=dflt.length;var extract_length=true;var check_length=true;if(extract_length){var len=mktemp();current.push(["send",["symbol",":="],["data",len,["send",temp,["send",["symbol","."],["data",["void"],["symbol","length"]]]]]],["symbol","true"]);newclause();if(check_length){var lo=((nfw+nbw)+start);var hi=(lo+ndflt);if((rest===undefined)){if((lo===hi)){current.push(["send",["symbol","=="],["data",len,["value",lo]]]);}else{current.push(["send",["symbol","and"],["data",["send",["symbol",">="],["data",len,["value",lo]]],["send",["symbol","<="],["data",len,["value",hi]]]]]);}}else{current.push(["send",["symbol",">="],["data",len,["value",lo]]]);}newclause();}else{null;}}else{null;}var __t601=enumerate(fw);var __t602=__t601.length;for(var __t603=0;(__t603<__t602);(__t603++)){var __t611=__t601[__t603];var __tp0;var j;var m;var other;if(((__t611 instanceof Array)&&(((__tp0=__t611.length),true)&&((__tp0===2)&&((j=__t611[0]),true,(m=__t611[1]),true))))){helper(m,["send",temp,["value",(j+start)]]);}else{if(((other=__t611),true)){false;}else{throw ["Could not find a match",__t611];}}}false;var __t604=enumerate(dflt);var __t605=__t604.length;for(var __t606=0;(__t606<__t605);(__t606++)){var __t612=__t604[__t606];var __tp0;var j;var __tp1;var __tp2;var patt;var value;var other;if(((__t612 instanceof Array)&&(((__tp0=__t612.length),true)&&((__tp0===2)&&(((j=__t612[0]),true,(__tp1=__t612[1]),(__tp1 instanceof Array))&&(((__tp2=__tp1.length),true)&&((__tp2===2)&&((patt=__tp1[0]),true,(value=__tp1[1]),true)))))))){var idx=((j+nfw)+start);helper(patt,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",idx],len]],value,["send",temp,["value",idx]]]]);}else{if(((other=__t612),true)){false;}else{throw ["Could not find a match",__t612];}}}false;if((rest!==undefined)){var pos=((nfw+ndflt)+start);var slice=function(){if((nbw>0)){return ["data",["value",pos],["value",(-nbw)]];}else{return ["data",["value",pos]];}}();helper(rest,["send",["send",temp,["send",["symbol","."],["data",["void"],["symbol","slice"]]]],slice]);}else{null;}var __t607=[];var __t608=enumerate(bw);var __t609=__t608.length;for(var __t610=0;(__t610<__t609);(__t610++)){var __t613=__t608[__t610];var __tp0;var j;var m;var other;if(((__t613 instanceof Array)&&(((__tp0=__t613.length),true)&&((__tp0===2)&&((j=__t613[0]),true,(m=__t613[1]),true))))){__t607.push(helper(m,["send",temp,["send",["symbol","-"],["data",len,["value",(nbw-j)]]]]));}else{if(((other=__t613),true)){false;}else{throw ["Could not find a match",__t613];}}}return __t607;};var __t585=lhs;var __tp0;var __tp1;var __t586;var __t587;var __tp0;var __tp1;var s;var __tp0;var __tp1;var v;var __tp0;var __tp1;var condition;var pattern;var __tp0;var __tp1;var __tp0;var __tp1;var c;var pattern;var __tp0;var __tp1;var xs;var __tp0;var __tp1;var xs;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var checkers;var expr;var __tp0;var __tp1;var checker;var expr;var __tp0;var __tp1;var projector;var expr;var __tp0;var __tp1;var fname;var spec;var __tp0;var __tp1;var i;var args;var __tp0;var __tp1;var args;var other;var __t588=false;var __t589=false;var __t590=false;var __t591=false;if(((__t585 instanceof Array)&&(((__tp0=__t585.length),true)&&((__tp0===1)&&((__tp1=__t585[0]),(__tp1==="void")))))){var x=["check",["macro",make_checker(["value",null],["symbol","___eq"])],["ignore"]];return helper_noexpand(x,curr);}else{if(((__t585==="_")||((__t585 instanceof Array)&&(((__t586=__t585.length),true)&&((__t586===1)&&((__t587=__t585[0]),(__t587==="ignore"))))))){if((!is_symbol(curr,env))){current.push(curr);return current.push(["symbol","true"]);}else{return null;}}else{if(((__t588=(__t585 instanceof Array))&&((__t589=((__tp0=__t585.length),true))&&((__t590=(__tp0===2))&&(((__tp1=__t585[0]),(__tp1==="symbol"))&&((s=__t585[1]),true)))))){vars.push(["symbol",s]);current.push(["assign",["symbol",s],curr]);return current.push(["value",true]);}else{if((__t590&&(((__tp1=__t585[0]),(__tp1==="value"))&&((v=__t585[1]),true)))){var x=["check",["macro",make_checker(lhs,["symbol","___eq"])],["ignore"]];return helper_noexpand(x,curr);}else{if((__t589&&((__tp0===3)&&(((__tp1=__t585[0]),(__tp1==="test"))&&((condition=__t585[1]),true,(pattern=__t585[2]),true))))){helper(pattern,curr);current.push(condition);return newclause();}else{if((__t589&&((__tp0===1)&&((__tp1=__t585[0]),(__tp1==="placeholder"))))){(placeholder=gensym());vars.push(placeholder);current.push(["assign",placeholder,curr]);return current.push(["value",true]);}else{if((__t589&&((__tp0===3)&&(((__tp1=__t585[0]),(__tp1==="constant"))&&((c=__t585[1]),true,(pattern=__t585[2]),true))))){return helper(pattern,c);}else{if((__t589&&((__t590=(__tp0>=1))&&(((__tp1=__t585[0]),(__tp1==="all"))&&((xs=__t585.slice(1)),true))))){var temp=maybe_temp(curr);var __t614=xs;var __t615=__t614.length;for(var __t616=0;(__t616<__t615);(__t616++)){var __t617=__t614[__t616];var x;var other;if(((x=__t617),true)){helper(x,temp);}else{if(((other=__t617),true)){false;}else{throw ["Could not find a match",__t617];}}}false;return false;}else{if((__t590&&(((__tp1=__t585[0]),(__tp1==="any"))&&((xs=__t585.slice(1)),true)))){var normalize=function(vars){return function(){var __t621=[];var __t622=vars;var __t623=__t622.length;for(var __t624=0;(__t624<__t623);(__t624++)){var __t625=__t622[__t624];var __tp0;var __tp1;var v;var other;if(((__t625 instanceof Array)&&(((__tp0=__t625.length),true)&&((__tp0===2)&&(((__tp1=__t625[0]),(__tp1==="symbol"))&&((v=__t625[1]),true,(v.slice(0,3)!=="__t"))))))){__t621.push(v);}else{if(((other=__t625),true)){false;}else{throw ["Could not find a match",__t625];}}}return __t621;}().sort().join(",");};var temp=maybe_temp(curr);var myvars=undefined;var clauses=[];var __t618=xs;var __t619=__t618.length;for(var __t620=0;(__t620<__t619);(__t620++)){var __t626=__t618[__t620];var x;var other;if(((x=__t626),true)){var p=parse_lhs(env,x,temp,gensym);var __t627=null;var _;if((myvars===undefined)){(myvars=p[0]);}else{if((normalize(p[0])!==normalize(myvars))){throw [Error("Must have the same set of variables in both branches!",(("["+String(myvars))+"]"),(("["+String(p[0]))+"]"))];}else{if(((_=__t627),true)){(vars=vars.concat(p[0]));}else{throw ["Could not find a match",__t627];}}}clauses.push(make_pattern_test(p[1]));}else{if(((other=__t626),true)){false;}else{throw ["Could not find a match",__t626];}}}false;current.push(make_or_pattern(clauses));(vars=vars.concat(myvars));return newclause();}else{if((__t589&&((__t590=(__tp0===3))&&((__t591=((__tp1=__t585[0]),(__tp1==="check")))&&(((__tp2=__t585[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3>=1)&&(((__tp4=__tp2[0]),(__tp4==="multi"))&&((checkers=__tp2.slice(1)),true,(expr=__t585[2]),true))))))))){var temp=maybe_temp(curr);var __t628=checkers;var __t629=__t628.length;for(var __t630=0;(__t630<__t629);(__t630++)){var __t631=__t628[__t630];var checker;var other;if(((checker=__t631),true)){current.push(["send",checker,["data",temp]]);newclause();}else{if(((other=__t631),true)){false;}else{throw ["Could not find a match",__t631];}}}false;return helper(expr,temp);}else{if((__t591&&((checker=__t585[1]),true,(expr=__t585[2]),true))){var temp=maybe_temp(curr);current.push(["send",checker,["data",temp]]);newclause();return helper(expr,temp);}else{if((__t590&&(((__tp1=__t585[0]),(__tp1==="project"))&&((projector=__t585[1]),true,(expr=__t585[2]),true)))){var temp=maybe_temp(curr);var temp2=mktemp();current.push(["send",["symbol",":="],["data",temp2,["send",projector,["data",temp]]]],["send",temp2,["value",0]]);newclause();return helper(expr,["send",temp2,["value",1]]);}else{if((__t590&&(((__tp1=__t585[0]),(__tp1==="send"))&&((fname=__t585[1]),true,(spec=__t585[2]),true)))){return helper(fname,["send",["symbol","->"],["data",spec,curr]]);}else{if((__t589&&((__tp0>=2)&&(((__tp1=__t585[0]),(__tp1==="duck"))&&((i=__t585[1]),true,(args=__t585.slice(2)),true))))){var temp=maybe_temp(curr);current.push(["value",true]);var __tp0;var specs;var __tp1;var fw;var bw;var keys;var dflt;var rest;if((((__tp0=lhs_parse_specs(env,args)),(specs=__tp0),true,(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===5)&&((fw=__tp0[0]),true,(bw=__tp0[1]),true,(keys=__tp0[2]),true,(dflt=__tp0[3]),true,(rest=__tp0[4]),true))))){(void 0);}else{throw "a condition failed";}if(keys.length){helper_keys(temp,keys);}else{null;}if((((((keys.length===0)||fw.length)||bw.length)||dflt.length)||rest)){return helper_array(temp,specs,i);}else{return null;}}else{if((__t589&&((__tp0>=1)&&(((__tp1=__t585[0]),(__tp1==="data"))&&((args=__t585.slice(1)),true))))){var temp=maybe_temp(curr);var __tp0;var specs;var __tp1;var fw;var bw;var keys;var dflt;var rest;if((((__tp0=lhs_parse_specs(env,args)),(specs=__tp0),true,(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===5)&&((fw=__tp0[0]),true,(bw=__tp0[1]),true,(keys=__tp0[2]),true,(dflt=__tp0[3]),true,(rest=__tp0[4]),true))))){(void 0);}else{throw "a condition failed";}if(keys.length){helper_keys(temp,keys);}else{null;}if((((((keys.length===0)||fw.length)||bw.length)||dflt.length)||rest)){current.push(["send",["symbol","instanceof"],["data",temp,["symbol","Array"]]]);newclause();return helper_array(temp,specs,0);}else{return null;}}else{if(((other=__t585),true)){__lt____gt__(null,other);__lt____gt__(null,Error().stack);throw ["OopsG",other];}else{throw ["Could not find a match",__t585];}}}}}}}}}}}}}}}}};helper(lhs,rhs);if((current.length>1)){clauses.push(current);}else{null;}return [vars,clauses,placeholder];};var make_declarations=function(vars,val){var __t632=[];var __t633=vars;var __t634=__t633.length;for(var __t635=0;(__t635<__t634);(__t635++)){var __t636=__t633[__t635];var name;var other;if(((name=__t636),true)){__t632.push(["declare",name,["value",val]]);}else{if(((other=__t636),true)){false;}else{throw ["Could not find a match",__t636];}}}return __t632;};var make_pattern_test=function(clauses){var ands=clauses.pop();while((clauses.length>0)){(ands=["send",["symbol","and"],["data",clauses.pop(),ands]]);}return (ands||["value",true]);};var make_or_pattern=function(clauses){var ors=clauses.pop();while((clauses.length>0)){(ors=["send",["symbol","or"],["data",clauses.pop(),ors]]);}return ors;};var find_arrow=function(__t638){var expr;var __t637;(expr=__t638);true;(__t637=__t638);var __t639=__t637;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var __tp0;var __tp1;var __tp2;var x;var __t642;var __t643;var __t640;var __t641;var x;var x;var __tp0;var __tp1;var v;var __tp0;var kind;var args;var __t644=false;var __t645=false;var __t646=false;var __t647=false;if(((__t644=(__t639 instanceof Array))&&((__t645=((__tp0=__t639.length),true))&&((__t646=(__tp0===2))&&((__t647=((__tp1=__t639[0]),(__tp1==="symbol")))&&((__tp2=__t639[1]),(__tp2==="match"))))))){var placeholder=gensym();return [placeholder,placeholder];}else{if((__t647&&((__tp2=__t639[1]),(__tp2==="|>")))){var placeholder=gensym();return [placeholder,placeholder];}else{if((__t647&&((__tp2=__t639[1]),(__tp2==="|>*")))){var placeholder=gensym();return [placeholder,["send",["symbol","*"],["data",["void"],placeholder]]];}else{if((((__t639 instanceof Array)&&(((__t640=__t639.length),true)&&((__t640===2)&&(((__t641=__t639[0]),(__t641==="symbol"))&&((x=__t639[1]),true)))))||(((x=__t639),true,(__t639 instanceof Array))&&(((__t642=__t639.length),true)&&((__t642===1)&&((__t643=__t639[0]),(__t643==="void"))))))){return [false,expr];}else{if((((x=__t639),true,(__t639 instanceof Array))&&(((__tp0=__t639.length),true)&&((__tp0===2)&&(((__tp1=__t639[0]),(__tp1==="value"))&&((v=__t639[1]),true)))))){return [false,x];}else{if(((__t639 instanceof Array)&&(((__tp0=__t639.length),true)&&((__tp0>=1)&&((kind=__t639[0]),true,(args=__t639.slice(1)),true))))){var placeholder=false;var new_args=function(){var __t648=[];var __t649=args;var __t650=__t649.length;for(var __t651=0;(__t651<__t650);(__t651++)){var __t652=__t649[__t651];var arg;var other;if(((arg=__t652),true)){__t648.push(function(){var __tp0;var __tp1;var ph;var new_arg;if((((__tp0=find_arrow(arg)),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((ph=__tp0[0]),true,(new_arg=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}if(ph){(placeholder=ph);}else{null;}return new_arg;}());}else{if(((other=__t652),true)){false;}else{throw ["Could not find a match",__t652];}}}return __t648;}();return [placeholder,patch_array([kind],new_args)];}else{throw ["Could not find a match",__t639];}}}}}}};var same=function(){var __t654=Array.prototype.slice.call(arguments,0);var __tp0;var __t655;if(((__t654 instanceof Array)&&(((__tp0=__t654.length),true)&&((__tp0>=0)&&((__t655=__t654.slice(0)),true))))){var __t656=__t655;var __tp0;var __tp1;var __tp2;var __tp3;var x;var __tp4;var __tp5;var __tp6;var y;var __tp0;var __tp1;var __tp2;var __tp3;var x;var __tp4;var __tp5;var __tp6;var y;var __tp0;var __tp1;var __tp2;var __tp3;var x;var __tp4;var __tp5;var __tp6;var y;var __tp0;var __tp1;var __tp2;var __tp3;var f;var x;var __tp4;var __tp5;var __tp6;var g;var y;var __tp0;var __tp1;var __tp2;var kind1;var xs;var __tp3;var __tp4;var kind2;var ys;var other;var __t657=false;var __t658=false;var __t659=false;var __t660=false;var __t661=false;var __t662=false;if(((__t657=(__t656 instanceof Array))&&((__t658=((__tp0=__t656.length),true))&&((__t659=(__tp0===2))&&((__t660=((__tp1=__t656[0]),(__tp1 instanceof Array)))&&((__t661=((__tp2=__tp1.length),true))&&((__t662=(__tp2===2))&&(((__tp3=__tp1[0]),(__tp3==="symbol"))&&(((x=__tp1[1]),true,(__tp4=__t656[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="symbol"))&&((y=__tp4[1]),true))))))))))))){return (x===y);}else{if((__t662&&(((__tp3=__tp1[0]),(__tp3==="value"))&&(((x=__tp1[1]),true,(__tp4=__t656[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="value"))&&((y=__tp4[1]),true)))))))){return (x===y);}else{if((__t662&&(((__tp3=__tp1[0]),(__tp3==="macro"))&&(((x=__tp1[1]),true,(__tp4=__t656[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===2)&&(((__tp6=__tp4[0]),(__tp6==="macro"))&&((y=__tp4[1]),true)))))))){return (x===y);}else{if((__t661&&((__tp2===3)&&(((__tp3=__tp1[0]),(__tp3==="send"))&&(((f=__tp1[1]),true,(x=__tp1[2]),true,(__tp4=__t656[1]),(__tp4 instanceof Array))&&(((__tp5=__tp4.length),true)&&((__tp5===3)&&(((__tp6=__tp4[0]),(__tp6==="send"))&&((g=__tp4[1]),true,(y=__tp4[2]),true))))))))){return (same(f,g)&&same(x,y));}else{if((__t661&&((__tp2>=1)&&(((kind1=__tp1[0]),true,(xs=__tp1.slice(1)),true,(__tp3=__t656[1]),(__tp3 instanceof Array))&&(((__tp4=__tp3.length),true)&&((__tp4>=1)&&((kind2=__tp3[0]),true,(ys=__tp3.slice(1)),true))))))){var allequal=xs.every(function(x,i){return same(x,send(ys,i));});return (((kind1===kind2)&&(xs.length===ys.length))&&allequal);}else{if(((other=__t656),true)){return false;}else{throw ["Could not find a match",__t656];}}}}}}}else{throw ["Could not find a match",__t654];}};stdenv.register_macro("|>",function(__t664,__t663){var __tp0;var context;var env;if(((__t664 instanceof Array)&&(((__tp0=__t664.length),true)&&((__tp0===2)&&((context=__t664[0]),true,(env=__t664[1]),true))))){(void 0);}else{throw "a condition failed";}var __t665=__t663;var __tp0;var __tp1;var __tp0;var __tp1;var to_match;var cl;var __t666=false;var __t667=false;if(((__t666=(__t665 instanceof Array))&&((__t667=((__tp0=__t665.length),true))&&((__tp0===1)&&((__tp1=__t665[0]),(__tp1==="void")))))){return ["placeholder"];}else{if((__t667&&((__tp0===3)&&(((__tp1=__t665[0]),(__tp1==="data"))&&((to_match=__t665[1]),true,(cl=__t665[2]),true))))){var temp=gensym();var clauses=function(){var __t668=cl;var __tp0;var __tp1;var cls;var other;if(((__t668 instanceof Array)&&(((__tp0=__t668.length),true)&&((__tp0>=1)&&(((__tp1=__t668[0]),(__tp1==="multi"))&&((cls=__t668.slice(1)),true)))))){return cls;}else{if(((other=__t668),true)){return [other];}else{throw ["Could not find a match",__t668];}}}();var cached_conditions=[];var stmts=["multi",["declare",temp,to_match]];(clauses=function(){var __t669=[];var __t670=clauses;var __t671=__t670.length;for(var __t672=0;(__t672<__t671);(__t672++)){var __t673=__t670[__t672];var clause;var other;if(((clause=__t673),true)){__t669.push(function(){var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var lhs;var body;if(((clause instanceof Array)&&(((__tp0=clause.length),true)&&((__tp0===3)&&(((__tp1=clause[0]),(__tp1==="send"))&&(((__tp2=clause[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="->"))&&(((__tp6=clause[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((lhs=__tp6[1]),true,(body=__tp6[2]),true))))))))))))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var decls;var conditions;var placeholder;if((((__tp0=parse_lhs(env,lhs,temp)),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===3)&&((decls=__tp0[0]),true,(conditions=__tp0[1]),true,(placeholder=__tp0[2]),true))))){(void 0);}else{throw "a condition failed";}(stmts=stmts.concat(make_declarations(decls)));var b=function(){if(placeholder){return ["send",["symbol","|>"],["data",placeholder,body]];}else{return body;}}();var f=function(x){return ["done",expand(["expr",env],x)];};return [conditions.map(f),b];}());}else{if(((other=__t673),true)){false;}else{throw ["Could not find a match",__t673];}}}return __t669;}());var shares=function(){var f=function(__t674,i){var __tp0;var conditions;var body;if(((__t674 instanceof Array)&&(((__tp0=__t674.length),true)&&((__tp0===2)&&((conditions=__t674[0]),true,(body=__t674[1]),true))))){(void 0);}else{throw "a condition failed";}var res=0;var prev_conditions=send(clauses,i)[0];var nc=conditions.length;for(var j=0;((j<nc)&&same(send(conditions,j),send(prev_conditions,j)));(j++)){(res++);}return res;};return clauses.slice(1).map(f);}();var max=send(Math.max,shares);shares.push(0);var vars=[];(vars=vars.concat(function(){var __t675=[];var __t676=range(1,max);var __t677=__t676.length;for(var __t678=0;(__t678<__t677);(__t678++)){var __t679=__t676[__t678];var _;var other;if(((_=__t679),true)){__t675.push(gensym());}else{if(((other=__t679),true)){false;}else{throw ["Could not find a match",__t679];}}}return __t675;}()));(stmts=stmts.concat(make_declarations(vars,false)));var shared_last=0;var new_clauses=clauses.map(function(__t680,i){var __tp0;var conditions;var body;if(((__t680 instanceof Array)&&(((__tp0=__t680.length),true)&&((__tp0===2)&&((conditions=__t680[0]),true,(body=__t680[1]),true))))){(void 0);}else{throw "a condition failed";}var shared=function(){if(shared_last){return [send(vars,(shared_last-1))];}else{return [];}}();var n_to_share=Math.max(shared_last,send(shares,i));var to_share=conditions.slice(shared_last,n_to_share).map(function(x,j){return ["assign",send(vars,(shared_last+j)),x];});(shared_last=send(shares,i));var rest=conditions.slice(n_to_share);return [shared.concat(to_share).concat(rest),body];});(clauses=new_clauses);var r=["js_throw",["data",["value","Could not find a match"],temp]];while((clauses.length>0)){var __tp0;var __tp1;var conditions;var body;if((((__tp0=clauses.pop()),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((conditions=__tp0[0]),true,(body=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}var test=make_pattern_test(conditions);(r=["if",test,body,r]);}stmts.push(r);return stmts;}else{throw ["Could not find a match",__t665];}}});var qqstruct=function(name,args){return patch_array(["data",["value",name]],args);};var qq=function(__t682){var expr;var __t681;(expr=__t682);true;(__t681=__t682);var __t683=__t681;var __tp0;var __tp1;var s;var __tp0;var __tp1;var __tp0;var __tp1;var v;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var insert;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var insert;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var insert;var __tp0;var name;var args;var __t684=false;var __t685=false;var __t686=false;var __t687=false;var __t688=false;var __t689=false;var __t690=false;var __t691=false;if(((__t684=(__t683 instanceof Array))&&((__t685=((__tp0=__t683.length),true))&&((__tp0===2)&&(((__tp1=__t683[0]),(__tp1==="symbol"))&&((s=__t683[1]),true)))))){return qqstruct("symbol",[["value",s]]);}else{if((__t685&&((__tp0===1)&&((__tp1=__t683[0]),(__tp1==="void"))))){return qqstruct("void",[]);}else{if((__t685&&((__tp0===2)&&(((__tp1=__t683[0]),(__tp1==="value"))&&((v=__t683[1]),true))))){return qqstruct("value",[expr]);}else{if((__t685&&((__t686=(__tp0===3))&&((__t687=((__tp1=__t683[0]),(__tp1==="send")))&&((__t688=((__tp2=__t683[1]),(__tp2 instanceof Array)))&&((__t689=((__tp3=__tp2.length),true))&&((__t690=(__tp3===2))&&((__t691=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="^"))&&(((__tp6=__t683[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((insert=__tp6[2]),true)))))))))))))))))){return insert;}else{if((__t691&&(((__tp5=__tp2[1]),(__tp5==="^="))&&(((__tp6=__t683[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((insert=__tp6[2]),true)))))))))))){return qqstruct("value",[insert]);}else{if((__t691&&(((__tp5=__tp2[1]),(__tp5==="^*"))&&(((__tp6=__t683[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((insert=__tp6[2]),true)))))))))))){return ["send",["symbol","*"],["data",["void"],insert]];}else{if((__t685&&((__tp0>=1)&&((name=__t683[0]),true,(args=__t683.slice(1)),true)))){return qqstruct(name,function(){var __t692=[];var __t693=args;var __t694=__t693.length;for(var __t695=0;(__t695<__t694);(__t695++)){var __t696=__t693[__t695];var arg;var other;if(((arg=__t696),true)){__t692.push(qq(arg));}else{if(((other=__t696),true)){false;}else{throw ["Could not find a match",__t696];}}}return __t692;}());}else{throw ["Could not find a match",__t683];}}}}}}}};stdenv.register_macro("'",function(__t697,__t698){var __tp0;var context;var env;if(((__t697 instanceof Array)&&(((__tp0=__t697.length),true)&&((__tp0===2)&&((context=__t697[0]),true,(env=__t697[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var expr;if(((__t698 instanceof Array)&&(((__tp0=__t698.length),true)&&((__tp0===3)&&(((__tp1=__t698[0]),(__tp1==="data"))&&(((__tp2=__t698[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&((expr=__t698[2]),true)))))))))){(void 0);}else{throw "a condition failed";}return qq(expr);});stdenv.register_macro("provide",function(__t699,__t700){var __tp0;var context;var env;if(((__t699 instanceof Array)&&(((__tp0=__t699.length),true)&&((__tp0===2)&&((context=__t699[0]),true,(env=__t699[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var expr;if(((__t700 instanceof Array)&&(((__tp0=__t700.length),true)&&((__tp0===2)&&(((__tp1=__t700[0]),(__tp1==="data"))&&(((__tp2=__t700[1]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((expr=__tp3[1]),true))))))){(void 0);}else{throw "a condition failed";}return ["sink",["multi"].concat(function(){var __t701=[];var __t702=expr;var __t703=__t702.length;for(var __t704=0;(__t704<__t703);(__t704++)){var __t705=__t702[__t704];var s;var __tp0;var __tp1;var name;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var s;var __tp9;var __t708;var __t709;var name;var __t706;var __t707;var name;var other;var other;var __t710=false;if((((s=__t705),true,(__t705 instanceof Array))&&(((__tp0=__t705.length),true)&&((__tp0===2)&&(((__tp1=__t705[0]),(__tp1==="symbol"))&&((name=__t705[1]),true)))))){__t701.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name]],s]]);}else{if(((__t705 instanceof Array)&&(((__tp0=__t705.length),true)&&((__tp0===3)&&(((__tp1=__t705[0]),(__tp1==="send"))&&(((__tp2=__t705[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="as"))&&(((__tp6=__t705[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((s=__tp6[1]),true,(__tp9=__tp6[2]),(((__tp9 instanceof Array)&&(((__t706=__tp9.length),true)&&((__t706===2)&&(((__t707=__tp9[0]),(__t707==="symbol"))&&((name=__tp9[1]),true)))))||((__tp9 instanceof Array)&&(((__t708=__tp9.length),true)&&((__t708===2)&&(((__t709=__tp9[0]),(__t709==="value"))&&((name=__tp9[1]),true))))))))))))))))))))){__t701.push(["send",["symbol",":="],["data",["send",["symbol","exports"],["value",name]],s]]);}else{if((__t710=((other=__t705),true))){__t701.push(function(){throw ErrorFactory(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");}());}else{if(__t710){false;}else{throw ["Could not find a match",__t705];}}}}}return __t701;}())];});stdenv.register_macro("require",function(__t711,__t712){var __tp0;var context;var env;if(((__t711 instanceof Array)&&(((__tp0=__t711.length),true)&&((__tp0===2)&&((context=__t711[0]),true,(env=__t711[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var expr;if(((__t712 instanceof Array)&&(((__tp0=__t712.length),true)&&((__tp0===2)&&(((__tp1=__t712[0]),(__tp1==="data"))&&((expr=__t712[1]),true)))))){(void 0);}else{throw "a condition failed";}var stmts=[];var topfetch=function(pkg,v){stmts.push(["send",["symbol","="],["data",v,["send",["send",["symbol","___node"],["send",["symbol","."],["data",["void"],["symbol","require"]]]],["data",["value",pkg]]]]]);return v;};var produce=function(__t713,fetch){var __t714=__t713;var __tp0;var __tp1;var s;var __tp0;var __tp1;var __tp2;var s;var __t717;var __t718;var subp;var __t715;var __t716;var subp;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __t721;var __t722;var pkg;var __t719;var __t720;var pkg;var s;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var pkg;var subp;var __t723=false;var __t724=false;var __t725=false;var __t726=false;var __t727=false;var __t728=false;var __t729=false;var __t730=false;if(((__t723=(__t714 instanceof Array))&&((__t724=((__tp0=__t714.length),true))&&((__t725=(__tp0===2))&&(((__tp1=__t714[0]),(__tp1==="symbol"))&&((s=__t714[1]),true)))))){return fetch(s,["symbol",s]);}else{if((__t725&&(((__tp1=__t714[0]),(__tp1==="value"))&&(((__tp2=__t714[1]),(typeof(__tp2)==="string"))&&((s=__tp2),true))))){return fetch(s,gensym());}else{if((((__t714 instanceof Array)&&(((__t715=__t714.length),true)&&((__t715>=1)&&(((__t716=__t714[0]),(__t716==="multi"))&&((subp=__t714.slice(1)),true)))))||((__t714 instanceof Array)&&(((__t717=__t714.length),true)&&((__t717>=1)&&(((__t718=__t714[0]),(__t718==="data"))&&((subp=__t714.slice(1)),true))))))){var __t731=[];var __t732=subp;var __t733=__t732.length;for(var __t734=0;(__t734<__t733);(__t734++)){var __t735=__t732[__t734];var p;var other;if(((p=__t735),true)){__t731.push(produce(p,fetch));}else{if(((other=__t735),true)){false;}else{throw ["Could not find a match",__t735];}}}return __t731;}else{if(((__t723=(__t714 instanceof Array))&&((__t724=((__tp0=__t714.length),true))&&((__t725=(__tp0===3))&&((__t726=((__tp1=__t714[0]),(__tp1==="send")))&&((__t727=((__tp2=__t714[1]),(__tp2 instanceof Array)))&&((__t728=((__tp3=__tp2.length),true))&&((__t729=(__tp3===2))&&((__t730=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="as"))&&(((__tp6=__t714[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(((__tp9 instanceof Array)&&(((__t719=__tp9.length),true)&&((__t719===2)&&(((__t720=__tp9[0]),(__t720==="value"))&&((pkg=__tp9[1]),true)))))||((__tp9 instanceof Array)&&(((__t721=__tp9.length),true)&&((__t721===2)&&(((__t722=__tp9[0]),(__t722==="symbol"))&&((pkg=__tp9[1]),true)))))))&&((s=__tp6[2]),true)))))))))))))))){return fetch(pkg,s);}else{if((__t730&&(((__tp5=__tp2[1]),(__tp5==="->"))&&(((__tp6=__t714[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((pkg=__tp6[1]),true,(subp=__tp6[2]),true)))))))){var pkgv=produce(pkg,fetch);return produce(subp,function(pkg,v){return stmts.push(["send",["symbol","="],["data",v,["send",pkgv,["value",pkg]]]]);});}else{throw ["Could not find a match",__t714];}}}}}};produce(expr,topfetch);return patch_array(["multi"],stmts);});stdenv.register_macro("%",function(__t736,__t737){var __tp0;var context;var env;if(((__t736 instanceof Array)&&(((__tp0=__t736.length),true)&&((__tp0===2)&&((context=__t736[0]),true,(env=__t736[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var descr;var contents;if(((__t737 instanceof Array)&&(((__tp0=__t737.length),true)&&((__tp0===3)&&(((__tp1=__t737[0]),(__tp1==="data"))&&((descr=__t737[1]),true,(contents=__t737[2]),true)))))){(void 0);}else{throw "a condition failed";}var tags=["data"];var parse=function(__t738){var __t739=__t738;var __tp0;var __tp1;var __tp0;var __tp1;var s;var __tp0;var __tp1;var x;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var __t742;var __t743;var x;var __t740;var __t741;var x;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var __t746;var __t747;var x;var __t744;var __t745;var x;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __t750;var __t751;var prop;var __t748;var __t749;var prop;var value;var __tp0;var __tp1;var expr;var rest;var __t754;var __t755;var args;var __t752;var __t753;var args;var __t756=false;var __t757=false;var __t758=false;var __t759=false;var __t760=false;var __t761=false;var __t762=false;var __t763=false;if(((__t756=(__t739 instanceof Array))&&((__t757=((__tp0=__t739.length),true))&&((__tp0===1)&&((__tp1=__t739[0]),(__tp1==="void")))))){return null;}else{if((__t757&&((__t758=(__tp0===2))&&(((__tp1=__t739[0]),(__tp1==="symbol"))&&((s=__t739[1]),true))))){return tags.push(["value",("+"+s)]);}else{if((__t758&&(((__tp1=__t739[0]),(__tp1==="value"))&&((x=__t739[1]),true)))){return tags.push(["value",("+"+x)]);}else{if((__t757&&((__t758=(__tp0===3))&&((__t759=((__tp1=__t739[0]),(__tp1==="send")))&&((__t760=((__tp2=__t739[1]),(__tp2 instanceof Array)))&&((__t761=((__tp3=__tp2.length),true))&&((__t762=(__tp3===2))&&((__t763=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="."))&&(((__tp6=__t739[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((__tp12=__tp6[2]),(((__tp12 instanceof Array)&&(((__t740=__tp12.length),true)&&((__t740===2)&&(((__t741=__tp12[0]),(__t741==="symbol"))&&((x=__tp12[1]),true)))))||((__tp12 instanceof Array)&&(((__t742=__tp12.length),true)&&((__t742===2)&&(((__t743=__tp12[0]),(__t743==="value"))&&((x=__tp12[1]),true)))))))))))))))))))))))){return tags.push(["value",x]);}else{if((__t763&&(((__tp5=__tp2[1]),(__tp5==="#"))&&(((__tp6=__t739[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===1)&&(((__tp11=__tp9[0]),(__tp11==="void"))&&((__tp12=__tp6[2]),(((__tp12 instanceof Array)&&(((__t744=__tp12.length),true)&&((__t744===2)&&(((__t745=__tp12[0]),(__t745==="symbol"))&&((x=__tp12[1]),true)))))||((__tp12 instanceof Array)&&(((__t746=__tp12.length),true)&&((__t746===2)&&(((__t747=__tp12[0]),(__t747==="value"))&&((x=__tp12[1]),true)))))))))))))))))){return tags.push(["value",("#"+x)]);}else{if((__t763&&(((__tp5=__tp2[1]),(__tp5==="="))&&(((__tp6=__t739[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(((__tp9 instanceof Array)&&(((__t748=__tp9.length),true)&&((__t748===2)&&(((__t749=__tp9[0]),(__t749==="symbol"))&&((prop=__tp9[1]),true)))))||((__tp9 instanceof Array)&&(((__t750=__tp9.length),true)&&((__t750===2)&&(((__t751=__tp9[0]),(__t751==="value"))&&((prop=__tp9[1]),true)))))))&&((value=__tp6[2]),true))))))))){return tags.push(["send",["send",["symbol","#"],["data",["void"],["symbol","assoc"]]],["data",["value",prop],value]]);}else{if((__t759&&((expr=__t739[1]),true,(rest=__t739[2]),true))){parse(expr);return parse(rest);}else{if((((__t739 instanceof Array)&&(((__t752=__t739.length),true)&&((__t752>=1)&&(((__t753=__t739[0]),(__t753==="multi"))&&((args=__t739.slice(1)),true)))))||((__t739 instanceof Array)&&(((__t754=__t739.length),true)&&((__t754>=1)&&(((__t755=__t739[0]),(__t755==="data"))&&((args=__t739.slice(1)),true))))))){return args.forEach(parse);}else{throw ["Could not find a match",__t739];}}}}}}}}};parse(descr);(contents=function(){var __t764=contents;var __tp0;var __tp1;var __tp0;var __tp1;var args;var x;var __t765=false;var __t766=false;if(((__t765=(__t764 instanceof Array))&&((__t766=((__tp0=__t764.length),true))&&((__tp0===1)&&((__tp1=__t764[0]),(__tp1==="void")))))){return ["data"];}else{if((__t766&&((__tp0>=1)&&(((__tp1=__t764[0]),(__tp1==="multi"))&&((args=__t764.slice(1)),true))))){return patch_array(["data"],args);}else{if(((x=__t764),true)){return x;}else{throw ["Could not find a match",__t764];}}}}());return ["send",["symbol","Node"],["data",tags,contents]];});var var_operator=function(temp){return function(_,expr){var f=function(__t767){var __t768=__t767;var __tp0;var __tp1;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __t769;var other;var __t770=false;var __t771=false;if(((__t770=(__t768 instanceof Array))&&((__t771=((__tp0=__t768.length),true))&&((__tp0===1)&&((__tp1=__t768[0]),(__tp1==="void")))))){return temp;}else{if((__t771&&((__tp0===3)&&(((__tp1=__t768[0]),(__tp1==="data"))&&(((__tp2=__t768[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===1)&&(((__tp4=__tp2[0]),(__tp4==="void"))&&((__t769=__t768[2]),true))))))))){var __t772=__t769;var __tp0;var __tp1;var s;var __tp0;var __tp1;var obj;var msg;var other;var __t773=false;var __t774=false;if(((__t773=(__t772 instanceof Array))&&((__t774=((__tp0=__t772.length),true))&&((__tp0===2)&&(((__tp1=__t772[0]),(__tp1==="symbol"))&&((s=__t772[1]),true)))))){return ["send",temp,["value",s]];}else{if((__t774&&((__tp0===3)&&(((__tp1=__t772[0]),(__tp1==="send"))&&((obj=__t772[1]),true,(msg=__t772[2]),true))))){var x=f(["data",["void"],obj]);return ["send",x,msg];}else{if(((other=__t772),true)){return ["send",temp,other];}else{throw ["Could not find a match",__t772];}}}}else{if(((other=__t768),true)){return ["send",temp,other];}else{throw ["Could not find a match",__t768];}}}};return f(expr);};};stdenv.register_macro("chain",function(__t775,__t776){var __tp0;var context;var env;if(((__t775 instanceof Array)&&(((__tp0=__t775.length),true)&&((__tp0===2)&&((context=__t775[0]),true,(env=__t775[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var defn;var body;if(((__t776 instanceof Array)&&(((__tp0=__t776.length),true)&&((__tp0===3)&&(((__tp1=__t776[0]),(__tp1==="data"))&&((defn=__t776[1]),true,(body=__t776[2]),true)))))){(void 0);}else{throw "a condition failed";}var newenv=env.fork();var temp=gensym();var __tp0;var __tp1;var variable;var expr;if((((__tp0=function(){var __t777=defn;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var x;var y;var other;if(((__t777 instanceof Array)&&(((__tp0=__t777.length),true)&&((__tp0===3)&&(((__tp1=__t777[0]),(__tp1==="send"))&&(((__tp2=__t777[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="as"))&&(((__tp6=__t777[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((x=__tp6[1]),true,(y=__tp6[2]),true))))))))))))))){return [y,x];}else{if(((other=__t777),true)){return [["symbol","@"],other];}else{throw ["Could not find a match",__t777];}}}()),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((variable=__tp0[0]),true,(expr=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var var_str;if(((variable instanceof Array)&&(((__tp0=variable.length),true)&&((__tp0===2)&&(((__tp1=variable[0]),(__tp1==="symbol"))&&((var_str=variable[1]),true)))))){(void 0);}else{throw "a condition failed";}newenv.register_macro(var_str,var_operator(temp));var stmts=["multi"].concat(function(){var __t778=[];var __t779=aslist(body);var __t780=__t779.length;for(var __t781=0;(__t781<__t780);(__t781++)){var __t782=__t779[__t781];var x;var other;if(((x=__t782),true)){__t778.push(["send",["symbol",":="],["data",temp,x]]);}else{if(((other=__t782),true)){false;}else{throw ["Could not find a match",__t782];}}}return __t778;}());var v=["multi",["send",["symbol","="],["data",temp,expr]],stmts,temp];return ["done",expand([context,newenv],v)];});stdenv.register_macro("using",function(__t783,__t784){var __tp0;var context;var env;if(((__t783 instanceof Array)&&(((__tp0=__t783.length),true)&&((__tp0===2)&&((context=__t783[0]),true,(env=__t783[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var defn;var body;if(((__t784 instanceof Array)&&(((__tp0=__t784.length),true)&&((__tp0===3)&&(((__tp1=__t784[0]),(__tp1==="data"))&&((defn=__t784[1]),true,(body=__t784[2]),true)))))){(void 0);}else{throw "a condition failed";}var newenv=env.fork();var temp=gensym();var __tp0;var __tp1;var variable;var expr;if((((__tp0=function(){var __t785=defn;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var x;var y;var other;if(((__t785 instanceof Array)&&(((__tp0=__t785.length),true)&&((__tp0===3)&&(((__tp1=__t785[0]),(__tp1==="send"))&&(((__tp2=__t785[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="as"))&&(((__tp6=__t785[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((x=__tp6[1]),true,(y=__tp6[2]),true))))))))))))))){return [y,x];}else{if(((other=__t785),true)){return [["symbol","@"],other];}else{throw ["Could not find a match",__t785];}}}()),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((variable=__tp0[0]),true,(expr=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var var_str;if(((variable instanceof Array)&&(((__tp0=variable.length),true)&&((__tp0===2)&&(((__tp1=variable[0]),(__tp1==="symbol"))&&((var_str=variable[1]),true)))))){(void 0);}else{throw "a condition failed";}newenv.register_macro(var_str,var_operator(temp));var v=["multi",["send",["symbol","="],["data",temp,expr]],body];return ["done",expand([context,newenv],v)];});var partition=function(xs,predicate){var t=[];var f=[];var __t786=xs;var __t787=__t786.length;for(var __t788=0;(__t788<__t787);(__t788++)){var __t789=__t786[__t788];var x;var x;var other;if(((x=__t789),true,predicate(x))){t.push(x);}else{if(((x=__t789),true)){f.push(x);}else{if(((other=__t789),true)){false;}else{throw ["Could not find a match",__t789];}}}}false;return [t,f];};stdenv.register_macro("class",function(__t790,arg){var __tp0;var context;var env;if(((__t790 instanceof Array)&&(((__tp0=__t790.length),true)&&((__tp0===2)&&((context=__t790[0]),true,(env=__t790[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var clsvar;var __tp2;var __tp3;var body;if((((__tp0=function(){var __t794=arg;var __tp0;var __tp1;var body;var __tp0;var __tp1;var name;var body;var __t795=false;var __t796=false;if(((__t795=(__t794 instanceof Array))&&((__t796=((__tp0=__t794.length),true))&&((__tp0===2)&&(((__tp1=__t794[0]),(__tp1==="data"))&&((body=__t794[1]),true)))))){return [gensym(),body];}else{if((__t796&&((__tp0===3)&&(((__tp1=__t794[0]),(__tp1==="data"))&&((name=__t794[1]),true,(body=__t794[2]),true))))){return [name,body];}else{throw ["Could not find a match",__t794];}}}()),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&(((clsvar=__tp0[0]),true,(__tp2=__tp0[1]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((body=__tp3[1]),true)))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var ctors;var clauses;if((((__tp0=partition(body,function(__t797){var __t798=__t797;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var __tp12;var __tp13;var __tp14;var __tp15;var _;var _;var otherwise;if(((__t798 instanceof Array)&&(((__tp0=__t798.length),true)&&((__tp0===3)&&(((__tp1=__t798[0]),(__tp1==="send"))&&(((__tp2=__t798[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="="))&&(((__tp6=__t798[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===3)&&(((__tp11=__tp9[0]),(__tp11==="send"))&&(((__tp12=__tp9[1]),(__tp12 instanceof Array))&&(((__tp13=__tp12.length),true)&&((__tp13===2)&&(((__tp14=__tp12[0]),(__tp14==="symbol"))&&(((__tp15=__tp12[1]),(__tp15==="constructor"))&&((_=__tp9[2]),true,(_=__tp6[2]),true)))))))))))))))))))))))){return true;}else{if(((otherwise=__t798),true)){return false;}else{throw ["Could not find a match",__t798];}}})),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((ctors=__tp0[0]),true,(clauses=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var ctor_args;var ctor_body;if((((__tp0=function(){var __t799=ctors;var __tp0;var __tp0;var __t800;var __t801=false;var __t802=false;if(((__t801=(__t799 instanceof Array))&&((__t802=((__tp0=__t799.length),true))&&(__tp0===0)))){return [["data"],[]];}else{if((__t802&&((__tp0===1)&&((__t800=__t799[0]),true)))){var __t803=__t800;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var _;var args;var __tp12;var __tp13;var body;if(((__t803 instanceof Array)&&(((__tp0=__t803.length),true)&&((__tp0===3)&&(((__tp1=__t803[0]),(__tp1==="send"))&&(((__tp2=__t803[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="="))&&(((__tp6=__t803[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===3)&&(((__tp11=__tp9[0]),(__tp11==="send"))&&(((_=__tp9[1]),true,(args=__tp9[2]),true,(__tp12=__tp6[2]),(__tp13=___projector(aslist)(__tp12)),__tp13[0])&&((body=__tp13[1]),true)))))))))))))))))))){return [args,body];}else{throw ["Could not find a match",__t803];}}else{throw ["Could not find a match",__t799];}}}()),(__tp0 instanceof Array))&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((ctor_args=__tp0[0]),true,(ctor_body=__tp0[1]),true))))){(void 0);}else{throw "a condition failed";}var selfvar=gensym();(ctor_body=function(){var prep=["send",["symbol","="],["data",selfvar,["send",["symbol","if"],["data",["send",["symbol","not"],["data",["void"],["send",["send",["symbol","?"],["data",clsvar,["void"]]],["symbol","this"]]]],["send",["send",["symbol","Object"],["send",["symbol","."],["data",["void"],["symbol","create"]]]],["data",["send",clsvar,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]]]],["symbol","this"]]]]];var ret=selfvar;return patch_array(["multi",prep],ctor_body,[ret]);}());var newenv=env.fork();newenv.register_macro("@",var_operator(selfvar));var defns=[];var static_defns=[];var __t791=clauses;var __t792=__t791.length;for(var __t793=0;(__t793<__t792);(__t793++)){var __t804=__t791[__t793];var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var body;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var __tp9;var __tp10;var __tp11;var name;var args;var __tp12;var __tp13;var body;var other;var __t805=false;var __t806=false;var __t807=false;var __t808=false;var __t809=false;var __t810=false;var __t811=false;var __t812=false;if(((__t805=(__t804 instanceof Array))&&((__t806=((__tp0=__t804.length),true))&&((__t807=(__tp0===3))&&((__t808=((__tp1=__t804[0]),(__tp1==="send")))&&((__t809=((__tp2=__t804[1]),(__tp2 instanceof Array)))&&((__t810=((__tp3=__tp2.length),true))&&((__t811=(__tp3===2))&&((__t812=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="static"))&&(((__tp6=__t804[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===2)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp10=___projector(aslist)(__tp9)),__tp10[0])&&((body=__tp10[1]),true)))))))))))))))){(static_defns=static_defns.concat(body));}else{if((__t812&&(((__tp5=__tp2[1]),(__tp5==="="))&&(((__tp6=__t804[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((__tp9=__tp6[1]),(__tp9 instanceof Array))&&(((__tp10=__tp9.length),true)&&((__tp10===3)&&(((__tp11=__tp9[0]),(__tp11==="send"))&&(((name=__tp9[1]),true,(args=__tp9[2]),true,(__tp12=__tp6[2]),(__tp13=___projector(aslist)(__tp12)),__tp13[0])&&((body=__tp13[1]),true))))))))))))){(name=function(){var __t813=name;var __tp0;var __tp1;var _;var __tp0;var __tp1;var n;var __t814=false;var __t815=false;var __t816=false;if(((__t814=(__t813 instanceof Array))&&((__t815=((__tp0=__t813.length),true))&&((__t816=(__tp0===2))&&(((__tp1=__t813[0]),(__tp1==="value"))&&((_=__t813[1]),true)))))){return name;}else{if((__t816&&(((__tp1=__t813[0]),(__tp1==="symbol"))&&((n=__t813[1]),true)))){return ["value",n];}else{throw ["Could not find a match",__t813];}}}());defns.push(["send",["symbol",":="],["data",["send",["send",clsvar,["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],name],["send",["symbol","->"],["data",args,patch_array(["multi",["send",["symbol","="],["data",selfvar,["symbol","this"]]]],body)]]]]);}else{if(((other=__t804),true)){false;}else{throw ["Could not find a match",__t804];}}}}false;return ["done",expand([context,newenv],patch_array(["multi",["send",["symbol","="],["data",clsvar,["send",["symbol","->"],["data",ctor_args,ctor_body]]]],["send",["symbol","augment"],["data",clsvar,patch_array(["data"],static_defns)]]],defns,[clsvar]))];});stdenv.register_macro("do",function(__t817,__t818){var __tp0;var context;var env;if(((__t817 instanceof Array)&&(((__tp0=__t817.length),true)&&((__tp0===2)&&((context=__t817[0]),true,(env=__t817[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var body;if(((__t818 instanceof Array)&&(((__tp0=__t818.length),true)&&((__tp0===2)&&(((__tp1=__t818[0]),(__tp1==="data"))&&(((__tp2=__t818[1]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((body=__tp3[1]),true))))))){(void 0);}else{throw "a condition failed";}return patch_array(["multi"],body);});stdenv.register_macro("then",function(__t819,__t820){var __tp0;var context;var env;if(((__t819 instanceof Array)&&(((__tp0=__t819.length),true)&&((__tp0===2)&&((context=__t819[0]),true,(env=__t819[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var body;if(((__t820 instanceof Array)&&(((__tp0=__t820.length),true)&&((__tp0===2)&&(((__tp1=__t820[0]),(__tp1==="data"))&&(((__tp2=__t820[1]),(__tp3=___projector(aslist)(__tp2)),__tp3[0])&&((body=__tp3[1]),true))))))){(void 0);}else{throw "a condition failed";}return patch_array(["multi"],body);});var group=function(xs,classifier){var groups=[];var curr=[];var newgroup=function(){if((curr.length>0)){groups.push(curr);}else{null;}return (curr=[]);};var __t821=xs;var __t822=__t821.length;for(var __t823=0;(__t823<__t822);(__t823++)){var __t824=__t821[__t823];var x;var other;if(((x=__t824),true)){if(classifier(x)){newgroup();}else{null;}curr.push(x);}else{if(((other=__t824),true)){false;}else{throw ["Could not find a match",__t824];}}}false;newgroup();return groups;};var blocktest_wrap=function(label,expr,accumulator){var value=gensym();return ["multi",["send",["symbol","="],["data",value,["send",["symbol","!!"],["data",["multi",["send",["symbol","|>"],["data",expr,["multi",["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","true"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","success"]]],["data",["symbol","x"]]]]],["send",["symbol","->"],["data",["send",["send",["symbol","?"],["data",["symbol","false"],["void"]]],["symbol","x"]],["send",["send",["symbol","#"],["data",["void"],["symbol","failure"]]],["data",["symbol","x"]]]]]]]]],["send",["symbol","->"],["data",["symbol","__err"],["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",["symbol","__err"]]]]]]]]],["send",["send",accumulator,["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","test_result"]]],["data",label,value]]]]];};var blocktest_mac=function(label,tests,acc){var ok=gensym();var stmts=[];stmts.push(["send",["symbol","="],["data",ok,["symbol","true"]]]);var __t825=tests;var __t826=__t825.length;for(var __t827=0;(__t827<__t826);(__t827++)){var __t828=__t825[__t827];var stmt;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var _;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var new_label;var __tp9;var __tp10;var new_tests;var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var sources;var __tp9;var __tp10;var clauses;var expr;var other;var __t829=false;var __t830=false;var __t831=false;var __t832=false;var __t833=false;var __t834=false;var __t835=false;var __t836=false;if((((stmt=__t828),true,(__t828 instanceof Array))&&(((__tp0=__t828.length),true)&&((__tp0===3)&&(((__tp1=__t828[0]),(__tp1==="send"))&&(((__tp2=__t828[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="do"))&&((_=__t828[2]),true))))))))))){stmts.push(["send",["symbol","!!"],["data",stmt,["send",["symbol","->"],["data",["symbol","__err"],["multi",["send",["send",acc,["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",label,["symbol","__err"]]]]],["send",["symbol",":="],["data",ok,["symbol","false"]]]]]]]]);}else{if(((__t829=(__t828 instanceof Array))&&((__t830=((__tp0=__t828.length),true))&&((__t831=(__tp0===3))&&((__t832=((__tp1=__t828[0]),(__tp1==="send")))&&((__t833=((__tp2=__t828[1]),(__tp2 instanceof Array)))&&((__t834=((__tp3=__tp2.length),true))&&((__t835=(__tp3===2))&&((__t836=((__tp4=__tp2[0]),(__tp4==="symbol")))&&(((__tp5=__tp2[1]),(__tp5==="=>"))&&(((__tp6=__t828[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((new_label=__tp6[1]),true,(__tp9=__tp6[2]),(__tp10=___projector(aslist)(__tp9)),__tp10[0])&&((new_tests=__tp10[1]),true)))))))))))))))){var labv=gensym();stmts.push(["multi",["send",["symbol","="],["data",labv,["send",["symbol","++"],["data",label,["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],new_label]]]]],patch_array(["multi"],blocktest_mac(labv,new_tests,acc))]);}else{if((__t836&&(((__tp5=__tp2[1]),(__tp5==="each"))&&(((__tp6=__t828[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&(((sources=__tp6[1]),true,(__tp9=__tp6[2]),(__tp10=___projector(aslist)(__tp9)),__tp10[0])&&((clauses=__tp10[1]),true))))))))){var loopvar=gensym();(clauses=function(){var __t837=[];var __t838=clauses;var __t839=__t838.length;for(var __t840=0;(__t840<__t839);(__t840++)){var __t841=__t838[__t840];var clause;var other;if(((clause=__t841),true)){__t837.push(function(){var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var __tp6;var __tp7;var __tp8;var lhs;var rhs;if(((clause instanceof Array)&&(((__tp0=clause.length),true)&&((__tp0===3)&&(((__tp1=clause[0]),(__tp1==="send"))&&(((__tp2=clause[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===2)&&(((__tp4=__tp2[0]),(__tp4==="symbol"))&&(((__tp5=__tp2[1]),(__tp5==="->"))&&(((__tp6=clause[2]),(__tp6 instanceof Array))&&(((__tp7=__tp6.length),true)&&((__tp7===3)&&(((__tp8=__tp6[0]),(__tp8==="data"))&&((lhs=__tp6[1]),true,(rhs=__tp6[2]),true))))))))))))))){(void 0);}else{throw "a condition failed";}var x=blocktest_mac(["send",["symbol","++"],["data",label,["data",loopvar]]],___projector(aslist)(rhs)[1],acc);return ["send",["symbol","->"],["data",lhs,patch_array(["multi"],x)]];}());}else{if(((other=__t841),true)){false;}else{throw ["Could not find a match",__t841];}}}return __t837;}());clauses.push(["send",["symbol","->"],["data",["symbol","__no"],["send",["send",acc,["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","error"]]],["data",label,["value","No handler for test case"],["symbol","__no"]]]]]]]);stmts.push(build_each(sources,patch_array(["multi"],clauses),["multi"],["multi"],loopvar));}else{if(((expr=__t828),true)){stmts.push(["send",["symbol","if"],["data",ok,["multi",["send",["symbol","then"],["data",blocktest_wrap(label,expr,acc)]],["send",["symbol","else"],["data",["send",["send",acc,["send",["symbol","."],["data",["void"],["symbol","push"]]]],["data",["send",["send",["symbol","#"],["data",["void"],["symbol","aborted"]]],["data",label,["send",["symbol","'"],["data",["void"],expr]]]]]]]]]]]);}else{if(((other=__t828),true)){false;}else{throw ["Could not find a match",__t828];}}}}}}false;stmts.push(acc);return stmts;};stdenv.register_macro("blocktest",function(__t842,__t843){var __tp0;var context;var env;if(((__t842 instanceof Array)&&(((__tp0=__t842.length),true)&&((__tp0===2)&&((context=__t842[0]),true,(env=__t842[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var args;if(((__t843 instanceof Array)&&(((__tp0=__t843.length),true)&&((__tp0>=1)&&(((__tp1=__t843[0]),(__tp1==="data"))&&((args=__t843.slice(1)),true)))))){(void 0);}else{throw "a condition failed";}var acc=gensym();var labv=gensym();var stmts=["multi",["send",["symbol","="],["data",acc,["data"]]]];var rval=function(){var __t844=args;var __tp0;var __tp1;var __tp2;var tests;var __tp0;var labels;var __tp1;var __tp2;var tests;var __t845=false;var __t846=false;if(((__t845=(__t844 instanceof Array))&&((__t846=((__tp0=__t844.length),true))&&((__tp0===1)&&(((__tp1=__t844[0]),(__tp2=___projector(aslist)(__tp1)),__tp2[0])&&((tests=__tp2[1]),true)))))){stmts.push(["send",["symbol","="],["data",labv,["data"]]]);return (stmts=stmts.concat(blocktest_mac(labv,tests,acc)));}else{if((__t846&&((__tp0===2)&&(((labels=__t844[0]),true,(__tp1=__t844[1]),(__tp2=___projector(aslist)(__tp1)),__tp2[0])&&((tests=__tp2[1]),true))))){stmts.push(["send",["symbol","="],["data",labv,["send",["send",["symbol","!"],["data",["symbol","Array"],["void"]]],labels]]]);return (stmts=stmts.concat(blocktest_mac(labv,tests,acc)));}else{throw ["Could not find a match",__t844];}}}();return rval;});stdenv.register_macro("macro",function(__t847,expr){var __tp0;var context;var env;if(((__t847 instanceof Array)&&(((__tp0=__t847.length),true)&&((__tp0===2)&&((context=__t847[0]),true,(env=__t847[1]),true))))){(void 0);}else{throw "a condition failed";}var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var __tp5;var name;var __tp6;var __tp7;var sname;var args;var body;if(((expr instanceof Array)&&(((__tp0=expr.length),true)&&((__tp0===3)&&(((__tp1=expr[0]),(__tp1==="data"))&&(((__tp2=expr[1]),(__tp2 instanceof Array))&&(((__tp3=__tp2.length),true)&&((__tp3===3)&&(((__tp4=__tp2[0]),(__tp4==="send"))&&(((__tp5=__tp2[1]),(name=__tp5),true,(__tp5 instanceof Array))&&(((__tp6=__tp5.length),true)&&((__tp6===2)&&(((__tp7=__tp5[0]),(__tp7==="symbol"))&&((sname=__tp5[1]),true,(args=__tp2[2]),true,(body=expr[2]),true)))))))))))))){(void 0);}else{throw "a condition failed";}var fn=["send",["symbol","->"],["data",args,body]];var code=generate_from_ast(fn);var efn=eval((("("+code.slice(0,(-1)))+")"));env.register_macro(sname,efn);return ["value",undefined];});stdenv.register_macro("match",function(__t849,__t848){var __tp0;var context;var env;if(((__t849 instanceof Array)&&(((__tp0=__t849.length),true)&&((__tp0===2)&&((context=__t849[0]),true,(env=__t849[1]),true))))){(void 0);}else{throw "a condition failed";}var __t850=__t848;var __tp0;var __tp1;var __tp0;var __tp1;var obj;var clauses;var __tp0;var __tp1;var clauses;var __t851=false;var __t852=false;if(((__t851=(__t850 instanceof Array))&&((__t852=((__tp0=__t850.length),true))&&((__tp0===1)&&((__tp1=__t850[0]),(__tp1==="void")))))){return ["placeholder"];}else{if((__t852&&((__tp0===3)&&(((__tp1=__t850[0]),(__tp1==="data"))&&((obj=__t850[1]),true,(clauses=__t850[2]),true))))){return ["send",["symbol","|>"],["data",obj,clauses]];}else{if((__t852&&((__tp0===2)&&(((__tp1=__t850[0]),(__tp1==="data"))&&((clauses=__t850[1]),true))))){return ["send",["symbol","|>"],["data",["value",null],clauses]];}else{throw ["Could not find a match",__t850];}}}});(exports["stdenv"]=stdenv);
