require("earlgrey-runtime");
var $3825=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});var accum$1008;var accum$1012;var accum$1436;var accum$1440;var accum$3635;var accum$3639;var $725$765;var __lt____gt__$766;var $726$767;var __lt____lt____colon__$768;var util$769;var classify$770;var GenSym$771;var gensym$772;var $728$773;var PatternParser$774;var PatternProcessor$775;var Scope$776;var Env$777;var track_location$778;var Expander$779;var mac1$780;var __chk_ncache$781;var __chk_scache$782;var checker_db$783;($725$765=require("./pp"));(__lt____gt__$766=$725$765["<>"]);($726$767=require("./location"));(__lt____lt____colon__$768=$726$767["<<:"]);(util$769=require("./util"));(classify$770=util$769.classify);(GenSym$771=util$769.GenSym);(gensym$772=util$769.gensym);($728$773=require("./pattern"));(PatternParser$774=$728$773.PatternParser);(PatternProcessor$775=$728$773.PatternProcessor);(Scope$776=(function(){var t0$837;var $828$832;var it$0$823;(it$0$823=(function(){if((!getChecker(Scope$776)(this))){return Object.create(Scope$776.prototype);}else{return this;}})());($828$832=arguments);(t0$837=$828$832.length);if(((t0$837>=0)&&(t0$837<=3))){(it$0$823["parent"]=(function(){if((0>=t0$837)){return null;}else{return $828$832[0];}})());(it$0$823["name"]=(function(){if((1>=t0$837)){return gensym$772("scope");}else{return $828$832[1];}})());(it$0$823["expander"]=(function(){if((2>=t0$837)){return it$0$823.parent.expander;}else{return $828$832[2];}})());(it$0$823["options"]=({}));}else{___match_error($828$832);}return it$0$823;}));(Scope$776.prototype["getopt"]=(function(opt$858){var otherwise$895;var $875$884;var $871$878;var it$0$862;var self$863;(it$0$862=this);(self$863=this);($871$878=null);$871$878;if(Object.prototype.hasOwnProperty.call(it$0$862.options,opt$858)){return $3825(it$0$862.options,opt$858);}else{if((it$0$862.parent===null)){return (void 0);}else{(otherwise$895=$871$878);return it$0$862.parent.getopt(opt$858);}}}));(Scope$776.prototype["setopt"]=(function(opt$901,value$902){var it$0$906;var self$907;(it$0$906=this);(self$907=this);(it$0$906.options[opt$901]=value$902);}));(Scope$776.prototype["gensym"]=(function(){var it$0$926;var self$927;(it$0$926=this);(self$927=this);return it$0$926.expander.gensym();}));(Scope$776.prototype["step"]=(function(context$939,expr$940){var it$0$944;var self$945;(it$0$944=this);(self$945=this);return it$0$944.expander.step(context$939,it$0$944,expr$940);}));(Scope$776.prototype["step_all"]=(function(context$957,exprs$958){var it$0$962;var self$963;(it$0$962=this);(self$963=this);return it$0$962.expander.step_all(context$957,it$0$962,exprs$958);}));(Scope$776.prototype["expand"]=(function(context$975,expr$976){var it$0$980;var self$981;(it$0$980=this);(self$981=this);return it$0$980.expander.expand(context$975,it$0$980,expr$976);}));(Scope$776.prototype["toString"]=(function(){var it$0$996;var self$997;(it$0$996=this);(self$997=this);return (("Scope{"+it$0$996.name)+"}");}));__amp____colon__(Scope$776,__amp____colon__(((accum$1008=({})),((accum$1008["::name"]="Scope"),accum$1008)),((accum$1012=({})),((accum$1012["::egclass"]=true),accum$1012))));Scope$776;(Env$777=(function(){var it$0$1021;(it$0$1021=(function(){if((!getChecker(Env$777)(this))){return Object.create(Env$777.prototype);}else{return this;}})());(it$0$1021["scopes"]=({}));return it$0$1021;}));(Env$777.prototype["list_bindings"]=(function(origin$1036){var values$1052;var scope$1053;var it$0$1040;var self$1041;(it$0$1040=this);(self$1041=this);(values$1052=({}));(scope$1053=origin$1036);$1060:while(scope$1053){__amp____colon__(values$1052,$3825(it$0$1040.scopes,scope$1053.name));(scope$1053=scope$1053.parent);}return values$1052;}));(Env$777.prototype["resolve"]=(function(scope$1072,name$1073){var scope_data$1088;var it$0$1077;var self$1078;(it$0$1077=this);(self$1078=this);if((scope$1072===null)){return (void 0);}(scope_data$1088=$3825(it$0$1077.scopes,scope$1072.name));if((scope_data$1088&&Object.prototype.hasOwnProperty.call(scope_data$1088,name$1073))){return $3825(scope_data$1088,name$1073);}else{return it$0$1077.resolve(scope$1072.parent,name$1073);}}));(Env$777.prototype["bind"]=(function(scope$1097,name$1098,value$1099){var it$0$1103;var self$1104;(it$0$1103=this);(self$1104=this);if((!$3825(it$0$1103.scopes,scope$1097.name))){(it$0$1103.scopes[scope$1097.name]=({}));}($3825(it$0$1103.scopes,scope$1097.name)[name$1098]=value$1099);}));(Env$777.prototype["mark"]=(function(expr$1126){var x$1193;var x$1199;var bridge$1145$1185;var x$1205;var bridge$1144$1178;var x$1211;var bridge$1143$1171;var x$1217;var $index$1252;var $length$1246;var temp$1240;var other$1273;var type$1224;var args$1225;var e$1160;var bridge$1142$1155;var t0$1156;var $1139$1150;var it$0$1130;var self$1131;(it$0$1130=this);(self$1131=this);($1139$1150=expr$1126);if(___hasprop($1139$1150,"env")){(e$1160=$1139$1150.env);return expr$1126;}else{(bridge$1142$1155=$1139$1150);if(((((bridge$1143$1171=bridge$1142$1155)),((((bridge$1144$1178=bridge$1143$1171)),((((bridge$1145$1185=bridge$1144$1178)),((((x$1193=bridge$1145$1185)),((x$1193 instanceof Array)&&(x$1193[0]==="symbol")))||(((x$1199=bridge$1145$1185)),((x$1199 instanceof Array)&&(x$1199[0]==="value")))))||(((x$1205=bridge$1144$1178)),((x$1205 instanceof Array)&&(x$1205[0]==="variable")))))||(((x$1211=bridge$1143$1171)),((x$1211 instanceof Array)&&(x$1211[0]==="macro")))))||(((x$1217=bridge$1142$1155)),((x$1217 instanceof Array)&&(x$1217[0]==="void"))))){return __amp____colon__(expr$1126,({"env":it$0$1130}));}else{if((($1139$1150 instanceof Array)&&(((t0$1156=$1139$1150.length)),(t0$1156>=1)))){(type$1224=$1139$1150[0]);(args$1225=Array.prototype.slice.call($1139$1150,1));(temp$1240=args$1225);($length$1246=temp$1240.length);($index$1252=0);$1234:for(;($index$1252<$length$1246);($index$1252++)){var arg$1269;var m$1261;(m$1261=temp$1240[$index$1252]);(arg$1269=m$1261);it$0$1130.mark(arg$1269);}return __amp____colon__(expr$1126,({"env":it$0$1130}));}else{(other$1273=$1139$1150);return __amp____colon__(expr$1126,({"env":it$0$1130}));}}}}));(Env$777.prototype["fork"]=(function(){var $index$1315;var $length$1309;var temp$1303;var e$1293;var it$0$1282;var self$1283;(it$0$1282=this);(self$1283=this);(e$1293=Env$777());(temp$1303=items(it$0$1282.scopes));($length$1309=temp$1303.length);($index$1315=0);$1294:for(;($index$1315<$length$1309);($index$1315++)){var $index$1370;var $length$1364;var temp$1358;var acc$1352;var scope$1334;var bindings$1335;var t0$1329;var t1$1330;var m$1324;(m$1324=temp$1303[$index$1315]);(t0$1329=m$1324);if(((t0$1329 instanceof Array)&&(((t1$1330=t0$1329.length)),(t1$1330===2)))){(scope$1334=t0$1329[0]);(bindings$1335=t0$1329[1]);(acc$1352=[]);(temp$1358=items(bindings$1335));($length$1364=temp$1358.length);($index$1370=0);$1347:for(;($index$1370<$length$1364);($index$1370++)){var k$1389;var v$1390;var t0$1384;var t1$1385;var m$1379;(m$1379=temp$1358[$index$1370]);(t0$1384=m$1379);if(((t0$1384 instanceof Array)&&(((t1$1385=t0$1384.length)),(t1$1385===2)))){(k$1389=t0$1384[0]);(v$1390=t0$1384[1]);acc$1352.push(((function(){if((!$3825(e$1293.scopes,scope$1334))){(e$1293.scopes[scope$1334]=({}));}})(),(($3825(e$1293.scopes,scope$1334)[k$1389]=v$1390))));}else{___match_error(m$1379,"/home/olivier/git/eg/src/expand.eg",2262,2409);}}acc$1352;}else{___match_error(m$1324,"/home/olivier/git/eg/src/expand.eg",2212,2409);}}return e$1293;}));(Env$777.prototype["toString"]=(function(){var it$0$1424;var self$1425;(it$0$1424=this);(self$1425=this);return "Env{...}";}));__amp____colon__(Env$777,__amp____colon__(((accum$1436=({})),((accum$1436["::name"]="Env"),accum$1436)),((accum$1440=({})),((accum$1440["::egclass"]=true),accum$1440))));Env$777;(track_location$778=(function(f$1447){var f2$1451;(f2$1451=(function(context$1456,scope$1457,expr$1458){var rval$1472;var other$1518;var v$1508;var t0$1504;var $1462$1499;var rval$1465;(rval$1465=(((rval$1472=false)),((function(){try{(rval$1472=f$1447(context$1456,scope$1457,expr$1458));}catch(excv$1483){var e$1489;(e$1489=excv$1483);(rval$1472=(__lt____lt____colon__$768(e$1489,expr$1458),function(){throw e$1489;}()));}})(),rval$1472)));($1462$1499=rval$1465);if((($1462$1499 instanceof Array)&&(((t0$1504=$1462$1499.length)),((t0$1504===2)&&($1462$1499[0]==="bounce"))))){(v$1508=$1462$1499[1]);return f2$1451(context$1456,scope$1457,__lt____lt____colon__$768(v$1508,expr$1458));}else{(other$1518=$1462$1499);return __lt____lt____colon__$768(other$1518,expr$1458);}}));return f2$1451;}));(Expander$779=(function(env_factory$1526,generic_nodes$1527){var it$0$1530;(it$0$1530=(function(){if((!getChecker(Expander$779)(this))){return Object.create(Expander$779.prototype);}else{return this;}})());(it$0$1530["gensym"]=gensym$772);(it$0$1530["mkenv"]=env_factory$1526);(it$0$1530["generic_nodes"]=generic_nodes$1527);return it$0$1530;}));(Expander$779.prototype["run_macro"]=(function(m$1554,context$1555,scope$1556,form$1557,arg$1558){var rval$1581;var rval$1573;var it$0$1562;var self$1563;(it$0$1562=this);(self$1563=this);(rval$1573=(((rval$1581=false)),((function(){try{(rval$1581=m$1554(context$1555,scope$1556,form$1557,arg$1558));}catch(excv$1592){var msg$1649;var msg$1771;var find$1660;var err$1661;var other$1655;var $1632$1637;var e$1629;var e$1779;var value$1602;var t0$1595;var t1$1596;var t2$1597;var t3$1598;(t0$1595=excv$1592);if((getChecker(ErrorFactory(["match"]))(t0$1595)&&(___hasprop(t0$1595,"args")&&(((t1$1596=t0$1595.args)),((t1$1596 instanceof Array)&&(((t2$1597=t1$1596.length)),((t2$1597===1)&&(((t3$1598=t1$1596[0])),___hasprop(t3$1598,"value"))))))))){(value$1602=t3$1598.value);(rval$1581=(((e$1629=((($1632$1637=value$1602)),(function(){if(($1632$1637===context$1555)){(msg$1649="The macro cannot be found in this context.");return ErrorFactory(["syntax","context"]).create(msg$1649,({"context":context$1555,"form":form$1557}));}else{(other$1655=$1632$1637);(find$1660=(function($1665$1668){var t0$1677;var msg$1699;var $index$1733;var $length$1727;var temp$1721;var other$1763;var type$1705;var xs$1706;var t0$1691;var $1670$1686;var ph$1674;var arg$1675;(t0$1677=$1665$1668);(arg$1675=t0$1677);(ph$1674=t0$1677);($1670$1686=ph$1674);if(($1670$1686===value$1602)){(msg$1699="The macro expected something different.");return ErrorFactory(["syntax","argument"]).create(msg$1699,({"context":context$1555,"argument":arg$1675,"form":form$1557}));}else{if((($1670$1686 instanceof Array)&&(((t0$1691=$1670$1686.length)),(t0$1691>=1)))){(type$1705=$1670$1686[0]);(xs$1706=Array.prototype.slice.call($1670$1686,1));(temp$1721=xs$1706);($length$1727=temp$1721.length);($index$1733=0);$1715:for(;($index$1733<$length$1727);($index$1733++)){var x$1751;var t0$1747;var m$1742;(m$1742=temp$1721[$index$1733]);(t0$1747=getProjector(find$1660)(m$1742));if(t0$1747[0]){(x$1751=t0$1747[1]);if(x$1751){return x$1751;}}else{___match_error(m$1742,"/home/olivier/git/eg/src/expand.eg",3668,3753);}}return false;}else{(other$1763=$1670$1686);return false;}}}));(err$1661=find$1660(arg$1558));if(err$1661){return err$1661;}else{(msg$1771="The macro expected something different (could not locate error in the source).");return ErrorFactory(["syntax","failure"]).create(msg$1771,({"form":form$1557,"value":value$1602}));}}})()))),function(){throw e$1629;}()));}else{(e$1779=excv$1592);(rval$1581=function(){throw e$1779;}());}}})(),rval$1581)));return it$0$1562.mkenv().mark(rval$1573);}));(Expander$779.prototype["step"]=(function(context$1790,scope$1791,expr$1792){var helper$1807;var it$0$1796;var self$1797;(it$0$1796=this);(self$1797=this);(helper$1807=track_location$778((function(context$1814,scope$1815,$1811$1816){var t0$1830;var other$1885;var env$1880;var $1867$1872;var other$1930;var t0$1917;var $1907$1912;var other$1934;var m$1899;var t0$1895;var $1861$1890;var env$1864;var other$1964;var t0$1951;var $1941$1946;var other$1996;var m$1986;var t0$1982;var $1972$1977;var other$2005;var x$2000;var f$1968;var arg$1969;var m$1938;var s$1851;var $1824$1846;var $1825$1847;var $1826$1848;var t0$1844;var $1818$1839;var ph$1827;var expr$1828;(t0$1830=$1811$1816);(expr$1828=t0$1830);(ph$1827=t0$1830);($1818$1839=ph$1827);if((($1824$1846=($1818$1839 instanceof Array))&&(((t0$1844=$1818$1839.length)),(($1826$1848=(t0$1844===2))&&($1818$1839[0]==="symbol"))))){(s$1851=$1818$1839[1]);(env$1864=((($1867$1872=expr$1828)),(function(){if(___hasprop($1867$1872,"env")){(env$1880=$1867$1872.env);return expr$1828.env;}else{(other$1885=$1867$1872);throw ErrorFactory(["syntax","no_env"]).create("No environment was found to resolve",({"symbol":expr$1828}));}})()));($1861$1890=env$1864.resolve(scope$1815,s$1851));if((($1861$1890 instanceof Array)&&(((t0$1895=$1861$1890.length)),((t0$1895===2)&&($1861$1890[0]==="macro"))))){(m$1899=$1861$1890[1]);($1907$1912=context$1814);if((($1907$1912 instanceof Array)&&(((t0$1917=$1907$1912.length)),((t0$1917===2)&&(($1907$1912[0]==="expr")&&($1907$1912[1]==="head")))))){return ["macro",m$1899];}else{(other$1930=$1907$1912);return ["bounce",it$0$1796.run_macro(m$1899,context$1814,scope$1815,expr$1828,__lt____lt____colon__$768(["void"],expr$1828))];}}else{(other$1934=$1861$1890);return expr$1828;}}else{if(($1826$1848&&($1818$1839[0]==="macro"))){(m$1938=$1818$1839[1]);($1941$1946=context$1814);if((($1941$1946 instanceof Array)&&(((t0$1951=$1941$1946.length)),((t0$1951===2)&&(($1941$1946[0]==="expr")&&($1941$1946[1]==="head")))))){return expr$1828;}else{(other$1964=$1941$1946);return ["bounce",it$0$1796.run_macro(m$1938,context$1814,scope$1815,expr$1828,__lt____lt____colon__$768(["void"],expr$1828))];}}else{if(($1824$1846&&((t0$1844===3)&&($1818$1839[0]==="send")))){(f$1968=$1818$1839[1]);(arg$1969=$1818$1839[2]);($1972$1977=helper$1807(["expr","head"],scope$1815,f$1968));if((($1972$1977 instanceof Array)&&(((t0$1982=$1972$1977.length)),((t0$1982===2)&&($1972$1977[0]==="macro"))))){(m$1986=$1972$1977[1]);return ["bounce",it$0$1796.run_macro(m$1986,context$1814,scope$1815,expr$1828,arg$1969)];}else{(other$1996=$1972$1977);return expr$1828;}}else{if(($1824$1846&&((t0$1844===2)&&($1818$1839[0]==="nostep")))){(x$2000=$1818$1839[1]);return x$2000;}else{(other$2005=$1818$1839);return expr$1828;}}}}})));return helper$1807(context$1790,scope$1791,expr$1792);}));(Expander$779.prototype["step_all"]=(function(context$2014,scope$2015,$2011$2016){var t0$2031;var t1$2032;var pre$2049;var bulk$2050;var post$2051;var stmts$2029;var it$0$2020;var self$2021;(it$0$2020=this);(self$2021=this);(t0$2031=$2011$2016);if(((t0$2031 instanceof Array)&&(((t1$2032=t0$2031.length)),(t1$2032>=0)))){(stmts$2029=Array.prototype.slice.call(t0$2031,0));}else{___match_error($2011$2016);}(pre$2049=[]);(bulk$2050=[]);(post$2051=[]);$2061:while(stmts$2029.length){var $index$2152;var $length$2146;var temp$2140;var acc$2134;var e$2123;var x$2175;var m$2117;var stmt$2112;var stmt$2107;var prepend$2093;var $2072$2088;var $2073$2089;var $2074$2090;var t0$2086;var $2066$2081;var current$2075;(current$2075=stmts$2029.shift());($2066$2081=it$0$2020.step(context$2014,scope$2015,current$2075));if((($2072$2088=($2066$2081 instanceof Array))&&(((t0$2086=$2066$2081.length)),((t0$2086>=1)&&($2066$2081[0]==="splice"))))){(prepend$2093=Array.prototype.slice.call($2066$2081,1));(stmts$2029=prepend$2093.concat(stmts$2029));}else{if(($2072$2088&&(($2074$2090=(t0$2086===2))&&($2066$2081[0]==="float")))){(stmt$2107=$2066$2081[1]);(pre$2049=pre$2049.concat(it$0$2020.step_all(context$2014,scope$2015,[stmt$2107])));}else{if(($2074$2090&&($2066$2081[0]==="sink"))){(stmt$2112=$2066$2081[1]);(post$2051=post$2051.concat(it$0$2020.step_all(context$2014,scope$2015,[stmt$2112])));}else{if(($2074$2090&&($2066$2081[0]==="restmacro"))){(m$2117=$2066$2081[1]);(e$2123=it$0$2020.mkenv());(stmts$2029=(((acc$2134=[])),(((temp$2140=m$2117(stmts$2029))),((($length$2146=temp$2140.length)),((($index$2152=0)),(function(){$2129:for(;($index$2152<$length$2146);($index$2152++)){var stmt$2169;var m$2161;(m$2161=temp$2140[$index$2152]);(stmt$2169=m$2161);acc$2134.push(e$2123.mark(stmt$2169));}})()))),acc$2134));}else{(x$2175=$2066$2081);bulk$2050.push(x$2175);}}}}}return pre$2049.concat(bulk$2050).concat(post$2051);}));(Expander$779.prototype["expand"]=(function(context$2181,scope$2182,expr$2183){var helper$2198;var it$0$2187;var self$2188;(it$0$2187=this);(self$2188=this);(helper$2198=track_location$778((function(context$2203,scope$2204,expr$2205){var t0$2270;var other$2292;var $2265$2280;var env$2268;var $index$2345;var $length$2339;var temp$2333;var acc$2327;var newargs$2319;var $index$2399;var $length$2393;var temp$2387;var acc$2381;var newargs$2373;var t0$2463;var newscope$2457;var env$2458;var $index$2547;var $length$2541;var temp$2535;var acc$2529;var $index$2759;var $length$2753;var temp$2747;var acc$2741;var t0$2508;var newscope$2492;var stepscope$2493;var changes$2494;var newargs$2495;var vars$2496;var exp$2497;var $index$3182;var $length$3176;var temp$3170;var other$3286;var t0$3264;var $3253$3259;var is_obj$3061;var obj$3062;var arr$3063;var arr_parts$3064;var obj_parts$3065;var new_arr_part$3066;var new_obj_part$3067;var r$3068;var x$3324;var msg$3331;var otherwise$3347;var m$3337;var t0$3317;var $3302$3312;var t$3306;var $index$3391;var $length$3385;var temp$3379;var acc$3373;var newscope$3361;var s$3470;var newscope$3483;var name$3461;var t0$3457;var $index$3527;var $length$3521;var temp$3515;var acc$3509;var $index$3583;var $length$3577;var temp$3571;var acc$3565;var tokens$3556;var msg$3557;var other$3629;var c$3624;var ops$3549;var args$3550;var type$3498;var args$3499;var tag$3487;var body$3488;var x$3452;var $2225$3453;var bindings$3355;var body$3356;var target$3296;var value$3297;var args$3049;var args$2483;var args$2478;var args$2473;var variable$2437;var s$2438;var value$2439;var body$2440;var args$2368;var args$2314;var f$2308;var arg$2309;var s$2255;var $2233$2250;var $2234$2251;var $2235$2252;var t0$2246;var t1$2247;var t2$2248;var $2209$2241;(expr$2205=it$0$2187.step(context$2203,scope$2204,expr$2205));($2209$2241=expr$2205);if((($2233$2250=($2209$2241 instanceof Array))&&(((t0$2246=$2209$2241.length)),(($2235$2252=(t0$2246===2))&&($2209$2241[0]==="symbol"))))){(s$2255=$2209$2241[1]);(t0$2270=expr$2205);if(___hasprop(t0$2270,"env")){(env$2268=t0$2270.env);}else{___match_error(expr$2205,"/home/olivier/git/eg/src/expand.eg",8143,8147);}($2265$2280=env$2268.resolve(scope$2204,s$2255));if(($2265$2280===(void 0))){throw ErrorFactory(["syntax","undeclared"]).create(("Undeclared variable: "+s$2255),({"node":expr$2205}));}else{(other$2292=$2265$2280);return ["bounce",other$2292];}}else{if(($2235$2252&&($2209$2241[0]==="value"))){$2209$2241[1];return expr$2205;}else{if(($2235$2252&&($2209$2241[0]==="variable"))){$2209$2241[1];return expr$2205;}else{if(($2233$2250&&((t0$2246===1)&&($2209$2241[0]==="void")))){return expr$2205;}else{if(($2233$2250&&((t0$2246===3)&&($2209$2241[0]==="send")))){(f$2308=$2209$2241[1]);(arg$2309=$2209$2241[2]);return ["send",helper$2198(["expr","head"],scope$2204,f$2308),helper$2198(["expr","tail"],scope$2204,arg$2309)];}else{if(($2233$2250&&(($2235$2252=(t0$2246>=1))&&($2209$2241[0]==="array")))){(args$2314=Array.prototype.slice.call($2209$2241,1));(newargs$2319=(((acc$2327=[])),(((temp$2333=it$0$2187.step_all(["expr","array"],scope$2204,args$2314))),((($length$2339=temp$2333.length)),((($index$2345=0)),(function(){$2322:for(;($index$2345<$length$2339);($index$2345++)){var arg$2362;var m$2354;(m$2354=temp$2333[$index$2345]);(arg$2362=m$2354);acc$2327.push(helper$2198(["expr","expr"],scope$2204,arg$2362));}})()))),acc$2327));return ["array"].concat(newargs$2319);}else{if(($2235$2252&&($2209$2241[0]==="object"))){(args$2368=Array.prototype.slice.call($2209$2241,1));(newargs$2373=(((acc$2381=[])),(((temp$2387=it$0$2187.step_all(["expr","object"],scope$2204,args$2368))),((($length$2393=temp$2387.length)),((($index$2399=0)),(function(){$2376:for(;($index$2399<$length$2393);($index$2399++)){var k$2418;var v$2419;var t0$2413;var t1$2414;var m$2408;(m$2408=temp$2387[$index$2399]);(t0$2413=m$2408);if(((t0$2413 instanceof Array)&&(((t1$2414=t0$2413.length)),((t1$2414===3)&&(t0$2413[0]==="array"))))){(k$2418=t0$2413[1]);(v$2419=t0$2413[2]);acc$2381.push(["array",helper$2198(["expr","expr"],scope$2204,k$2418),helper$2198(["expr","expr"],scope$2204,v$2419)]);}else{___match_error(m$2408,"/home/olivier/git/eg/src/expand.eg",8986,9175);}}})()))),acc$2381));return ["object"].concat(newargs$2373);}else{if(($2233$2250&&((t0$2246===4)&&(($2209$2241[0]==="bind")&&(((t1$2247=$2209$2241[1])),((variable$2437=t1$2247),((t1$2247 instanceof Array)&&(((t2$2248=t1$2247.length)),((t2$2248===2)&&(t1$2247[0]==="symbol")))))))))){(s$2438=t1$2247[1]);(value$2439=$2209$2241[2]);(body$2440=$2209$2241[3]);(newscope$2457=Scope$776(scope$2204));(t0$2463=variable$2437);if(___hasprop(t0$2463,"env")){(env$2458=t0$2463.env);}else{___match_error(variable$2437,"/home/olivier/git/eg/src/expand.eg",9318,9326);}env$2458.bind(newscope$2457,s$2438,value$2439);return helper$2198(context$2203,newscope$2457,body$2440);}else{if(($2233$2250&&(($2235$2252=(t0$2246>=1))&&($2209$2241[0]==="splice")))){(args$2473=Array.prototype.slice.call($2209$2241,1));return ["bounce",__amp____colon__(["multi"].concat(args$2473),({"override_scope":true}))];}else{if(($2235$2252&&($2209$2241[0]==="interactive"))){(args$2478=Array.prototype.slice.call($2209$2241,1));return ["bounce",__amp____colon__(["multi"].concat(args$2478),({"override_scope":true,"all_mutable":true}))];}else{if(($2235$2252&&($2209$2241[0]==="multi"))){(args$2483=Array.prototype.slice.call($2209$2241,1));(newscope$2492=(function(){if(expr$2205.override_scope){return scope$2204;}else{return Scope$776(scope$2204);}})());(stepscope$2493=(function(){if(expr$2205.nonrecursive){return scope$2204;}else{return newscope$2492;}})());(changes$2494=false);(t0$2508=classify$770("newargs","vars",(((acc$2529=[])),(((temp$2535=it$0$2187.step_all(["expr","multi"],stepscope$2493,args$2483))),((($length$2541=temp$2535.length)),((($index$2547=0)),(function(){$2513:for(;($index$2547<$length$2541);($index$2547++)){var t0$2613;var env$2611;var t0$2647;var v$2658;var env$2645;var t0$2705;var env$2703;var other$2718;var s$2685;var variable$2686;var v$2667;var value$2668;var variable$2626;var s$2627;var value$2628;var variable$2591;var s$2592;var value$2593;var opt$2574;var value$2575;var $2521$2566;var $2522$2567;var $2523$2568;var $2524$2569;var $2525$2570;var $2526$2571;var t0$2561;var t1$2562;var t2$2563;var t3$2564;var m$2556;(m$2556=temp$2535[$index$2547]);(t0$2561=m$2556);if((($2522$2567=(t0$2561 instanceof Array))&&(((t1$2562=t0$2561.length)),(($2524$2569=(t1$2562===3))&&(t0$2561[0]==="option"))))){(opt$2574=t0$2561[1]);(value$2575=t0$2561[2]);acc$2529.push((newscope$2492.setopt(opt$2574,value$2575),["ignore"]));}else{if(($2524$2569&&((t0$2561[0]==="declare_raw")&&(((t2$2563=t0$2561[1])),((variable$2591=t2$2563),((t2$2563 instanceof Array)&&(((t3$2564=t2$2563.length)),((t3$2564===2)&&(t2$2563[0]==="symbol"))))))))){(s$2592=t2$2563[1]);(value$2593=t0$2561[2]);acc$2529.push(((((t0$2613=variable$2591)),(function(){if(___hasprop(t0$2613,"env")){(env$2611=t0$2613.env);}else{return ___match_error(variable$2591,"/home/olivier/git/eg/src/expand.eg",10272,10280);}})()),env$2611.bind(newscope$2492,s$2592,value$2593),((changes$2494=true)),["ignore"]));}else{if(($2522$2567&&(($2524$2569=((t1$2562>=2)&&(t1$2562<=3)))&&(($2525$2570=(t0$2561[0]==="declare"))&&(((t2$2563=t0$2561[1])),((variable$2626=t2$2563),((t2$2563 instanceof Array)&&(((t3$2564=t2$2563.length)),((t3$2564===2)&&(t2$2563[0]==="symbol")))))))))){(s$2627=t2$2563[1]);(value$2628=(function(){if((2>=t1$2562)){return null;}else{return t0$2561[2];}})());acc$2529.push(((((t0$2647=variable$2626)),(function(){if(___hasprop(t0$2647,"env")){(env$2645=t0$2647.env);}else{return ___match_error(variable$2626,"/home/olivier/git/eg/src/expand.eg",10520,10528);}})()),(function(){if((variable$2626.use_previous&&env$2645.resolve(newscope$2492,s$2627))){return ["splice"];}else{(v$2658=__lt____lt____colon__$768(["variable",it$0$2187.gensym(s$2627)],variable$2626));__amp____colon__(v$2658,({"mutable":(expr$2205.all_mutable||variable$2626.mutable)}));env$2645.bind(newscope$2492,s$2627,v$2658);(changes$2494=true);if(value$2628){return ["splice",["newargs",["assign",v$2658,value$2628]],["vars",v$2658]];}else{return ["vars",v$2658];}}})()));}else{if(($2525$2570&&((v$2667=t2$2563),((t2$2563 instanceof Array)&&(((t3$2564=t2$2563.length)),((t3$2564===2)&&(t2$2563[0]==="variable"))))))){t2$2563[1];(value$2668=(function(){if((2>=t1$2562)){return null;}else{return t0$2561[2];}})());acc$2529.push((((changes$2494=true)),(function(){if(value$2668){return ["splice",["newargs",["assign",v$2667,value$2668]],["vars",v$2667]];}else{return ["vars",v$2667];}})()));}else{if(($2522$2567&&((t1$2562===2)&&((t0$2561[0]==="undeclare")&&(((t2$2563=t0$2561[1])),((t2$2563 instanceof Array)&&(((t3$2564=t2$2563.length)),((t3$2564===2)&&(t2$2563[0]==="symbol"))))))))){(s$2685=t2$2563[1]);(variable$2686=t2$2563);acc$2529.push(((((t0$2705=variable$2686)),(function(){if(___hasprop(t0$2705,"env")){(env$2703=t0$2705.env);}else{return ___match_error(variable$2686,"/home/olivier/git/eg/src/expand.eg",11792,11800);}})()),env$2703.bind(newscope$2492,s$2685,(void 0)),((changes$2494=true)),["ignore"]));}else{(other$2718=m$2556);acc$2529.push(["newargs",other$2718]);}}}}}}})()))),acc$2529)));if((___hasprop(t0$2508,"newargs")&&((newargs$2495=t0$2508.newargs),___hasprop(t0$2508,"vars")))){(vars$2496=t0$2508.vars);}else{___match_error(classify$770("newargs","vars",(((acc$2741=[])),(((temp$2747=it$0$2187.step_all(["expr","multi"],stepscope$2493,args$2483))),((($length$2753=temp$2747.length)),((($index$2759=0)),(function(){$2725:for(;($index$2759<$length$2753);($index$2759++)){var t0$2825;var env$2823;var t0$2859;var v$2870;var env$2857;var t0$2917;var env$2915;var other$2930;var s$2897;var variable$2898;var v$2879;var value$2880;var variable$2838;var s$2839;var value$2840;var variable$2803;var s$2804;var value$2805;var opt$2786;var value$2787;var $2733$2778;var $2734$2779;var $2735$2780;var $2736$2781;var $2737$2782;var $2738$2783;var t0$2773;var t1$2774;var t2$2775;var t3$2776;var m$2768;(m$2768=temp$2747[$index$2759]);(t0$2773=m$2768);if((($2734$2779=(t0$2773 instanceof Array))&&(((t1$2774=t0$2773.length)),(($2736$2781=(t1$2774===3))&&(t0$2773[0]==="option"))))){(opt$2786=t0$2773[1]);(value$2787=t0$2773[2]);acc$2741.push((newscope$2492.setopt(opt$2786,value$2787),["ignore"]));}else{if(($2736$2781&&((t0$2773[0]==="declare_raw")&&(((t2$2775=t0$2773[1])),((variable$2803=t2$2775),((t2$2775 instanceof Array)&&(((t3$2776=t2$2775.length)),((t3$2776===2)&&(t2$2775[0]==="symbol"))))))))){(s$2804=t2$2775[1]);(value$2805=t0$2773[2]);acc$2741.push(((((t0$2825=variable$2803)),(function(){if(___hasprop(t0$2825,"env")){(env$2823=t0$2825.env);}else{return ___match_error(variable$2803,"/home/olivier/git/eg/src/expand.eg",10272,10280);}})()),env$2823.bind(newscope$2492,s$2804,value$2805),((changes$2494=true)),["ignore"]));}else{if(($2734$2779&&(($2736$2781=((t1$2774>=2)&&(t1$2774<=3)))&&(($2737$2782=(t0$2773[0]==="declare"))&&(((t2$2775=t0$2773[1])),((variable$2838=t2$2775),((t2$2775 instanceof Array)&&(((t3$2776=t2$2775.length)),((t3$2776===2)&&(t2$2775[0]==="symbol")))))))))){(s$2839=t2$2775[1]);(value$2840=(function(){if((2>=t1$2774)){return null;}else{return t0$2773[2];}})());acc$2741.push(((((t0$2859=variable$2838)),(function(){if(___hasprop(t0$2859,"env")){(env$2857=t0$2859.env);}else{return ___match_error(variable$2838,"/home/olivier/git/eg/src/expand.eg",10520,10528);}})()),(function(){if((variable$2838.use_previous&&env$2857.resolve(newscope$2492,s$2839))){return ["splice"];}else{(v$2870=__lt____lt____colon__$768(["variable",it$0$2187.gensym(s$2839)],variable$2838));__amp____colon__(v$2870,({"mutable":(expr$2205.all_mutable||variable$2838.mutable)}));env$2857.bind(newscope$2492,s$2839,v$2870);(changes$2494=true);if(value$2840){return ["splice",["newargs",["assign",v$2870,value$2840]],["vars",v$2870]];}else{return ["vars",v$2870];}}})()));}else{if(($2737$2782&&((v$2879=t2$2775),((t2$2775 instanceof Array)&&(((t3$2776=t2$2775.length)),((t3$2776===2)&&(t2$2775[0]==="variable"))))))){t2$2775[1];(value$2880=(function(){if((2>=t1$2774)){return null;}else{return t0$2773[2];}})());acc$2741.push((((changes$2494=true)),(function(){if(value$2880){return ["splice",["newargs",["assign",v$2879,value$2880]],["vars",v$2879]];}else{return ["vars",v$2879];}})()));}else{if(($2734$2779&&((t1$2774===2)&&((t0$2773[0]==="undeclare")&&(((t2$2775=t0$2773[1])),((t2$2775 instanceof Array)&&(((t3$2776=t2$2775.length)),((t3$2776===2)&&(t2$2775[0]==="symbol"))))))))){(s$2897=t2$2775[1]);(variable$2898=t2$2775);acc$2741.push(((((t0$2917=variable$2898)),(function(){if(___hasprop(t0$2917,"env")){(env$2915=t0$2917.env);}else{return ___match_error(variable$2898,"/home/olivier/git/eg/src/expand.eg",11792,11800);}})()),env$2915.bind(newscope$2492,s$2897,(void 0)),((changes$2494=true)),["ignore"]));}else{(other$2930=m$2768);acc$2741.push(["newargs",other$2930]);}}}}}}})()))),acc$2741)),"/home/olivier/git/eg/src/expand.eg",9944,12022);}(exp$2497=(function(s$2937){var $index$2970;var $length$2964;var temp$2958;var acc$2952;var $index$3026;var $length$3020;var temp$3014;var acc$3008;var stepped$2941;(stepped$2941=(((acc$2952=[])),(((temp$2958=enumerate(newargs$2495))),((($length$2964=temp$2958.length)),((($index$2970=0)),(function(){$2947:for(;($index$2970<$length$2964);($index$2970++)){var i$2989;var arg$2990;var t0$2984;var t1$2985;var m$2979;(m$2979=temp$2958[$index$2970]);(t0$2984=m$2979);if(((t0$2984 instanceof Array)&&(((t1$2985=t0$2984.length)),(t1$2985===2)))){(i$2989=t0$2984[0]);(arg$2990=t0$2984[1]);acc$2952.push(it$0$2187.step(["expr",(function(){if((i$2989===(newargs$2495.length-1))){return "expr";}else{return "ignore";}})()],s$2937,arg$2990));}else{___match_error(m$2979,"/home/olivier/git/eg/src/expand.eg",12244,12421);}}})()))),acc$2952));(acc$3008=[]);(temp$3014=stepped$2941);($length$3020=temp$3014.length);($index$3026=0);$2942:for(;($index$3026<$length$3020);($index$3026++)){var arg$3043;var m$3035;(m$3035=temp$3014[$index$3026]);(arg$3043=m$3035);acc$3008.push(helper$2198(["expr","expr"],s$2937,arg$3043));}return acc$3008;}));if(changes$2494){return ["scope",vars$2496,["multi"].concat(exp$2497(newscope$2492))];}else{return ["multi"].concat(exp$2497(scope$2204));}}else{if(($2235$2252&&($2209$2241[0]==="data"))){(args$3049=Array.prototype.slice.call($2209$2241,1));(is_obj$3061=false);(obj$3062=["object"]);(arr$3063=["array"]);(arr_parts$3064=[]);(obj_parts$3065=[]);(new_arr_part$3066=(function(){var other$3123;var t0$3110;var $3100$3105;($3100$3105=arr$3063);if((($3100$3105 instanceof Array)&&(((t0$3110=$3100$3105.length)),((t0$3110===1)&&($3100$3105[0]==="array"))))){return false;}else{(other$3123=$3100$3105);arr_parts$3064.push(arr$3063);(arr$3063=["array"]);}}));(new_obj_part$3067=(function(){var other$3159;var t0$3146;var $3136$3141;($3136$3141=obj$3062);if((($3136$3141 instanceof Array)&&(((t0$3146=$3136$3141.length)),((t0$3146===1)&&($3136$3141[0]==="object"))))){return false;}else{(other$3159=$3136$3141);obj_parts$3065.push(obj$3062);(obj$3062=["object"]);}}));(temp$3170=it$0$2187.step_all(["expr","data"],scope$2204,args$3049));($length$3176=temp$3170.length);($index$3182=0);$3069:for(;($index$3182<$length$3176);($index$3182++)){var other$3249;var expr$3239;var expr$3233;var k$3222;var v$3223;var $3076$3199;var $3077$3200;var $3078$3201;var $3079$3202;var t0$3196;var t1$3197;var m$3191;(m$3191=temp$3170[$index$3182]);(t0$3196=m$3191);if((($3077$3200=(t0$3196 instanceof Array))&&(((t1$3197=t0$3196.length)),((t1$3197===1)&&(t0$3196[0]==="assoc"))))){(is_obj$3061=true);}else{if(($3077$3200&&((t1$3197===3)&&(t0$3196[0]==="assoc")))){(k$3222=t0$3196[1]);(v$3223=t0$3196[2]);(is_obj$3061=true);obj$3062.push(["array",k$3222,v$3223]);}else{if(($3077$3200&&(($3079$3202=(t1$3197===2))&&(t0$3196[0]==="dynsplice")))){(expr$3233=t0$3196[1]);new_arr_part$3066();arr_parts$3064.push(expr$3233);}else{if(($3079$3202&&(t0$3196[0]==="objsplice"))){(expr$3239=t0$3196[1]);(is_obj$3061=true);new_obj_part$3067();obj_parts$3065.push(expr$3239);}else{(other$3249=m$3191);arr$3063.push(other$3249);}}}}}new_arr_part$3066();new_obj_part$3067();(r$3068=((($3253$3259=arr_parts$3064)),(function(){if((($3253$3259 instanceof Array)&&(((t0$3264=$3253$3259.length)),((t0$3264===0)&&is_obj$3061)))){return util$769.construct(obj_parts$3065,(function(x$3277,rest$3278){return ["send",["symbol","&:"],["data",x$3277,rest$3278]];}),["object"]);}else{$3253$3259;if(is_obj$3061){throw ErrorFactory(["syntax","array","object"]).create("Cannot mix array and object notations.");}else{(other$3286=$3253$3259);return util$769.construct(arr_parts$3064.reverse(),(function(x$3290,rest$3291){return ["send",["send",rest$3291,["send",["symbol","."],["data",["void"],["symbol","concat"]]]],["data",x$3290]];}),["array"]);}}})()));return helper$2198(context$2203,scope$2204,it$0$2187.mkenv().mark(r$3068));}else{if(($2233$2250&&(($2235$2252=(t0$2246===3))&&($2209$2241[0]==="assign")))){(target$3296=$2209$2241[1]);(value$3297=$2209$2241[2]);(t$3306=helper$2198(["expr","expr"],scope$2204,target$3296));($3302$3312=t$3306);if(((((x$3324=$3302$3312)),((x$3324 instanceof Array)&&(x$3324[0]==="variable")))&&(((!t$3306.mutable)&&t$3306.assigned)&&(t$3306.assigned.group_id!==target$3296.group_id)))){(msg$3331=["Variable was declared as read-only. Declare it as","mutable at the origin with `var` (if you have access","to the declaration) or declare a new variable with","`let` or `var` or remove the original binding with","`delete`"].join(" "));throw ErrorFactory(["syntax"]).create(msg$3331,({"variable":target$3296,"loc":t$3306.assigned}));}else{if((($3302$3312 instanceof Array)&&(((t0$3317=$3302$3312.length)),((t0$3317===2)&&($3302$3312[0]==="macro"))))){(m$3337=$3302$3312[1]);["bounce",m$3337(["assign"],scope$2204,expr$2205,value$3297)];}else{(otherwise$3347=$3302$3312);(t$3306["assigned"]=target$3296);}}return ["assign",t$3306,helper$2198(["expr","expr"],scope$2204,value$3297)];}else{if(($2235$2252&&($2209$2241[0]==="lambda"))){(bindings$3355=$2209$2241[1]);(body$3356=$2209$2241[2]);(newscope$3361=Scope$776(scope$2204));return ["lambda",(((acc$3373=[])),(((temp$3379=bindings$3355)),((($length$3385=temp$3379.length)),((($index$3391=0)),(function(){$3365:for(;($index$3391<$length$3385);($index$3391++)){var v$3428;var x$3439;var other$3447;var v$3435;var b$3411;var env$3412;var $3370$3408;var t0$3405;var t1$3406;var m$3400;(m$3400=temp$3379[$index$3391]);(t0$3405=m$3400);if(((t0$3405 instanceof Array)&&(((t1$3406=t0$3405.length)),((t1$3406===2)&&((t0$3405[0]==="symbol")&&((b$3411=t0$3405[1]),___hasprop(t0$3405,"env"))))))){(env$3412=t0$3405.env);acc$3373.push((((v$3428=["variable",it$0$2187.gensym(b$3411)])),(env$3412.bind(newscope$3361,b$3411,v$3428),v$3428)));}else{if((((x$3439=t0$3405)),((x$3439 instanceof Array)&&(x$3439[0]==="variable")))){(v$3435=t0$3405);acc$3373.push(v$3435);}else{(other$3447=m$3400);acc$3373.push(function(){throw ErrorFactory(["syntax","lambda","binding"]).create("Not a valid binding.",({"node":other$3447}));}());}}}})()))),acc$3373),helper$2198(["expr","expr"],newscope$3361,body$3356)];}else{if(($2235$2252&&($2209$2241[0]==="use"))){($2225$3453=$2209$2241[1]);(x$3452=$2209$2241[2]);(t0$3457=$2225$3453);if((typeof(t0$3457)==="string")){(name$3461=t0$3457);(s$3470=scope$2204);$3474:while(s$3470){if((s$3470.name.slice(0,(name$3461.length+1))===(name$3461+"/"))){break $3474;}else{(s$3470=s$3470.parent);}}if(s$3470){return helper$2198(context$2203,s$3470,x$3452);}else{throw ErrorFactory(["syntax","noscope"]).create(("Could not find a scope tagged: "+name$3461));}}else{(newscope$3483=$2225$3453);return helper$2198(context$2203,newscope$3483,x$3452);}}else{if(($2235$2252&&(($2209$2241[0]==="tagscope")&&(((t1$2247=$2209$2241[1])),(typeof(t1$2247)==="string"))))){(tag$3487=t1$2247);(body$3488=$2209$2241[2]);return helper$2198(context$2203,Scope$776(scope$2204,it$0$2187.gensym((tag$3487+"/"))),body$3488);}else{if(($2233$2250&&((t0$2246>=1)&&((type$3498=$2209$2241[0]),((args$3499=Array.prototype.slice.call($2209$2241,1)),(it$0$2187.generic_nodes.indexOf(type$3498)!==-1)))))){return [type$3498].concat((((acc$3509=[])),(((temp$3515=args$3499)),((($length$3521=temp$3515.length)),((($index$3527=0)),(function(){$3504:for(;($index$3527<$length$3521);($index$3527++)){var arg$3544;var m$3536;(m$3536=temp$3515[$index$3527]);(arg$3544=m$3536);acc$3509.push(helper$2198(["expr","expr"],scope$2204,arg$3544));}})()))),acc$3509));}else{if(($2233$2250&&((t0$2246>=2)&&($2209$2241[0]==="mismix")))){(ops$3549=$2209$2241[1]);(args$3550=Array.prototype.slice.call($2209$2241,2));(tokens$3556=object((((acc$3565=[])),(((temp$3571=enumerate(ops$3549))),((($length$3577=temp$3571.length)),((($index$3583=0)),(function(){$3560:for(;($index$3583<$length$3577);($index$3583++)){var i$3602;var op$3603;var t0$3597;var t1$3598;var m$3592;(m$3592=temp$3571[$index$3583]);(t0$3597=m$3592);if(((t0$3597 instanceof Array)&&(((t1$3598=t0$3597.length)),(t1$3598===2)))){(i$3602=t0$3597[0]);(op$3603=t0$3597[1]);acc$3565.push([("token"+String((i$3602+1))),op$3603]);}else{___match_error(m$3592,"/home/olivier/git/eg/src/expand.eg",17380,17480);}}})()))),acc$3565)));(msg$3557="These operators or brackets cannot be mixed together.");throw ErrorFactory(["syntax","mismatch"]).create(msg$3557,tokens$3556);}else{if(($2233$2250&&((t0$2246===2)&&($2209$2241[0]==="char")))){(c$3624=$2209$2241[1]);throw ErrorFactory(["syntax","illegal_character"]).create(("An illegal character was found: "+c$3624),({"node":expr$2205}));}else{(other$3629=$2209$2241);throw ErrorFactory(["syntax","illegal_node"]).create(("An illegal node was found: "+other$3629),({"node":other$3629,"context":context$2203}));}}}}}}}}}}}}}}}}}}}})));return helper$2198(context$2181,scope$2182,expr$2183);}));__amp____colon__(Expander$779,__amp____colon__(((accum$3635=({})),((accum$3635["::name"]="Expander"),accum$3635)),((accum$3639=({})),((accum$3639["::egclass"]=true),accum$3639))));Expander$779;(mac1$780=(function(f$3646){return ["macro",(function(context$3652,scope$3653,form$3654,$3649$3655){var t0$3659;var t1$3660;var expr$3657;(t0$3659=$3649$3655);if(((t0$3659 instanceof Array)&&(((t1$3660=t0$3659.length)),((t1$3660===2)&&(t0$3659[0]==="data"))))){(expr$3657=t0$3659[1]);}else{___match_error($3649$3655);}return f$3646(expr$3657);})];}));(__chk_ncache$781=({}));(__chk_scache$782=({}));(checker_db$783=(function($3683$3686){var v$3731;var v$3750;var s$3744;var n$3725;var $3688$3701;var ph$3695;(ph$3695=$3683$3686);($3688$3701=ph$3695);if(($3688$3701===null)){return checker_db$783.null;}else{if(($3688$3701===(void 0))){return checker_db$783.undefined;}else{if(($3688$3701===true)){return checker_db$783.true;}else{if(($3688$3701===false)){return checker_db$783.false;}else{if((typeof($3688$3701)==="number")){(n$3725=$3688$3701);if($3825(__chk_ncache$781,n$3725)){return $3825(__chk_ncache$781,n$3725);}else{(v$3731=mac1$780((function(x$3736){return ["send",["symbol","==="],["data",x$3736,["value",n$3725]]];})));(__chk_ncache$781[n$3725]=v$3731);return v$3731;}}else{if((typeof($3688$3701)==="string")){(s$3744=$3688$3701);if(Object.prototype.hasOwnProperty.call(__chk_scache$782,s$3744)){return $3825(__chk_scache$782,s$3744);}else{(v$3750=mac1$780((function(x$3755){return ["send",["symbol","==="],["data",x$3755,["value",s$3744]]];})));(__chk_scache$782[s$3744]=v$3750);return v$3750;}}else{___match_error($3688$3701);}}}}}}}));__amp____colon__(checker_db$783,({"String":mac1$780((function(x$3766){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3766]],["value","string"]]];})),"Number":mac1$780((function(x$3770){return ["send",["symbol","==="],["data",["send",["symbol","typeof"],["data",x$3770]],["value","number"]]];})),"Array":mac1$780((function(x$3774){return ["send",["symbol","instanceof"],["data",x$3774,["symbol","Array"]]];})),"true":mac1$780((function(x$3778){return x$3778;})),"false":mac1$780((function(x$3782){return ["send",["symbol","not"],["data",["void"],x$3782]];})),"null":mac1$780((function(x$3786){return ["send",["symbol","==="],["data",x$3786,["value",null]]];})),"undefined":mac1$780((function(x$3790){return ["send",["symbol","==="],["data",x$3790,["value",(void 0)]]];}))}));(exports["Env"]=Env$777);(exports["Scope"]=Scope$776);(exports["track_location"]=track_location$778);(exports["Expander"]=Expander$779);(exports["GenSym"]=GenSym$771);(exports["gensym"]=gensym$772);(exports["mac1"]=mac1$780);(exports["checker_db"]=checker_db$783);
