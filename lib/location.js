var $7925=function(type$7928){var f$7932;(f$7932=type$7928["::check"]);if((f$7932===(void 0))){return function(value$7938){return (value$7938 instanceof type$7928);};}else{return function(value$7942){return f$7932.call(type$7928,value$7942);};}};
var $7944=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $7945=function(dest$7948,values$7949){var k$7954;(k$7954=null);$7952:for(k$7954 in values$7949){if(values$7949.hasOwnProperty(k$7954)){(dest$7948[k$7954]=values$7949[k$7954]);}}return dest$7948;};
var $7962=function($7964$7967){var ph$7973;(ph$7973=$7964$7967);var $7969$7979;($7969$7979=ph$7973);var bridge$7971$7984;var x$7988;(bridge$7971$7984=$7969$7979);if((((typeof(bridge$7971$7984)==="string")&&((x$7988=bridge$7971$7984),true))||((typeof(bridge$7971$7984)==="number")&&((x$7988=bridge$7971$7984),true)))){return ["value",x$7988];}else{var other$7999;(other$7999=$7969$7979);return other$7999["::serialize_ast"]();}};
var send$7699;(send$7699=function(obj$7706,$7703$7707){var ph$7713;var msg$7714;var t0$7716;(t0$7716=$7703$7707);(msg$7714=t0$7716);(ph$7713=t0$7716);var $7709$7725;($7709$7725=ph$7713);var bridge$7711$7730;(bridge$7711$7730=$7709$7725);if(((typeof(bridge$7711$7730)==="string")||(typeof(bridge$7711$7730)==="number"))){return obj$7706[msg$7714];}else{var other$7742;(other$7742=$7709$7725);return obj$7706["::send"](msg$7714);}});(Array[":::project"]=function($7748$7751){var ph$7756;var value$7757;var t0$7759;(t0$7759=$7748$7751);(value$7757=t0$7759);(ph$7756=t0$7759);var $7753$7768;($7753$7768=ph$7756);if($7925(Array)($7753$7768)){return [true,value$7757];}else{$7753$7768;return [true,[value$7757]];}});(Array.prototype["::check"]=function(value$7786){if((value$7786 instanceof Array)){var i$7792;(i$7792=0);$7789:for(;(i$7792<this.length);(i$7792++)){if(($7944(this,i$7792)!==$7944(value$7786,i$7792))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $7945(this.slice(0),this);});(Array.prototype[":::project"]=function(value$7811){if((value$7811 instanceof Array)){var i$7817;(i$7817=0);$7814:for(;(i$7817<this.length);(i$7817++)){if(($7944(this,i$7817)!==$7944(value$7811,i$7817))){return [true,[value$7811]];}}return [true,value$7811.slice(this.length)];}else{return [true,[value$7811]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($7962));});(RegExp.prototype["::check"]=function($7835$7838){var ph$7843;(ph$7843=$7835$7838);var $7840$7849;($7840$7849=ph$7843);var value$7857;if((typeof($7840$7849)==="string")){(value$7857=$7840$7849);if(value$7857.match(this)){return true;}else{return false;}}else{var other$7862;(other$7862=$7840$7849);return false;}});(RegExp.prototype[":::project"]=function($7868$7871){var ph$7876;(ph$7876=$7868$7871);var $7873$7882;($7873$7882=ph$7876);var value$7890;if((typeof($7873$7882)==="string")){(value$7890=$7873$7882);var $7893$7898;($7893$7898=value$7890.match(this));var m$7906;if(($7893$7898===null)){(m$7906=$7893$7898);return [false,null];}else{var m$7911;(m$7911=$7893$7898);return [true,m$7911];}}else{var other$7915;(other$7915=$7873$7882);return [false,null];}});(Function.prototype["::send"]=function(args$7922){return this.apply(this,args$7922);});
var $10488=function(arr$10491){var results$10497;var l$10498;(results$10497=[]);(l$10498=arr$10491.length);var i$10507;(i$10507=0);$10496:for(;(i$10507<l$10498);(i$10507++)){results$10497.push([i$10507,$7944(arr$10491,i$10507)]);}return results$10497;};
var $10255=function(){var $10256$10262;($10256$10262=function(tags$10267){var it$0$10270;(it$0$10270=function(){if((!$7925($10256$10262)(this))){return Object.create($10256$10262.prototype);}else{return this;}}());(it$0$10270["tags"]=tags$10267);return it$0$10270;});($10256$10262.prototype["create"]=function(){var it$0$10290;var self$10291;(it$0$10290=this);(self$10291=this);var $10288$10300;($10288$10300=arguments);var t0$10305;var message$10309;var args$10310;(t0$10305=$10288$10300.length);if((t0$10305>=0)){(message$10309=function(){if((0>=t0$10305)){return "";}else{return $10288$10300[0];}}());(args$10310=Array.prototype.slice.call($10288$10300,1));var e$10323;(e$10323=Error(message$10309));(e$10323["::tags"]=it$0$10290.tags);(e$10323["args"]=args$10310);var temp$10339;(temp$10339=$10488(args$10310));var $length$10345;($length$10345=temp$10339.length);var $index$10351;($index$10351=0);$10324:for(;($index$10351<$length$10345);($index$10351++)){var m$10360;(m$10360=temp$10339[$index$10351]);var t0$10365;var t1$10366;var i$10370;var arg$10371;(t0$10365=m$10360);if(((t0$10365 instanceof Array)&&(((t1$10366=t0$10365.length)),(t1$10366===2)))){(i$10370=t0$10365[0]);(arg$10371=t0$10365[1]);(e$10323[i$10370]=arg$10371);}else{$10236(m$10360);}}(e$10323["length"]=args$10310.length);(e$10323["name"]=["E"].concat(it$0$10290.tags).join("."));return e$10323;}else{$10236($10288$10300);}});($10256$10262.prototype["::check"]=function(e$10401){var it$0$10405;var self$10406;(it$0$10405=this);(self$10406=this);var tags$10416;if(((!e$10401)||(!$7925(Error)(e$10401)))){return false;}(tags$10416=(e$10401["::tags"]||[]));var temp$10427;(temp$10427=it$0$10405.tags);var $length$10433;($length$10433=temp$10427.length);var $index$10439;($index$10439=0);$10417:for(;($index$10439<$length$10433);($index$10439++)){var m$10448;(m$10448=temp$10427[$index$10439]);var tag$10456;(tag$10456=m$10448);if((tags$10416.indexOf(tag$10456)===-1)){return false;}else{false;}}return true;});($10256$10262.prototype["::deconstruct"]=function(e$10465){var it$0$10469;var self$10470;(it$0$10469=this);(self$10470=this);return e$10465.args;});$7945($10256$10262,$7945(function(){var accum$10481;(accum$10481=({}));(accum$10481["::name"]="$10256");return accum$10481;}(),function(){var accum$10485;(accum$10485=({}));(accum$10485["::egclass"]=true);return accum$10485;}()));return $10256$10262;}();
var $10236=function(value$10239,url$10240,start$10241,end$10242){var err$10246;(err$10246=$10255(["match"]).create("Could not find a match for value",({"value":value$10239})));if(url$10240){(err$10246["location"]=["location",url$10240,start$10241,end$10242]);}throw err$10246;};
var $10803=function(type$10806){return function(value$10810){var f$10814;(f$10814=type$10806[":::project"]);if((f$10814===(void 0))){(f$10814=type$10806["::project"]);if((f$10814===(void 0))){return [true,type$10806(value$10810)];}else{var rval$10827;(rval$10827=false);try{(rval$10827=[true,f$10814(value$10810)]);}catch(excv$10838){var e$10844;(e$10844=excv$10838);(rval$10827=[false,null]);}return rval$10827;}}else{return f$10814.call(type$10806,value$10810);}};};
var $10850=function($10852$10855,key$10856){var ph$10864;(ph$10864=$10852$10855);var $10858$10870;($10858$10870=ph$10864);var bridge$10860$10875;(bridge$10860$10875=$10858$10870);if(((bridge$10860$10875===null)||(bridge$10860$10875===(void 0)))){return false;}else{var x$10887;if((typeof($10858$10870)==="string")){(x$10887=$10858$10870);return (key$10856 in String.prototype);}else{var x$10892;if((typeof($10858$10870)==="number")){(x$10892=$10858$10870);return (key$10856 in Number.prototype);}else{var x$10897;(x$10897=$10858$10870);return (key$10856 in x$10897);}}}};
var $10514=function(){var $10515$10520;($10515$10520=function($10524$10531,$10526$10532,$10528$10533){var it$0$10536;(it$0$10536=function(){if((!$7925($10515$10520)(this))){return Object.create($10515$10520.prototype);}else{return this;}}());var t0$10543;(t0$10543=$10803(Array)($10524$10531));if(t0$10543[0]){(it$0$10536["tags"]=t0$10543[1]);}else{$10236($10524$10531);}(it$0$10536["props"]=$10526$10532);var t0$10555;(t0$10555=$10803(Array)($10528$10533));if(t0$10555[0]){(it$0$10536["children"]=t0$10555[1]);}else{$10236($10528$10533);}undefined;return it$0$10536;});$7945(function(){var accum$10569;(accum$10569=({}));(accum$10569["::check"]=function(x$10574){return (((x$10574&&x$10574.tags)&&x$10574.props)&&x$10574.children);});return accum$10569;}(),$7945(function(){var accum$10577;(accum$10577=({}));(accum$10577[":::project"]=function($10581$10584){var ph$10589;(ph$10589=$10581$10584);var $10586$10595;($10586$10595=ph$10589);var tags$10603;var props$10604;var children$10605;if(($10850($10586$10595,"tags")&&((tags$10603=$10586$10595.tags),($10850($10586$10595,"props")&&((props$10604=$10586$10595.props),$10850($10586$10595,"children")))))){(children$10605=$10586$10595.children);return [true,[tags$10603,props$10604,children$10605]];}else{$10586$10595;return [false,null];}});return accum$10577;}(),$7945(function(){var accum$10614;(accum$10614=({}));(accum$10614["::name"]="$10515");return accum$10614;}(),function(){var accum$10618;(accum$10618=({}));(accum$10618["::egclass"]=true);return accum$10618;}())));($10515$10520.prototype["::check"]=function($10624$10627){var it$0$10631;var self$10632;(it$0$10631=this);(self$10632=this);var ph$10643;(ph$10643=$10624$10627);var $10640$10649;($10640$10649=ph$10643);var n$10657;if($7925($10514)($10640$10649)){(n$10657=$10640$10649);var temp$10667;(temp$10667=it$0$10631.tags);var $length$10673;($length$10673=temp$10667.length);var $index$10679;($index$10679=0);$10661:for(;($index$10679<$length$10673);($index$10679++)){var m$10688;(m$10688=temp$10667[$index$10679]);var c$10696;(c$10696=m$10688);if((n$10657.tags.indexOf(c$10696)===-1)){return false;}else{false;}}return true;}else{$10640$10649;return false;}});($10515$10520.prototype[":::project"]=function($10707$10710){var it$0$10714;var self$10715;(it$0$10714=this);(self$10715=this);var ph$10726;(ph$10726=$10707$10710);var $10723$10732;($10723$10732=ph$10726);var n$10740;if($7925(it$0$10714)($10723$10732)){(n$10740=$10723$10732);return [true,[n$10740.tags,n$10740.props,n$10740.children]];}else{$10723$10732;return [false,null];}});$7945($10515$10520,$7945(function(){var accum$10751;(accum$10751=({}));(accum$10751["::check"]=function(x$10756){return (((x$10756&&x$10756.tags)&&x$10756.props)&&x$10756.children);});return accum$10751;}(),$7945(function(){var accum$10759;(accum$10759=({}));(accum$10759[":::project"]=function($10763$10766){var ph$10771;(ph$10771=$10763$10766);var $10768$10777;($10768$10777=ph$10771);var tags$10785;var props$10786;var children$10787;if(($10850($10768$10777,"tags")&&((tags$10785=$10768$10777.tags),($10850($10768$10777,"props")&&((props$10786=$10768$10777.props),$10850($10768$10777,"children")))))){(children$10787=$10768$10777.children);return [true,[tags$10785,props$10786,children$10787]];}else{$10768$10777;return [false,null];}});return accum$10759;}(),$7945(function(){var accum$10796;(accum$10796=({}));(accum$10796["::name"]="$10515");return accum$10796;}(),function(){var accum$10800;(accum$10800=({}));(accum$10800["::egclass"]=true);return accum$10800;}()))));return $10515$10520;}();
var $10899=function(from$10902,to$10903){var rval$10908;(rval$10908=[]);var i$10914;(i$10914=from$10902);$10907:for(;(i$10914<=to$10903);(i$10914++)){rval$10908.push(i$10914);}return rval$10908;};
var $10921=function(obj$10924){var results$10929;(results$10929=[]);var k$10934;(k$10934=null);$10928:for(k$10934 in obj$10924){if(Object.prototype.hasOwnProperty.call(obj$10924,k$10934)){results$10929.push([k$10934,$7944(obj$10924,k$10934)]);}}return results$10929;};var accum$8215;var accum$8219;var accum$8579;var accum$8583;var $8003$8033;var binsearch$8034;var $8004$8035;var __lt____gt__$8036;var repr$8037;var fs$8038;var Source$8039;var Location$8040;var highlight$8041;var highlight_lines$8042;var clamp$8043;var morsel$8044;var highlight_locations$8045;var highlight_locations_same_source$8046;var merge_locations$8047;var __lt____lt____colon__$8048;var __plus____plus____colon__$8049;var format_error$8050;var display_error$8051;($8003$8033=require("./util"));(binsearch$8034=$8003$8033.binsearch);($8004$8035=require("./pp"));(__lt____gt__$8036=$8004$8035["<>"]);(repr$8037=$8004$8035.repr);(fs$8038=require("fs"));(Source$8039=function(){var $index$8139;var $length$8133;var temp$8127;var curr$8108;var text$8094;var url$8095;var t0$8090;var $8081$8085;var it$0$8076;(it$0$8076=function(){if((!$7925(Source$8039)(this))){return Object.create(Source$8039.prototype);}else{return this;}}());($8081$8085=arguments);(t0$8090=$8081$8085.length);if(((t0$8090>=1)&&(t0$8090<=2))){(text$8094=$8081$8085[0]);(url$8095=function(){if((1>=t0$8090)){return false;}else{return $8081$8085[1];}}());(it$0$8076["text"]=text$8094);(it$0$8076["url"]=url$8095);(it$0$8076["counts"]=[]);(curr$8108=0);(temp$8127=text$8094.split("\n"));($length$8133=temp$8127.length);($index$8139=0);$8109:for(;($index$8139<$length$8133);($index$8139++)){var line$8156;var m$8148;(m$8148=temp$8127[$index$8139]);(line$8156=m$8148);it$0$8076.counts.push(curr$8108);(curr$8108=(curr$8108+(line$8156.length+1)));}it$0$8076.counts.push(curr$8108);(it$0$8076["nlines"]=(it$0$8076.counts.length-1));}else{$10236($8081$8085);}return it$0$8076;});(Source$8039.prototype["linecol"]=function(pos$8169){var line$8185;var col$8186;var it$0$8173;var self$8174;(it$0$8173=this);(self$8174=this);(line$8185=binsearch$8034(it$0$8173.counts,pos$8169));(col$8186=(pos$8169-$7944(it$0$8173.counts,(line$8185-1))));return [line$8185,col$8186];});(Source$8039.prototype["highlight_lines"]=function(l1$8197,l2$8198,spans$8199){var it$0$8203;var self$8204;(it$0$8203=this);(self$8204=this);return highlight_lines$8042(it$0$8203.text,it$0$8203.counts,[(l1$8197-1),(l2$8198-1)],spans$8199);});$7945(Source$8039,$7945(((accum$8215=({})),((accum$8215["::name"]="Source"),accum$8215)),((accum$8219=({})),((accum$8219["::egclass"]=true),accum$8219))));Source$8039;(Location$8040=function(source$8226,start$8227,end$8228){var it$0$8231;(it$0$8231=function(){if((!$7925(Location$8040)(this))){return Object.create(Location$8040.prototype);}else{return this;}}());(it$0$8231["source"]=(source$8226||Source$8039("",null)));(it$0$8231["start"]=start$8227);(it$0$8231["end"]=end$8228);return it$0$8231;});(Location$8040.prototype["text"]=function(){var it$0$8258;var self$8259;(it$0$8258=this);(self$8259=this);return it$0$8258.source.text.slice(it$0$8258.start,it$0$8258.end);});(Location$8040.prototype["at_start"]=function(){var it$0$8274;var self$8275;(it$0$8274=this);(self$8275=this);return Location$8040(it$0$8274.source,it$0$8274.start,it$0$8274.start);});(Location$8040.prototype["at_end"]=function(){var it$0$8290;var self$8291;(it$0$8290=this);(self$8291=this);return Location$8040(it$0$8290.source,it$0$8290.end,it$0$8290.end);});(Location$8040.prototype["linerange"]=function(){var l2$8362;var t0$8353;var t1$8354;var l1$8333;var $8317$8334;var t0$8327;var t1$8328;var t2$8329;var $8315$8322;var it$0$8306;var self$8307;(it$0$8306=this);(self$8307=this);($8315$8322=it$0$8306.linecol());if((($8315$8322 instanceof Array)&&(((t0$8327=$8315$8322.length)),((t0$8327===2)&&(((t1$8328=$8315$8322[0])),((t1$8328 instanceof Array)&&(((t2$8329=t1$8328.length)),(t2$8329===2)))))))){(l1$8333=t1$8328[0]);t1$8328[1];($8317$8334=$8315$8322[1]);if(($8317$8334===null)){return [l1$8333,l1$8333];}else{(t0$8353=$8317$8334);if(((t0$8353 instanceof Array)&&(((t1$8354=t0$8353.length)),(t1$8354===2)))){(l2$8362=t0$8353[0]);t0$8353[1];return [l1$8333,l2$8362];}else{$10236($8317$8334,"/home/olivier/git/earl-grey/src/location.eg",1080,1085);}}}else{$10236($8315$8322);}});(Location$8040.prototype["linecol"]=function(){var start$8397;var end$8398;var it$0$8385;var self$8386;(it$0$8385=this);(self$8386=this);(start$8397=it$0$8385.source.linecol(it$0$8385.start));(end$8398=function(){if((it$0$8385.start===it$0$8385.end)){return null;}else{return it$0$8385.source.linecol((it$0$8385.end-1));}}());return [start$8397,end$8398];});(Location$8040.prototype["ref"]=function(){var otherwise$8532;var $8512$8521;var $8508$8515;var l2$8484;var c2$8485;var t0$8473;var t1$8474;var t2$8475;var t3$8476;var l1$8441;var c1$8442;var $8423$8443;var t0$8433;var t1$8434;var t2$8435;var t3$8436;var t4$8437;var $8421$8428;var it$0$8412;var self$8413;(it$0$8412=this);(self$8413=this);($8421$8428=it$0$8412.linecol());if((($8421$8428 instanceof Array)&&(((t0$8433=$8421$8428.length)),((t0$8433===2)&&(((t1$8434=$8421$8428[0])),((t1$8434 instanceof Array)&&(((t2$8435=t1$8434.length)),((t2$8435===2)&&(((t3$8436=[true,String(t1$8434[0])])),(t3$8436[0]&&((l1$8441=t3$8436[1]),(((t4$8437=[true,String(t1$8434[1])])),t4$8437[0])))))))))))){(c1$8442=t4$8437[1]);($8423$8443=$8421$8428[1]);if(($8423$8443===null)){return ((l1$8441+":")+c1$8442);}else{(t0$8473=$8423$8443);if(((t0$8473 instanceof Array)&&(((t1$8474=t0$8473.length)),((t1$8474===2)&&(((t2$8475=[true,String(t0$8473[0])])),(t2$8475[0]&&((l2$8484=t2$8475[1]),(((t3$8476=[true,String(t0$8473[1])])),t3$8476[0])))))))){(c2$8485=t3$8476[1]);($8508$8515=null);$8508$8515;if(((l1$8441===l2$8484)&&(c1$8442===c2$8485))){return ((l1$8441+":")+c1$8442);}else{if((l1$8441===l2$8484)){return ((((l1$8441+":")+c1$8442)+"-")+c2$8485);}else{(otherwise$8532=$8508$8515);return ((((((l1$8441+":")+c1$8442)+"-")+l1$8441)+":")+c2$8485);}}}else{$10236($8423$8443,"/home/olivier/git/earl-grey/src/location.eg",1422,1427);}}}else{$10236($8421$8428);}});(Location$8040.prototype["highlight"]=function(){var cls$8566;var context$8567;var t0$8562;var $8545$8557;var it$0$8547;var self$8548;(it$0$8547=this);(self$8548=this);($8545$8557=arguments);(t0$8562=$8545$8557.length);if(((t0$8562>=0)&&(t0$8562<=2))){(cls$8566=function(){if((0>=t0$8562)){return "hl1";}else{return $8545$8557[0];}}());(context$8567=function(){if((1>=t0$8562)){return 0;}else{return $8545$8557[1];}}());return highlight_locations$8045([[it$0$8547,cls$8566]],context$8567);}else{$10236($8545$8557);}});$7945(Location$8040,$7945(((accum$8579=({})),((accum$8579["::name"]="Location"),accum$8579)),((accum$8583=({})),((accum$8583["::egclass"]=true),accum$8583))));Location$8040;(highlight$8041=function(){var $index$8635;var $length$8629;var temp$8623;var acc$8617;var text$8603;var spans$8604;var offset$8605;var t0$8599;var $8590$8594;($8590$8594=arguments);(t0$8599=$8590$8594.length);if(((t0$8599>=2)&&(t0$8599<=3))){(text$8603=$8590$8594[0]);(spans$8604=$8590$8594[1]);(offset$8605=function(){if((2>=t0$8599)){return 0;}else{return $8590$8594[2];}}());return $10514([],({}),(((acc$8617=[])),(((temp$8623=morsel$8044(spans$8604))),((($length$8629=temp$8623.length)),((($index$8635=0)),function(){$8612:for(;($index$8635<$length$8629);($index$8635++)){var xstart$8672;var xend$8673;var start$8654;var end$8655;var attributes$8656;var t0$8649;var t1$8650;var m$8644;(m$8644=temp$8623[$index$8635]);(t0$8649=m$8644);if(((t0$8649 instanceof Array)&&(((t1$8650=t0$8649.length)),(t1$8650===3)))){(start$8654=t0$8649[0]);(end$8655=t0$8649[1]);(attributes$8656=t0$8649[2]);acc$8617.push((((xstart$8672=Math.max((start$8654-offset$8605),0))),((xend$8673=Math.min((end$8655-offset$8605),text$8603.length))),$10514([("."+attributes$8656.slice(0,1))],({}),text$8603.slice(xstart$8672,xend$8673))));}else{$10236(m$8644,"/home/olivier/git/earl-grey/src/location.eg",1969,2262);}}}()))),acc$8617));}else{$10236($8590$8594);}});(highlight_lines$8042=function(text$8691,linelocs$8692,$8688$8693,spans$8694){var t0$8699;var t1$8700;var $index$8736;var $length$8730;var temp$8724;var acc$8718;var l1$8696;var l2$8697;(t0$8699=$8688$8693);if(((t0$8699 instanceof Array)&&(((t1$8700=t0$8699.length)),(t1$8700===2)))){(l1$8696=t0$8699[0]);(l2$8697=t0$8699[1]);}else{$10236($8688$8693);}return $10514(["span"],({}),(((acc$8718=[])),(((temp$8724=$10899(l1$8696,l2$8697))),((($length$8730=temp$8724.length)),((($index$8736=0)),function(){$8713:for(;($index$8736<$length$8730);($index$8736++)){var start$8759;var end$8760;var lineno$8753;var m$8745;(m$8745=temp$8724[$index$8736]);(lineno$8753=m$8745);acc$8718.push((((start$8759=$7944(linelocs$8692,lineno$8753))),((end$8760=$7944(linelocs$8692,(lineno$8753+1)))),$10514(["span"],({}),[$10514([".lineno"],({}),(lineno$8753+1)),$10514([".source"],({}),highlight$8041(text$8691,[[start$8759,end$8760,[]]].concat(clamp$8043(spans$8694,start$8759,end$8760))))])));}}()))),acc$8718));});(clamp$8043=function(spans$8772,bot$8773,top$8774){var $index$8799;var $length$8793;var temp$8787;var acc$8781;(acc$8781=[]);(temp$8787=spans$8772);($length$8793=temp$8787.length);($index$8799=0);$8776:for(;($index$8799<$length$8793);($index$8799++)){var start$8818;var end$8819;var attr$8820;var t0$8813;var t1$8814;var m$8808;(m$8808=temp$8787[$index$8799]);(t0$8813=m$8808);if(((t0$8813 instanceof Array)&&(((t1$8814=t0$8813.length)),((t1$8814===3)&&((start$8818=t0$8813[0]),((end$8819=t0$8813[1]),((attr$8820=t0$8813[2]),((end$8819>=bot$8773)&&(start$8818<=top$8774))))))))){acc$8781.push([Math.max(start$8818,bot$8773),Math.min(end$8819,top$8774),attr$8820]);}else{false;}}return acc$8781;});(morsel$8044=function(spans$8842){var jump$8849;var jumptill$8850;var process_elements$8851;var thespans$8852;(jump$8849=function(active$8857,bot$8858,top$8859){var $index$8895;var $length$8889;var temp$8883;var acc$8877;var $index$8948;var $length$8942;var temp$8936;var e$8864;var attributes$8865;(e$8864=$7944(Math.min,[top$8859].concat((((acc$8877=[])),(((temp$8883=active$8857)),((($length$8889=temp$8883.length)),((($index$8895=0)),function(){$8872:for(;($index$8895<$length$8889);($index$8895++)){var x$8914;var t0$8909;var t1$8910;var m$8904;(m$8904=temp$8883[$index$8895]);(t0$8909=m$8904);if(((t0$8909 instanceof Array)&&(((t1$8910=t0$8909.length)),(t1$8910===3)))){t0$8909[0];(x$8914=t0$8909[1]);t0$8909[2];acc$8877.push(x$8914);}else{$10236(m$8904,"/home/olivier/git/earl-grey/src/location.eg",3585,3628);}}}()))),acc$8877))));(attributes$8865=[]);(temp$8936=active$8857);($length$8942=temp$8936.length);($index$8948=0);$8866:for(;($index$8948<$length$8942);($index$8948++)){var X$8967;var t0$8962;var t1$8963;var m$8957;(m$8957=temp$8936[$index$8948]);(t0$8962=m$8957);if(((t0$8962 instanceof Array)&&(((t1$8963=t0$8962.length)),(t1$8963===3)))){t0$8962[0];t0$8962[1];(X$8967=t0$8962[2]);(attributes$8865=attributes$8865.concat(X$8967));}else{$10236(m$8957,"/home/olivier/git/earl-grey/src/location.eg",3654,3695);}}return [e$8864,[bot$8858,e$8864,attributes$8865]];});(jumptill$8850=function(active$8986,bot$8987,top$8988){var t0$9000;var t1$9001;var $index$9039;var $length$9033;var temp$9027;var acc$9021;var t0$9079;var t1$9080;var newbot$8994;var span$8995;var newactive$8996;var spans$8997;var remainder$8998;if((bot$8987===top$8988)){return [[],active$8986];}else{(t0$9000=jump$8849(active$8986,bot$8987,top$8988));if(((t0$9000 instanceof Array)&&(((t1$9001=t0$9000.length)),(t1$9001===2)))){(newbot$8994=t0$9000[0]);(span$8995=t0$9000[1]);}else{$10236(jump$8849(active$8986,bot$8987,top$8988),"/home/olivier/git/earl-grey/src/location.eg",3931,3965);}(newactive$8996=(((acc$9021=[])),(((temp$9027=active$8986)),((($length$9033=temp$9027.length)),((($index$9039=0)),function(){$9016:for(;($index$9039<$length$9033);($index$9039++)){var x$9058;var e$9059;var attr$9060;var t0$9053;var t1$9054;var m$9048;(m$9048=temp$9027[$index$9039]);(t0$9053=m$9048);(x$9058=t0$9053);if(((t0$9053 instanceof Array)&&(((t1$9054=t0$9053.length)),((t1$9054===3)&&(t0$9053[0],((e$9059=t0$9053[1]),((attr$9060=t0$9053[2]),(e$9059>newbot$8994)))))))){acc$9021.push(x$9058);}else{false;}}}()))),acc$9021));(t0$9079=jumptill$8850(newactive$8996,newbot$8994,top$8988));if(((t0$9079 instanceof Array)&&(((t1$9080=t0$9079.length)),(t1$9080===2)))){(spans$8997=t0$9079[0]);(remainder$8998=t0$9079[1]);}else{$10236(jumptill$8850(newactive$8996,newbot$8994,top$8988),"/home/olivier/git/earl-grey/src/location.eg",4080,4124);}return [[span$8995].concat(spans$8997),remainder$8998];}});(process_elements$8851=function(start$9098,active$9099,rem$9100){var $index$9205;var $length$9199;var temp$9193;var acc$9187;var t0$9244;var t1$9245;var top$9177;var bot$9178;var spans$9179;var t0$9297;var t1$9298;var spans$9294;var newactive$9295;var start$9260;var active$9261;var next$9262;var target$9263;var end$9264;var attr$9265;var rest$9266;var start$9157;var active$9158;var $9106$9122;var $9107$9123;var $9108$9124;var t0$9116;var t1$9117;var t2$9118;var t3$9119;var t4$9120;var $9102$9111;($9102$9111=[start$9098,active$9099,rem$9100]);if((($9106$9122=($9102$9111 instanceof Array))&&(((t0$9116=$9102$9111.length)),(($9108$9124=(t0$9116===3))&&($9102$9111[0],(((t1$9117=$9102$9111[1])),((t1$9117 instanceof Array)&&(((t2$9118=t1$9117.length)),((t2$9118===0)&&(((t3$9119=$9102$9111[2])),((t3$9119 instanceof Array)&&(((t4$9120=t3$9119.length)),(t4$9120===0))))))))))))){return [];}else{if(($9108$9124&&((start$9157=$9102$9111[0]),((active$9158=$9102$9111[1]),(((t1$9117=$9102$9111[2])),((t1$9117 instanceof Array)&&(((t2$9118=t1$9117.length)),(t2$9118===0)))))))){(top$9177=$7944(Math.max,(((acc$9187=[])),(((temp$9193=active$9158)),((($length$9199=temp$9193.length)),((($index$9205=0)),function(){$9182:for(;($index$9205<$length$9199);($index$9205++)){var e$9224;var t0$9219;var t1$9220;var m$9214;(m$9214=temp$9193[$index$9205]);(t0$9219=m$9214);if(((t0$9219 instanceof Array)&&(((t1$9220=t0$9219.length)),(t1$9220===3)))){t0$9219[0];(e$9224=t0$9219[1]);t0$9219[2];acc$9187.push(e$9224);}else{$10236(m$9214,"/home/olivier/git/earl-grey/src/location.eg",4309,4347);}}}()))),acc$9187)));(bot$9178=Math.min(start$9157,top$9177));(t0$9244=jumptill$8850(active$9158,start$9157,top$9177));if(((t0$9244 instanceof Array)&&(((t1$9245=t0$9244.length)),(t1$9245===2)))){(spans$9179=t0$9244[0]);t0$9244[1];}else{$10236(jumptill$8850(active$9158,start$9157,top$9177),"/home/olivier/git/earl-grey/src/location.eg",4400,4438);}return spans$9179;}else{if(($9108$9124&&((start$9260=$9102$9111[0]),((active$9261=$9102$9111[1]),(((t1$9117=$9102$9111[2])),((t1$9117 instanceof Array)&&(((t2$9118=t1$9117.length)),((t2$9118>=1)&&(((t3$9119=t1$9117[0])),((next$9262=t3$9119),((t3$9119 instanceof Array)&&(((t4$9120=t3$9119.length)),(t4$9120===3))))))))))))){(target$9263=t3$9119[0]);(end$9264=t3$9119[1]);(attr$9265=t3$9119[2]);(rest$9266=Array.prototype.slice.call(t1$9117,1));(t0$9297=jumptill$8850(active$9261,start$9260,target$9263));if(((t0$9297 instanceof Array)&&(((t1$9298=t0$9297.length)),(t1$9298===2)))){(spans$9294=t0$9297[0]);(newactive$9295=t0$9297[1]);}else{$10236(jumptill$8850(active$9261,start$9260,target$9263),"/home/olivier/git/earl-grey/src/location.eg",4542,4583);}return spans$9294.concat(process_elements$8851(target$9263,[next$9262].concat(newactive$9295),rest$9266));}else{$10236($9102$9111);}}}});(thespans$8852=spans$8842.sort(function($9317$9322,$9319$9323){var t0$9330;var t1$9331;var t0$9345;var t1$9346;var s1$9325;var e1$9326;var s2$9327;var e2$9328;(t0$9330=$9317$9322);if(((t0$9330 instanceof Array)&&(((t1$9331=t0$9330.length)),(t1$9331===3)))){(s1$9325=t0$9330[0]);(e1$9326=t0$9330[1]);t0$9330[2];}else{$10236($9317$9322);}(t0$9345=$9319$9323);if(((t0$9345 instanceof Array)&&(((t1$9346=t0$9345.length)),(t1$9346===3)))){(s2$9327=t0$9345[0]);(e2$9328=t0$9345[1]);t0$9345[2];}else{$10236($9319$9323);}if((s1$9325===s2$9327)){return (e1$9326-e2$9328);}else{return (s1$9325-s2$9327);}}));return process_elements$8851(thespans$8852[0][0],[],thespans$8852);});(highlight_locations$8045=function(){var $index$9410;var $length$9404;var temp$9398;var $index$9478;var $length$9472;var temp$9466;var acc$9460;var srcs$9388;var locations$9378;var context$9379;var t0$9374;var $9365$9369;($9365$9369=arguments);(t0$9374=$9365$9369.length);if(((t0$9374>=1)&&(t0$9374<=2))){(locations$9378=$9365$9369[0]);(context$9379=function(){if((1>=t0$9374)){return 0;}else{return $9365$9369[1];}}());(srcs$9388=({}));(temp$9398=locations$9378);($length$9404=temp$9398.length);($index$9410=0);$9389:for(;($index$9410<$length$9404);($index$9410++)){var key$9444;var loc$9429;var cls$9430;var t0$9424;var t1$9425;var m$9419;(m$9419=temp$9398[$index$9410]);(t0$9424=m$9419);if(((t0$9424 instanceof Array)&&(((t1$9425=t0$9424.length)),(t1$9425===2)))){(loc$9429=t0$9424[0]);(cls$9430=t0$9424[1]);(key$9444=String((loc$9429.source&&loc$9429.source.url)));if((!$7944(srcs$9388,key$9444))){(srcs$9388[key$9444]=[]);}$7944(srcs$9388,key$9444).push([loc$9429,cls$9430]);}else{$10236(m$9419,"/home/olivier/git/earl-grey/src/location.eg",4929,5098);}}return $10514(["div"],({}),(((acc$9460=[])),(((temp$9466=$10921(srcs$9388))),((($length$9472=temp$9466.length)),((($index$9478=0)),function(){$9455:for(;($index$9478<$length$9472);($index$9478++)){var locs$9497;var t0$9492;var t1$9493;var m$9487;(m$9487=temp$9466[$index$9478]);(t0$9492=m$9487);if(((t0$9492 instanceof Array)&&(((t1$9493=t0$9492.length)),(t1$9493===2)))){t0$9492[0];(locs$9497=t0$9492[1]);acc$9460.push(highlight_locations_same_source$8046(locs$9497,context$9379));}else{$10236(m$9487,"/home/olivier/git/earl-grey/src/location.eg",5103,5197);}}}()))),acc$9460));}else{$10236($9365$9369);}});(highlight_locations_same_source$8046=function(){var $index$9577;var $length$9571;var temp$9565;var acc$9559;var t0$9617;var t1$9618;var $index$9660;var $length$9654;var temp$9648;var acc$9642;var $index$9718;var $length$9712;var temp$9706;var acc$9700;var loc$9546;var src$9547;var l1$9548;var l2$9549;var first$9550;var last$9551;var locations$9532;var context$9533;var t0$9528;var $9519$9523;($9519$9523=arguments);(t0$9528=$9519$9523.length);if(((t0$9528>=1)&&(t0$9528<=2))){(locations$9532=$9519$9523[0]);(context$9533=function(){if((1>=t0$9528)){return 0;}else{return $9519$9523[1];}}());(loc$9546=merge_locations$8047((((acc$9559=[])),(((temp$9565=locations$9532)),((($length$9571=temp$9565.length)),((($index$9577=0)),function(){$9554:for(;($index$9577<$length$9571);($index$9577++)){var x$9596;var cls$9597;var t0$9591;var t1$9592;var m$9586;(m$9586=temp$9565[$index$9577]);(t0$9591=m$9586);if(((t0$9591 instanceof Array)&&(((t1$9592=t0$9591.length)),(t1$9592===2)))){(x$9596=t0$9591[0]);(cls$9597=t0$9591[1]);acc$9559.push(x$9596);}else{$10236(m$9586,"/home/olivier/git/earl-grey/src/location.eg",5280,5308);}}}()))),acc$9559)));(src$9547=loc$9546.source);(t0$9617=loc$9546.linerange());if(((t0$9617 instanceof Array)&&(((t1$9618=t0$9617.length)),(t1$9618===2)))){(l1$9548=t0$9617[0]);(l2$9549=t0$9617[1]);}else{$10236(loc$9546.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5344,5363);}(first$9550=Math.max(1,(l1$9548-context$9533)));(last$9551=Math.min(src$9547.nlines,(l2$9549+context$9533)));return $10514(["div",".location"],({}),[$10514(["div",".source"],({}),[$10514([".sourcefile"],({}),(src$9547.url||"???")),(((acc$9642=[])),(((temp$9648=locations$9532)),((($length$9654=temp$9648.length)),((($index$9660=0)),function(){$9637:for(;($index$9660<$length$9654);($index$9660++)){var loc$9679;var cls$9680;var t0$9674;var t1$9675;var m$9669;(m$9669=temp$9648[$index$9660]);(t0$9674=m$9669);if(((t0$9674 instanceof Array)&&(((t1$9675=t0$9674.length)),(t1$9675===2)))){(loc$9679=t0$9674[0]);(cls$9680=t0$9674[1]);acc$9642.push($10514([("."+cls$9680),".sourcepos"],({}),loc$9679.ref()));}else{$10236(m$9669,"/home/olivier/git/earl-grey/src/location.eg",5528,5674);}}}()))),acc$9642)]),src$9547.highlight_lines(first$9550,last$9551,(((acc$9700=[])),(((temp$9706=locations$9532)),((($length$9712=temp$9706.length)),((($index$9718=0)),function(){$9695:for(;($index$9718<$length$9712);($index$9718++)){var loc$9737;var cls$9738;var t0$9732;var t1$9733;var m$9727;(m$9727=temp$9706[$index$9718]);(t0$9732=m$9727);if(((t0$9732 instanceof Array)&&(((t1$9733=t0$9732.length)),(t1$9733===2)))){(loc$9737=t0$9732[0]);(cls$9738=t0$9732[1]);acc$9700.push([loc$9737.start,loc$9737.end,[cls$9738]]);}else{$10236(m$9727,"/home/olivier/git/earl-grey/src/location.eg",5729,5787);}}}()))),acc$9700))]);}else{$10236($9519$9523);}});(merge_locations$8047=function($9759$9762){var $index$9834;var $length$9828;var temp$9822;var acc$9816;var $index$9880;var $length$9874;var temp$9868;var acc$9862;var start$9807;var end$9808;var locs$9801;var loc$9796;var $9768$9783;var $9769$9784;var t0$9781;var $9764$9776;var ph$9770;(ph$9770=$9759$9762);($9764$9776=ph$9770);if((($9768$9783=($9764$9776 instanceof Array))&&(((t0$9781=$9764$9776.length)),(t0$9781===0)))){return Location$8040(null,0,0);}else{if(($9768$9783&&(t0$9781===1))){(loc$9796=$9764$9776[0]);return loc$9796;}else{if(($9768$9783&&(t0$9781>=0))){(locs$9801=Array.prototype.slice.call($9764$9776,0));(start$9807=$7944(Math.min,(((acc$9816=[])),(((temp$9822=locs$9801)),((($length$9828=temp$9822.length)),((($index$9834=0)),function(){$9811:for(;($index$9834<$length$9828);($index$9834++)){var loc$9851;var m$9843;(m$9843=temp$9822[$index$9834]);(loc$9851=m$9843);acc$9816.push(loc$9851.start);}}()))),acc$9816)));(end$9808=$7944(Math.max,(((acc$9862=[])),(((temp$9868=locs$9801)),((($length$9874=temp$9868.length)),((($index$9880=0)),function(){$9857:for(;($index$9880<$length$9874);($index$9880++)){var loc$9897;var m$9889;(m$9889=temp$9868[$index$9880]);(loc$9897=m$9889);acc$9862.push(loc$9897.end);}}()))),acc$9862)));return Location$8040(locs$9801[0].source,start$9807,end$9808);}else{$10236($9764$9776);}}}});(__lt____lt____colon__$8048=function(x$9908,y$9909){if((!$7925(Location$8040)(x$9908.location))){(x$9908["location"]=function(){if(((!y$9909)||$7925(Location$8040)(y$9909))){return y$9909;}else{return y$9909.location;}}());}return x$9908;});(__plus____plus____colon__$8049=function(x$9922,y$9923){var rval$9940;var x2$9928;var y2$9929;(x2$9928=function(){if(((!x$9922)||$7925(Location$8040)(x$9922))){return x$9922;}else{return x$9922.location;}}());(y2$9929=function(){if(((!y$9923)||$7925(Location$8040)(y$9923))){return y$9923;}else{return y$9923.location;}}());(rval$9940=false);try{(rval$9940=merge_locations$8047([x2$9928,y2$9929]));}catch(excv$9951){var e$9957;(e$9957=excv$9951);(rval$9940=(void 0));}return rval$9940;});(format_error$8050=function(){var $index$10073;var $length$10067;var temp$10061;var acc$10055;var hls$10043;var locs$10044;var rval$10155;var loc$10181;var data$10148;var other$10187;var url$10136;var start$10137;var end$10138;var loc$10126;var args$10023;var fmt_args$10013;var $9975$10008;var $9976$10009;var $9977$10010;var t0$10004;var t1$10005;var t2$10006;var e$9990;var context$9991;var $9970$9992;var t0$9985;var t1$9986;var $9968$9980;($9968$9980=arguments);(t0$9985=$9968$9980.length);if(((t0$9985>=1)&&(t0$9985<=2))){(t1$9986=$9968$9980[0]);(e$9990=t1$9986);($9970$9992=t1$9986);(context$9991=function(){if((1>=t0$9985)){return 0;}else{return $9968$9980[1];}}());(fmt_args$10013=function(e$10018){if((e$10018.args&&e$10018.args.length)){return $10514([".error_args"],({}),repr$8037(e$10018.args));}else{return "";}});(t0$10004=$9970$9992);if(($7925($10255(["syntax"]))(t0$10004)&&($10850(t0$10004,"args")&&(((t1$10005=t0$10004.args)),((t1$10005 instanceof Array)&&(((t2$10006=t1$10005.length)),(t2$10006===1))))))){(args$10023=t1$10005[0]);(hls$10043=["hl1","hl2","hl3","hl4"]);(locs$10044=(((acc$10055=[])),(((temp$10061=$10488($10921(args$10023)))),((($length$10067=temp$10061.length)),((($index$10073=0)),function(){$10050:for(;($index$10073<$length$10067);($index$10073++)){var i$10094;var key$10095;var arg$10096;var t0$10087;var t1$10088;var t2$10089;var t3$10090;var m$10082;(m$10082=temp$10061[$index$10073]);(t0$10087=m$10082);if(((t0$10087 instanceof Array)&&(((t1$10088=t0$10087.length)),((t1$10088===2)&&((i$10094=t0$10087[0]),(((t2$10089=t0$10087[1])),((t2$10089 instanceof Array)&&(((t3$10090=t2$10089.length)),((t3$10090===2)&&((key$10095=t2$10089[0]),((arg$10096=t2$10089[1]),(arg$10096&&arg$10096.location)))))))))))){acc$10055.push([arg$10096.location,$7944(hls$10043,(i$10094%4))]);}else{false;}}}()))),acc$10055));return $10514(["div"],({}),[$10514([".error"],({}),[$10514([".error_type"],({}),e$9990.name),$10514([".error_message"],({}),e$9990.message)]),$10514([".error_args",".syntax"],({}),repr$8037(args$10023)),highlight_locations$8045(locs$10044,context$9991)]);}else{if((($9976$10009=$10850(t0$10004,"location"))&&(((t1$10005=t0$10004.location)),$7925(Location$8040)(t1$10005)))){(loc$10126=t1$10005);return $10514(["div"],({}),[$10514([".error"],({}),[$10514([".error_type"],({}),e$9990.name),$10514([".error_message"],({}),e$9990.message)]),fmt_args$10013(e$9990),highlight_locations$8045([[loc$10126,"hl1"]],context$9991),$10514([".traceback"],({}),(e$9990.stack||""))]);}else{if(($9976$10009&&((t1$10005 instanceof Array)&&(((t2$10006=t1$10005.length)),((t2$10006===4)&&(t1$10005[0]==="location")))))){(url$10136=t1$10005[1]);(start$10137=t1$10005[2]);(end$10138=t1$10005[3]);(data$10148=(((rval$10155=false)),(function(){try{(rval$10155=fs$8038.readFileSync(url$10136,"utf8"));}catch(excv$10166){var e$10172;(e$10172=excv$10166);(rval$10155=null);}}(),rval$10155)));if(data$10148){(loc$10181=Location$8040(Source$8039(data$10148,url$10136),start$10137,end$10138));return $10514(["div"],({}),[$10514([".error"],({}),[$10514([".error_type"],({}),e$9990.name),$10514([".error_message"],({}),e$9990.message)]),fmt_args$10013(e$9990),highlight_locations$8045([[loc$10181,"hl1"]],context$9991),$10514([".traceback"],({}),($10514([],({}),e$9990.stack)||""))]);}else{return $10514(["div"],({}),[$10514([".error"],({}),[$10514([".error_type"],({}),e$9990.name),$10514([".error_message"],({}),e$9990.message)]),fmt_args$10013(e$9990),$10514([".traceback"],({}),($10514([],({}),e$9990.stack)||e$9990))]);}}else{(other$10187=$9970$9992);return $10514(["div"],({}),[$10514([".error"],({}),[$10514([".error_type"],({}),e$9990.name),$10514([".error_message"],({}),e$9990.message)]),fmt_args$10013(e$9990),$10514([".traceback"],({}),$10514([],({}),e$9990.stack))]);}}}}else{$10236($9968$9980);}});(display_error$8051=function(e$10196){return __lt____gt__$8036(null,format_error$8050(e$10196));});(exports["Source"]=Source$8039);(exports["Location"]=Location$8040);(exports["highlight"]=highlight$8041);(exports["highlight_locations"]=highlight_locations$8045);(exports["merge_locations"]=merge_locations$8047);(exports["<<:"]=__lt____lt____colon__$8048);(exports["++:"]=__plus____plus____colon__$8049);(exports["format_error"]=format_error$8050);(exports["display_error"]=display_error$8051);
