var $4105=function(type$4107){var f$4110;(f$4110=type$4107["::check"]);;if((f$4110===(void 0))){return function(value$4115){return (value$4115 instanceof type$4107);};}else{return function(value$4118){return f$4110.call(type$4107,value$4118);};}};
var $4120=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $4121=function($4122$4124){var ph$4128;(ph$4128=$4122$4124);;var $4126$4133;($4126$4133=ph$4128);;var bridge$4127$4138;var x$4142;(bridge$4127$4138=$4126$4133);if((((typeof(bridge$4127$4138)==="string")&&((x$4142=bridge$4127$4138),true))||((typeof(bridge$4127$4138)==="number")&&((x$4142=bridge$4127$4138),true)))){return ["value",x$4142];}else{var other$4149;(other$4149=$4126$4133);return other$4149["::serialize_ast"]();}};
var send$3968;(send$3968=function(obj$3973,$3971$3974){var ph$3978;var msg$3979;var t0$3981;(t0$3981=$3971$3974);(msg$3979=t0$3981);(ph$3978=t0$3981);;var $3976$3985;($3976$3985=ph$3978);;var bridge$3977$3990;(bridge$3977$3990=$3976$3985);if(((typeof(bridge$3977$3990)==="string")||(typeof(bridge$3977$3990)==="number"))){return obj$3973[msg$3979];}else{var other$3998;(other$3998=$3976$3985);return obj$3973["::send"](msg$3979);}});;(Array[":::project"]=function($4001$4003){var ph$4006;var value$4007;var t0$4009;(t0$4009=$4001$4003);(value$4007=t0$4009);(ph$4006=t0$4009);;var $4005$4013;($4005$4013=ph$4006);;if($4105(Array)($4005$4013)){return [true,value$4007];}else{$4005$4013;return [true,[value$4007]];}});(Array.prototype["::check"]=function(value$4027){if((value$4027 instanceof Array)){var i$4032;(i$4032=0);;$4030:for(;(i$4032<this.length);(i$4032++)){if(($4120(this,i$4032)!==$4120(value$4027,i$4032))){return false;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value$4041){if((value$4041 instanceof Array)){var i$4046;(i$4046=0);;$4044:for(;(i$4046<this.length);(i$4046++)){if(($4120(this,i$4046)!==$4120(value$4041,i$4046))){return [true,[value$4041]];}}return [true,value$4041.slice(this.length)];}else{return [true,[value$4041]];}});(Array.prototype[":::deconstruct"]=function(value$4055){return [true,value$4055.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($4121));});(RegExp.prototype["::check"]=function(value$4060){return value$4060.match(this);});(RegExp.prototype[":::project"]=function(value$4063){var $4065$4067;($4065$4067=value$4063.match(this));;var m$4075;if(($4065$4067===null)){(m$4075=$4065$4067);return [false,null];}else{var m$4080;(m$4080=$4065$4067);return [true,m$4080];}});(RegExp.prototype[":::deconstruct"]=function(value$4083){var $4085$4087;($4085$4087=value$4083.match(this));;var m$4095;if(($4085$4087===null)){(m$4095=$4085$4087);return [false,null];}else{var m$4100;(m$4100=$4085$4087);return [true,m$4100];}});(Function.prototype["::send"]=function(args$4103){return this.apply(this,args$4103);});
var $5730=function(dest$5732,values$5733){var k$5738;(k$5738=null);$5736:for(k$5738 in values$5733){if(values$5733.hasOwnProperty(k$5738)){(dest$5732[k$5738]=values$5733[k$5738]);}}return dest$5732;};
var $5624=function(){var $5625$5627;($5625$5627=function(tags$5631){var it$0$5634;(it$0$5634=function(){if((!$4105($5625$5627)(this))){return Object.create($5625$5627.prototype);}else{return this;}}());;(it$0$5634["tags"]=tags$5631);return it$0$5634;});;($5625$5627.prototype["create"]=function(){var $5643$5645;($5643$5645=arguments);;var t0$5650;var message$5654;var args$5655;(t0$5650=$5643$5645.length);if((t0$5650>=0)){(message$5654=function(){if((0>=t0$5650)){return "";}else{return $5643$5645[0];}}());(args$5655=Array.prototype.slice.call($5643$5645,1));var it$0$5659;(it$0$5659=this);;var e$5664;(e$5664=Error(message$5654));;(e$5664["::tags"]=it$0$5659.tags);(e$5664["args"]=args$5655);(e$5664["name"]=["E"].concat(it$0$5659.tags).join("."));return e$5664;}else{$5611($5643$5645);}});($5625$5627.prototype["::check"]=function(e$5673){var it$0$5676;(it$0$5676=this);;var tags$5681;if(((!e$5673)||(!$4105(Error)(e$5673)))){return false;}(tags$5681=(e$5673["::tags"]||[]));;var temp$5689;(temp$5689=it$0$5676.tags);;var len$5694;(len$5694=temp$5689.length);;var i$5699;(i$5699=0);;$5682:for(;(i$5699<len$5694);(i$5699++)){var m$5707;(m$5707=temp$5689[i$5699]);;var tag$5715;(tag$5715=m$5707);if((tags$5681.indexOf(tag$5715)===(-1))){return false;}else{false;;}}return true;});($5625$5627.prototype["::deconstruct"]=function(e$5723){var it$0$5726;(it$0$5726=this);;return e$5723.args;});$5730($5625$5627,({}));return $5625$5627;}();
var $5611=function(value$5613,url$5614,start$5615,end$5616){var err$5619;(err$5619=$5624(["match"]).create("Could not find a match for value",({"value":value$5613})));;if(url$5614){(err$5619["location"]=["location",url$5614,start$5615,end$5616]);}throw err$5619;};
var $5847=function(type$5849){return function(value$5852){var f$5855;(f$5855=type$5849[":::project"]);;if((f$5855===(void 0))){var f$5860;(f$5860=type$5849["::project"]);;if((f$5860===(void 0))){return [true,type$5849(value$5852)];}else{var rval$5865;(rval$5865=false);;try{(rval$5865=[true,f$5860(value$5852)]);}catch(excv$5871){var e$5877;(e$5877=excv$5871);(rval$5865=[false,null]);}return rval$5865;}}else{return f$5855.call(type$5849,value$5852);}};};
var $5742=function(){var $5743$5745;($5743$5745=function($5748$5751,$5749$5752){var classes$5754;var children$5755;var t0$5757;(t0$5757=$5847(Array)($5748$5751));if(t0$5757[0]){(classes$5754=t0$5757[1]);;}else{$5611($5748$5751);}var t0$5762;(t0$5762=$5847(Array)($5749$5752));if(t0$5762[0]){(children$5755=t0$5762[1]);;}else{$5611($5749$5752);}var it$0$5767;(it$0$5767=function(){if((!$4105($5743$5745)(this))){return Object.create($5743$5745.prototype);}else{return this;}}());;(it$0$5767["classes"]=classes$5754.sort());(it$0$5767["children"]=children$5755);return it$0$5767;});;$5730(function(){var accum$5775;(accum$5775=({}));(accum$5775["::check"]=function(x$5779){return ((x$5779&&x$5779.classes)&&x$5779.children);});return accum$5775;}(),function(){var accum$5782;(accum$5782=({}));(accum$5782["::deconstruct"]=function(x$5786){return [x$5786.classes,x$5786.children];});return accum$5782;}());($5743$5745.prototype["::check"]=function(n$5791){var it$0$5794;(it$0$5794=this);;var temp$5802;(temp$5802=it$0$5794.classes);;var len$5807;(len$5807=temp$5802.length);;var i$5812;(i$5812=0);;$5799:for(;(i$5812<len$5807);(i$5812++)){var m$5820;(m$5820=temp$5802[i$5812]);;var c$5828;(c$5828=m$5820);if((n$5791.classes.indexOf(c$5828)===(-1))){return false;}else{false;;}}return true;});$5730($5743$5745,$5730(function(){var accum$5834;(accum$5834=({}));(accum$5834["::check"]=function(x$5838){return ((x$5838&&x$5838.classes)&&x$5838.children);});return accum$5834;}(),function(){var accum$5841;(accum$5841=({}));(accum$5841["::deconstruct"]=function(x$5845){return [x$5845.classes,x$5845.children];});return accum$5841;}()));return $5743$5745;}();
var $5879=function(from$5881,to$5882){var rval$5886;(rval$5886=[]);;var i$5891;(i$5891=from$5881);;$5885:for(;(i$5891<=to$5882);(i$5891++)){rval$5886.push(i$5891);}return rval$5886;};
var $5898=function($5899$5901,key$5902){var ph$5906;(ph$5906=$5899$5901);;var $5904$5911;($5904$5911=ph$5906);;var bridge$5905$5916;(bridge$5905$5916=$5904$5911);if(((bridge$5905$5916===null)||(bridge$5905$5916===(void 0)))){return false;}else{var x$5924;if((typeof($5904$5911)==="string")){(x$5924=$5904$5911);return (key$5902 in String.prototype);}else{var x$5929;if((typeof($5904$5911)==="number")){(x$5929=$5904$5911);return (key$5902 in Number.prototype);}else{var x$5934;(x$5934=$5904$5911);return (key$5902 in x$5934);}}}};var $4152$4154;var binsearch$4155;var items$4156;var enumerate$4157;var $4153$4158;var Node$4159;var __lt____gt__$4160;var repr$4161;var fs$4162;var Source$4163;var Location$4164;var highlight$4165;var highlight_lines$4166;var clamp$4167;var morsel$4168;var highlight_locations$4169;var highlight_locations_same_source$4170;var merge_locations$4171;var __lt____lt____colon__$4172;var __plus____plus____colon__$4173;var format_error$4174;var display_error$4175;($4152$4154=require("./util"));;(binsearch$4155=$4152$4154.binsearch);;(items$4156=$4152$4154.items);;(enumerate$4157=$4152$4154.enumerate);;($4153$4158=require("./pp"));;(Node$4159=$4153$4158.Node);;(__lt____gt__$4160=$4153$4158["<>"]);;(repr$4161=$4153$4158.repr);;(fs$4162=require("fs"));;(Source$4163=function(){var i$4245;var len$4240;var temp$4235;var curr$4228;var it$0$4222;var text$4217;var url$4218;var t0$4213;var $4206$4208;($4206$4208=arguments);;(t0$4213=$4206$4208.length);if(((t0$4213>=1)&&(t0$4213<=2))){(text$4217=$4206$4208[0]);(url$4218=function(){if((1>=t0$4213)){return false;}else{return $4206$4208[1];}}());(it$0$4222=function(){if((!$4105(Source$4163)(this))){return Object.create(Source$4163.prototype);}else{return this;}}());;(it$0$4222["text"]=text$4217);(it$0$4222["url"]=url$4218);(it$0$4222["counts"]=[]);(curr$4228=0);;(temp$4235=text$4217.split("\n"));;(len$4240=temp$4235.length);;(i$4245=0);;$4229:for(;(i$4245<len$4240);(i$4245++)){var line$4261;var m$4253;(m$4253=temp$4235[i$4245]);;(line$4261=m$4253);it$0$4222.counts.push(curr$4228);(curr$4228=(curr$4228+(line$4261.length+1)));}it$0$4222.counts.push(curr$4228);(it$0$4222["nlines"]=(it$0$4222.counts.length-1));return it$0$4222;}else{$5611($4206$4208);}});;(Source$4163.prototype["linecol"]=function(pos$4270){var line$4278;var col$4279;var it$0$4273;(it$0$4273=this);;(line$4278=binsearch$4155(it$0$4273.counts,pos$4270));;(col$4279=(pos$4270-$4120(it$0$4273.counts,(line$4278-1))));;return [line$4278,col$4279];});(Source$4163.prototype["highlight_lines"]=function(l1$4289,l2$4290,spans$4291){var it$0$4294;(it$0$4294=this);;return highlight_lines$4166(it$0$4294.text,it$0$4294.counts,[(l1$4289-1),(l2$4290-1)],spans$4291);});$5730(Source$4163,({}));Source$4163;(Location$4164=function(source$4301,start$4302,end$4303){var it$0$4306;(it$0$4306=function(){if((!$4105(Location$4164)(this))){return Object.create(Location$4164.prototype);}else{return this;}}());;(it$0$4306["source"]=(source$4301||Source$4163("",null)));(it$0$4306["start"]=start$4302);(it$0$4306["end"]=end$4303);return it$0$4306;});;(Location$4164.prototype["text"]=function(){var it$0$4318;(it$0$4318=this);;return it$0$4318.source.text.slice(it$0$4318.start,it$0$4318.end);});(Location$4164.prototype["linerange"]=function(){var l2$4362;var t0$4353;var t1$4354;var l1$4345;var $4328$4346;var t0$4339;var t1$4340;var t2$4341;var $4327$4334;var it$0$4329;(it$0$4329=this);;($4327$4334=it$0$4329.linecol());;if((($4327$4334 instanceof Array)&&((t0$4339=$4327$4334.length),((t0$4339===2)&&((t1$4340=$4327$4334[0]),((t1$4340 instanceof Array)&&((t2$4341=t1$4340.length),(t2$4341===2)))))))){(l1$4345=t1$4340[0]);t1$4340[1];($4328$4346=$4327$4334[1]);if(($4328$4346===null)){return [l1$4345,l1$4345];}else{(t0$4353=$4328$4346);if(((t0$4353 instanceof Array)&&((t1$4354=t0$4353.length),(t1$4354===2)))){(l2$4362=t0$4353[0]);t0$4353[1];return [l1$4345,l2$4362];}else{$5611($4328$4346,"/home/olivier/git/earl-grey/src/location.eg",978,983);}}}else{$5611($4327$4334);}});(Location$4164.prototype["linecol"]=function(){var start$4380;var end$4381;var it$0$4375;(it$0$4375=this);;(start$4380=it$0$4375.source.linecol(it$0$4375.start));;(end$4381=function(){if((it$0$4375.start===it$0$4375.end)){return null;}else{return it$0$4375.source.linecol((it$0$4375.end-1));}}());;return [start$4380,end$4381];});(Location$4164.prototype["ref"]=function(){var otherwise$4464;var $4445$4453;var $4444$4447;var l2$4436;var c2$4437;var t0$4425;var t1$4426;var t2$4427;var t3$4428;var l1$4413;var c1$4414;var $4394$4415;var t0$4405;var t1$4406;var t2$4407;var t3$4408;var t4$4409;var $4393$4400;var it$0$4395;(it$0$4395=this);;($4393$4400=it$0$4395.linecol());;if((($4393$4400 instanceof Array)&&((t0$4405=$4393$4400.length),((t0$4405===2)&&((t1$4406=$4393$4400[0]),((t1$4406 instanceof Array)&&((t2$4407=t1$4406.length),((t2$4407===2)&&((t3$4408=[true,String(t1$4406[0])]),(t3$4408[0]&&((l1$4413=t3$4408[1]),((t4$4409=[true,String(t1$4406[1])]),t4$4409[0])))))))))))){(c1$4414=t4$4409[1]);($4394$4415=$4393$4400[1]);if(($4394$4415===null)){return ((l1$4413+":")+c1$4414);}else{(t0$4425=$4394$4415);if(((t0$4425 instanceof Array)&&((t1$4426=t0$4425.length),((t1$4426===2)&&((t2$4427=[true,String(t0$4425[0])]),(t2$4427[0]&&((l2$4436=t2$4427[1]),((t3$4428=[true,String(t0$4425[1])]),t3$4428[0])))))))){(c2$4437=t3$4428[1]);($4444$4447=null);;$4444$4447;if(((l1$4413===l2$4436)&&(c1$4414===c2$4437))){return ((l1$4413+":")+c1$4414);}else{if((l1$4413===l2$4436)){return ((((l1$4413+":")+c1$4414)+"-")+c2$4437);}else{(otherwise$4464=$4444$4447);return ((((((l1$4413+":")+c1$4414)+"-")+l1$4413)+":")+c2$4437);}}}else{$5611($4394$4415,"/home/olivier/git/earl-grey/src/location.eg",1318,1323);}}}else{$5611($4393$4400);}});(Location$4164.prototype["highlight"]=function(){var it$0$4489;var cls$4484;var context$4485;var t0$4480;var $4473$4475;($4473$4475=arguments);;(t0$4480=$4473$4475.length);if(((t0$4480>=0)&&(t0$4480<=2))){(cls$4484=function(){if((0>=t0$4480)){return "hl1";}else{return $4473$4475[0];}}());(context$4485=function(){if((1>=t0$4480)){return 0;}else{return $4473$4475[1];}}());(it$0$4489=this);;return highlight_locations$4169([[it$0$4489,cls$4484]],context$4485);}else{$5611($4473$4475);}});$5730(Location$4164,({}));Location$4164;(highlight$4165=function(){var i$4531;var len$4526;var temp$4521;var acc$4516;var text$4509;var spans$4510;var offset$4511;var t0$4505;var $4498$4500;($4498$4500=arguments);;(t0$4505=$4498$4500.length);if(((t0$4505>=2)&&(t0$4505<=3))){(text$4509=$4498$4500[0]);(spans$4510=$4498$4500[1]);(offset$4511=function(){if((2>=t0$4505)){return 0;}else{return $4498$4500[2];}}());return $5742([],(((acc$4516=[])),(((temp$4521=morsel$4168(spans$4510))),(((len$4526=temp$4521.length)),(((i$4531=0)),function(){$4514:for(;(i$4531<len$4526);(i$4531++)){var xstart$4556;var xend$4557;var start$4549;var end$4550;var attributes$4551;var t0$4544;var t1$4545;var m$4539;(m$4539=temp$4521[i$4531]);;(t0$4544=m$4539);if(((t0$4544 instanceof Array)&&((t1$4545=t0$4544.length),(t1$4545===3)))){(start$4549=t0$4544[0]);(end$4550=t0$4544[1]);(attributes$4551=t0$4544[2]);acc$4516.push((((xstart$4556=Math.max((start$4549-offset$4511),0))),((xend$4557=Math.min((end$4550-offset$4511),text$4509.length))),Node$4159(attributes$4551.slice(0,1),[text$4509.slice(xstart$4556,xend$4557)])));}else{false;;}}}()))),acc$4516));}else{$5611($4498$4500);}});;(highlight_lines$4166=function(text$4573,linelocs$4574,$4571$4575,spans$4576){var t0$4581;var t1$4582;var i$4604;var len$4599;var temp$4594;var acc$4589;var l1$4578;var l2$4579;(t0$4581=$4571$4575);if(((t0$4581 instanceof Array)&&((t1$4582=t0$4581.length),(t1$4582===2)))){(l1$4578=t0$4581[0]);(l2$4579=t0$4581[1]);;}else{$5611($4571$4575);}return $5742(["+span"],(((acc$4589=[])),(((temp$4594=$5879(l1$4578,l2$4579))),(((len$4599=temp$4594.length)),(((i$4604=0)),function(){$4587:for(;(i$4604<len$4599);(i$4604++)){var start$4623;var end$4624;var lineno$4620;var m$4612;(m$4612=temp$4594[i$4604]);;(lineno$4620=m$4612);acc$4589.push((((start$4623=$4120(linelocs$4574,lineno$4620))),((end$4624=$4120(linelocs$4574,(lineno$4620+1)))),$5742(["+span"],[$5742(["lineno"],(lineno$4620+1)),$5742(["source"],highlight$4165(text$4573,[[start$4623,end$4624,[]]].concat(clamp$4167(spans$4576,start$4623,end$4624))))])));}}()))),acc$4589));});;(clamp$4167=function(spans$4635,bot$4636,top$4637){var i$4656;var len$4651;var temp$4646;var acc$4641;(acc$4641=[]);;(temp$4646=spans$4635);;(len$4651=temp$4646.length);;(i$4656=0);;$4639:for(;(i$4656<len$4651);(i$4656++)){var start$4674;var end$4675;var attr$4676;var t0$4669;var t1$4670;var m$4664;(m$4664=temp$4646[i$4656]);;(t0$4669=m$4664);if(((t0$4669 instanceof Array)&&((t1$4670=t0$4669.length),((t1$4670===3)&&((start$4674=t0$4669[0]),((end$4675=t0$4669[1]),((attr$4676=t0$4669[2]),((end$4675>=bot$4636)&&(start$4674<=top$4637))))))))){acc$4641.push([Math.max(start$4674,bot$4636),Math.min(end$4675,top$4637),attr$4676]);}else{false;;}}return acc$4641;});;(morsel$4168=function(spans$4689){var jump$4692;var jumptill$4693;var process$4694;var thespans$4695;(jump$4692=function(active$4699,bot$4700,top$4701){var i$4727;var len$4722;var temp$4717;var acc$4712;var i$4767;var len$4762;var temp$4757;var e$4704;var attributes$4705;(e$4704=$4120(Math.min,[top$4701].concat((((acc$4712=[])),(((temp$4717=active$4699)),(((len$4722=temp$4717.length)),(((i$4727=0)),function(){$4710:for(;(i$4727<len$4722);(i$4727++)){var x$4745;var t0$4740;var t1$4741;var m$4735;(m$4735=temp$4717[i$4727]);;(t0$4740=m$4735);if(((t0$4740 instanceof Array)&&((t1$4741=t0$4740.length),(t1$4741===3)))){t0$4740[0];(x$4745=t0$4740[1]);t0$4740[2];acc$4712.push(x$4745);}else{false;;}}}()))),acc$4712))));;(attributes$4705=[]);;(temp$4757=active$4699);;(len$4762=temp$4757.length);;(i$4767=0);;$4706:for(;(i$4767<len$4762);(i$4767++)){var X$4785;var t0$4780;var t1$4781;var m$4775;(m$4775=temp$4757[i$4767]);;(t0$4780=m$4775);if(((t0$4780 instanceof Array)&&((t1$4781=t0$4780.length),(t1$4781===3)))){t0$4780[0];t0$4780[1];(X$4785=t0$4780[2]);(attributes$4705=attributes$4705.concat(X$4785));}else{false;;}}return [e$4704,[bot$4700,e$4704,attributes$4705]];});;(jumptill$4693=function(active$4795,bot$4796,top$4797){var t0$4806;var t1$4807;var i$4831;var len$4826;var temp$4821;var acc$4816;var t0$4862;var t1$4863;var newbot$4800;var span$4801;var newactive$4802;var spans$4803;var remainder$4804;if((bot$4796===top$4797)){return [[],active$4795];}else{(t0$4806=jump$4692(active$4795,bot$4796,top$4797));if(((t0$4806 instanceof Array)&&((t1$4807=t0$4806.length),(t1$4807===2)))){(newbot$4800=t0$4806[0]);(span$4801=t0$4806[1]);;}else{$5611(jump$4692(active$4795,bot$4796,top$4797),"/home/olivier/git/earl-grey/src/location.eg",3736,3758);}(newactive$4802=(((acc$4816=[])),(((temp$4821=active$4795)),(((len$4826=temp$4821.length)),(((i$4831=0)),function(){$4814:for(;(i$4831<len$4826);(i$4831++)){var x$4849;var e$4850;var attr$4851;var t0$4844;var t1$4845;var m$4839;(m$4839=temp$4821[i$4831]);;(t0$4844=m$4839);(x$4849=t0$4844);if(((t0$4844 instanceof Array)&&((t1$4845=t0$4844.length),((t1$4845===3)&&(t0$4844[0],((e$4850=t0$4844[1]),((attr$4851=t0$4844[2]),(e$4850>newbot$4800)))))))){acc$4816.push(x$4849);}else{false;;}}}()))),acc$4816));;(t0$4862=jumptill$4693(newactive$4802,newbot$4800,top$4797));if(((t0$4862 instanceof Array)&&((t1$4863=t0$4862.length),(t1$4863===2)))){(spans$4803=t0$4862[0]);(remainder$4804=t0$4862[1]);;}else{$5611(jumptill$4693(newactive$4802,newbot$4800,top$4797),"/home/olivier/git/earl-grey/src/location.eg",3880,3912);}return [[span$4801].concat(spans$4803),remainder$4804];}});;(process$4694=function(start$4872,active$4873,rem$4874){var i$4938;var len$4933;var temp$4928;var acc$4923;var t0$4967;var t1$4968;var top$4916;var bot$4917;var spans$4918;var t0$4995;var t1$4996;var spans$4992;var newactive$4993;var start$4975;var active$4976;var next$4977;var target$4978;var end$4979;var attr$4980;var rest$4981;var start$4907;var active$4908;var $4877$4892;var $4878$4893;var $4879$4894;var t0$4886;var t1$4887;var t2$4888;var t3$4889;var t4$4890;var $4876$4881;($4876$4881=[start$4872,active$4873,rem$4874]);;if((($4877$4892=($4876$4881 instanceof Array))&&((t0$4886=$4876$4881.length),(($4879$4894=(t0$4886===3))&&($4876$4881[0],((t1$4887=$4876$4881[1]),((t1$4887 instanceof Array)&&((t2$4888=t1$4887.length),((t2$4888===0)&&((t3$4889=$4876$4881[2]),((t3$4889 instanceof Array)&&((t4$4890=t3$4889.length),(t4$4890===0))))))))))))){return [];}else{if(($4879$4894&&((start$4907=$4876$4881[0]),((active$4908=$4876$4881[1]),((t1$4887=$4876$4881[2]),((t1$4887 instanceof Array)&&((t2$4888=t1$4887.length),(t2$4888===0)))))))){(top$4916=$4120(Math.max,(((acc$4923=[])),(((temp$4928=active$4908)),(((len$4933=temp$4928.length)),(((i$4938=0)),function(){$4921:for(;(i$4938<len$4933);(i$4938++)){var e$4956;var t0$4951;var t1$4952;var m$4946;(m$4946=temp$4928[i$4938]);;(t0$4951=m$4946);if(((t0$4951 instanceof Array)&&((t1$4952=t0$4951.length),(t1$4952===3)))){t0$4951[0];(e$4956=t0$4951[1]);t0$4951[2];acc$4923.push(e$4956);}else{false;;}}}()))),acc$4923)));;(bot$4917=Math.min(start$4907,top$4916));;(t0$4967=jumptill$4693(active$4908,start$4907,top$4916));if(((t0$4967 instanceof Array)&&((t1$4968=t0$4967.length),(t1$4968===2)))){(spans$4918=t0$4967[0]);t0$4967[1];;}else{$5611(jumptill$4693(active$4908,start$4907,top$4916),"/home/olivier/git/earl-grey/src/location.eg",4187,4215);}return spans$4918;}else{if(($4879$4894&&((start$4975=$4876$4881[0]),((active$4976=$4876$4881[1]),((t1$4887=$4876$4881[2]),((t1$4887 instanceof Array)&&((t2$4888=t1$4887.length),((t2$4888>=1)&&((t3$4889=t1$4887[0]),((next$4977=t3$4889),((t3$4889 instanceof Array)&&((t4$4890=t3$4889.length),(t4$4890===3))))))))))))){(target$4978=t3$4889[0]);(end$4979=t3$4889[1]);(attr$4980=t3$4889[2]);(rest$4981=Array.prototype.slice.call(t1$4887,1));(t0$4995=jumptill$4693(active$4976,start$4975,target$4978));if(((t0$4995 instanceof Array)&&((t1$4996=t0$4995.length),(t1$4996===2)))){(spans$4992=t0$4995[0]);(newactive$4993=t0$4995[1]);;}else{$5611(jumptill$4693(active$4976,start$4975,target$4978),"/home/olivier/git/earl-grey/src/location.eg",4325,4356);}return spans$4992.concat(process$4694(target$4978,[next$4977].concat(newactive$4993),rest$4981));}else{$5611($4876$4881);}}}});;(thespans$4695=spans$4689.sort(function($5006$5009,$5007$5010){var t0$5017;var t1$5018;var t0$5024;var t1$5025;var s1$5012;var e1$5013;var s2$5014;var e2$5015;(t0$5017=$5006$5009);if(((t0$5017 instanceof Array)&&((t1$5018=t0$5017.length),(t1$5018===3)))){(s1$5012=t0$5017[0]);(e1$5013=t0$5017[1]);t0$5017[2];;}else{$5611($5006$5009);}(t0$5024=$5007$5010);if(((t0$5024 instanceof Array)&&((t1$5025=t0$5024.length),(t1$5025===3)))){(s2$5014=t0$5024[0]);(e2$5015=t0$5024[1]);t0$5024[2];;}else{$5611($5007$5010);}if((s1$5012===s2$5014)){return (e1$5013-e2$5015);}else{return (s1$5012-s2$5014);}}));;return process$4694(thespans$4695[0][0],[],thespans$4695);});;(highlight_locations$4169=function(){var i$5068;var len$5063;var temp$5058;var i$5116;var len$5111;var temp$5106;var acc$5101;var srcs$5051;var locations$5046;var context$5047;var t0$5042;var $5035$5037;($5035$5037=arguments);;(t0$5042=$5035$5037.length);if(((t0$5042>=1)&&(t0$5042<=2))){(locations$5046=$5035$5037[0]);(context$5047=function(){if((1>=t0$5042)){return 0;}else{return $5035$5037[1];}}());(srcs$5051=({}));;(temp$5058=locations$5046);;(len$5063=temp$5058.length);;(i$5068=0);;$5052:for(;(i$5068<len$5063);(i$5068++)){var key$5092;var loc$5086;var cls$5087;var t0$5081;var t1$5082;var m$5076;(m$5076=temp$5058[i$5068]);;(t0$5081=m$5076);if(((t0$5081 instanceof Array)&&((t1$5082=t0$5081.length),(t1$5082===2)))){(loc$5086=t0$5081[0]);(cls$5087=t0$5081[1]);(key$5092=String((loc$5086.source&&loc$5086.source.url)));;if((!$4120(srcs$5051,key$5092))){(srcs$5051[key$5092]=[]);}$4120(srcs$5051,key$5092).push([loc$5086,cls$5087]);}else{false;;}}return $5742(["+div"],(((acc$5101=[])),(((temp$5106=items$4156(srcs$5051))),(((len$5111=temp$5106.length)),(((i$5116=0)),function(){$5099:for(;(i$5116<len$5111);(i$5116++)){var locs$5134;var t0$5129;var t1$5130;var m$5124;(m$5124=temp$5106[i$5116]);;(t0$5129=m$5124);if(((t0$5129 instanceof Array)&&((t1$5130=t0$5129.length),(t1$5130===2)))){t0$5129[0];(locs$5134=t0$5129[1]);acc$5101.push(highlight_locations_same_source$4170(locs$5134,context$5047));}else{false;;}}}()))),acc$5101));}else{$5611($5035$5037);}});;(highlight_locations_same_source$4170=function(){var i$5187;var len$5182;var temp$5177;var acc$5172;var t0$5217;var t1$5218;var i$5246;var len$5241;var temp$5236;var acc$5231;var i$5288;var len$5283;var temp$5278;var acc$5273;var loc$5162;var src$5163;var l1$5164;var l2$5165;var first$5166;var last$5167;var locations$5157;var context$5158;var t0$5153;var $5146$5148;($5146$5148=arguments);;(t0$5153=$5146$5148.length);if(((t0$5153>=1)&&(t0$5153<=2))){(locations$5157=$5146$5148[0]);(context$5158=function(){if((1>=t0$5153)){return 0;}else{return $5146$5148[1];}}());(loc$5162=merge_locations$4171((((acc$5172=[])),(((temp$5177=locations$5157)),(((len$5182=temp$5177.length)),(((i$5187=0)),function(){$5170:for(;(i$5187<len$5182);(i$5187++)){var x$5205;var cls$5206;var t0$5200;var t1$5201;var m$5195;(m$5195=temp$5177[i$5187]);;(t0$5200=m$5195);if(((t0$5200 instanceof Array)&&((t1$5201=t0$5200.length),(t1$5201===2)))){(x$5205=t0$5200[0]);(cls$5206=t0$5200[1]);acc$5172.push(x$5205);}else{false;;}}}()))),acc$5172)));;(src$5163=loc$5162.source);;(t0$5217=loc$5162.linerange());if(((t0$5217 instanceof Array)&&((t1$5218=t0$5217.length),(t1$5218===2)))){(l1$5164=t0$5217[0]);(l2$5165=t0$5217[1]);;}else{$5611(loc$5162.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5108,5123);}(first$5166=Math.max(1,(l1$5164-context$5158)));;(last$5167=Math.min(src$5163.nlines,(l2$5165+context$5158)));;return $5742(["+div","location"],[$5742(["+div","source"],[$5742(["sourcefile"],(src$5163.url||"???")),(((acc$5231=[])),(((temp$5236=locations$5157)),(((len$5241=temp$5236.length)),(((i$5246=0)),function(){$5229:for(;(i$5246<len$5241);(i$5246++)){var loc$5264;var cls$5265;var t0$5259;var t1$5260;var m$5254;(m$5254=temp$5236[i$5246]);;(t0$5259=m$5254);if(((t0$5259 instanceof Array)&&((t1$5260=t0$5259.length),(t1$5260===2)))){(loc$5264=t0$5259[0]);(cls$5265=t0$5259[1]);acc$5231.push(Node$4159([cls$5265,"sourcepos"],loc$5264.ref()));}else{false;;}}}()))),acc$5231)]),src$5163.highlight_lines(first$5166,last$5167,(((acc$5273=[])),(((temp$5278=locations$5157)),(((len$5283=temp$5278.length)),(((i$5288=0)),function(){$5271:for(;(i$5288<len$5283);(i$5288++)){var loc$5306;var cls$5307;var t0$5301;var t1$5302;var m$5296;(m$5296=temp$5278[i$5288]);;(t0$5301=m$5296);if(((t0$5301 instanceof Array)&&((t1$5302=t0$5301.length),(t1$5302===2)))){(loc$5306=t0$5301[0]);(cls$5307=t0$5301[1]);acc$5273.push([loc$5306.start,loc$5306.end,[cls$5307]]);}else{false;;}}}()))),acc$5273))]);}else{$5611($5146$5148);}});;(merge_locations$4171=function($5318$5320){var i$5376;var len$5371;var temp$5366;var acc$5361;var i$5414;var len$5409;var temp$5404;var acc$5399;var start$5355;var end$5356;var locs$5351;var loc$5346;var $5323$5337;var $5324$5338;var t0$5335;var $5322$5330;var ph$5325;(ph$5325=$5318$5320);;($5322$5330=ph$5325);;if((($5323$5337=($5322$5330 instanceof Array))&&((t0$5335=$5322$5330.length),(t0$5335===0)))){return Location$4164(null,0,0);}else{if(($5323$5337&&(t0$5335===1))){(loc$5346=$5322$5330[0]);return loc$5346;}else{if(($5323$5337&&(t0$5335>=0))){(locs$5351=Array.prototype.slice.call($5322$5330,0));(start$5355=$4120(Math.min,(((acc$5361=[])),(((temp$5366=locs$5351)),(((len$5371=temp$5366.length)),(((i$5376=0)),function(){$5359:for(;(i$5376<len$5371);(i$5376++)){var loc$5392;var m$5384;(m$5384=temp$5366[i$5376]);;(loc$5392=m$5384);acc$5361.push(loc$5392.start);}}()))),acc$5361)));;(end$5356=$4120(Math.max,(((acc$5399=[])),(((temp$5404=locs$5351)),(((len$5409=temp$5404.length)),(((i$5414=0)),function(){$5397:for(;(i$5414<len$5409);(i$5414++)){var loc$5430;var m$5422;(m$5422=temp$5404[i$5414]);;(loc$5430=m$5422);acc$5399.push(loc$5430.end);}}()))),acc$5399)));;return Location$4164(locs$5351[0].source,start$5355,end$5356);}else{$5611($5322$5330);}}}});;(__lt____lt____colon__$4172=function(x$5439,y$5440){if((!$4105(Location$4164)(x$5439.location))){(x$5439["location"]=function(){if(((!y$5440)||$4105(Location$4164)(y$5440))){return y$5440;}else{return y$5440.location;}}());}return x$5439;});;(__plus____plus____colon__$4173=function(x$5448,y$5449){var rval$5453;(x$5448=function(){if(((!x$5448)||$4105(Location$4164)(x$5448))){return x$5448;}else{return x$5448.location;}}());(y$5449=function(){if(((!y$5449)||$4105(Location$4164)(y$5449))){return y$5449;}else{return y$5449.location;}}());(rval$5453=false);;try{(rval$5453=merge_locations$4171([x$5448,y$5449]));}catch(excv$5459){var e$5465;(e$5465=excv$5459);(rval$5453=(void 0));}return rval$5453;});;(format_error$4174=function($5470$5472){var t0$5480;var i$5526;var len$5521;var temp$5516;var acc$5511;var hls$5502;var locs$5503;var rval$5579;var loc$5595;var data$5575;var other$5601;var url$5568;var start$5569;var end$5570;var loc$5562;var args$5496;var $5475$5492;var $5476$5493;var t0$5489;var t1$5490;var $5474$5484;var ph$5477;var e$5478;(t0$5480=$5470$5472);(e$5478=t0$5480);(ph$5477=t0$5480);;($5474$5484=ph$5477);;if(($4105($5624(["syntax"]))($5474$5484)&&($5898($5474$5484,"args")&&((t0$5489=$5474$5484.args),((t0$5489 instanceof Array)&&((t1$5490=t0$5489.length),(t1$5490===1))))))){(args$5496=t0$5489[0]);(hls$5502=["hl1","hl2","hl3","hl4"]);;(locs$5503=(((acc$5511=[])),(((temp$5516=enumerate$4157(items$4156(args$5496)))),(((len$5521=temp$5516.length)),(((i$5526=0)),function(){$5509:for(;(i$5526<len$5521);(i$5526++)){var i$5546;var key$5547;var arg$5548;var t0$5539;var t1$5540;var t2$5541;var t3$5542;var m$5534;(m$5534=temp$5516[i$5526]);;(t0$5539=m$5534);if(((t0$5539 instanceof Array)&&((t1$5540=t0$5539.length),((t1$5540===2)&&((i$5546=t0$5539[0]),((t2$5541=t0$5539[1]),((t2$5541 instanceof Array)&&((t3$5542=t2$5541.length),((t3$5542===2)&&((key$5547=t2$5541[0]),((arg$5548=t2$5541[1]),(arg$5548&&arg$5548.location)))))))))))){acc$5511.push([arg$5548.location,$4120(hls$5502,(i$5546%4))]);}else{false;;}}}()))),acc$5511));;return $5742(["+div"],[$5742(["+div"],[$5742(["error_type"],e$5478.name),$5742(["error_message"],e$5478.message)]),repr$4161(args$5496),highlight_locations$4169(locs$5503)]);}else{if((($5475$5492=$5898($5474$5484,"location"))&&((t0$5489=$5474$5484.location),$4105(Location$4164)(t0$5489)))){(loc$5562=t0$5489);return $5742(["+div"],[$5742(["+div"],[$5742(["error_type"],e$5478.name),$5742(["error_message"],e$5478.message)]),function(){if(e$5478.args){return repr$4161(e$5478.args);}else{return "";}}(),highlight_locations$4169([[loc$5562,"hl1"]]),$5742(["traceback"],(e$5478.stack||""))]);}else{if(($5475$5492&&((t0$5489 instanceof Array)&&((t1$5490=t0$5489.length),((t1$5490===4)&&(t0$5489[0]==="location")))))){(url$5568=t0$5489[1]);(start$5569=t0$5489[2]);(end$5570=t0$5489[3]);(data$5575=(((rval$5579=false)),(function(){try{(rval$5579=fs$4162.readFileSync(url$5568,"utf8"));}catch(excv$5585){var e$5591;(e$5591=excv$5585);(rval$5579=null);}}(),rval$5579)));;if(data$5575){(loc$5595=Location$4164(Source$4163(data$5575,url$5568),start$5569,end$5570));;return $5742(["+div"],[$5742(["+div"],[$5742(["error_type"],e$5478.name),$5742(["error_message"],e$5478.message)]),function(){if(e$5478.args){return repr$4161(e$5478.args);}else{return "";}}(),highlight_locations$4169([[loc$5595,"hl1"]]),$5742(["traceback"],(e$5478.stack||""))]);}else{return $5742(["+div"],$5742(["traceback"],(e$5478.stack||e$5478)));}}else{(other$5601=$5474$5484);return $5742(["traceback"],(e$5478.stack||e$5478));}}}});;(display_error$4175=function(e$5607){return __lt____gt__$4160(null,format_error$4174(e$5607));});;(exports["Source"]=Source$4163);(exports["Location"]=Location$4164);(exports["highlight"]=highlight$4165);(exports["highlight_locations"]=highlight_locations$4169);(exports["merge_locations"]=merge_locations$4171);(exports["<<:"]=__lt____lt____colon__$4172);(exports["++:"]=__plus____plus____colon__$4173);(exports["format_error"]=format_error$4174);(exports["display_error"]=display_error$4175);
