var $6157=function(type$6159){var f$6162;(f$6162=type$6159["::check"]);if((f$6162===(void 0))){return function(value$6167){return (value$6167 instanceof type$6159);};}else{return function(value$6170){return f$6162.call(type$6159,value$6170);};}};
var $6172=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $6173=function(dest$6175,values$6176){var k$6181;(k$6181=null);$6179:for(k$6181 in values$6176){if(values$6176.hasOwnProperty(k$6181)){(dest$6175[k$6181]=values$6176[k$6181]);}}return dest$6175;};
var $6188=function($6189$6191){var ph$6195;(ph$6195=$6189$6191);var $6193$6200;($6193$6200=ph$6195);var bridge$6194$6205;var x$6209;(bridge$6194$6205=$6193$6200);if((((typeof(bridge$6194$6205)==="string")&&((x$6209=bridge$6194$6205),true))||((typeof(bridge$6194$6205)==="number")&&((x$6209=bridge$6194$6205),true)))){return ["value",x$6209];}else{var other$6219;(other$6219=$6193$6200);return other$6219["::serialize_ast"]();}};
var send$5964;(send$5964=function(obj$5969,$5967$5970){var ph$5974;var msg$5975;var t0$5977;(t0$5977=$5967$5970);(msg$5975=t0$5977);(ph$5974=t0$5977);var $5972$5984;($5972$5984=ph$5974);var bridge$5973$5989;(bridge$5973$5989=$5972$5984);if(((typeof(bridge$5973$5989)==="string")||(typeof(bridge$5973$5989)==="number"))){return obj$5969[msg$5975];}else{var other$6000;(other$6000=$5972$5984);return obj$5969["::send"](msg$5975);}});(Array[":::project"]=function($6005$6007){var ph$6010;var value$6011;var t0$6013;(t0$6013=$6005$6007);(value$6011=t0$6013);(ph$6010=t0$6013);var $6009$6020;($6009$6020=ph$6010);if($6157(Array)($6009$6020)){return [true,value$6011];}else{$6009$6020;return [true,[value$6011]];}});(Array.prototype["::check"]=function(value$6037){if((value$6037 instanceof Array)){var i$6042;(i$6042=0);$6040:for(;(i$6042<this.length);(i$6042++)){if(($6172(this,i$6042)!==$6172(value$6037,i$6042))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $6173(this.slice(0),this);});(Array.prototype[":::project"]=function(value$6059){if((value$6059 instanceof Array)){var i$6064;(i$6064=0);$6062:for(;(i$6064<this.length);(i$6064++)){if(($6172(this,i$6064)!==$6172(value$6059,i$6064))){return [true,[value$6059]];}}return [true,value$6059.slice(this.length)];}else{return [true,[value$6059]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($6188));});(RegExp.prototype["::check"]=function($6080$6082){var ph$6085;(ph$6085=$6080$6082);var $6084$6090;($6084$6090=ph$6085);var value$6098;if((typeof($6084$6090)==="string")){(value$6098=$6084$6090);if(value$6098.match(this)){return true;}else{return false;}}else{var other$6103;(other$6103=$6084$6090);return false;}});(RegExp.prototype[":::project"]=function($6108$6110){var ph$6113;(ph$6113=$6108$6110);var $6112$6118;($6112$6118=ph$6113);var value$6126;if((typeof($6112$6118)==="string")){(value$6126=$6112$6118);var $6129$6131;($6129$6131=value$6126.match(this));var m$6139;if(($6129$6131===null)){(m$6139=$6129$6131);return [false,null];}else{var m$6144;(m$6144=$6129$6131);return [true,m$6144];}}else{var other$6148;(other$6148=$6112$6118);return [false,null];}});(Function.prototype["::send"]=function(args$6154){return this.apply(this,args$6154);});
var $8289=function(arr$8291){var results$8295;var l$8296;(results$8295=[]);(l$8296=arr$8291.length);var i$8304;(i$8304=0);$8294:for(;(i$8304<l$8296);(i$8304++)){results$8295.push([i$8304,$6172(arr$8291,i$8304)]);}return results$8295;};
var $8093=function(){var $8094$8096;($8094$8096=function(tags$8100){var it$0$8103;(it$0$8103=function(){if((!$6157($8094$8096)(this))){return Object.create($8094$8096.prototype);}else{return this;}}());(it$0$8103["tags"]=tags$8100);return it$0$8103;});($8094$8096.prototype["create"]=function(){var $8115$8117;($8115$8117=arguments);var t0$8122;var message$8126;var args$8127;(t0$8122=$8115$8117.length);if((t0$8122>=0)){(message$8126=function(){if((0>=t0$8122)){return "";}else{return $8115$8117[0];}}());(args$8127=Array.prototype.slice.call($8115$8117,1));var it$0$8134;(it$0$8134=this);var self$8139;(self$8139=this);var e$8144;(e$8144=Error(message$8126));(e$8144["::tags"]=it$0$8134.tags);(e$8144["args"]=args$8127);var temp$8158;(temp$8158=$8289(args$8127));var $length$8163;($length$8163=temp$8158.length);var $index$8168;($index$8168=0);$8145:for(;($index$8168<$length$8163);($index$8168++)){var m$8176;(m$8176=temp$8158[$index$8168]);var t0$8181;var t1$8182;var i$8186;var arg$8187;(t0$8181=m$8176);if(((t0$8181 instanceof Array)&&(((t1$8182=t0$8181.length)),(t1$8182===2)))){(i$8186=t0$8181[0]);(arg$8187=t0$8181[1]);(e$8144[i$8186]=arg$8187);}else{$8077(m$8176);}}(e$8144["length"]=args$8127.length);(e$8144["name"]=["E"].concat(it$0$8134.tags).join("."));return e$8144;}else{$8077($8115$8117);}});($8094$8096.prototype["::check"]=function(e$8213){var it$0$8216;(it$0$8216=this);var self$8221;(self$8221=this);var tags$8226;if(((!e$8213)||(!$6157(Error)(e$8213)))){return false;}(tags$8226=(e$8213["::tags"]||[]));var temp$8235;(temp$8235=it$0$8216.tags);var $length$8240;($length$8240=temp$8235.length);var $index$8245;($index$8245=0);$8227:for(;($index$8245<$length$8240);($index$8245++)){var m$8253;(m$8253=temp$8235[$index$8245]);var tag$8261;(tag$8261=m$8253);if((tags$8226.indexOf(tag$8261)===-1)){return false;}else{false;}}return true;});($8094$8096.prototype["::deconstruct"]=function(e$8269){var it$0$8272;(it$0$8272=this);var self$8277;(self$8277=this);return e$8269.args;});$6173($8094$8096,$6173(function(){var accum$8282;(accum$8282=({}));(accum$8282["::name"]="$8094");return accum$8282;}(),function(){var accum$8286;(accum$8286=({}));(accum$8286["::egclass"]=true);return accum$8286;}()));return $8094$8096;}();
var $8077=function(value$8079,url$8080,start$8081,end$8082){var err$8085;(err$8085=$8093(["match"]).create("Could not find a match for value",({"value":value$8079})));if(url$8080){(err$8085["location"]=["location",url$8080,start$8081,end$8082]);}throw err$8085;};
var $8450=function(type$8452){return function(value$8455){var f$8458;(f$8458=type$8452[":::project"]);if((f$8458===(void 0))){(f$8458=type$8452["::project"]);if((f$8458===(void 0))){return [true,type$8452(value$8455)];}else{var rval$8467;(rval$8467=false);try{(rval$8467=[true,f$8458(value$8455)]);}catch(excv$8476){var e$8482;(e$8482=excv$8476);(rval$8467=[false,null]);}return rval$8467;}}else{return f$8458.call(type$8452,value$8455);}};};
var $8311=function(){var $8312$8314;($8312$8314=function($8317$8320,$8318$8321){var classes$8323;var children$8324;var t0$8326;(t0$8326=$8450(Array)($8317$8320));if(t0$8326[0]){(classes$8323=t0$8326[1]);}else{$8077($8317$8320);}var t0$8334;(t0$8334=$8450(Array)($8318$8321));if(t0$8334[0]){(children$8324=t0$8334[1]);}else{$8077($8318$8321);}var it$0$8342;(it$0$8342=function(){if((!$6157($8312$8314)(this))){return Object.create($8312$8314.prototype);}else{return this;}}());(it$0$8342["classes"]=classes$8323.sort());(it$0$8342["children"]=children$8324);return it$0$8342;});$6173(function(){var accum$8356;(accum$8356=({}));(accum$8356["::check"]=function(x$8360){return ((x$8360&&x$8360.classes)&&x$8360.children);});return accum$8356;}(),$6173(function(){var accum$8363;(accum$8363=({}));(accum$8363["::deconstruct"]=function(x$8367){return [x$8367.classes,x$8367.children];});return accum$8363;}(),$6173(function(){var accum$8370;(accum$8370=({}));(accum$8370["::name"]="$8312");return accum$8370;}(),function(){var accum$8374;(accum$8374=({}));(accum$8374["::egclass"]=true);return accum$8374;}())));($8312$8314.prototype["::check"]=function(n$8380){var it$0$8383;(it$0$8383=this);var self$8388;(self$8388=this);var temp$8397;(temp$8397=it$0$8383.classes);var $length$8402;($length$8402=temp$8397.length);var $index$8407;($index$8407=0);$8393:for(;($index$8407<$length$8402);($index$8407++)){var m$8415;(m$8415=temp$8397[$index$8407]);var c$8423;(c$8423=m$8415);if((n$8380.classes.indexOf(c$8423)===-1)){return false;}else{false;}}return true;});$6173($8312$8314,$6173(function(){var accum$8429;(accum$8429=({}));(accum$8429["::check"]=function(x$8433){return ((x$8433&&x$8433.classes)&&x$8433.children);});return accum$8429;}(),$6173(function(){var accum$8436;(accum$8436=({}));(accum$8436["::deconstruct"]=function(x$8440){return [x$8440.classes,x$8440.children];});return accum$8436;}(),$6173(function(){var accum$8443;(accum$8443=({}));(accum$8443["::name"]="$8312");return accum$8443;}(),function(){var accum$8447;(accum$8447=({}));(accum$8447["::egclass"]=true);return accum$8447;}()))));return $8312$8314;}();
var $8487=function(from$8489,to$8490){var rval$8494;(rval$8494=[]);var i$8499;(i$8499=from$8489);$8493:for(;(i$8499<=to$8490);(i$8499++)){rval$8494.push(i$8499);}return rval$8494;};
var $8506=function(obj$8508){var results$8512;(results$8512=[]);var k$8517;(k$8517=null);$8511:for(k$8517 in obj$8508){if(Object.prototype.hasOwnProperty.call(obj$8508,k$8517)){results$8512.push([k$8517,$6172(obj$8508,k$8517)]);}}return results$8512;};
var $8521=function($8522$8524,key$8525){var ph$8529;(ph$8529=$8522$8524);var $8527$8534;($8527$8534=ph$8529);var bridge$8528$8539;(bridge$8528$8539=$8527$8534);if(((bridge$8528$8539===null)||(bridge$8528$8539===(void 0)))){return false;}else{var x$8550;if((typeof($8527$8534)==="string")){(x$8550=$8527$8534);return (key$8525 in String.prototype);}else{var x$8555;if((typeof($8527$8534)==="number")){(x$8555=$8527$8534);return (key$8525 in Number.prototype);}else{var x$8560;(x$8560=$8527$8534);return (key$8525 in x$8560);}}}};var accum$6384;var accum$6388;var accum$6668;var accum$6672;var $6223$6225;var binsearch$6226;var $6224$6227;var __lt____gt__$6228;var repr$6229;var fs$6230;var Source$6231;var Location$6232;var highlight$6233;var highlight_lines$6234;var clamp$6235;var morsel$6236;var highlight_locations$6237;var highlight_locations_same_source$6238;var merge_locations$6239;var __lt____lt____colon__$6240;var __plus____plus____colon__$6241;var format_error$6242;var display_error$6243;($6223$6225=require("./util"));(binsearch$6226=$6223$6225.binsearch);($6224$6227=require("./pp"));(__lt____gt__$6228=$6224$6227["<>"]);(repr$6229=$6224$6227.repr);(fs$6230=require("fs"));(Source$6231=function(){var $index$6317;var $length$6312;var temp$6307;var curr$6290;var it$0$6284;var text$6276;var url$6277;var t0$6272;var $6265$6267;($6265$6267=arguments);(t0$6272=$6265$6267.length);if(((t0$6272>=1)&&(t0$6272<=2))){(text$6276=$6265$6267[0]);(url$6277=function(){if((1>=t0$6272)){return false;}else{return $6265$6267[1];}}());(it$0$6284=function(){if((!$6157(Source$6231)(this))){return Object.create(Source$6231.prototype);}else{return this;}}());(it$0$6284["text"]=text$6276);(it$0$6284["url"]=url$6277);(it$0$6284["counts"]=[]);(curr$6290=0);(temp$6307=text$6276.split("\n"));($length$6312=temp$6307.length);($index$6317=0);$6291:for(;($index$6317<$length$6312);($index$6317++)){var line$6333;var m$6325;(m$6325=temp$6307[$index$6317]);(line$6333=m$6325);it$0$6284.counts.push(curr$6290);(curr$6290=(curr$6290+(line$6333.length+1)));}it$0$6284.counts.push(curr$6290);(it$0$6284["nlines"]=(it$0$6284.counts.length-1));return it$0$6284;}else{$8077($6265$6267);}});(Source$6231.prototype["linecol"]=function(pos$6345){var line$6358;var col$6359;var self$6353;var it$0$6348;(it$0$6348=this);(self$6353=this);(line$6358=binsearch$6226(it$0$6348.counts,pos$6345));(col$6359=(pos$6345-$6172(it$0$6348.counts,(line$6358-1))));return [line$6358,col$6359];});(Source$6231.prototype["highlight_lines"]=function(l1$6369,l2$6370,spans$6371){var self$6379;var it$0$6374;(it$0$6374=this);(self$6379=this);return highlight_lines$6234(it$0$6374.text,it$0$6374.counts,[(l1$6369-1),(l2$6370-1)],spans$6371);});$6173(Source$6231,$6173(((accum$6384=({})),((accum$6384["::name"]="Source"),accum$6384)),((accum$6388=({})),((accum$6388["::egclass"]=true),accum$6388))));Source$6231;(Location$6232=function(source$6394,start$6395,end$6396){var it$0$6399;(it$0$6399=function(){if((!$6157(Location$6232)(this))){return Object.create(Location$6232.prototype);}else{return this;}}());(it$0$6399["source"]=(source$6394||Source$6231("",null)));(it$0$6399["start"]=start$6395);(it$0$6399["end"]=end$6396);return it$0$6399;});(Location$6232.prototype["text"]=function(){var self$6425;var it$0$6420;(it$0$6420=this);(self$6425=this);return it$0$6420.source.text.slice(it$0$6420.start,it$0$6420.end);});(Location$6232.prototype["linerange"]=function(){var l2$6483;var t0$6474;var t1$6475;var l1$6457;var $6440$6458;var t0$6451;var t1$6452;var t2$6453;var $6439$6446;var self$6441;var it$0$6434;(it$0$6434=this);(self$6441=this);($6439$6446=it$0$6434.linecol());if((($6439$6446 instanceof Array)&&(((t0$6451=$6439$6446.length)),((t0$6451===2)&&(((t1$6452=$6439$6446[0])),((t1$6452 instanceof Array)&&(((t2$6453=t1$6452.length)),(t2$6453===2)))))))){(l1$6457=t1$6452[0]);t1$6452[1];($6440$6458=$6439$6446[1]);if(($6440$6458===null)){return [l1$6457,l1$6457];}else{(t0$6474=$6440$6458);if(((t0$6474 instanceof Array)&&(((t1$6475=t0$6474.length)),(t1$6475===2)))){(l2$6483=t0$6474[0]);t0$6474[1];return [l1$6457,l2$6483];}else{$8077($6440$6458,"/home/olivier/git/earl-grey/src/location.eg",968,973);}}}else{$8077($6439$6446);}});(Location$6232.prototype["linecol"]=function(){var start$6512;var end$6513;var self$6507;var it$0$6502;(it$0$6502=this);(self$6507=this);(start$6512=it$0$6502.source.linecol(it$0$6502.start));(end$6513=function(){if((it$0$6502.start===it$0$6502.end)){return null;}else{return it$0$6502.source.linecol((it$0$6502.end-1));}}());return [start$6512,end$6513];});(Location$6232.prototype["ref"]=function(){var otherwise$6628;var $6609$6617;var $6608$6611;var l2$6588;var c2$6589;var t0$6577;var t1$6578;var t2$6579;var t3$6580;var l1$6550;var c1$6551;var $6531$6552;var t0$6542;var t1$6543;var t2$6544;var t3$6545;var t4$6546;var $6530$6537;var self$6532;var it$0$6525;(it$0$6525=this);(self$6532=this);($6530$6537=it$0$6525.linecol());if((($6530$6537 instanceof Array)&&(((t0$6542=$6530$6537.length)),((t0$6542===2)&&(((t1$6543=$6530$6537[0])),((t1$6543 instanceof Array)&&(((t2$6544=t1$6543.length)),((t2$6544===2)&&(((t3$6545=[true,String(t1$6543[0])])),(t3$6545[0]&&((l1$6550=t3$6545[1]),(((t4$6546=[true,String(t1$6543[1])])),t4$6546[0])))))))))))){(c1$6551=t4$6546[1]);($6531$6552=$6530$6537[1]);if(($6531$6552===null)){return ((l1$6550+":")+c1$6551);}else{(t0$6577=$6531$6552);if(((t0$6577 instanceof Array)&&(((t1$6578=t0$6577.length)),((t1$6578===2)&&(((t2$6579=[true,String(t0$6577[0])])),(t2$6579[0]&&((l2$6588=t2$6579[1]),(((t3$6580=[true,String(t0$6577[1])])),t3$6580[0])))))))){(c2$6589=t3$6580[1]);($6608$6611=null);$6608$6611;if(((l1$6550===l2$6588)&&(c1$6551===c2$6589))){return ((l1$6550+":")+c1$6551);}else{if((l1$6550===l2$6588)){return ((((l1$6550+":")+c1$6551)+"-")+c2$6589);}else{(otherwise$6628=$6608$6611);return ((((((l1$6550+":")+c1$6551)+"-")+l1$6550)+":")+c2$6589);}}}else{$8077($6531$6552,"/home/olivier/git/earl-grey/src/location.eg",1310,1315);}}}else{$8077($6530$6537);}});(Location$6232.prototype["highlight"]=function(){var self$6661;var it$0$6656;var cls$6648;var context$6649;var t0$6644;var $6637$6639;($6637$6639=arguments);(t0$6644=$6637$6639.length);if(((t0$6644>=0)&&(t0$6644<=2))){(cls$6648=function(){if((0>=t0$6644)){return "hl1";}else{return $6637$6639[0];}}());(context$6649=function(){if((1>=t0$6644)){return 0;}else{return $6637$6639[1];}}());(it$0$6656=this);(self$6661=this);return highlight_locations$6237([[it$0$6656,cls$6648]],context$6649);}else{$8077($6637$6639);}});$6173(Location$6232,$6173(((accum$6668=({})),((accum$6668["::name"]="Location"),accum$6668)),((accum$6672=({})),((accum$6672["::egclass"]=true),accum$6672))));Location$6232;(highlight$6233=function(){var $index$6715;var $length$6710;var temp$6705;var acc$6700;var text$6689;var spans$6690;var offset$6691;var t0$6685;var $6678$6680;($6678$6680=arguments);(t0$6685=$6678$6680.length);if(((t0$6685>=2)&&(t0$6685<=3))){(text$6689=$6678$6680[0]);(spans$6690=$6678$6680[1]);(offset$6691=function(){if((2>=t0$6685)){return 0;}else{return $6678$6680[2];}}());return $8311([],(((acc$6700=[])),(((temp$6705=morsel$6236(spans$6690))),((($length$6710=temp$6705.length)),((($index$6715=0)),function(){$6697:for(;($index$6715<$length$6710);($index$6715++)){var xstart$6747;var xend$6748;var start$6733;var end$6734;var attributes$6735;var t0$6728;var t1$6729;var m$6723;(m$6723=temp$6705[$index$6715]);(t0$6728=m$6723);if(((t0$6728 instanceof Array)&&(((t1$6729=t0$6728.length)),(t1$6729===3)))){(start$6733=t0$6728[0]);(end$6734=t0$6728[1]);(attributes$6735=t0$6728[2]);acc$6700.push((((xstart$6747=Math.max((start$6733-offset$6691),0))),((xend$6748=Math.min((end$6734-offset$6691),text$6689.length))),$8311(attributes$6735.slice(0,1),[text$6689.slice(xstart$6747,xend$6748)])));}else{$8077(m$6723,"/home/olivier/git/earl-grey/src/location.eg",1857,2069);}}}()))),acc$6700));}else{$8077($6678$6680);}});(highlight_lines$6234=function(text$6764,linelocs$6765,$6762$6766,spans$6767){var t0$6772;var t1$6773;var $index$6802;var $length$6797;var temp$6792;var acc$6787;var l1$6769;var l2$6770;(t0$6772=$6762$6766);if(((t0$6772 instanceof Array)&&(((t1$6773=t0$6772.length)),(t1$6773===2)))){(l1$6769=t0$6772[0]);(l2$6770=t0$6772[1]);}else{$8077($6762$6766);}return $8311(["+span"],(((acc$6787=[])),(((temp$6792=$8487(l1$6769,l2$6770))),((($length$6797=temp$6792.length)),((($index$6802=0)),function(){$6784:for(;($index$6802<$length$6797);($index$6802++)){var start$6822;var end$6823;var lineno$6818;var m$6810;(m$6810=temp$6792[$index$6802]);(lineno$6818=m$6810);acc$6787.push((((start$6822=$6172(linelocs$6765,lineno$6818))),((end$6823=$6172(linelocs$6765,(lineno$6818+1)))),$8311(["+span"],[$8311(["lineno"],(lineno$6818+1)),$8311(["source"],highlight$6233(text$6764,[[start$6822,end$6823,[]]].concat(clamp$6235(spans$6767,start$6822,end$6823))))])));}}()))),acc$6787));});(clamp$6235=function(spans$6834,bot$6835,top$6836){var $index$6856;var $length$6851;var temp$6846;var acc$6841;(acc$6841=[]);(temp$6846=spans$6834);($length$6851=temp$6846.length);($index$6856=0);$6838:for(;($index$6856<$length$6851);($index$6856++)){var start$6874;var end$6875;var attr$6876;var t0$6869;var t1$6870;var m$6864;(m$6864=temp$6846[$index$6856]);(t0$6869=m$6864);if(((t0$6869 instanceof Array)&&(((t1$6870=t0$6869.length)),((t1$6870===3)&&((start$6874=t0$6869[0]),((end$6875=t0$6869[1]),((attr$6876=t0$6869[2]),((end$6875>=bot$6835)&&(start$6874<=top$6836))))))))){acc$6841.push([Math.max(start$6874,bot$6835),Math.min(end$6875,top$6836),attr$6876]);}else{false;}}return acc$6841;});(morsel$6236=function(spans$6895){var jump$6898;var jumptill$6899;var process_elements$6900;var thespans$6901;(jump$6898=function(active$6905,bot$6906,top$6907){var $index$6935;var $length$6930;var temp$6925;var acc$6920;var $index$6982;var $length$6977;var temp$6972;var e$6910;var attributes$6911;(e$6910=$6172(Math.min,[top$6907].concat((((acc$6920=[])),(((temp$6925=active$6905)),((($length$6930=temp$6925.length)),((($index$6935=0)),function(){$6917:for(;($index$6935<$length$6930);($index$6935++)){var x$6953;var t0$6948;var t1$6949;var m$6943;(m$6943=temp$6925[$index$6935]);(t0$6948=m$6943);if(((t0$6948 instanceof Array)&&(((t1$6949=t0$6948.length)),(t1$6949===3)))){t0$6948[0];(x$6953=t0$6948[1]);t0$6948[2];acc$6920.push(x$6953);}else{$8077(m$6943,"/home/olivier/git/earl-grey/src/location.eg",3392,3435);}}}()))),acc$6920))));(attributes$6911=[]);(temp$6972=active$6905);($length$6977=temp$6972.length);($index$6982=0);$6912:for(;($index$6982<$length$6977);($index$6982++)){var X$7000;var t0$6995;var t1$6996;var m$6990;(m$6990=temp$6972[$index$6982]);(t0$6995=m$6990);if(((t0$6995 instanceof Array)&&(((t1$6996=t0$6995.length)),(t1$6996===3)))){t0$6995[0];t0$6995[1];(X$7000=t0$6995[2]);(attributes$6911=attributes$6911.concat(X$7000));}else{$8077(m$6990,"/home/olivier/git/earl-grey/src/location.eg",3457,3498);}}return [e$6910,[bot$6906,e$6910,attributes$6911]];});(jumptill$6899=function(active$7016,bot$7017,top$7018){var t0$7027;var t1$7028;var $index$7059;var $length$7054;var temp$7049;var acc$7044;var t0$7096;var t1$7097;var newbot$7021;var span$7022;var newactive$7023;var spans$7024;var remainder$7025;if((bot$7017===top$7018)){return [[],active$7016];}else{(t0$7027=jump$6898(active$7016,bot$7017,top$7018));if(((t0$7027 instanceof Array)&&(((t1$7028=t0$7027.length)),(t1$7028===2)))){(newbot$7021=t0$7027[0]);(span$7022=t0$7027[1]);}else{$8077(jump$6898(active$7016,bot$7017,top$7018),"/home/olivier/git/earl-grey/src/location.eg",3734,3768);}(newactive$7023=(((acc$7044=[])),(((temp$7049=active$7016)),((($length$7054=temp$7049.length)),((($index$7059=0)),function(){$7041:for(;($index$7059<$length$7054);($index$7059++)){var x$7077;var e$7078;var attr$7079;var t0$7072;var t1$7073;var m$7067;(m$7067=temp$7049[$index$7059]);(t0$7072=m$7067);(x$7077=t0$7072);if(((t0$7072 instanceof Array)&&(((t1$7073=t0$7072.length)),((t1$7073===3)&&(t0$7072[0],((e$7078=t0$7072[1]),((attr$7079=t0$7072[2]),(e$7078>newbot$7021)))))))){acc$7044.push(x$7077);}else{false;}}}()))),acc$7044));(t0$7096=jumptill$6899(newactive$7023,newbot$7021,top$7018));if(((t0$7096 instanceof Array)&&(((t1$7097=t0$7096.length)),(t1$7097===2)))){(spans$7024=t0$7096[0]);(remainder$7025=t0$7096[1]);}else{$8077(jumptill$6899(newactive$7023,newbot$7021,top$7018),"/home/olivier/git/earl-grey/src/location.eg",3883,3927);}return [[span$7022].concat(spans$7024),remainder$7025];}});(process_elements$6900=function(start$7112,active$7113,rem$7114){var $index$7200;var $length$7195;var temp$7190;var acc$7185;var t0$7236;var t1$7237;var top$7177;var bot$7178;var spans$7179;var t0$7282;var t1$7283;var spans$7279;var newactive$7280;var start$7250;var active$7251;var next$7252;var target$7253;var end$7254;var attr$7255;var rest$7256;var start$7162;var active$7163;var $7117$7132;var $7118$7133;var $7119$7134;var t0$7126;var t1$7127;var t2$7128;var t3$7129;var t4$7130;var $7116$7121;($7116$7121=[start$7112,active$7113,rem$7114]);if((($7117$7132=($7116$7121 instanceof Array))&&(((t0$7126=$7116$7121.length)),(($7119$7134=(t0$7126===3))&&($7116$7121[0],(((t1$7127=$7116$7121[1])),((t1$7127 instanceof Array)&&(((t2$7128=t1$7127.length)),((t2$7128===0)&&(((t3$7129=$7116$7121[2])),((t3$7129 instanceof Array)&&(((t4$7130=t3$7129.length)),(t4$7130===0))))))))))))){return [];}else{if(($7119$7134&&((start$7162=$7116$7121[0]),((active$7163=$7116$7121[1]),(((t1$7127=$7116$7121[2])),((t1$7127 instanceof Array)&&(((t2$7128=t1$7127.length)),(t2$7128===0)))))))){(top$7177=$6172(Math.max,(((acc$7185=[])),(((temp$7190=active$7163)),((($length$7195=temp$7190.length)),((($index$7200=0)),function(){$7182:for(;($index$7200<$length$7195);($index$7200++)){var e$7218;var t0$7213;var t1$7214;var m$7208;(m$7208=temp$7190[$index$7200]);(t0$7213=m$7208);if(((t0$7213 instanceof Array)&&(((t1$7214=t0$7213.length)),(t1$7214===3)))){t0$7213[0];(e$7218=t0$7213[1]);t0$7213[2];acc$7185.push(e$7218);}else{$8077(m$7208,"/home/olivier/git/earl-grey/src/location.eg",4112,4150);}}}()))),acc$7185)));(bot$7178=Math.min(start$7162,top$7177));(t0$7236=jumptill$6899(active$7163,start$7162,top$7177));if(((t0$7236 instanceof Array)&&(((t1$7237=t0$7236.length)),(t1$7237===2)))){(spans$7179=t0$7236[0]);t0$7236[1];}else{$8077(jumptill$6899(active$7163,start$7162,top$7177),"/home/olivier/git/earl-grey/src/location.eg",4203,4241);}return spans$7179;}else{if(($7119$7134&&((start$7250=$7116$7121[0]),((active$7251=$7116$7121[1]),(((t1$7127=$7116$7121[2])),((t1$7127 instanceof Array)&&(((t2$7128=t1$7127.length)),((t2$7128>=1)&&(((t3$7129=t1$7127[0])),((next$7252=t3$7129),((t3$7129 instanceof Array)&&(((t4$7130=t3$7129.length)),(t4$7130===3))))))))))))){(target$7253=t3$7129[0]);(end$7254=t3$7129[1]);(attr$7255=t3$7129[2]);(rest$7256=Array.prototype.slice.call(t1$7127,1));(t0$7282=jumptill$6899(active$7251,start$7250,target$7253));if(((t0$7282 instanceof Array)&&(((t1$7283=t0$7282.length)),(t1$7283===2)))){(spans$7279=t0$7282[0]);(newactive$7280=t0$7282[1]);}else{$8077(jumptill$6899(active$7251,start$7250,target$7253),"/home/olivier/git/earl-grey/src/location.eg",4345,4386);}return spans$7279.concat(process_elements$6900(target$7253,[next$7252].concat(newactive$7280),rest$7256));}else{$8077($7116$7121);}}}});(thespans$6901=spans$6895.sort(function($7299$7302,$7300$7303){var t0$7310;var t1$7311;var t0$7323;var t1$7324;var s1$7305;var e1$7306;var s2$7307;var e2$7308;(t0$7310=$7299$7302);if(((t0$7310 instanceof Array)&&(((t1$7311=t0$7310.length)),(t1$7311===3)))){(s1$7305=t0$7310[0]);(e1$7306=t0$7310[1]);t0$7310[2];}else{$8077($7299$7302);}(t0$7323=$7300$7303);if(((t0$7323 instanceof Array)&&(((t1$7324=t0$7323.length)),(t1$7324===3)))){(s2$7307=t0$7323[0]);(e2$7308=t0$7323[1]);t0$7323[2];}else{$8077($7300$7303);}if((s1$7305===s2$7307)){return (e1$7306-e2$7308);}else{return (s1$7305-s2$7307);}}));return process_elements$6900(thespans$6901[0][0],[],thespans$6901);});(highlight_locations$6237=function(){var $index$7377;var $length$7372;var temp$7367;var $index$7435;var $length$7430;var temp$7425;var acc$7420;var srcs$7359;var locations$7351;var context$7352;var t0$7347;var $7340$7342;($7340$7342=arguments);(t0$7347=$7340$7342.length);if(((t0$7347>=1)&&(t0$7347<=2))){(locations$7351=$7340$7342[0]);(context$7352=function(){if((1>=t0$7347)){return 0;}else{return $7340$7342[1];}}());(srcs$7359=({}));(temp$7367=locations$7351);($length$7372=temp$7367.length);($index$7377=0);$7360:for(;($index$7377<$length$7372);($index$7377++)){var key$7407;var loc$7395;var cls$7396;var t0$7390;var t1$7391;var m$7385;(m$7385=temp$7367[$index$7377]);(t0$7390=m$7385);if(((t0$7390 instanceof Array)&&(((t1$7391=t0$7390.length)),(t1$7391===2)))){(loc$7395=t0$7390[0]);(cls$7396=t0$7390[1]);(key$7407=String((loc$7395.source&&loc$7395.source.url)));if((!$6172(srcs$7359,key$7407))){(srcs$7359[key$7407]=[]);}$6172(srcs$7359,key$7407).push([loc$7395,cls$7396]);}else{$8077(m$7385,"/home/olivier/git/earl-grey/src/location.eg",4732,4901);}}return $8311(["+div"],(((acc$7420=[])),(((temp$7425=$8506(srcs$7359))),((($length$7430=temp$7425.length)),((($index$7435=0)),function(){$7417:for(;($index$7435<$length$7430);($index$7435++)){var locs$7453;var t0$7448;var t1$7449;var m$7443;(m$7443=temp$7425[$index$7435]);(t0$7448=m$7443);if(((t0$7448 instanceof Array)&&(((t1$7449=t0$7448.length)),(t1$7449===2)))){t0$7448[0];(locs$7453=t0$7448[1]);acc$7420.push(highlight_locations_same_source$6238(locs$7453,context$7352));}else{$8077(m$7443,"/home/olivier/git/earl-grey/src/location.eg",4906,5000);}}}()))),acc$7420));}else{$8077($7340$7342);}});(highlight_locations_same_source$6238=function(){var $index$7517;var $length$7512;var temp$7507;var acc$7502;var t0$7554;var t1$7555;var $index$7590;var $length$7585;var temp$7580;var acc$7575;var $index$7640;var $length$7635;var temp$7630;var acc$7625;var loc$7491;var src$7492;var l1$7493;var l2$7494;var first$7495;var last$7496;var locations$7483;var context$7484;var t0$7479;var $7472$7474;($7472$7474=arguments);(t0$7479=$7472$7474.length);if(((t0$7479>=1)&&(t0$7479<=2))){(locations$7483=$7472$7474[0]);(context$7484=function(){if((1>=t0$7479)){return 0;}else{return $7472$7474[1];}}());(loc$7491=merge_locations$6239((((acc$7502=[])),(((temp$7507=locations$7483)),((($length$7512=temp$7507.length)),((($index$7517=0)),function(){$7499:for(;($index$7517<$length$7512);($index$7517++)){var x$7535;var cls$7536;var t0$7530;var t1$7531;var m$7525;(m$7525=temp$7507[$index$7517]);(t0$7530=m$7525);if(((t0$7530 instanceof Array)&&(((t1$7531=t0$7530.length)),(t1$7531===2)))){(x$7535=t0$7530[0]);(cls$7536=t0$7530[1]);acc$7502.push(x$7535);}else{$8077(m$7525,"/home/olivier/git/earl-grey/src/location.eg",5083,5111);}}}()))),acc$7502)));(src$7492=loc$7491.source);(t0$7554=loc$7491.linerange());if(((t0$7554 instanceof Array)&&(((t1$7555=t0$7554.length)),(t1$7555===2)))){(l1$7493=t0$7554[0]);(l2$7494=t0$7554[1]);}else{$8077(loc$7491.linerange(),"/home/olivier/git/earl-grey/src/location.eg",5147,5166);}(first$7495=Math.max(1,(l1$7493-context$7484)));(last$7496=Math.min(src$7492.nlines,(l2$7494+context$7484)));return $8311(["+div","location"],[$8311(["+div","source"],[$8311(["sourcefile"],(src$7492.url||"???")),(((acc$7575=[])),(((temp$7580=locations$7483)),((($length$7585=temp$7580.length)),((($index$7590=0)),function(){$7572:for(;($index$7590<$length$7585);($index$7590++)){var loc$7608;var cls$7609;var t0$7603;var t1$7604;var m$7598;(m$7598=temp$7580[$index$7590]);(t0$7603=m$7598);if(((t0$7603 instanceof Array)&&(((t1$7604=t0$7603.length)),(t1$7604===2)))){(loc$7608=t0$7603[0]);(cls$7609=t0$7603[1]);acc$7575.push($8311([cls$7609,"sourcepos"],loc$7608.ref()));}else{$8077(m$7598,"/home/olivier/git/earl-grey/src/location.eg",5331,5401);}}}()))),acc$7575)]),src$7492.highlight_lines(first$7495,last$7496,(((acc$7625=[])),(((temp$7630=locations$7483)),((($length$7635=temp$7630.length)),((($index$7640=0)),function(){$7622:for(;($index$7640<$length$7635);($index$7640++)){var loc$7658;var cls$7659;var t0$7653;var t1$7654;var m$7648;(m$7648=temp$7630[$index$7640]);(t0$7653=m$7648);if(((t0$7653 instanceof Array)&&(((t1$7654=t0$7653.length)),(t1$7654===2)))){(loc$7658=t0$7653[0]);(cls$7659=t0$7653[1]);acc$7625.push([loc$7658.start,loc$7658.end,[cls$7659]]);}else{$8077(m$7648,"/home/olivier/git/earl-grey/src/location.eg",5456,5514);}}}()))),acc$7625))]);}else{$8077($7472$7474);}});(merge_locations$6239=function($7677$7679){var $index$7739;var $length$7734;var temp$7729;var acc$7724;var $index$7779;var $length$7774;var temp$7769;var acc$7764;var start$7717;var end$7718;var locs$7713;var loc$7708;var $7682$7696;var $7683$7697;var t0$7694;var $7681$7689;var ph$7684;(ph$7684=$7677$7679);($7681$7689=ph$7684);if((($7682$7696=($7681$7689 instanceof Array))&&(((t0$7694=$7681$7689.length)),(t0$7694===0)))){return Location$6232(null,0,0);}else{if(($7682$7696&&(t0$7694===1))){(loc$7708=$7681$7689[0]);return loc$7708;}else{if(($7682$7696&&(t0$7694>=0))){(locs$7713=Array.prototype.slice.call($7681$7689,0));(start$7717=$6172(Math.min,(((acc$7724=[])),(((temp$7729=locs$7713)),((($length$7734=temp$7729.length)),((($index$7739=0)),function(){$7721:for(;($index$7739<$length$7734);($index$7739++)){var loc$7755;var m$7747;(m$7747=temp$7729[$index$7739]);(loc$7755=m$7747);acc$7724.push(loc$7755.start);}}()))),acc$7724)));(end$7718=$6172(Math.max,(((acc$7764=[])),(((temp$7769=locs$7713)),((($length$7774=temp$7769.length)),((($index$7779=0)),function(){$7761:for(;($index$7779<$length$7774);($index$7779++)){var loc$7795;var m$7787;(m$7787=temp$7769[$index$7779]);(loc$7795=m$7787);acc$7764.push(loc$7795.end);}}()))),acc$7764)));return Location$6232(locs$7713[0].source,start$7717,end$7718);}else{$8077($7681$7689);}}}});(__lt____lt____colon__$6240=function(x$7805,y$7806){if((!$6157(Location$6232)(x$7805.location))){(x$7805["location"]=function(){if(((!y$7806)||$6157(Location$6232)(y$7806))){return y$7806;}else{return y$7806.location;}}());}return x$7805;});(__plus____plus____colon__$6241=function(x$7817,y$7818){var rval$7830;var x2$7821;var y2$7822;(x2$7821=function(){if(((!x$7817)||$6157(Location$6232)(x$7817))){return x$7817;}else{return x$7817.location;}}());(y2$7822=function(){if(((!y$7818)||$6157(Location$6232)(y$7818))){return y$7818;}else{return y$7818.location;}}());(rval$7830=false);try{(rval$7830=merge_locations$6239([x2$7821,y2$7822]));}catch(excv$7839){var e$7845;(e$7845=excv$7839);(rval$7830=(void 0));}return rval$7830;});(format_error$6242=function(){var $index$7939;var $length$7934;var temp$7929;var acc$7924;var hls$7914;var locs$7915;var rval$8010;var loc$8032;var data$8006;var other$8038;var url$7996;var start$7997;var end$7998;var loc$7987;var args$7899;var fmt_args$7890;var $7856$7886;var $7857$7887;var $7858$7888;var t0$7882;var t1$7883;var t2$7884;var e$7870;var context$7871;var $7855$7872;var t0$7865;var t1$7866;var $7854$7860;($7854$7860=arguments);(t0$7865=$7854$7860.length);if(((t0$7865>=1)&&(t0$7865<=2))){(t1$7866=$7854$7860[0]);(e$7870=t1$7866);($7855$7872=t1$7866);(context$7871=function(){if((1>=t0$7865)){return 0;}else{return $7854$7860[1];}}());(fmt_args$7890=function(e$7894){if((e$7894.args&&e$7894.args.length)){return $8311(["error_args"],repr$6229(e$7894.args));}else{return "";}});(t0$7882=$7855$7872);if(($6157($8093(["syntax"]))(t0$7882)&&($8521(t0$7882,"args")&&(((t1$7883=t0$7882.args)),((t1$7883 instanceof Array)&&(((t2$7884=t1$7883.length)),(t2$7884===1))))))){(args$7899=t1$7883[0]);(hls$7914=["hl1","hl2","hl3","hl4"]);(locs$7915=(((acc$7924=[])),(((temp$7929=$8289($8506(args$7899)))),((($length$7934=temp$7929.length)),((($index$7939=0)),function(){$7921:for(;($index$7939<$length$7934);($index$7939++)){var i$7959;var key$7960;var arg$7961;var t0$7952;var t1$7953;var t2$7954;var t3$7955;var m$7947;(m$7947=temp$7929[$index$7939]);(t0$7952=m$7947);if(((t0$7952 instanceof Array)&&(((t1$7953=t0$7952.length)),((t1$7953===2)&&((i$7959=t0$7952[0]),(((t2$7954=t0$7952[1])),((t2$7954 instanceof Array)&&(((t3$7955=t2$7954.length)),((t3$7955===2)&&((key$7960=t2$7954[0]),((arg$7961=t2$7954[1]),(arg$7961&&arg$7961.location)))))))))))){acc$7924.push([arg$7961.location,$6172(hls$7914,(i$7959%4))]);}else{false;}}}()))),acc$7924));return $8311(["+div"],[$8311(["error"],[$8311(["error_type"],e$7870.name),$8311(["error_message"],e$7870.message)]),$8311(["error_args","syntax"],repr$6229(args$7899)),highlight_locations$6237(locs$7915,context$7871)]);}else{if((($7857$7887=$8521(t0$7882,"location"))&&(((t1$7883=t0$7882.location)),$6157(Location$6232)(t1$7883)))){(loc$7987=t1$7883);return $8311(["+div"],[$8311(["error"],[$8311(["error_type"],e$7870.name),$8311(["error_message"],e$7870.message)]),fmt_args$7890(e$7870),highlight_locations$6237([[loc$7987,"hl1"]],context$7871),$8311(["traceback"],(e$7870.stack||""))]);}else{if(($7857$7887&&((t1$7883 instanceof Array)&&(((t2$7884=t1$7883.length)),((t2$7884===4)&&(t1$7883[0]==="location")))))){(url$7996=t1$7883[1]);(start$7997=t1$7883[2]);(end$7998=t1$7883[3]);(data$8006=(((rval$8010=false)),(function(){try{(rval$8010=fs$6230.readFileSync(url$7996,"utf8"));}catch(excv$8019){var e$8025;(e$8025=excv$8019);(rval$8010=null);}}(),rval$8010)));if(data$8006){(loc$8032=Location$6232(Source$6231(data$8006,url$7996),start$7997,end$7998));return $8311(["+div"],[$8311(["error"],[$8311(["error_type"],e$7870.name),$8311(["error_message"],e$7870.message)]),fmt_args$7890(e$7870),highlight_locations$6237([[loc$8032,"hl1"]],context$7871),$8311(["traceback"],($8311([],e$7870.stack)||""))]);}else{return $8311(["+div"],[$8311(["error"],[$8311(["error_type"],e$7870.name),$8311(["error_message"],e$7870.message)]),fmt_args$7890(e$7870),$8311(["traceback"],($8311([],e$7870.stack)||e$7870))]);}}else{(other$8038=$7855$7872);return $8311(["+div"],[$8311(["error"],[$8311(["error_type"],e$7870.name),$8311(["error_message"],e$7870.message)]),fmt_args$7890(e$7870),$8311(["traceback"],$8311([],e$7870.stack))]);}}}}else{$8077($7854$7860);}});(display_error$6243=function(e$8046){return __lt____gt__$6228(null,format_error$6242(e$8046));});(exports["Source"]=Source$6231);(exports["Location"]=Location$6232);(exports["highlight"]=highlight$6233);(exports["highlight_locations"]=highlight_locations$6237);(exports["merge_locations"]=merge_locations$6239);(exports["<<:"]=__lt____lt____colon__$6240);(exports["++:"]=__plus____plus____colon__$6241);(exports["format_error"]=format_error$6242);(exports["display_error"]=display_error$6243);
