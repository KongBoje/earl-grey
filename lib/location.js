var send=function(obj,msg){var __t111=msg;var other;if(((typeof(__t111)==="string")||(typeof(__t111)==="number"))){return obj[msg];}else{if(((other=__t111),true)){return obj["::send"](msg);}else{throw ["Could not find a match",__t111];}}};(Function.prototype["::send"]=function(args){return this.apply(this,args);});var augment=function(dest,values){for(k in values){(dest[k]=send(values,k));}return dest;};var patch_array=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};var range=function(from,to){var rval=[];for(var i=from;(i<=to);(i++)){rval.push(i);}return rval;};var StructFactory=function(name){var make=function(){var r=Array.prototype.slice.call(arguments,0);(r["#"]=name);return r;};(make[":::project"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return [true,value];}else{if(true){return [true,make(value)];}else{return false;}}});(make["::check"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return true;}else{if(true){return false;}else{return false;}}});(make[":::deconstruct"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return [true,value.slice(0)];}else{if(true){return [false,false];}else{return false;}}});return make;};var Struct=function(name){var r=Array.prototype.slice.call(arguments,1);(r["#"]=name);return r;};(Struct["::check"]=function(value){if((value instanceof Array)){return (value["#"]!==undefined);}else{if(true){return false;}else{return false;}}});(Struct[":::deconstruct"]=function(value){if(((value instanceof Array)&&(value["#"]!==undefined))){return [true,[value["#"]].concat(value.slice(0))];}else{if(true){return [false,null];}else{return false;}}});var pr_terminus=function(node){var r=HTML(node,"span");var pre=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">");var post=("</div>"+String.fromCharCode(7));return console.log(((pre+r)+post));};var pr=function(__t112,r){var __t113=__t112;var n;var x;if((___checker(Node)(__t113)&&((n=__t113),true))){return pr_terminus(n);}else{if(((x=__t113),true)){return pr_terminus((r||repr)(x));}else{throw ["Could not find a match",__t113];}}};var repr=function(__t115,__t116){var x;var __t114;(x=__t115);true;(__t114=__t115);var recur;var recur;if(((___checker(Function)(__t116)&&((recur=__t116),true))||((recur=repr),true))){(void 0);}else{throw "a condition failed";}var __t117=__t114;var __tp0;var __tp1;var __tp2;var tag;var entries;var entries;var other;if((__t117===true)){return Node(["special","true"],"true");}else{if((__t117===false)){return Node(["special","false"],"false");}else{if((__t117===null)){return Node(["special","nil"],"null");}else{if((__t117===(void 0))){return Node(["special","nil"],"undefined");}else{if((typeof(__t117)==="number")){return Node(["num"],String(x));}else{if((typeof(__t117)==="string")){return Node(["str"],x);}else{if((___checker(Struct)(__t117)&&(((__tp0=___deconstructor(Struct)(__t117)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2>=1)&&((tag=__tp1[0]),true,(entries=__tp1.slice(1)),true)))))){return Node(["struct"],[Node(["sym"],tag),Node(["sequence"],function(){var __t118=[];var __t119=entries;var __t120=__t119.length;for(var __t121=0;(__t121<__t120);(__t121++)){var __t122=__t119[__t121];var x;var other;if(((x=__t122),true)){__t118.push(recur(x,repr));}else{if(((other=__t122),true)){false;}else{throw ["Could not find a match",__t122];}}}return __t118;}())]);}else{if((___checker(Array)(__t117)&&((entries=__t117),true))){return Node(["sequence"],function(){var __t123=[];var __t124=entries;var __t125=__t124.length;for(var __t126=0;(__t126<__t125);(__t126++)){var __t127=__t124[__t126];var x;var other;if(((x=__t127),true)){__t123.push(recur(x,repr));}else{if(((other=__t127),true)){false;}else{throw ["Could not find a match",__t127];}}}return __t123;}());}else{if(x["::repr"]){return x["::repr"](recur);}else{if((Object.getPrototypeOf(x)===Object.prototype)){return Node(["table"],function(){var __t128=[];var __t129=items(x);var __t130=__t129.length;for(var __t131=0;(__t131<__t130);(__t131++)){var __t132=__t129[__t131];var __tp0;var k;var v;var other;if(((__t132 instanceof Array)&&((__t132["#"]===undefined)&&(((__tp0=__t132.length),true)&&((__tp0===2)&&((k=__t132[0]),true,(v=__t132[1]),true)))))){__t128.push(Node(["pairing"],[recur(k,repr),recur(v,repr)]));}else{if(((other=__t132),true)){false;}else{throw ["Could not find a match",__t132];}}}return __t128;}());}else{if(((other=__t117),true)){return Node(["unknown"],other.toString());}else{throw ["Could not find a match",__t117];}}}}}}}}}}}};var ___checker=function(type){var __t133=type["::check"];var f;if((__t133===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=__t133),true)){return function(value){return f.call(type,value);};}else{throw ["Could not find a match",__t133];}}};var checker=___checker;var ___projector=function(type){return function(value){var __t134=type[":::project"];var f;if((__t134===(void 0))){var __t135=type["::project"];var f;if((__t135===(void 0))){return [true,type(value)];}else{if(((f=__t135),true)){var __t137;try{(__t137=[true,f(value)]);}catch(__t136){(__t137=[false,null]);}return __t137;}else{throw ["Could not find a match",__t135];}}}else{if(((f=__t134),true)){return f.call(type,value);}else{throw ["Could not find a match",__t134];}}};};var projector=___projector;var ___deconstructor=function(type){return function(value){var __t138=type[":::deconstruct"];var f;if((__t138===(void 0))){var __t139=type["::deconstruct"];var f;if((__t139===(void 0))){if((value instanceof Array)){return [true,value];}else{if(true){return [false,null];}else{return false;}}}else{if(((f=__t139),true)){var __t141;try{(__t141=[true,f.call(type,value)]);}catch(__t140){(__t141=[false,null]);}return __t141;}else{throw ["Could not find a match",__t139];}}}else{if(((f=__t138),true)){return f.call(type,value);}else{throw ["Could not find a match",__t138];}}};};var deconstructor=___deconstructor;(Array[":::project"]=function(value){var __t142=value;var _;if(___checker(Array)(__t142)){return [true,value];}else{if(((_=__t142),true)){return [true,[value]];}else{throw ["Could not find a match",__t142];}}});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var __t143=value.match(this);var m;var m;if(((__t143===null)&&((m=__t143),true))){return [false,null];}else{if(((m=__t143),true)){return [true,m];}else{throw ["Could not find a match",__t143];}}});(RegExp.prototype[":::deconstruct"]=function(value){var __t144=value.match(this);var m;var m;if(((__t144===null)&&((m=__t144),true))){return [false,null];}else{if(((m=__t144),true)){return [true,m];}else{throw ["Could not find a match",__t144];}}});var Node=function(__t99,__t100){var __tp0;var classes;if((((__tp0=___projector(Array)(__t99)),__tp0[0])&&((classes=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var __tp0;var children;if((((__tp0=___projector(Array)(__t100)),__tp0[0])&&((children=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var __t98=function(){if((!___checker(Node)(this))){return Object.create(Node.prototype);}else{return this;}}();(__t98["classes"]=classes.sort());(__t98["children"]=children);return __t98;};augment(Node,({"::check":function(x){return ((x&&x.classes)&&x.children);},"::deconstruct":function(x){return [x.classes,x.children];}}));(Node.prototype["::check"]=function(n){var __t98=this;var __t101=__t98.classes;var __t102=__t101.length;for(var __t103=0;(__t103<__t102);(__t103++)){var __t104=__t101[__t103];var c;var other;if(((c=__t104),true,(n.classes.indexOf(c)===(-1)))){return false;}else{if(((other=__t104),true)){false;}else{throw ["Could not find a match",__t104];}}}false;return true;});Node;var escape_html=function(__t145){var __tp0;var s;if((((__tp0=[true,String(__t145)]),__tp0[0])&&((s=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var repl=({"&":"&amp;","<":"&lt;",">":"&gt;"});return s.replace(RegExp("[&<>]","g"),function(x){return send(repl,x);});};var quotify=function(__t146){var __tp0;var s;if((((__tp0=[true,String(__t146)]),__tp0[0])&&((s=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}return s.replace(RegExp("[\"\\\\]","g"),function(x){return ("\\"+x);});};var HTML=function(__t147,default_tag){var __t148=__t147;var s;var children;var __tp0;var __tp1;var __tp2;var tags;var children;var other;if(((typeof(__t148)==="string")&&((s=__t148),true))){return escape_html(s);}else{if((___checker(Array)(__t148)&&((children=__t148),true))){return function(){var __t149=[];var __t150=children;var __t151=__t150.length;for(var __t152=0;(__t152<__t151);(__t152++)){var __t153=__t150[__t152];var child;var other;if(((child=__t153),true)){__t149.push(HTML(child,default_tag));}else{if(((other=__t153),true)){false;}else{throw ["Could not find a match",__t153];}}}return __t149;}().join("");}else{if((___checker(Node)(__t148)&&(((__tp0=___deconstructor(Node)(__t148)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((tags=__tp1[0]),true,(children=__tp1[1]),true)))))){var tag=(default_tag||"span");var classes=[];var id=null;var kv=[];var sub=[];var __t154=tags;var __t155=__t154.length;for(var __t156=0;(__t156<__t155);(__t156++)){var __t158=__t154[__t156];var __tp0;var __tp1;var __tp2;var k;var v;var __tp0;var __tp1;var __tp2;var k;var __tp0;var __tp1;var __tp2;var _;var m;var __tp0;var __tp1;var __tp2;var _;var m;var s;var other;var __t159=false;var __t160=false;var __t161=false;if(((__t159=(__t158["#"]==="assoc"))&&((__t160=((__tp0=[true,__t158]),__tp0[0]))&&((__t161=((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true))&&((__tp2===2)&&((k=__tp1[0]),true,(v=__tp1[1]),true)))))){kv.push([k,v]);}else{if((__t161&&((__tp2===1)&&((k=__tp1[0]),true)))){kv.push([k,undefined]);}else{if((___checker(RegExp("(?:^\\+((?:.*)))",""))(__t158)&&(((__tp0=___deconstructor(RegExp("(?:^\\+((?:.*)))",""))(__t158)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((_=__tp1[0]),true,(m=__tp1[1]),true)))))){(tag=m);}else{if((___checker(RegExp("(?:^#((?:.*)))",""))(__t158)&&(((__tp0=___deconstructor(RegExp("(?:^#((?:.*)))",""))(__t158)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((_=__tp1[0]),true,(m=__tp1[1]),true)))))){(id=m);}else{if(((typeof(__t158)==="string")&&((s=__t158),true))){classes.push(s);}else{if(((other=__t158),true)){false;}else{throw ["Could not find a match",__t158];}}}}}}}false;var accum=function(){if((tag==="raw")){return [];}else{return ["<",tag];}}();if(id){(accum=accum.concat(" id=\"",id,"\""));}else{false;}if(classes.length){(accum=accum.concat(" class=\"",quotify(classes.join(" ")),"\""));}else{false;}if(kv){var __t162=[];var __t163=kv;var __t164=__t163.length;for(var __t165=0;(__t165<__t164);(__t165++)){var __t166=__t163[__t165];var __tp0;var k;var v;var other;if(((__t166 instanceof Array)&&((__t166["#"]===undefined)&&(((__tp0=__t166.length),true)&&((__tp0===2)&&((k=__t166[0]),true,(v=__t166[1]),true)))))){__t162.push((accum=accum.concat(function(){if((v!==null)){return [" ",k,"=\"",quotify(v),"\""];}else{return [" ",k];}}())));}else{if(((other=__t166),true)){false;}else{throw ["Could not find a match",__t166];}}}__t162;}else{false;}(children=function(){var __t167=tag;var other;if((__t167==="raw")){var __t168=[];var __t169=children;var __t170=__t169.length;for(var __t171=0;(__t171<__t170);(__t171++)){var __t172=__t169[__t171];var s;var c;var other;if(((typeof(__t172)==="string")&&((s=__t172),true))){__t168.push(s);}else{if(((c=__t172),true)){__t168.push(HTML(c,default_tag));}else{if(((other=__t172),true)){false;}else{throw ["Could not find a match",__t172];}}}}return __t168;}else{if(((other=__t167),true)){var __t173=[];var __t174=children;var __t175=__t174.length;for(var __t176=0;(__t176<__t175);(__t176++)){var __t177=__t174[__t176];var c;var other;if(((c=__t177),true)){__t173.push(HTML(c,default_tag));}else{if(((other=__t177),true)){false;}else{throw ["Could not find a match",__t177];}}}return __t173;}else{throw ["Could not find a match",__t167];}}}());var __t157=tag;var other;if((__t157==="raw")){return accum.concat(children).join("");}else{if(((other=__t157),true)){var x=patch_array([">"],children,["</",tag,">"]);return accum.concat(x).join("");}else{throw ["Could not find a match",__t157];}}}else{if(((other=__t148),true)){return HTML([true,String(other)][1],default_tag);}else{throw ["Could not find a match",__t148];}}}}};var ErrorFactory=function(tags){var __t105=function(){if((!___checker(ErrorFactory)(this))){return Object.create(ErrorFactory.prototype);}else{return this;}}();(__t105["tags"]=tags);return __t105;};augment(ErrorFactory,[]);(ErrorFactory.prototype["create"]=function(){var __t106=Array.prototype.slice.call(arguments,0);var __tp0;var message;var args;if(((__t106 instanceof Array)&&((__t106["#"]===undefined)&&(((__tp0=__t106.length),true)&&((__tp0>=0)&&((message=function(){if((0>=__tp0)){return "";}else{return __t106[0];}}()),true,(args=__t106.slice(1)),true)))))){var __t105=this;var e=Error(message);(e["::tags"]=__t105.tags);(e["args"]=args);(e["name"]=["E"].concat(__t105.tags).join("."));return e;}else{throw ["Could not find a match",__t106];}});(ErrorFactory.prototype["::check"]=function(e){var __t105=this;if(((!e)||(!___checker(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var __t107=__t105.tags;var __t108=__t107.length;for(var __t109=0;(__t109<__t108);(__t109++)){var __t110=__t107[__t109];var tag;var other;if(((tag=__t110),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=__t110),true)){false;}else{throw ["Could not find a match",__t110];}}}false;return true;});(ErrorFactory.prototype["::deconstruct"]=function(e){var __t105=this;return e.args;});ErrorFactory;
var Source=function(){var __t179=Array.prototype.slice.call(arguments,0);var __tp0;var text;var url;if(((__t179 instanceof Array)&&((__t179["#"]===undefined)&&(((__tp0=__t179.length),true)&&(((__tp0>=1)&&(__tp0<=2))&&((text=__t179[0]),true,(url=function(){if((1>=__tp0)){return false;}else{return __t179[1];}}()),true)))))){var __t178=function(){if((!___checker(Source)(this))){return Object.create(Source.prototype);}else{return this;}}();(__t178["text"]=text);(__t178["url"]=url);(__t178["counts"]=[]);var curr=0;var __t180=text.split("\n");var __t181=__t180.length;for(var __t182=0;(__t182<__t181);(__t182++)){var __t183=__t180[__t182];var line;var other;if(((line=__t183),true)){__t178.counts.push(curr);(curr=(curr+(line.length+1)));}else{if(((other=__t183),true)){false;}else{throw ["Could not find a match",__t183];}}}false;__t178.counts.push(curr);(__t178["nlines"]=(__t178.counts.length-1));return __t178;}else{throw ["Could not find a match",__t179];}};augment(Source,[]);(Source.prototype["linecol"]=function(pos){var __t178=this;var line=binsearch(__t178.counts,pos);var col=(pos-send(__t178.counts,(line-1)));return [line,col];});(Source.prototype["highlight_lines"]=function(l1,l2,spans){var __t178=this;return highlight_lines(__t178.text,__t178.counts,[(l1-1),(l2-1)],spans);});Source;var Location=function(source,start,end){var __t184=function(){if((!___checker(Location)(this))){return Object.create(Location.prototype);}else{return this;}}();(__t184["source"]=(source||Source("",null)));(__t184["start"]=start);(__t184["end"]=end);return __t184;};augment(Location,[]);(Location.prototype["text"]=function(){var __t184=this;return __t184.source.text.slice(__t184.start,__t184.end);});(Location.prototype["linerange"]=function(){var __t184=this;var __t185=__t184.linecol();var __tp0;var __tp1;var __tp2;var l1;var _;var __t186;if(((__t185 instanceof Array)&&((__t185["#"]===undefined)&&(((__tp0=__t185.length),true)&&((__tp0===2)&&(((__tp1=__t185[0]),(__tp1 instanceof Array))&&((__tp1["#"]===undefined)&&(((__tp2=__tp1.length),true)&&((__tp2===2)&&((l1=__tp1[0]),true,(_=__tp1[1]),true,(__t186=__t185[1]),true)))))))))){var __t187=__t186;var __tp0;var l2;var _;if((__t187===null)){return [l1,l1];}else{if(((__t187 instanceof Array)&&((__t187["#"]===undefined)&&(((__tp0=__t187.length),true)&&((__tp0===2)&&((l2=__t187[0]),true,(_=__t187[1]),true)))))){return [l1,l2];}else{throw ["Could not find a match",__t187];}}}else{throw ["Could not find a match",__t185];}});(Location.prototype["linecol"]=function(){var __t184=this;var start=__t184.source.linecol(__t184.start);var end=function(){if((__t184.start===__t184.end)){return null;}else{return __t184.source.linecol((__t184.end-1));}}();return [start,end];});(Location.prototype["ref"]=function(){var __t184=this;var __t188=__t184.linecol();var __tp0;var __tp1;var __tp2;var __tp3;var __tp4;var l1;var __tp5;var __tp6;var c1;var __t189;if(((__t188 instanceof Array)&&((__t188["#"]===undefined)&&(((__tp0=__t188.length),true)&&((__tp0===2)&&(((__tp1=__t188[0]),(__tp1 instanceof Array))&&((__tp1["#"]===undefined)&&(((__tp2=__tp1.length),true)&&((__tp2===2)&&(((__tp3=__tp1[0]),(__tp4=[true,String(__tp3)]),__tp4[0])&&(((l1=__tp4[1]),true,(__tp5=__tp1[1]),(__tp6=[true,String(__tp5)]),__tp6[0])&&((c1=__tp6[1]),true,(__t189=__t188[1]),true)))))))))))){var __t190=__t189;var __tp0;var __tp1;var __tp2;var l2;var __tp3;var __tp4;var c2;if((__t190===null)){return ((l1+":")+c1);}else{if(((__t190 instanceof Array)&&((__t190["#"]===undefined)&&(((__tp0=__t190.length),true)&&((__tp0===2)&&(((__tp1=__t190[0]),(__tp2=[true,String(__tp1)]),__tp2[0])&&(((l2=__tp2[1]),true,(__tp3=__t190[1]),(__tp4=[true,String(__tp3)]),__tp4[0])&&((c2=__tp4[1]),true)))))))){var __t191=null;var otherwise;if(((l1===l2)&&(c1===c2))){return ((l1+":")+c1);}else{if((l1===l2)){return ((((l1+":")+c1)+"-")+c2);}else{if(((otherwise=__t191),true)){return ((((((l1+":")+c1)+"-")+l1)+":")+c2);}else{throw ["Could not find a match",__t191];}}}}else{throw ["Could not find a match",__t190];}}}else{throw ["Could not find a match",__t188];}});(Location.prototype["highlight"]=function(){var __t192=Array.prototype.slice.call(arguments,0);var __tp0;var cls;var context;if(((__t192 instanceof Array)&&((__t192["#"]===undefined)&&(((__tp0=__t192.length),true)&&(((__tp0>=0)&&(__tp0<=2))&&((cls=function(){if((0>=__tp0)){return "hl1";}else{return __t192[0];}}()),true,(context=function(){if((1>=__tp0)){return 0;}else{return __t192[1];}}()),true)))))){var __t184=this;return highlight_locations([[__t184,cls]],context);}else{throw ["Could not find a match",__t192];}});Location;var highlight=function(){var __t193=Array.prototype.slice.call(arguments,0);var __tp0;var text;var spans;var offset;if(((__t193 instanceof Array)&&((__t193["#"]===undefined)&&(((__tp0=__t193.length),true)&&(((__tp0>=2)&&(__tp0<=3))&&((text=__t193[0]),true,(spans=__t193[1]),true,(offset=function(){if((2>=__tp0)){return 0;}else{return __t193[2];}}()),true)))))){return Node([],function(){var __t194=[];var __t195=morsel(spans);var __t196=__t195.length;for(var __t197=0;(__t197<__t196);(__t197++)){var __t198=__t195[__t197];var __tp0;var start;var end;var attributes;var other;if(((__t198 instanceof Array)&&((__t198["#"]===undefined)&&(((__tp0=__t198.length),true)&&((__tp0===3)&&((start=__t198[0]),true,(end=__t198[1]),true,(attributes=__t198[2]),true)))))){__t194.push(function(){var xstart=Math.max((start-offset),0);var xend=Math.min((end-offset),text.length);return Node(attributes,[text.slice(xstart,xend)]);}());}else{if(((other=__t198),true)){false;}else{throw ["Could not find a match",__t198];}}}return __t194;}());}else{throw ["Could not find a match",__t193];}};var highlight_lines=function(text,linelocs,__t199,spans){var __tp0;var l1;var l2;if(((__t199 instanceof Array)&&((__t199["#"]===undefined)&&(((__tp0=__t199.length),true)&&((__tp0===2)&&((l1=__t199[0]),true,(l2=__t199[1]),true)))))){(void 0);}else{throw "a condition failed";}return Node(["+span"],function(){var __t200=[];var __t201=range(l1,l2);var __t202=__t201.length;for(var __t203=0;(__t203<__t202);(__t203++)){var __t204=__t201[__t203];var lineno;var other;if(((lineno=__t204),true)){__t200.push(function(){var start=send(linelocs,lineno);var end=send(linelocs,(lineno+1));return Node(["+span"],[Node(["lineno"],(lineno+1)),Node(["source"],highlight(text,patch_array([[start,end,[]]],clamp(spans,start,end))))]);}());}else{if(((other=__t204),true)){false;}else{throw ["Could not find a match",__t204];}}}return __t200;}());};var clamp=function(spans,bot,top){var __t205=[];var __t206=spans;var __t207=__t206.length;for(var __t208=0;(__t208<__t207);(__t208++)){var __t209=__t206[__t208];var __tp0;var start;var end;var attr;var other;if(((__t209 instanceof Array)&&((__t209["#"]===undefined)&&(((__tp0=__t209.length),true)&&((__tp0===3)&&((start=__t209[0]),true,(end=__t209[1]),true,(attr=__t209[2]),true,((end>=bot)&&(start<=top)))))))){__t205.push([Math.max(start,bot),Math.min(end,top),attr]);}else{if(((other=__t209),true)){false;}else{throw ["Could not find a match",__t209];}}}return __t205;};var morsel=function(spans){var jump=function(active,bot,top){var e=send(Math.min,patch_array([top],function(){var __t210=[];var __t211=active;var __t212=__t211.length;for(var __t213=0;(__t213<__t212);(__t213++)){var __t214=__t211[__t213];var __tp0;var _;var x;var _;var other;if(((__t214 instanceof Array)&&((__t214["#"]===undefined)&&(((__tp0=__t214.length),true)&&((__tp0===3)&&((_=__t214[0]),true,(x=__t214[1]),true,(_=__t214[2]),true)))))){__t210.push(x);}else{if(((other=__t214),true)){false;}else{throw ["Could not find a match",__t214];}}}return __t210;}()));var attributes=send(patch_array,function(){var __t215=[];var __t216=active;var __t217=__t216.length;for(var __t218=0;(__t218<__t217);(__t218++)){var __t219=__t216[__t218];var __tp0;var _;var _;var X;var other;if(((__t219 instanceof Array)&&((__t219["#"]===undefined)&&(((__tp0=__t219.length),true)&&((__tp0===3)&&((_=__t219[0]),true,(_=__t219[1]),true,(X=__t219[2]),true)))))){__t215.push(X);}else{if(((other=__t219),true)){false;}else{throw ["Could not find a match",__t219];}}}return __t215;}());return [e,[bot,e,attributes]];};var jumptill=function(active,bot,top){if((bot===top)){return [[],active];}else{if(true){var __tp0;var __tp1;var newbot;var span;if((((__tp0=jump(active,bot,top)),(__tp0 instanceof Array))&&((__tp0["#"]===undefined)&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((newbot=__tp0[0]),true,(span=__tp0[1]),true)))))){(void 0);}else{throw "a condition failed";}var newactive=function(){var __t220=[];var __t221=active;var __t222=__t221.length;for(var __t223=0;(__t223<__t222);(__t223++)){var __t224=__t221[__t223];var x;var __tp0;var _;var e;var attr;var other;if((((x=__t224),true,(__t224 instanceof Array))&&((__t224["#"]===undefined)&&(((__tp0=__t224.length),true)&&((__tp0===3)&&((_=__t224[0]),true,(e=__t224[1]),true,(attr=__t224[2]),true,(e>newbot))))))){__t220.push(x);}else{if(((other=__t224),true)){false;}else{throw ["Could not find a match",__t224];}}}return __t220;}();var __tp0;var __tp1;var spans;var remainder;if((((__tp0=jumptill(newactive,newbot,top)),(__tp0 instanceof Array))&&((__tp0["#"]===undefined)&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((spans=__tp0[0]),true,(remainder=__tp0[1]),true)))))){(void 0);}else{throw "a condition failed";}return [[span].concat(spans),remainder];}else{return false;}}};var process=function(start,active,rem){var __t225=[start,active,rem];var __tp0;var _;var __tp1;var __tp2;var __tp3;var __tp4;var __tp0;var start;var active;var __tp1;var __tp2;var __tp0;var start;var active;var __tp1;var __tp2;var __tp3;var next;var __tp4;var target;var end;var attr;var rest;var __t226=false;var __t227=false;var __t228=false;var __t229=false;var __t230=false;var __t231=false;var __t232=false;if(((__t226=(__t225 instanceof Array))&&((__t227=(__t225["#"]===undefined))&&((__t228=((__tp0=__t225.length),true))&&((__t229=(__tp0===3))&&(((_=__t225[0]),true,(__tp1=__t225[1]),(__tp1 instanceof Array))&&((__tp1["#"]===undefined)&&(((__tp2=__tp1.length),true)&&((__tp2===0)&&(((__tp3=__t225[2]),(__tp3 instanceof Array))&&((__tp3["#"]===undefined)&&(((__tp4=__tp3.length),true)&&(__tp4===0))))))))))))){return [];}else{if((__t229&&((__t230=((start=__t225[0]),true,(active=__t225[1]),true,(__tp1=__t225[2]),(__tp1 instanceof Array)))&&((__t231=(__tp1["#"]===undefined))&&((__t232=((__tp2=__tp1.length),true))&&(__tp2===0)))))){var top=send(Math.max,function(){var __t233=[];var __t234=active;var __t235=__t234.length;for(var __t236=0;(__t236<__t235);(__t236++)){var __t237=__t234[__t236];var __tp0;var _;var e;var _;var other;if(((__t237 instanceof Array)&&((__t237["#"]===undefined)&&(((__tp0=__t237.length),true)&&((__tp0===3)&&((_=__t237[0]),true,(e=__t237[1]),true,(_=__t237[2]),true)))))){__t233.push(e);}else{if(((other=__t237),true)){false;}else{throw ["Could not find a match",__t237];}}}return __t233;}());var bot=Math.min(start,top);var __tp0;var __tp1;var spans;var _;if((((__tp0=jumptill(active,start,top)),(__tp0 instanceof Array))&&((__tp0["#"]===undefined)&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((spans=__tp0[0]),true,(_=__tp0[1]),true)))))){(void 0);}else{throw "a condition failed";}return spans;}else{if((__t232&&((__tp2>=1)&&(((__tp3=__tp1[0]),(next=__tp3),true,(__tp3 instanceof Array))&&((__tp3["#"]===undefined)&&(((__tp4=__tp3.length),true)&&((__tp4===3)&&((target=__tp3[0]),true,(end=__tp3[1]),true,(attr=__tp3[2]),true,(rest=__tp1.slice(1)),true)))))))){var __tp0;var __tp1;var spans;var newactive;if((((__tp0=jumptill(active,start,target)),(__tp0 instanceof Array))&&((__tp0["#"]===undefined)&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((spans=__tp0[0]),true,(newactive=__tp0[1]),true)))))){(void 0);}else{throw "a condition failed";}return spans.concat(process(target,[next].concat(newactive),rest));}else{throw ["Could not find a match",__t225];}}}};var thespans=spans.sort(function(__t238,__t239){var __tp0;var s1;var e1;var _;if(((__t238 instanceof Array)&&((__t238["#"]===undefined)&&(((__tp0=__t238.length),true)&&((__tp0===3)&&((s1=__t238[0]),true,(e1=__t238[1]),true,(_=__t238[2]),true)))))){(void 0);}else{throw "a condition failed";}var __tp0;var s2;var e2;var _;if(((__t239 instanceof Array)&&((__t239["#"]===undefined)&&(((__tp0=__t239.length),true)&&((__tp0===3)&&((s2=__t239[0]),true,(e2=__t239[1]),true,(_=__t239[2]),true)))))){(void 0);}else{throw "a condition failed";}if((s1===s2)){return (e1-e2);}else{return (s1-s2);}});return process(thespans[0][0],[],thespans);};var highlight_locations=function(){var __t240=Array.prototype.slice.call(arguments,0);var __tp0;var locations;var context;if(((__t240 instanceof Array)&&((__t240["#"]===undefined)&&(((__tp0=__t240.length),true)&&(((__tp0>=1)&&(__tp0<=2))&&((locations=__t240[0]),true,(context=function(){if((1>=__tp0)){return 0;}else{return __t240[1];}}()),true)))))){var loc=merge_locations(function(){var __t241=[];var __t242=locations;var __t243=__t242.length;for(var __t244=0;(__t244<__t243);(__t244++)){var __t245=__t242[__t244];var __tp0;var x;var cls;var other;if(((__t245 instanceof Array)&&((__t245["#"]===undefined)&&(((__tp0=__t245.length),true)&&((__tp0===2)&&((x=__t245[0]),true,(cls=__t245[1]),true)))))){__t241.push(x);}else{if(((other=__t245),true)){false;}else{throw ["Could not find a match",__t245];}}}return __t241;}());var src=loc.source;var __tp0;var __tp1;var l1;var l2;if((((__tp0=loc.linerange()),(__tp0 instanceof Array))&&((__tp0["#"]===undefined)&&(((__tp1=__tp0.length),true)&&((__tp1===2)&&((l1=__tp0[0]),true,(l2=__tp0[1]),true)))))){(void 0);}else{throw "a condition failed";}var first=Math.max(1,(l1-context));var last=Math.min(src.nlines,(l2+context));return src.highlight_lines(first,last,function(){var __t246=[];var __t247=locations;var __t248=__t247.length;for(var __t249=0;(__t249<__t248);(__t249++)){var __t250=__t247[__t249];var __tp0;var loc;var cls;var other;if(((__t250 instanceof Array)&&((__t250["#"]===undefined)&&(((__tp0=__t250.length),true)&&((__tp0===2)&&((loc=__t250[0]),true,(cls=__t250[1]),true)))))){__t246.push([loc.start,loc.end,[cls]]);}else{if(((other=__t250),true)){false;}else{throw ["Could not find a match",__t250];}}}return __t246;}());}else{throw ["Could not find a match",__t240];}};var merge_locations=function(__t251){var __t252=__t251;var __tp0;var __tp0;var loc;var __tp0;var locs;var __t253=false;var __t254=false;var __t255=false;if(((__t253=(__t252 instanceof Array))&&((__t254=(__t252["#"]===undefined))&&((__t255=((__tp0=__t252.length),true))&&(__tp0===0))))){return Location(null,0,0);}else{if((__t255&&((__tp0===1)&&((loc=__t252[0]),true)))){return loc;}else{if((__t255&&((__tp0>=0)&&((locs=__t252.slice(0)),true)))){var start=send(Math.min,function(){var __t256=[];var __t257=locs;var __t258=__t257.length;for(var __t259=0;(__t259<__t258);(__t259++)){var __t260=__t257[__t259];var loc;var other;if(((loc=__t260),true)){__t256.push(loc.start);}else{if(((other=__t260),true)){false;}else{throw ["Could not find a match",__t260];}}}return __t256;}());var end=send(Math.max,function(){var __t261=[];var __t262=locs;var __t263=__t262.length;for(var __t264=0;(__t264<__t263);(__t264++)){var __t265=__t262[__t264];var loc;var other;if(((loc=__t265),true)){__t261.push(loc.end);}else{if(((other=__t265),true)){false;}else{throw ["Could not find a match",__t265];}}}return __t261;}());return Location(locs[0].source,start,end);}else{throw ["Could not find a match",__t252];}}}};var __lt____lt____colon__=function(x,y){(x["location"]=function(){if(((!y)||___checker(Location)(y))){return y;}else{return y.location;}}());return x;};var __plus____plus____colon__=function(x,y){(x=function(){if(((!x)||___checker(Location)(x))){return x;}else{return x.location;}}());(y=function(){if(((!y)||___checker(Location)(y))){return y;}else{return y.location;}}());var __t267;try{(__t267=merge_locations([x,y]));}catch(__t266){(__t267=undefined);}return __t267;};(exports["Source"]=Source);(exports["Location"]=Location);(exports["highlight"]=highlight);(exports["highlight_locations"]=highlight_locations);(exports["merge_locations"]=merge_locations);(exports["<<:"]=__lt____lt____colon__);(exports["++:"]=__plus____plus____colon__);
