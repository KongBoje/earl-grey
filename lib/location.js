var τ344=function(type){var τ345=type["::check"];var f;if((τ345===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ345),true)){return function(value){return f.call(type,value);};}else{throw τ336(["match"]).create("Could not find a match",({"value":τ345}));}}};
var τ346=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};
var τ336=function(){var τ337=function(tags){var τ338=function(){if((!τ344(τ337)(this))){return Object.create(τ337.prototype);}else{return this;}}();(τ338["tags"]=tags);return τ338;};τ346(τ337);(τ337.prototype["create"]=function(){var τ339=Array.prototype.slice.call(arguments,0);var τp0;var message;var args;if(((τ339 instanceof Array)&&(((τp0=τ339.length),true)&&((τp0>=0)&&((message=function(){if((0>=τp0)){return "";}else{return τ339[0];}}()),true,(args=τ339.slice(1)),true))))){var τ338=this;var e=Error(message);(e["::tags"]=τ338.tags);(e["args"]=args);(e["name"]=["E"].concat(τ338.tags).join("."));return e;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ339}));}});(τ337.prototype["::check"]=function(e){var τ338=this;if(((!e)||(!τ344(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var τ340=τ338.tags;var τ341=τ340.length;for(var τ342=0;(τ342<τ341);(τ342++)){var τ343=τ340[τ342];var tag;var other;if(((tag=τ343),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=τ343),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ343}));}}}false;return true;});(τ337.prototype["::deconstruct"]=function(e){var τ338=this;return e.args;});return τ337;}();
var τ347=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ348=function(τ349){var τ350=τ349;var x;var x;var other;if((((typeof(τ350)==="string")&&((x=τ350),true))||((typeof(τ350)==="number")&&((x=τ350),true)))){return ["value",x];}else{if(((other=τ350),true)){return other["::serialize_ast"]();}else{throw τ336(["match"]).create("Could not find a match",({"value":τ350}));}}};
var send=function(obj,τ329){var msg;var τ328;(msg=τ329);true;(τ328=τ329);var τ330=τ328;var other;if(((typeof(τ330)==="string")||(typeof(τ330)==="number"))){return obj[msg];}else{if(((other=τ330),true)){return obj["::send"](msg);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ330}));}}};(Array[":::project"]=function(τ332){var value;var τ331;(value=τ332);true;(τ331=τ332);var τ333=τ331;var _;if(τ344(Array)(τ333)){return [true,value];}else{if(((_=τ333),true)){return [true,[value]];}else{throw τ336(["match"]).create("Could not find a match",({"value":τ333}));}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ347(["array"],this.map(τ348));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ334=value.match(this);var m;var m;if(((τ334===null)&&((m=τ334),true))){return [false,null];}else{if(((m=τ334),true)){return [true,m];}else{throw τ336(["match"]).create("Could not find a match",({"value":τ334}));}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ335=value.match(this);var m;var m;if(((τ335===null)&&((m=τ335),true))){return [false,null];}else{if(((m=τ335),true)){return [true,m];}else{throw τ336(["match"]).create("Could not find a match",({"value":τ335}));}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});
var τ467=function(from,to){var rval=[];for(var i=from;(i<=to);(i++)){rval.push(i);}return rval;};
var τ468=function(type){return function(value){var τ469=type[":::deconstruct"];var f;if((τ469===(void 0))){var τ470=type["::deconstruct"];var f;if((τ470===(void 0))){if((value instanceof Array)){return [true,value];}else{if(true){return [false,null];}else{return false;}}}else{if(((f=τ470),true)){var τ472;try{(τ472=[true,f.call(type,value)]);}catch(τ471){(τ472=[false,null]);}return τ472;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ470}));}}}else{if(((f=τ469),true)){return f.call(type,value);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ469}));}}};};
var τ473=function(τ474,key){var τ475=τ474;var x;var x;var x;if(((τ475===null)||(τ475===(void 0)))){return false;}else{if(((typeof(τ475)==="string")&&((x=τ475),true))){return (key in String.prototype);}else{if(((typeof(τ475)==="number")&&((x=τ475),true))){return (key in Number.prototype);}else{if(((x=τ475),true)){return (key in x);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ475}));}}}}};var τ351=require("./util");var binsearch=τ351.binsearch;var items=τ351.items;var enumerate=τ351.enumerate;var τ352=require("./pp");var Node=τ352.Node;var __lt____gt__=τ352["<>"];var repr=τ352.repr;var fs=require("fs");var Source=function(){var τ354=Array.prototype.slice.call(arguments,0);var τp0;var text;var url;if(((τ354 instanceof Array)&&(((τp0=τ354.length),true)&&(((τp0>=1)&&(τp0<=2))&&((text=τ354[0]),true,(url=function(){if((1>=τp0)){return false;}else{return τ354[1];}}()),true))))){var τ353=function(){if((!τ344(Source)(this))){return Object.create(Source.prototype);}else{return this;}}();(τ353["text"]=text);(τ353["url"]=url);(τ353["counts"]=[]);var curr=0;var τ355=text.split("\n");var τ356=τ355.length;for(var τ357=0;(τ357<τ356);(τ357++)){var τ358=τ355[τ357];var line;var other;if(((line=τ358),true)){τ353.counts.push(curr);(curr=(curr+(line.length+1)));}else{if(((other=τ358),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ358}));}}}false;τ353.counts.push(curr);(τ353["nlines"]=(τ353.counts.length-1));return τ353;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ354}));}};τ346(Source);(Source.prototype["linecol"]=function(pos){var τ353=this;var line=binsearch(τ353.counts,pos);var col=(pos-send(τ353.counts,(line-1)));return [line,col];});(Source.prototype["highlight_lines"]=function(l1,l2,spans){var τ353=this;return highlight_lines(τ353.text,τ353.counts,[(l1-1),(l2-1)],spans);});Source;var Location=function(source,start,end){var τ359=function(){if((!τ344(Location)(this))){return Object.create(Location.prototype);}else{return this;}}();(τ359["source"]=(source||Source("",null)));(τ359["start"]=start);(τ359["end"]=end);return τ359;};τ346(Location);(Location.prototype["text"]=function(){var τ359=this;return τ359.source.text.slice(τ359.start,τ359.end);});(Location.prototype["linerange"]=function(){var τ359=this;var τ360=τ359.linecol();var τp0;var τp1;var τp2;var l1;var _;var τ361;if(((τ360 instanceof Array)&&(((τp0=τ360.length),true)&&((τp0===2)&&(((τp1=τ360[0]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===2)&&((l1=τp1[0]),true,(_=τp1[1]),true,(τ361=τ360[1]),true)))))))){var τ362=τ361;var τp0;var l2;var _;if((τ362===null)){return [l1,l1];}else{if(((τ362 instanceof Array)&&(((τp0=τ362.length),true)&&((τp0===2)&&((l2=τ362[0]),true,(_=τ362[1]),true))))){return [l1,l2];}else{throw τ336(["match"]).create("Could not find a match",({"value":τ362}));}}}else{throw τ336(["match"]).create("Could not find a match",({"value":τ360}));}});(Location.prototype["linecol"]=function(){var τ359=this;var start=τ359.source.linecol(τ359.start);var end=function(){if((τ359.start===τ359.end)){return null;}else{return τ359.source.linecol((τ359.end-1));}}();return [start,end];});(Location.prototype["ref"]=function(){var τ359=this;var τ363=τ359.linecol();var τp0;var τp1;var τp2;var τp3;var τp4;var l1;var τp5;var τp6;var c1;var τ364;if(((τ363 instanceof Array)&&(((τp0=τ363.length),true)&&((τp0===2)&&(((τp1=τ363[0]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===2)&&(((τp3=τp1[0]),(τp4=[true,String(τp3)]),τp4[0])&&(((l1=τp4[1]),true,(τp5=τp1[1]),(τp6=[true,String(τp5)]),τp6[0])&&((c1=τp6[1]),true,(τ364=τ363[1]),true)))))))))){var τ365=τ364;var τp0;var τp1;var τp2;var l2;var τp3;var τp4;var c2;if((τ365===null)){return ((l1+":")+c1);}else{if(((τ365 instanceof Array)&&(((τp0=τ365.length),true)&&((τp0===2)&&(((τp1=τ365[0]),(τp2=[true,String(τp1)]),τp2[0])&&(((l2=τp2[1]),true,(τp3=τ365[1]),(τp4=[true,String(τp3)]),τp4[0])&&((c2=τp4[1]),true))))))){var τ366=null;var otherwise;if(((l1===l2)&&(c1===c2))){return ((l1+":")+c1);}else{if((l1===l2)){return ((((l1+":")+c1)+"-")+c2);}else{if(((otherwise=τ366),true)){return ((((((l1+":")+c1)+"-")+l1)+":")+c2);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ366}));}}}}else{throw τ336(["match"]).create("Could not find a match",({"value":τ365}));}}}else{throw τ336(["match"]).create("Could not find a match",({"value":τ363}));}});(Location.prototype["highlight"]=function(){var τ367=Array.prototype.slice.call(arguments,0);var τp0;var cls;var context;if(((τ367 instanceof Array)&&(((τp0=τ367.length),true)&&(((τp0>=0)&&(τp0<=2))&&((cls=function(){if((0>=τp0)){return "hl1";}else{return τ367[0];}}()),true,(context=function(){if((1>=τp0)){return 0;}else{return τ367[1];}}()),true))))){var τ359=this;return highlight_locations([[τ359,cls]],context);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ367}));}});Location;var highlight=function(){var τ368=Array.prototype.slice.call(arguments,0);var τp0;var text;var spans;var offset;if(((τ368 instanceof Array)&&(((τp0=τ368.length),true)&&(((τp0>=2)&&(τp0<=3))&&((text=τ368[0]),true,(spans=τ368[1]),true,(offset=function(){if((2>=τp0)){return 0;}else{return τ368[2];}}()),true))))){return Node([],function(){var τ369=[];var τ370=morsel(spans);var τ371=τ370.length;for(var τ372=0;(τ372<τ371);(τ372++)){var τ373=τ370[τ372];var τp0;var start;var end;var attributes;var other;if(((τ373 instanceof Array)&&(((τp0=τ373.length),true)&&((τp0===3)&&((start=τ373[0]),true,(end=τ373[1]),true,(attributes=τ373[2]),true))))){τ369.push(function(){var xstart=Math.max((start-offset),0);var xend=Math.min((end-offset),text.length);return Node(attributes,[text.slice(xstart,xend)]);}());}else{if(((other=τ373),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ373}));}}}return τ369;}());}else{throw τ336(["match"]).create("Could not find a match",({"value":τ368}));}};var highlight_lines=function(text,linelocs,τ374,spans){var τp0;var l1;var l2;if(((τ374 instanceof Array)&&(((τp0=τ374.length),true)&&((τp0===2)&&((l1=τ374[0]),true,(l2=τ374[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}return Node(["+span"],function(){var τ375=[];var τ376=τ467(l1,l2);var τ377=τ376.length;for(var τ378=0;(τ378<τ377);(τ378++)){var τ379=τ376[τ378];var lineno;var other;if(((lineno=τ379),true)){τ375.push(function(){var start=send(linelocs,lineno);var end=send(linelocs,(lineno+1));return Node(["+span"],[Node(["lineno"],(lineno+1)),Node(["source"],highlight(text,τ347([[start,end,[]]],clamp(spans,start,end))))]);}());}else{if(((other=τ379),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ379}));}}}return τ375;}());};var clamp=function(spans,bot,top){var τ380=[];var τ381=spans;var τ382=τ381.length;for(var τ383=0;(τ383<τ382);(τ383++)){var τ384=τ381[τ383];var τp0;var start;var end;var attr;var other;if(((τ384 instanceof Array)&&(((τp0=τ384.length),true)&&((τp0===3)&&((start=τ384[0]),true,(end=τ384[1]),true,(attr=τ384[2]),true,((end>=bot)&&(start<=top))))))){τ380.push([Math.max(start,bot),Math.min(end,top),attr]);}else{if(((other=τ384),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ384}));}}}return τ380;};var morsel=function(spans){var jump=function(active,bot,top){var e=send(Math.min,τ347([top],function(){var τ388=[];var τ389=active;var τ390=τ389.length;for(var τ391=0;(τ391<τ390);(τ391++)){var τ392=τ389[τ391];var τp0;var _;var x;var _;var other;if(((τ392 instanceof Array)&&(((τp0=τ392.length),true)&&((τp0===3)&&((_=τ392[0]),true,(x=τ392[1]),true,(_=τ392[2]),true))))){τ388.push(x);}else{if(((other=τ392),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ392}));}}}return τ388;}()));var attributes=[];var τ385=active;var τ386=τ385.length;for(var τ387=0;(τ387<τ386);(τ387++)){var τ393=τ385[τ387];var τp0;var _;var _;var X;var other;if(((τ393 instanceof Array)&&(((τp0=τ393.length),true)&&((τp0===3)&&((_=τ393[0]),true,(_=τ393[1]),true,(X=τ393[2]),true))))){(attributes=attributes.concat(X));}else{if(((other=τ393),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ393}));}}}false;return [e,[bot,e,attributes]];};var jumptill=function(active,bot,top){if((bot===top)){return [[],active];}else{var τp0;var τp1;var newbot;var span;if((((τp0=jump(active,bot,top)),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&((newbot=τp0[0]),true,(span=τp0[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}var newactive=function(){var τ394=[];var τ395=active;var τ396=τ395.length;for(var τ397=0;(τ397<τ396);(τ397++)){var τ398=τ395[τ397];var x;var τp0;var _;var e;var attr;var other;if((((x=τ398),true,(τ398 instanceof Array))&&(((τp0=τ398.length),true)&&((τp0===3)&&((_=τ398[0]),true,(e=τ398[1]),true,(attr=τ398[2]),true,(e>newbot)))))){τ394.push(x);}else{if(((other=τ398),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ398}));}}}return τ394;}();var τp0;var τp1;var spans;var remainder;if((((τp0=jumptill(newactive,newbot,top)),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&((spans=τp0[0]),true,(remainder=τp0[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}return [[span].concat(spans),remainder];}};var process=function(start,active,rem){var τ399=[start,active,rem];var τp0;var _;var τp1;var τp2;var τp3;var τp4;var τp0;var start;var active;var τp1;var τp2;var τp0;var start;var active;var τp1;var τp2;var τp3;var next;var τp4;var target;var end;var attr;var rest;var τ400=false;var τ401=false;var τ402=false;var τ403=false;var τ404=false;if(((τ400=(τ399 instanceof Array))&&((τ401=((τp0=τ399.length),true))&&((τ402=(τp0===3))&&(((_=τ399[0]),true,(τp1=τ399[1]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===0)&&(((τp3=τ399[2]),(τp3 instanceof Array))&&(((τp4=τp3.length),true)&&(τp4===0)))))))))){return [];}else{if((τ402&&((τ403=((start=τ399[0]),true,(active=τ399[1]),true,(τp1=τ399[2]),(τp1 instanceof Array)))&&((τ404=((τp2=τp1.length),true))&&(τp2===0))))){var top=send(Math.max,function(){var τ405=[];var τ406=active;var τ407=τ406.length;for(var τ408=0;(τ408<τ407);(τ408++)){var τ409=τ406[τ408];var τp0;var _;var e;var _;var other;if(((τ409 instanceof Array)&&(((τp0=τ409.length),true)&&((τp0===3)&&((_=τ409[0]),true,(e=τ409[1]),true,(_=τ409[2]),true))))){τ405.push(e);}else{if(((other=τ409),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ409}));}}}return τ405;}());var bot=Math.min(start,top);var τp0;var τp1;var spans;var _;if((((τp0=jumptill(active,start,top)),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&((spans=τp0[0]),true,(_=τp0[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}return spans;}else{if((τ404&&((τp2>=1)&&(((τp3=τp1[0]),(next=τp3),true,(τp3 instanceof Array))&&(((τp4=τp3.length),true)&&((τp4===3)&&((target=τp3[0]),true,(end=τp3[1]),true,(attr=τp3[2]),true,(rest=τp1.slice(1)),true))))))){var τp0;var τp1;var spans;var newactive;if((((τp0=jumptill(active,start,target)),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&((spans=τp0[0]),true,(newactive=τp0[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}return spans.concat(process(target,[next].concat(newactive),rest));}else{throw τ336(["match"]).create("Could not find a match",({"value":τ399}));}}}};var thespans=spans.sort(function(τ410,τ411){var τp0;var s1;var e1;var _;if(((τ410 instanceof Array)&&(((τp0=τ410.length),true)&&((τp0===3)&&((s1=τ410[0]),true,(e1=τ410[1]),true,(_=τ410[2]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}var τp0;var s2;var e2;var _;if(((τ411 instanceof Array)&&(((τp0=τ411.length),true)&&((τp0===3)&&((s2=τ411[0]),true,(e2=τ411[1]),true,(_=τ411[2]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}if((s1===s2)){return (e1-e2);}else{return (s1-s2);}});return process(thespans[0][0],[],thespans);};var highlight_locations=function(){var τ412=Array.prototype.slice.call(arguments,0);var τp0;var locations;var context;if(((τ412 instanceof Array)&&(((τp0=τ412.length),true)&&(((τp0>=1)&&(τp0<=2))&&((locations=τ412[0]),true,(context=function(){if((1>=τp0)){return 0;}else{return τ412[1];}}()),true))))){var srcs=({});var τ413=locations;var τ414=τ413.length;for(var τ415=0;(τ415<τ414);(τ415++)){var τ416=τ413[τ415];var τp0;var loc;var cls;var other;if(((τ416 instanceof Array)&&(((τp0=τ416.length),true)&&((τp0===2)&&((loc=τ416[0]),true,(cls=τ416[1]),true))))){var key=String((loc.source&&loc.source.url));if((!send(srcs,key))){(srcs[key]=[]);}else{null;}send(srcs,key).push([loc,cls]);}else{if(((other=τ416),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ416}));}}}false;return Node(["+div"],function(){var τ417=[];var τ418=items(srcs);var τ419=τ418.length;for(var τ420=0;(τ420<τ419);(τ420++)){var τ421=τ418[τ420];var τp0;var _;var locs;var other;if(((τ421 instanceof Array)&&(((τp0=τ421.length),true)&&((τp0===2)&&((_=τ421[0]),true,(locs=τ421[1]),true))))){τ417.push(highlight_locations_same_source(locs,context));}else{if(((other=τ421),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ421}));}}}return τ417;}());}else{throw τ336(["match"]).create("Could not find a match",({"value":τ412}));}};var highlight_locations_same_source=function(){var τ422=Array.prototype.slice.call(arguments,0);var τp0;var locations;var context;if(((τ422 instanceof Array)&&(((τp0=τ422.length),true)&&(((τp0>=1)&&(τp0<=2))&&((locations=τ422[0]),true,(context=function(){if((1>=τp0)){return 0;}else{return τ422[1];}}()),true))))){var loc=merge_locations(function(){var τ423=[];var τ424=locations;var τ425=τ424.length;for(var τ426=0;(τ426<τ425);(τ426++)){var τ427=τ424[τ426];var τp0;var x;var cls;var other;if(((τ427 instanceof Array)&&(((τp0=τ427.length),true)&&((τp0===2)&&((x=τ427[0]),true,(cls=τ427[1]),true))))){τ423.push(x);}else{if(((other=τ427),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ427}));}}}return τ423;}());var src=loc.source;var τp0;var τp1;var l1;var l2;if((((τp0=loc.linerange()),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&((l1=τp0[0]),true,(l2=τp0[1]),true))))){undefined;}else{throw τ336(["match"]).create("The value failed to match");}var first=Math.max(1,(l1-context));var last=Math.min(src.nlines,(l2+context));return Node(["+div","location"],[Node(["+div","source"],[Node(["sourcefile"],(src.url||"???")),function(){var τ428=[];var τ429=locations;var τ430=τ429.length;for(var τ431=0;(τ431<τ430);(τ431++)){var τ432=τ429[τ431];var τp0;var loc;var cls;var other;if(((τ432 instanceof Array)&&(((τp0=τ432.length),true)&&((τp0===2)&&((loc=τ432[0]),true,(cls=τ432[1]),true))))){τ428.push(Node([cls,"sourcepos"],loc.ref()));}else{if(((other=τ432),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ432}));}}}return τ428;}()]),src.highlight_lines(first,last,function(){var τ433=[];var τ434=locations;var τ435=τ434.length;for(var τ436=0;(τ436<τ435);(τ436++)){var τ437=τ434[τ436];var τp0;var loc;var cls;var other;if(((τ437 instanceof Array)&&(((τp0=τ437.length),true)&&((τp0===2)&&((loc=τ437[0]),true,(cls=τ437[1]),true))))){τ433.push([loc.start,loc.end,[cls]]);}else{if(((other=τ437),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ437}));}}}return τ433;}())]);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ422}));}};var merge_locations=function(τ438){var τ439=τ438;var τp0;var τp0;var loc;var τp0;var locs;var τ440=false;var τ441=false;if(((τ440=(τ439 instanceof Array))&&((τ441=((τp0=τ439.length),true))&&(τp0===0)))){return Location(null,0,0);}else{if((τ441&&((τp0===1)&&((loc=τ439[0]),true)))){return loc;}else{if((τ441&&((τp0>=0)&&((locs=τ439.slice(0)),true)))){var start=send(Math.min,function(){var τ442=[];var τ443=locs;var τ444=τ443.length;for(var τ445=0;(τ445<τ444);(τ445++)){var τ446=τ443[τ445];var loc;var other;if(((loc=τ446),true)){τ442.push(loc.start);}else{if(((other=τ446),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ446}));}}}return τ442;}());var end=send(Math.max,function(){var τ447=[];var τ448=locs;var τ449=τ448.length;for(var τ450=0;(τ450<τ449);(τ450++)){var τ451=τ448[τ450];var loc;var other;if(((loc=τ451),true)){τ447.push(loc.end);}else{if(((other=τ451),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ451}));}}}return τ447;}());return Location(locs[0].source,start,end);}else{throw τ336(["match"]).create("Could not find a match",({"value":τ439}));}}}};var __lt____lt____colon__=function(x,y){if((!x.location)){(x["location"]=function(){if(((!y)||τ344(Location)(y))){return y;}else{return y.location;}}());}else{null;}return x;};var __plus____plus____colon__=function(x,y){(x=function(){if(((!x)||τ344(Location)(x))){return x;}else{return x.location;}}());(y=function(){if(((!y)||τ344(Location)(y))){return y;}else{return y.location;}}());var τ453;try{(τ453=merge_locations([x,y]));}catch(τ452){(τ453=function(){var τ454=τ452;var e;var ___exc;if(((e=τ454),true)){return undefined;}else{if(((___exc=τ454),true)){throw ___exc;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ454}));}}}());}return τ453;};var format_error=function(τ456){var e;var τ455;(e=τ456);true;(τ455=τ456);var τ457=τ455;var τp0;var τp1;var τp2;var args;var τp0;var loc;var τp0;var τp1;var τp2;var url;var start;var end;var other;var τ458=false;if((τ344(τ336(["syntax"]))(τ457)&&(((τp0=τ468(τ336(["syntax"]))(τ457)),τp0[0])&&(((τp1=τp0[1]),true,(τp2=τp1.length),true)&&((τp2===1)&&((args=τp1[0]),true)))))){var hls=["hl1","hl2","hl3","hl4"];var locs=function(){var τ459=[];var τ460=enumerate(items(args));var τ461=τ460.length;for(var τ462=0;(τ462<τ461);(τ462++)){var τ463=τ460[τ462];var τp0;var i;var τp1;var τp2;var key;var arg;var other;if(((τ463 instanceof Array)&&(((τp0=τ463.length),true)&&((τp0===2)&&(((i=τ463[0]),true,(τp1=τ463[1]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===2)&&((key=τp1[0]),true,(arg=τp1[1]),true,(arg&&arg.location))))))))){τ459.push([arg.location,send(hls,(i%4))]);}else{if(((other=τ463),true)){false;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ463}));}}}return τ459;}();return Node(["+div"],[Node(["+div"],[Node(["error_type"],e.name),Node(["error_message"],e.message)]),repr(args),highlight_locations(locs)]);}else{if(((τ458=τ473(τ457,"location"))&&(((τp0=τ457.location),τ344(Location)(τp0))&&((loc=τp0),true)))){return Node(["+div"],[Node(["+div"],[Node(["error_type"],e.name),Node(["error_message"],e.message)]),function(){if(e.args){return repr(e.args);}else{return "";}}(),highlight_locations([[loc,"hl1"]]),Node(["traceback"],(e.stack||""))]);}else{if((τ458&&(((τp0=τ457.location),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===4)&&(((τp2=τp0[0]),(τp2==="location"))&&((url=τp0[1]),true,(start=τp0[2]),true,(end=τp0[3]),true))))))){var data=function(){var τ465;try{(τ465=fs.readFileSync(url,"utf8"));}catch(τ464){(τ465=function(){var τ466=τ464;var e;var ___exc;if(((e=τ466),true)){return null;}else{if(((___exc=τ466),true)){throw ___exc;}else{throw τ336(["match"]).create("Could not find a match",({"value":τ466}));}}}());}return τ465;}();if(data){var loc=Location(Source(data,url),start,end);return Node(["+div"],[Node(["+div"],[Node(["error_type"],e.name),Node(["error_message"],e.message)]),function(){if(e.args){return repr(e.args);}else{return "";}}(),highlight_locations([[loc,"hl1"]]),Node(["traceback"],(e.stack||""))]);}else{return Node(["+div"],Node(["traceback"],(e.stack||e)));}}else{if(((other=τ457),true)){return Node(["traceback"],(e.stack||e));}else{throw τ336(["match"]).create("Could not find a match",({"value":τ457}));}}}}};var display_error=function(e){return __lt____gt__(null,format_error(e));};(exports["Source"]=Source);(exports["Location"]=Location);(exports["highlight"]=highlight);(exports["highlight_locations"]=highlight_locations);(exports["merge_locations"]=merge_locations);(exports["<<:"]=__lt____lt____colon__);(exports["++:"]=__plus____plus____colon__);(exports["format_error"]=format_error);(exports["display_error"]=display_error);
