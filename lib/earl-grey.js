var $218=function(type$220){var f$223;(f$223=type$220["::check"]);if((f$223===(void 0))){return function(value$228){return (value$228 instanceof type$220);};}else{return function(value$231){return f$223.call(type$220,value$231);};}};
var $233=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $234=function(dest$236,values$237){var k$242;(k$242=null);$240:for(k$242 in values$237){if(values$237.hasOwnProperty(k$242)){(dest$236[k$242]=values$237[k$242]);}}return dest$236;};
var $249=function($250$252){var ph$256;(ph$256=$250$252);var $254$261;($254$261=ph$256);var bridge$255$266;var x$270;(bridge$255$266=$254$261);if((((typeof(bridge$255$266)==="string")&&((x$270=bridge$255$266),true))||((typeof(bridge$255$266)==="number")&&((x$270=bridge$255$266),true)))){return ["value",x$270];}else{var other$280;(other$280=$254$261);return other$280["::serialize_ast"]();}};
var send$25;(send$25=function(obj$30,$28$31){var ph$35;var msg$36;var t0$38;(t0$38=$28$31);(msg$36=t0$38);(ph$35=t0$38);var $33$45;($33$45=ph$35);var bridge$34$50;(bridge$34$50=$33$45);if(((typeof(bridge$34$50)==="string")||(typeof(bridge$34$50)==="number"))){return obj$30[msg$36];}else{var other$61;(other$61=$33$45);return obj$30["::send"](msg$36);}});(Array[":::project"]=function($66$68){var ph$71;var value$72;var t0$74;(t0$74=$66$68);(value$72=t0$74);(ph$71=t0$74);var $70$81;($70$81=ph$71);if($218(Array)($70$81)){return [true,value$72];}else{$70$81;return [true,[value$72]];}});(Array.prototype["::check"]=function(value$98){if((value$98 instanceof Array)){var i$103;(i$103=0);$101:for(;(i$103<this.length);(i$103++)){if(($233(this,i$103)!==$233(value$98,i$103))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $234(this.slice(0),this);});(Array.prototype[":::project"]=function(value$120){if((value$120 instanceof Array)){var i$125;(i$125=0);$123:for(;(i$125<this.length);(i$125++)){if(($233(this,i$125)!==$233(value$120,i$125))){return [true,[value$120]];}}return [true,value$120.slice(this.length)];}else{return [true,[value$120]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($249));});(RegExp.prototype["::check"]=function($141$143){var ph$146;(ph$146=$141$143);var $145$151;($145$151=ph$146);var value$159;if((typeof($145$151)==="string")){(value$159=$145$151);if(value$159.match(this)){return true;}else{return false;}}else{var other$164;(other$164=$145$151);return false;}});(RegExp.prototype[":::project"]=function($169$171){var ph$174;(ph$174=$169$171);var $173$179;($173$179=ph$174);var value$187;if((typeof($173$179)==="string")){(value$187=$173$179);var $190$192;($190$192=value$187.match(this));var m$200;if(($190$192===null)){(m$200=$190$192);return [false,null];}else{var m$205;(m$205=$190$192);return [true,m$205];}}else{var other$209;(other$209=$173$179);return [false,null];}});(Function.prototype["::send"]=function(args$215){return this.apply(this,args$215);});
var $940=function(arr$942){var results$946;var l$947;(results$946=[]);(l$947=arr$942.length);var i$955;(i$955=0);$945:for(;(i$955<l$947);(i$955++)){results$946.push([i$955,$233(arr$942,i$955)]);}return results$946;};
var $744=function(){var $745$747;($745$747=function(tags$751){var it$0$754;(it$0$754=function(){if((!$218($745$747)(this))){return Object.create($745$747.prototype);}else{return this;}}());(it$0$754["tags"]=tags$751);return it$0$754;});($745$747.prototype["create"]=function(){var $766$768;($766$768=arguments);var t0$773;var message$777;var args$778;(t0$773=$766$768.length);if((t0$773>=0)){(message$777=function(){if((0>=t0$773)){return "";}else{return $766$768[0];}}());(args$778=Array.prototype.slice.call($766$768,1));var it$0$785;(it$0$785=this);var self$790;(self$790=this);var e$795;(e$795=Error(message$777));(e$795["::tags"]=it$0$785.tags);(e$795["args"]=args$778);var temp$809;(temp$809=$940(args$778));var $length$814;($length$814=temp$809.length);var $index$819;($index$819=0);$796:for(;($index$819<$length$814);($index$819++)){var m$827;(m$827=temp$809[$index$819]);var t0$832;var t1$833;var i$837;var arg$838;(t0$832=m$827);if(((t0$832 instanceof Array)&&(((t1$833=t0$832.length)),(t1$833===2)))){(i$837=t0$832[0]);(arg$838=t0$832[1]);(e$795[i$837]=arg$838);}else{$728(m$827);}}(e$795["length"]=args$778.length);(e$795["name"]=["E"].concat(it$0$785.tags).join("."));return e$795;}else{$728($766$768);}});($745$747.prototype["::check"]=function(e$864){var it$0$867;(it$0$867=this);var self$872;(self$872=this);var tags$877;if(((!e$864)||(!$218(Error)(e$864)))){return false;}(tags$877=(e$864["::tags"]||[]));var temp$886;(temp$886=it$0$867.tags);var $length$891;($length$891=temp$886.length);var $index$896;($index$896=0);$878:for(;($index$896<$length$891);($index$896++)){var m$904;(m$904=temp$886[$index$896]);var tag$912;(tag$912=m$904);if((tags$877.indexOf(tag$912)===-1)){return false;}else{false;}}return true;});($745$747.prototype["::deconstruct"]=function(e$920){var it$0$923;(it$0$923=this);var self$928;(self$928=this);return e$920.args;});$234($745$747,$234(function(){var accum$933;(accum$933=({}));(accum$933["::name"]="$745");return accum$933;}(),function(){var accum$937;(accum$937=({}));(accum$937["::egclass"]=true);return accum$937;}()));return $745$747;}();
var $728=function(value$730,url$731,start$732,end$733){var err$736;(err$736=$744(["match"]).create("Could not find a match for value",({"value":value$730})));if(url$731){(err$736["location"]=["location",url$731,start$732,end$733]);}throw err$736;};
var $962=function($963$965,key$966){var ph$970;(ph$970=$963$965);var $968$975;($968$975=ph$970);var bridge$969$980;(bridge$969$980=$968$975);if(((bridge$969$980===null)||(bridge$969$980===(void 0)))){return false;}else{var x$991;if((typeof($968$975)==="string")){(x$991=$968$975);return (key$966 in String.prototype);}else{var x$996;if((typeof($968$975)==="number")){(x$996=$968$975);return (key$966 in Number.prototype);}else{var x$1001;(x$1001=$968$975);return (key$966 in x$1001);}}}};
var $1003=function(obj$1005){var results$1009;(results$1009=[]);var k$1014;(k$1014=null);$1008:for(k$1014 in obj$1005){if(Object.prototype.hasOwnProperty.call(obj$1005,k$1014)){results$1009.push([k$1014,$233(obj$1005,k$1014)]);}}return results$1009;};
var $1018=function(type$1020){return function(value$1023){var f$1026;(f$1026=type$1020[":::project"]);if((f$1026===(void 0))){(f$1026=type$1020["::project"]);if((f$1026===(void 0))){return [true,type$1020(value$1023)];}else{var rval$1035;(rval$1035=false);try{(rval$1035=[true,f$1026(value$1023)]);}catch(excv$1044){var e$1050;(e$1050=excv$1044);(rval$1035=[false,null]);}return rval$1035;}}else{return f$1026.call(type$1020,value$1023);}};};var accum$696;var accum$700;var $284$291;var Source$292;var Location$293;var highlight_locations$294;var $285$295;var tokenize$296;var $286$297;var parse$298;var $287$299;var translate$300;var Translator$301;var std$302;var exp$303;var opt$304;var version$305;var generate_from_ast$306;var generate$307;var Generator$308;($284$291=require("./location"));(Source$292=$284$291.Source);(Location$293=$284$291.Location);(highlight_locations$294=$284$291.highlight_locations);($285$295=require("./lex"));(tokenize$296=$285$295.tokenize);($286$297=require("./parse"));(parse$298=$286$297.parse);($287$299=require("./translate-js"));(translate$300=$287$299.translate);(Translator$301=$287$299.Translator);(std$302=require("./stdenv"));(exp$303=require("./expand"));(opt$304=require("./opt"));(version$305="zero");(generate_from_ast$306=function(ast$357){var ex$360;var tr$361;var rval$362;(ex$360=std$302.expand(["top"],std$302.topscope,std$302.stdenv.fork().convert(["multi",ast$357])));(ex$360=opt$304.hoist(ex$360));(tr$361=Translator$301());(rval$362=tr$361.translate(ex$360,"expr"));return [tr$361.dump_store(),rval$362];});std$302.stdenv.bind(std$302.topscope,"macro",["macro",function(context$378,scope$379,form$380,$376$381){var t0$435;var t1$436;var prep$430;var code$431;var mac$432;var mac2$433;var name$402;var sym$403;var arguments$404;var ast$405;var t0$394;var t1$395;var t2$396;var t3$397;var t4$398;var $383$389;var ph$384;(ph$384=$376$381);($383$389=ph$384);if((($383$389 instanceof Array)&&(((t0$394=$383$389.length)),((t0$394===3)&&(($383$389[0]==="data")&&(((t1$395=$383$389[1])),((t1$395 instanceof Array)&&(((t2$396=t1$395.length)),((t2$396===3)&&((t1$395[0]==="send")&&(((t3$397=t1$395[1])),((name$402=t3$397),((t3$397 instanceof Array)&&(((t4$398=t3$397.length)),((t4$398===2)&&(t3$397[0]==="symbol")))))))))))))))){(sym$403=t3$397[1]);(arguments$404=t1$395[2]);(ast$405=$383$389[2]);(t0$435=generate_from_ast$306(["send",["symbol","->"],["data",arguments$404,ast$405]]));if(((t0$435 instanceof Array)&&(((t1$436=t0$435.length)),(t1$436===2)))){(prep$430=t0$435[0]);(code$431=t0$435[1]);}else{$728(generate_from_ast$306(["send",["symbol","->"],["data",arguments$404,ast$405]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",808,858);}(mac$432=eval((prep$430+((";("+code$431)+")"))));(mac2$433=function(c$453,s$454,f$455,e$456){var env$459;var r$460;(env$459=scope$379.expander.mkenv());env$459.bind(scope$379,sym$403,["macro",mac2$433]);(r$460=mac$432(c$453,s$454,f$455,e$456));return env$459.convert(r$460);});return ["declare_raw",name$402,["macro",mac2$433]];}else{$728($383$389);}}]);std$302.stdenv.bind(std$302.topscope,"macros",["macro",function(context$473,scope$474,$470$475,$471$476){var t0$481;var t0$489;var t1$490;var t0$506;var t1$507;var $index$540;var $length$535;var temp$530;var acc$525;var prep$502;var code$503;var the_macros$504;var env$478;var body$479;(t0$481=$470$475);if($962(t0$481,"env")){(env$478=t0$481.env);}else{$728($470$475);}(t0$489=$471$476);if(((t0$489 instanceof Array)&&(((t1$490=t0$489.length)),((t1$490===2)&&(t0$489[0]==="data"))))){(body$479=t0$489[1]);}else{$728($471$476);}(t0$506=generate_from_ast$306(body$479));if(((t0$506 instanceof Array)&&(((t1$507=t0$506.length)),(t1$507===2)))){(prep$502=t0$506[0]);(code$503=t0$506[1]);}else{$728(generate_from_ast$306(body$479),"/home/olivier/git/earl-grey/src/earl-grey.eg",1368,1398);}(the_macros$504=eval((((prep$502+";(")+code$503)+")")));return ["splice"].concat((((acc$525=[])),(((temp$530=$1003(the_macros$504))),((($length$535=temp$530.length)),((($index$540=0)),function(){$522:for(;($index$540<$length$535);($index$540++)){var k$558;var v$559;var t0$553;var t1$554;var m$548;(m$548=temp$530[$index$540]);(t0$553=m$548);if(((t0$553 instanceof Array)&&(((t1$554=t0$553.length)),(t1$554===2)))){(k$558=t0$553[0]);(v$559=t0$553[1]);acc$525.push(["declare_raw",$234(["symbol",k$558],({"env":env$478})),["macro",v$559]]);}else{$728(m$548,"/home/olivier/git/earl-grey/src/earl-grey.eg",1468,1575);}}}()))),acc$525));}]);(generate$307=function(source$575){return Generator$308().generate(source$575);});(Generator$308=function(){var it$0$599;var interactive$592;var t0$588;var $581$583;($581$583=arguments);(t0$588=$581$583.length);if(((t0$588>=0)&&(t0$588<=1))){(interactive$592=function(){if((0>=t0$588)){return false;}else{return $581$583[0];}}());(it$0$599=function(){if((!$218(Generator$308)(this))){return Object.create(Generator$308.prototype);}else{return this;}}());(it$0$599["tr"]=Translator$301(std$302.stdprelude));(it$0$599["env"]=std$302.stdenv.fork());(it$0$599["interactive"]=interactive$592);return it$0$599;}else{$728($581$583);}});(Generator$308.prototype["generate"]=function(){var t0$668;var t1$669;var t2$670;var args$666;var stmt$662;var t$649;var p$650;var ex$651;var rval$652;var self$644;var it$0$639;var source$631;var dump$632;var t0$627;var $620$622;($620$622=arguments);(t0$627=$620$622.length);if(((t0$627>=1)&&(t0$627<=2))){(source$631=$620$622[0]);(dump$632=function(){if((1>=t0$627)){return true;}else{return $620$622[1];}}());(it$0$639=this);(self$644=this);(t$649=tokenize$296(source$631));(p$650=parse$298(t$649));(ex$651=(((stmt$662=function(){if(it$0$639.interactive){(t0$668=$1018(["multi"])(p$650));if((t0$668[0]&&(((t1$669=t0$668[1])),(((t2$670=t1$669.length)),(t2$670>=0))))){(args$666=Array.prototype.slice.call(t1$669,0));}else{$728(p$650,"/home/olivier/git/earl-grey/src/earl-grey.eg",2357,2358);}return ["interactive"].concat(args$666);}else{return ["multi",p$650];}}())),std$302.expand(["top"],std$302.topscope,it$0$639.env.convert(stmt$662))));(ex$651=opt$304.hoist(ex$651));(rval$652=it$0$639.tr.translate(ex$651,"stmt"));if(dump$632){return (it$0$639.tr.dump_store()+rval$652);}else{return rval$652;}}else{$728($620$622);}});$234(Generator$308,$234(((accum$696=({})),((accum$696["::name"]="Generator"),accum$696)),((accum$700=({})),((accum$700["::egclass"]=true),accum$700))));Generator$308;(exports["Source"]=Source$292);(exports["Location"]=Location$293);(exports["highlight_locations"]=highlight_locations$294);(exports["tokenize"]=tokenize$296);(exports["parse"]=parse$298);(exports["Generator"]=Generator$308);(exports["generate"]=generate$307);(exports["version"]=version$305);
