var $361=(function(type$364){var f$368;(f$368=type$364["::check"]);if((f$368===(void 0))){return (function(value$374){return (value$374 instanceof type$364);});}else{return (function(value$378){return f$368.call(type$364,value$378);});}});
var $380=(function(dest$383,values$384){var k$389;(k$389=null);$387:for(k$389 in values$384){if(values$384.hasOwnProperty(k$389)){(dest$383[k$389]=values$384[k$389]);}}return dest$383;});
var $397=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $398=(function($400$403){var ph$409;(ph$409=$400$403);var $405$415;($405$415=ph$409);var bridge$407$420;var x$424;(bridge$407$420=$405$415);if((((typeof(bridge$407$420)==="string")&&((x$424=bridge$407$420),true))||((typeof(bridge$407$420)==="number")&&((x$424=bridge$407$420),true)))){return ["value",x$424];}else{var other$435;(other$435=$405$415);return other$435["::serialize_ast"]();}});
var $437=(function(obj$440){var results$445;(results$445=[]);var k$450;(k$450=null);$444:for(k$450 in obj$440){if(Object.prototype.hasOwnProperty.call(obj$440,k$450)){results$445.push([k$450,$397(obj$440,k$450)]);}}return results$445;});
var $706=(function(arr$709){var results$715;var l$716;(results$715=[]);(l$716=arr$709.length);var i$725;(i$725=0);$714:for(;(i$725<l$716);(i$725++)){results$715.push([i$725,$397(arr$709,i$725)]);}return results$715;});
var $473=(function(){var $474$480;($474$480=(function(tags$485){var it$0$488;(it$0$488=(function(){if((!$361($474$480)(this))){return Object.create($474$480.prototype);}else{return this;}})());(it$0$488["tags"]=tags$485);return it$0$488;}));($474$480.prototype["create"]=(function(){var it$0$508;var self$509;(it$0$508=this);(self$509=this);var $506$518;($506$518=arguments);var t0$523;var message$527;var args$528;(t0$523=$506$518.length);if((t0$523>=0)){(message$527=(function(){if((0>=t0$523)){return "";}else{return $506$518[0];}})());(args$528=Array.prototype.slice.call($506$518,1));var e$541;(e$541=Error(message$527));(e$541["::tags"]=it$0$508.tags);(e$541["args"]=args$528);var temp$557;(temp$557=$706(args$528));var $length$563;($length$563=temp$557.length);var $index$569;($index$569=0);$542:for(;($index$569<$length$563);($index$569++)){var m$578;(m$578=temp$557[$index$569]);var t0$583;var t1$584;var i$588;var arg$589;(t0$583=m$578);if(((t0$583 instanceof Array)&&(((t1$584=t0$583.length)),(t1$584===2)))){(i$588=t0$583[0]);(arg$589=t0$583[1]);(e$541[i$588]=arg$589);}else{$454(m$578);}}(e$541["length"]=args$528.length);(e$541["name"]=["E"].concat(it$0$508.tags).join("."));return e$541;}else{$454($506$518);}}));($474$480.prototype["::check"]=(function(e$619){var it$0$623;var self$624;(it$0$623=this);(self$624=this);var tags$634;if(((!e$619)||(!$361(Error)(e$619)))){return false;}(tags$634=(e$619["::tags"]||[]));var temp$645;(temp$645=it$0$623.tags);var $length$651;($length$651=temp$645.length);var $index$657;($index$657=0);$635:for(;($index$657<$length$651);($index$657++)){var m$666;(m$666=temp$645[$index$657]);var tag$674;(tag$674=m$666);if((tags$634.indexOf(tag$674)===-1)){return false;}else{false;}}return true;}));($474$480.prototype["::deconstruct"]=(function(e$683){var it$0$687;var self$688;(it$0$687=this);(self$688=this);return e$683.args;}));$380($474$480,$380((function(){var accum$699;(accum$699=({}));(accum$699["::name"]="$474");return accum$699;})(),(function(){var accum$703;(accum$703=({}));(accum$703["::egclass"]=true);return accum$703;})()));return $474$480;})();
var $454=(function(value$457,url$458,start$459,end$460){var err$464;(err$464=$473(["match"]).create("Could not find a match for value",({"value":value$457})));if(url$458){(err$464["location"]=["location",url$458,start$459,end$460]);}throw err$464;});
var send$6;var __array_methods$7;var __re_methods$8;(send$6=(function(obj$21,$18$22){var ph$28;var msg$29;var t0$31;(t0$31=$18$22);(msg$29=t0$31);(ph$28=t0$31);var $24$40;($24$40=ph$28);var bridge$26$45;(bridge$26$45=$24$40);if(((typeof(bridge$26$45)==="string")||(typeof(bridge$26$45)==="number"))){return obj$21[msg$29];}else{var other$57;(other$57=$24$40);return obj$21["::send"](msg$29);}}));(Array[":::project"]=(function($63$66){var ph$71;var value$72;var t0$74;(t0$74=$63$66);(value$72=t0$74);(ph$71=t0$74);var $68$83;($68$83=ph$71);if($361(Array)($68$83)){return [true,value$72];}else{$68$83;return [true,[value$72]];}}));(__array_methods$7=$380((function(){var accum$104;(accum$104=({}));(accum$104["::check"]=(function(value$109){if((value$109 instanceof Array)){var i$115;(i$115=0);$112:for(;(i$115<this.length);(i$115++)){if(($397(this,i$115)!==$397(value$109,i$115))){return false;}}return true;}else{return false;}}));return accum$104;})(),$380((function(){var accum$124;(accum$124=({}));(accum$124["::clone"]=(function(){return $380(this.slice(0),this);}));return accum$124;})(),$380((function(){var accum$131;(accum$131=({}));(accum$131[":::project"]=(function(value$136){if((value$136 instanceof Array)){var i$142;(i$142=0);$139:for(;(i$142<this.length);(i$142++)){if(($397(this,i$142)!==$397(value$136,i$142))){return [true,this.concat([value$136])];}}return [true,value$136];}else{return [true,this.concat([value$136])];}}));return accum$131;})(),(function(){var accum$151;(accum$151=({}));(accum$151["::serialize_ast"]=(function(){return ["array"].concat(this.map($398));}));return accum$151;})()))));var temp$161;(temp$161=$437(__array_methods$7));var $length$167;($length$167=temp$161.length);var $index$173;($index$173=0);$9:for(;($index$173<$length$167);($index$173++)){var m$182;(m$182=temp$161[$index$173]);var t0$187;var t1$188;var k$192;var v$193;(t0$187=m$182);if(((t0$187 instanceof Array)&&(((t1$188=t0$187.length)),(t1$188===2)))){(k$192=t0$187[0]);(v$193=t0$187[1]);if((!$397(Array.prototype,k$192))){Object.defineProperty(Array.prototype,k$192,({"enumerable":false,"value":v$193}));}}else{$454(m$182);}}(__re_methods$8=$380((function(){var accum$213;(accum$213=({}));(accum$213["::check"]=(function($217$220){var ph$225;(ph$225=$217$220);var $222$231;($222$231=ph$225);var value$239;if((typeof($222$231)==="string")){(value$239=$222$231);if(value$239.match(this)){return true;}else{return false;}}else{var other$244;(other$244=$222$231);return false;}}));return accum$213;})(),(function(){var accum$247;(accum$247=({}));(accum$247[":::project"]=(function($251$254){var ph$259;(ph$259=$251$254);var $256$265;($256$265=ph$259);var value$273;if((typeof($256$265)==="string")){(value$273=$256$265);var $276$281;($276$281=value$273.match(this));var m$289;if(($276$281===null)){(m$289=$276$281);return [false,null];}else{var m$294;(m$294=$276$281);return [true,m$294];}}else{var other$298;(other$298=$256$265);return [false,null];}}));return accum$247;})()));var temp$304;(temp$304=$437(__re_methods$8));var $length$310;($length$310=temp$304.length);var $index$316;($index$316=0);$12:for(;($index$316<$length$310);($index$316++)){var m$325;(m$325=temp$304[$index$316]);var t0$330;var t1$331;var k$335;var v$336;(t0$330=m$325);if(((t0$330 instanceof Array)&&(((t1$331=t0$330.length)),(t1$331===2)))){(k$335=t0$330[0]);(v$336=t0$330[1]);if((!$397(RegExp.prototype,k$335))){Object.defineProperty(RegExp.prototype,k$335,({"enumerable":false,"value":v$336}));}}else{$454(m$325);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$380(({"enumerable":false}),(function(){var accum$354;(accum$354=({}));(accum$354["value"]=(function(args$359){return this.apply(this,args$359);}));return accum$354;})()));}
var $1454=(function($1456$1459,key$1460){var ph$1468;(ph$1468=$1456$1459);var $1462$1474;($1462$1474=ph$1468);var bridge$1464$1479;(bridge$1464$1479=$1462$1474);if(((bridge$1464$1479===null)||(bridge$1464$1479===(void 0)))){return false;}else{var x$1491;if((typeof($1462$1474)==="string")){(x$1491=$1462$1474);return (key$1460 in String.prototype);}else{var x$1496;if((typeof($1462$1474)==="number")){(x$1496=$1462$1474);return (key$1460 in Number.prototype);}else{var x$1501;(x$1501=$1462$1474);return (key$1460 in x$1501);}}}});
var $1503=(function(type$1506){return (function(value$1510){var f$1514;(f$1514=type$1506[":::project"]);if((f$1514===(void 0))){(f$1514=type$1506["::project"]);if((f$1514===(void 0))){return [true,type$1506(value$1510)];}else{var rval$1527;(rval$1527=false);try{(rval$1527=[true,f$1514(value$1510)]);}catch(excv$1538){var e$1544;(e$1544=excv$1538);(rval$1527=[false,null]);}return rval$1527;}}else{return f$1514.call(type$1506,value$1510);}});});var accum$1410;var accum$1414;var $734$768;var Source$769;var Location$770;var highlight_locations$771;var $735$772;var tokenize$773;var $736$774;var parse$775;var $737$776;var translate$777;var Translator$778;var std$779;var exp$780;var opt$781;var $741$782;var Body$783;var vm$784;var module$785;var path$786;var version$787;var evaluator$788;var generate_from_ast$789;var generate$790;var Generator$791;($734$768=require("./location"));(Source$769=$734$768.Source);(Location$770=$734$768.Location);(highlight_locations$771=$734$768.highlight_locations);($735$772=require("./lex"));(tokenize$773=$735$772.tokenize);($736$774=require("./parse"));(parse$775=$736$774.parse);($737$776=require("./translate-js"));(translate$777=$737$776.translate);(Translator$778=$737$776.Translator);(std$779=require("./stdenv"));(exp$780=require("./expand"));(opt$781=require("./opt"));($741$782=require("./util"));(Body$783=$741$782.Body);(vm$784=require("vm"));(module$785=require("module"));(path$786=require("path"));(version$787="zero");(evaluator$788=(function($855$858){var t0$867;var accum$910;var paths$892;var e_module$893;var e_require$894;var __eval$932;var $863$882;var $860$876;var ph$864;var options$865;(t0$867=$855$858);(options$865=t0$867);(ph$864=t0$867);($860$876=ph$864);$860$876;if(module$785._nodeModulePaths){(paths$892=module$785._nodeModulePaths(options$865.cwd));(e_module$893=(new module$785(options$865.showname)));$380(e_module$893,({"filename":options$865.filename,"paths":paths$892}));(e_require$894=(function(path$905){return module$785._load(path$905,e_module$893,true);}));$380(e_require$894,$380(({"main":e_module$893}),$380(((accum$910=({})),((accum$910["resolve"]=(function(path$915){return module$785._resolveFileName(path$915,e_module$893);})),accum$910)),({"paths":paths$892,"cache":require.cache}))));$380(global,({"__filename":options$865.filename,"__dirname":path$786.dirname(options$865.filename),"module":e_module$893,"require":e_require$894}));return (function(code$918){var script$922;(script$922=vm$784.createScript(code$918,options$865.showname));return script$922.runInThisContext();});}else{(__eval$932=eval);return (function(code$937){return __eval$932(code$937);});}}));(generate_from_ast$789=(function(ast$944){var ex$951;var tr$952;var rval$953;(ex$951=std$779.expand(["top"],std$779.topscope,std$779.stdenv.fork().mark(["multi",ast$944])));(ex$951=opt$781.hoist(ex$951));(tr$952=Translator$778());(rval$953=tr$952.translate(ex$951,"expr"));return [tr$952.dump_store(),rval$953];}));std$779.stdenv.bind(std$779.topscope,"macro",["macro",(function(context$971,scope$972,form$973,$968$974){var t0$1042;var t1$1043;var prep$1035;var code$1036;var file$1037;var ev$1038;var mac$1039;var mac2$1040;var name$997;var sym$998;var arguments$999;var ast$1000;var t0$989;var t1$990;var t2$991;var t3$992;var t4$993;var $976$984;var ph$978;(ph$978=$968$974);($976$984=ph$978);if((($976$984 instanceof Array)&&(((t0$989=$976$984.length)),((t0$989===3)&&(($976$984[0]==="data")&&(((t1$990=$976$984[1])),((t1$990 instanceof Array)&&(((t2$991=t1$990.length)),((t2$991===3)&&((t1$990[0]==="send")&&(((t3$992=t1$990[1])),((name$997=t3$992),((t3$992 instanceof Array)&&(((t4$993=t3$992.length)),((t4$993===2)&&(t3$992[0]==="symbol")))))))))))))))){(sym$998=t3$992[1]);(arguments$999=t1$990[2]);(ast$1000=$976$984[2]);(t0$1042=generate_from_ast$789(["send",["symbol","->"],["data",arguments$999,ast$1000]]));if(((t0$1042 instanceof Array)&&(((t1$1043=t0$1042.length)),(t1$1043===2)))){(prep$1035=t0$1042[0]);(code$1036=t0$1042[1]);}else{$454(generate_from_ast$789(["send",["symbol","->"],["data",arguments$999,ast$1000]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",1709,1749);}(file$1037=form$973.location.source.url);(ev$1038=evaluator$788(({"filename":file$1037,"showname":file$1037,"cwd":file$1037})));(mac$1039=ev$1038((prep$1035+((";("+code$1036)+")"))));(mac2$1040=(function(c$1069,s$1070,f$1071,e$1072){var bindings$1079;var env$1080;var r$1081;(bindings$1079=form$973.env.list_bindings(scope$972));(env$1080=exp$780.Env());(env$1080.scopes[std$779.topscope.name]=bindings$1079);(r$1081=mac$1039(c$1069,s$1070,f$1071,e$1072));return env$1080.mark(r$1081);}));return ["declare_raw",name$997,["macro",mac2$1040]];}else{$454($976$984);}})]);std$779.stdenv.bind(std$779.topscope,"macros",["macro",(function(context$1103,scope$1104,$1098$1105,$1100$1106){var t0$1112;var t0$1121;var t1$1122;var t0$1146;var t1$1147;var $index$1193;var $length$1187;var temp$1181;var acc$1175;var prep$1140;var code$1141;var file$1142;var ev$1143;var the_macros$1144;var form$1108;var env$1109;var body$1110;(t0$1112=$1098$1105);(form$1108=t0$1112);if($1454(t0$1112,"env")){(env$1109=t0$1112.env);}else{$454($1098$1105);}(t0$1121=$1100$1106);if(((t0$1121 instanceof Array)&&(((t1$1122=t0$1121.length)),((t1$1122===2)&&(t0$1121[0]==="data"))))){(body$1110=t0$1121[1]);}else{$454($1100$1106);}(t0$1146=generate_from_ast$789(body$1110));if(((t0$1146 instanceof Array)&&(((t1$1147=t0$1146.length)),(t1$1147===2)))){(prep$1140=t0$1146[0]);(code$1141=t0$1146[1]);}else{$454(generate_from_ast$789(body$1110),"/home/olivier/git/earl-grey/src/earl-grey.eg",2686,2709);}(file$1142=form$1108.location.source.url);(ev$1143=evaluator$788(({"filename":file$1142,"showname":file$1142,"cwd":file$1142})));(the_macros$1144=ev$1143((((prep$1140+";(")+code$1141)+")")));return ["splice"].concat((((acc$1175=[])),(((temp$1181=$437(the_macros$1144))),((($length$1187=temp$1181.length)),((($index$1193=0)),(function(){$1170:for(;($index$1193<$length$1187);($index$1193++)){var k$1212;var v$1213;var t0$1207;var t1$1208;var m$1202;(m$1202=temp$1181[$index$1193]);(t0$1207=m$1202);if(((t0$1207 instanceof Array)&&(((t1$1208=t0$1207.length)),(t1$1208===2)))){(k$1212=t0$1207[0]);(v$1213=t0$1207[1]);acc$1175.push(["declare_raw",$380(["symbol",k$1212],({"env":env$1109})),["macro",v$1213]]);}else{$454(m$1202,"/home/olivier/git/earl-grey/src/earl-grey.eg",2938,3035);}}})()))),acc$1175));})]);(generate$790=(function(source$1232){return Generator$791().generate(source$1232);}));(Generator$791=(function(){var interactive$1259;var t0$1255;var $1246$1250;var it$0$1241;(it$0$1241=(function(){if((!$361(Generator$791)(this))){return Object.create(Generator$791.prototype);}else{return this;}})());($1246$1250=arguments);(t0$1255=$1246$1250.length);if(((t0$1255>=0)&&(t0$1255<=1))){(interactive$1259=(function(){if((0>=t0$1255)){return false;}else{return $1246$1250[0];}})());(it$0$1241["tr"]=Translator$778(std$779.stdprelude));(it$0$1241["env"]=std$779.stdenv.fork());(it$0$1241["interactive"]=interactive$1259);(it$0$1241["_eval"]=null);}else{$454($1246$1250);}return it$0$1241;}));(Generator$791.prototype["generate"]=(function(){var t0$1349;var t1$1350;var t2$1351;var args$1347;var stmt$1342;var t$1328;var p$1329;var ex$1330;var rval$1331;var source$1314;var dump$1315;var t0$1310;var $1293$1305;var it$0$1295;var self$1296;(it$0$1295=this);(self$1296=this);($1293$1305=arguments);(t0$1310=$1293$1305.length);if(((t0$1310>=1)&&(t0$1310<=2))){(source$1314=$1293$1305[0]);(dump$1315=(function(){if((1>=t0$1310)){return true;}else{return $1293$1305[1];}})());(t$1328=tokenize$773(source$1314));(p$1329=parse$775(t$1328));(ex$1330=(((stmt$1342=(function(){if(it$0$1295.interactive){(t0$1349=$1503(Body$783)(p$1329));if((t0$1349[0]&&(((t1$1350=t0$1349[1])),(((t2$1351=t1$1350.length)),(t2$1351>=0))))){(args$1347=Array.prototype.slice.call(t1$1350,0));}else{$454(p$1329,"/home/olivier/git/earl-grey/src/earl-grey.eg",3834,3835);}return ["interactive"].concat(args$1347);}else{return ["multi",p$1329];}})())),std$779.expand(["top"],std$779.topscope,it$0$1295.env.mark(stmt$1342))));(ex$1330=opt$781.hoist(ex$1330));(rval$1331=it$0$1295.tr.translate(ex$1330,"stmt"));if(dump$1315){return (it$0$1295.tr.dump_store()+rval$1331);}else{return rval$1331;}}else{$454($1293$1305);}}));(Generator$791.prototype["evaluate"]=(function(source$1383){var file$1400;var it$0$1387;var self$1388;(it$0$1387=this);(self$1388=this);if((!it$0$1387._eval)){(file$1400=source$1383.url);(it$0$1387["_eval"]=evaluator$788(({"filename":file$1400,"showname":file$1400,"cwd":file$1400})));}return it$0$1387._eval(it$0$1387.generate(source$1383));}));$380(Generator$791,$380(((accum$1410=({})),((accum$1410["::name"]="Generator"),accum$1410)),((accum$1414=({})),((accum$1414["::egclass"]=true),accum$1414))));Generator$791;(exports["evaluator"]=evaluator$788);(exports["Source"]=Source$769);(exports["Location"]=Location$770);(exports["highlight_locations"]=highlight_locations$771);(exports["tokenize"]=tokenize$773);(exports["parse"]=parse$775);(exports["Generator"]=Generator$791);(exports["generate"]=generate$790);(exports["version"]=version$787);
