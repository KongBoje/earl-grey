var $237=(function(type$240){var f$244;(f$244=type$240["::check"]);if((f$244===(void 0))){return (function(value$250){return (value$250 instanceof type$240);});}else{return (function(value$254){return f$244.call(type$240,value$254);});}});
var $256=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $257=(function(dest$260,values$261){var k$266;(k$266=null);$264:for(k$266 in values$261){if(values$261.hasOwnProperty(k$266)){(dest$260[k$266]=values$261[k$266]);}}return dest$260;});
var $274=(function($276$279){var ph$285;(ph$285=$276$279);var $281$291;($281$291=ph$285);var bridge$283$296;var x$300;(bridge$283$296=$281$291);if((((typeof(bridge$283$296)==="string")&&((x$300=bridge$283$296),true))||((typeof(bridge$283$296)==="number")&&((x$300=bridge$283$296),true)))){return ["value",x$300];}else{var other$311;(other$311=$281$291);return other$311["::serialize_ast"]();}});
var send$11;(send$11=(function(obj$18,$15$19){var ph$25;var msg$26;var t0$28;(t0$28=$15$19);(msg$26=t0$28);(ph$25=t0$28);var $21$37;($21$37=ph$25);var bridge$23$42;(bridge$23$42=$21$37);if(((typeof(bridge$23$42)==="string")||(typeof(bridge$23$42)==="number"))){return obj$18[msg$26];}else{var other$54;(other$54=$21$37);return obj$18["::send"](msg$26);}}));(Array[":::project"]=(function($60$63){var ph$68;var value$69;var t0$71;(t0$71=$60$63);(value$69=t0$71);(ph$68=t0$71);var $65$80;($65$80=ph$68);if($237(Array)($65$80)){return [true,value$69];}else{$65$80;return [true,[value$69]];}}));(Array.prototype["::check"]=(function(value$98){if((value$98 instanceof Array)){var i$104;(i$104=0);$101:for(;(i$104<this.length);(i$104++)){if(($256(this,i$104)!==$256(value$98,i$104))){return false;}}return true;}else{return false;}}));(Array.prototype["::clone"]=(function(){return $257(this.slice(0),this);}));(Array.prototype[":::project"]=(function(value$123){if((value$123 instanceof Array)){var i$129;(i$129=0);$126:for(;(i$129<this.length);(i$129++)){if(($256(this,i$129)!==$256(value$123,i$129))){return [true,[value$123]];}}return [true,value$123.slice(this.length)];}else{return [true,[value$123]];}}));(Array.prototype["::serialize_ast"]=(function(){return ["array"].concat(this.map($274));}));(RegExp.prototype["::check"]=(function($147$150){var ph$155;(ph$155=$147$150);var $152$161;($152$161=ph$155);var value$169;if((typeof($152$161)==="string")){(value$169=$152$161);if(value$169.match(this)){return true;}else{return false;}}else{var other$174;(other$174=$152$161);return false;}}));(RegExp.prototype[":::project"]=(function($180$183){var ph$188;(ph$188=$180$183);var $185$194;($185$194=ph$188);var value$202;if((typeof($185$194)==="string")){(value$202=$185$194);var $205$210;($205$210=value$202.match(this));var m$218;if(($205$210===null)){(m$218=$205$210);return [false,null];}else{var m$223;(m$223=$205$210);return [true,m$223];}}else{var other$227;(other$227=$185$194);return [false,null];}}));(Function.prototype["::send"]=(function(args$234){return this.apply(this,args$234);}));
var $1259=(function(arr$1262){var results$1268;var l$1269;(results$1268=[]);(l$1269=arr$1262.length);var i$1278;(i$1278=0);$1267:for(;(i$1278<l$1269);(i$1278++)){results$1268.push([i$1278,$256(arr$1262,i$1278)]);}return results$1268;});
var $1026=(function(){var $1027$1033;($1027$1033=(function(tags$1038){var it$0$1041;(it$0$1041=(function(){if((!$237($1027$1033)(this))){return Object.create($1027$1033.prototype);}else{return this;}})());(it$0$1041["tags"]=tags$1038);return it$0$1041;}));($1027$1033.prototype["create"]=(function(){var it$0$1061;var self$1062;(it$0$1061=this);(self$1062=this);var $1059$1071;($1059$1071=arguments);var t0$1076;var message$1080;var args$1081;(t0$1076=$1059$1071.length);if((t0$1076>=0)){(message$1080=(function(){if((0>=t0$1076)){return "";}else{return $1059$1071[0];}})());(args$1081=Array.prototype.slice.call($1059$1071,1));var e$1094;(e$1094=Error(message$1080));(e$1094["::tags"]=it$0$1061.tags);(e$1094["args"]=args$1081);var temp$1110;(temp$1110=$1259(args$1081));var $length$1116;($length$1116=temp$1110.length);var $index$1122;($index$1122=0);$1095:for(;($index$1122<$length$1116);($index$1122++)){var m$1131;(m$1131=temp$1110[$index$1122]);var t0$1136;var t1$1137;var i$1141;var arg$1142;(t0$1136=m$1131);if(((t0$1136 instanceof Array)&&(((t1$1137=t0$1136.length)),(t1$1137===2)))){(i$1141=t0$1136[0]);(arg$1142=t0$1136[1]);(e$1094[i$1141]=arg$1142);}else{$1007(m$1131);}}(e$1094["length"]=args$1081.length);(e$1094["name"]=["E"].concat(it$0$1061.tags).join("."));return e$1094;}else{$1007($1059$1071);}}));($1027$1033.prototype["::check"]=(function(e$1172){var it$0$1176;var self$1177;(it$0$1176=this);(self$1177=this);var tags$1187;if(((!e$1172)||(!$237(Error)(e$1172)))){return false;}(tags$1187=(e$1172["::tags"]||[]));var temp$1198;(temp$1198=it$0$1176.tags);var $length$1204;($length$1204=temp$1198.length);var $index$1210;($index$1210=0);$1188:for(;($index$1210<$length$1204);($index$1210++)){var m$1219;(m$1219=temp$1198[$index$1210]);var tag$1227;(tag$1227=m$1219);if((tags$1187.indexOf(tag$1227)===-1)){return false;}else{false;}}return true;}));($1027$1033.prototype["::deconstruct"]=(function(e$1236){var it$0$1240;var self$1241;(it$0$1240=this);(self$1241=this);return e$1236.args;}));$257($1027$1033,$257((function(){var accum$1252;(accum$1252=({}));(accum$1252["::name"]="$1027");return accum$1252;})(),(function(){var accum$1256;(accum$1256=({}));(accum$1256["::egclass"]=true);return accum$1256;})()));return $1027$1033;})();
var $1007=(function(value$1010,url$1011,start$1012,end$1013){var err$1017;(err$1017=$1026(["match"]).create("Could not find a match for value",({"value":value$1010})));if(url$1011){(err$1017["location"]=["location",url$1011,start$1012,end$1013]);}throw err$1017;});
var $1285=(function($1287$1290,key$1291){var ph$1299;(ph$1299=$1287$1290);var $1293$1305;($1293$1305=ph$1299);var bridge$1295$1310;(bridge$1295$1310=$1293$1305);if(((bridge$1295$1310===null)||(bridge$1295$1310===(void 0)))){return false;}else{var x$1322;if((typeof($1293$1305)==="string")){(x$1322=$1293$1305);return (key$1291 in String.prototype);}else{var x$1327;if((typeof($1293$1305)==="number")){(x$1327=$1293$1305);return (key$1291 in Number.prototype);}else{var x$1332;(x$1332=$1293$1305);return (key$1291 in x$1332);}}}});
var $1334=(function(obj$1337){var results$1342;(results$1342=[]);var k$1347;(k$1347=null);$1341:for(k$1347 in obj$1337){if(Object.prototype.hasOwnProperty.call(obj$1337,k$1347)){results$1342.push([k$1347,$256(obj$1337,k$1347)]);}}return results$1342;});
var $1351=(function(type$1354){return (function(value$1358){var f$1362;(f$1362=type$1354[":::project"]);if((f$1362===(void 0))){(f$1362=type$1354["::project"]);if((f$1362===(void 0))){return [true,type$1354(value$1358)];}else{var rval$1375;(rval$1375=false);try{(rval$1375=[true,f$1362(value$1358)]);}catch(excv$1386){var e$1392;(e$1392=excv$1386);(rval$1375=[false,null]);}return rval$1375;}}else{return f$1362.call(type$1354,value$1358);}});});var accum$963;var accum$967;var $315$346;var Source$347;var Location$348;var highlight_locations$349;var $316$350;var tokenize$351;var $317$352;var parse$353;var $318$354;var translate$355;var Translator$356;var std$357;var exp$358;var opt$359;var vm$360;var module$361;var path$362;var version$363;var evaluator$364;var generate_from_ast$365;var generate$366;var Generator$367;($315$346=require("./location"));(Source$347=$315$346.Source);(Location$348=$315$346.Location);(highlight_locations$349=$315$346.highlight_locations);($316$350=require("./lex"));(tokenize$351=$316$350.tokenize);($317$352=require("./parse"));(parse$353=$317$352.parse);($318$354=require("./translate-js"));(translate$355=$318$354.translate);(Translator$356=$318$354.Translator);(std$357=require("./stdenv"));(exp$358=require("./expand"));(opt$359=require("./opt"));(vm$360=require("vm"));(module$361=require("module"));(path$362=require("path"));(version$363="zero");(evaluator$364=(function($425$428){var t0$437;var accum$480;var paths$462;var e_module$463;var e_require$464;var $433$452;var $430$446;var ph$434;var options$435;(t0$437=$425$428);(options$435=t0$437);(ph$434=t0$437);($430$446=ph$434);$430$446;if(module$361._nodeModulePaths){(paths$462=module$361._nodeModulePaths(options$435.cwd));(e_module$463=(new module$361(options$435.showname)));$257(e_module$463,({"filename":options$435.filename,"paths":paths$462}));(e_require$464=(function(path$475){return module$361._load(path$475,e_module$463,true);}));$257(e_require$464,$257(({"main":e_module$463}),$257(((accum$480=({})),((accum$480["resolve"]=(function(path$485){return module$361._resolveFileName(path$485,e_module$463);})),accum$480)),({"paths":paths$462,"cache":require.cache}))));$257(global,({"__filename":options$435.filename,"__dirname":path$362.dirname(options$435.filename),"module":e_module$463,"require":e_require$464}));return (function(code$488){var script$492;(script$492=vm$360.createScript(code$488,options$435.showname));return script$492.runInThisContext();});}else{return (function(code$501){return eval(code$501);});}}));(generate_from_ast$365=(function(ast$508){var ex$515;var tr$516;var rval$517;(ex$515=std$357.expand(["top"],std$357.topscope,std$357.stdenv.fork().mark(["multi",ast$508])));(ex$515=opt$359.hoist(ex$515));(tr$516=Translator$356());(rval$517=tr$516.translate(ex$515,"expr"));return [tr$516.dump_store(),rval$517];}));std$357.stdenv.bind(std$357.topscope,"macro",["macro",(function(context$535,scope$536,form$537,$532$538){var t0$606;var t1$607;var prep$599;var code$600;var file$601;var ev$602;var mac$603;var mac2$604;var name$561;var sym$562;var arguments$563;var ast$564;var t0$553;var t1$554;var t2$555;var t3$556;var t4$557;var $540$548;var ph$542;(ph$542=$532$538);($540$548=ph$542);if((($540$548 instanceof Array)&&(((t0$553=$540$548.length)),((t0$553===3)&&(($540$548[0]==="data")&&(((t1$554=$540$548[1])),((t1$554 instanceof Array)&&(((t2$555=t1$554.length)),((t2$555===3)&&((t1$554[0]==="send")&&(((t3$556=t1$554[1])),((name$561=t3$556),((t3$556 instanceof Array)&&(((t4$557=t3$556.length)),((t4$557===2)&&(t3$556[0]==="symbol")))))))))))))))){(sym$562=t3$556[1]);(arguments$563=t1$554[2]);(ast$564=$540$548[2]);(t0$606=generate_from_ast$365(["send",["symbol","->"],["data",arguments$563,ast$564]]));if(((t0$606 instanceof Array)&&(((t1$607=t0$606.length)),(t1$607===2)))){(prep$599=t0$606[0]);(code$600=t0$606[1]);}else{$1007(generate_from_ast$365(["send",["symbol","->"],["data",arguments$563,ast$564]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",1667,1717);}(file$601=form$537.location.source.url);(ev$602=evaluator$364(({"filename":file$601,"showname":file$601,"cwd":file$601})));(mac$603=ev$602((prep$599+((";("+code$600)+")"))));(mac2$604=(function(c$633,s$634,f$635,e$636){var bindings$643;var env$644;var r$645;(bindings$643=form$537.env.list_bindings(scope$536));(env$644=exp$358.Env());(env$644.scopes[std$357.topscope.name]=bindings$643);(r$645=mac$603(c$633,s$634,f$635,e$636));return env$644.mark(r$645);}));return ["declare_raw",name$561,["macro",mac2$604]];}else{$1007($540$548);}})]);std$357.stdenv.bind(std$357.topscope,"macros",["macro",(function(context$667,scope$668,$662$669,$664$670){var t0$675;var t0$684;var t1$685;var t0$705;var t1$706;var $index$746;var $length$740;var temp$734;var acc$728;var prep$701;var code$702;var the_macros$703;var env$672;var body$673;(t0$675=$662$669);if($1285(t0$675,"env")){(env$672=t0$675.env);}else{$1007($662$669);}(t0$684=$664$670);if(((t0$684 instanceof Array)&&(((t1$685=t0$684.length)),((t1$685===2)&&(t0$684[0]==="data"))))){(body$673=t0$684[1]);}else{$1007($664$670);}(t0$705=generate_from_ast$365(body$673));if(((t0$705 instanceof Array)&&(((t1$706=t0$705.length)),(t1$706===2)))){(prep$701=t0$705[0]);(code$702=t0$705[1]);}else{$1007(generate_from_ast$365(body$673),"/home/olivier/git/earl-grey/src/earl-grey.eg",2635,2665);}(the_macros$703=eval((((prep$701+";(")+code$702)+")")));return ["splice"].concat((((acc$728=[])),(((temp$734=$1334(the_macros$703))),((($length$740=temp$734.length)),((($index$746=0)),(function(){$723:for(;($index$746<$length$740);($index$746++)){var k$765;var v$766;var t0$760;var t1$761;var m$755;(m$755=temp$734[$index$746]);(t0$760=m$755);if(((t0$760 instanceof Array)&&(((t1$761=t0$760.length)),(t1$761===2)))){(k$765=t0$760[0]);(v$766=t0$760[1]);acc$728.push(["declare_raw",$257(["symbol",k$765],({"env":env$672})),["macro",v$766]]);}else{$1007(m$755,"/home/olivier/git/earl-grey/src/earl-grey.eg",2735,2842);}}})()))),acc$728));})]);(generate$366=(function(source$785){return Generator$367().generate(source$785);}));(Generator$367=(function(){var interactive$812;var t0$808;var $799$803;var it$0$794;(it$0$794=(function(){if((!$237(Generator$367)(this))){return Object.create(Generator$367.prototype);}else{return this;}})());($799$803=arguments);(t0$808=$799$803.length);if(((t0$808>=0)&&(t0$808<=1))){(interactive$812=(function(){if((0>=t0$808)){return false;}else{return $799$803[0];}})());(it$0$794["tr"]=Translator$356(std$357.stdprelude));(it$0$794["env"]=std$357.stdenv.fork());(it$0$794["interactive"]=interactive$812);(it$0$794["_eval"]=null);}else{$1007($799$803);}return it$0$794;}));(Generator$367.prototype["generate"]=(function(){var t0$902;var t1$903;var t2$904;var args$900;var stmt$895;var t$881;var p$882;var ex$883;var rval$884;var source$867;var dump$868;var t0$863;var $846$858;var it$0$848;var self$849;(it$0$848=this);(self$849=this);($846$858=arguments);(t0$863=$846$858.length);if(((t0$863>=1)&&(t0$863<=2))){(source$867=$846$858[0]);(dump$868=(function(){if((1>=t0$863)){return true;}else{return $846$858[1];}})());(t$881=tokenize$351(source$867));(p$882=parse$353(t$881));(ex$883=(((stmt$895=(function(){if(it$0$848.interactive){(t0$902=$1351(["multi"])(p$882));if((t0$902[0]&&(((t1$903=t0$902[1])),(((t2$904=t1$903.length)),(t2$904>=0))))){(args$900=Array.prototype.slice.call(t1$903,0));}else{$1007(p$882,"/home/olivier/git/earl-grey/src/earl-grey.eg",3643,3644);}return ["interactive"].concat(args$900);}else{return ["multi",p$882];}})())),std$357.expand(["top"],std$357.topscope,it$0$848.env.mark(stmt$895))));(ex$883=opt$359.hoist(ex$883));(rval$884=it$0$848.tr.translate(ex$883,"stmt"));if(dump$868){return (it$0$848.tr.dump_store()+rval$884);}else{return rval$884;}}else{$1007($846$858);}}));(Generator$367.prototype["evaluate"]=(function(source$936){var file$953;var it$0$940;var self$941;(it$0$940=this);(self$941=this);if((!it$0$940._eval)){(file$953=source$936.url);(it$0$940["_eval"]=evaluator$364(({"filename":file$953,"showname":file$953,"cwd":file$953})));}return it$0$940._eval(it$0$940.generate(source$936));}));$257(Generator$367,$257(((accum$963=({})),((accum$963["::name"]="Generator"),accum$963)),((accum$967=({})),((accum$967["::egclass"]=true),accum$967))));Generator$367;(exports["evaluator"]=evaluator$364);(exports["Source"]=Source$347);(exports["Location"]=Location$348);(exports["highlight_locations"]=highlight_locations$349);(exports["tokenize"]=tokenize$351);(exports["parse"]=parse$353);(exports["Generator"]=Generator$367);(exports["generate"]=generate$366);(exports["version"]=version$363);
