var $361=(function(type$364){var f$368;(f$368=type$364["::check"]);if((f$368===(void 0))){return (function(value$374){return (value$374 instanceof type$364);});}else{return (function(value$378){return f$368.call(type$364,value$378);});}});
var $380=(function(dest$383,values$384){var k$389;(k$389=null);$387:for(k$389 in values$384){if(values$384.hasOwnProperty(k$389)){(dest$383[k$389]=values$384[k$389]);}}return dest$383;});
var $397=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $398=(function($400$403){var ph$409;(ph$409=$400$403);var $405$415;($405$415=ph$409);var bridge$407$420;var x$424;(bridge$407$420=$405$415);if((((typeof(bridge$407$420)==="string")&&((x$424=bridge$407$420),true))||((typeof(bridge$407$420)==="number")&&((x$424=bridge$407$420),true)))){return ["value",x$424];}else{var other$435;(other$435=$405$415);return other$435["::serialize_ast"]();}});
var $437=(function(obj$440){var results$445;(results$445=[]);var k$450;(k$450=null);$444:for(k$450 in obj$440){if(Object.prototype.hasOwnProperty.call(obj$440,k$450)){results$445.push([k$450,$397(obj$440,k$450)]);}}return results$445;});
var $706=(function(arr$709){var results$715;var l$716;(results$715=[]);(l$716=arr$709.length);var i$725;(i$725=0);$714:for(;(i$725<l$716);(i$725++)){results$715.push([i$725,$397(arr$709,i$725)]);}return results$715;});
var $473=(function(){var $474$480;($474$480=(function(tags$485){var it$0$488;(it$0$488=(function(){if((!$361($474$480)(this))){return Object.create($474$480.prototype);}else{return this;}})());(it$0$488["tags"]=tags$485);return it$0$488;}));($474$480.prototype["create"]=(function(){var it$0$508;var self$509;(it$0$508=this);(self$509=this);var $506$518;($506$518=arguments);var t0$523;var message$527;var args$528;(t0$523=$506$518.length);if((t0$523>=0)){(message$527=(function(){if((0>=t0$523)){return "";}else{return $506$518[0];}})());(args$528=Array.prototype.slice.call($506$518,1));var e$541;(e$541=Error(message$527));(e$541["::tags"]=it$0$508.tags);(e$541["args"]=args$528);var temp$557;(temp$557=$706(args$528));var $length$563;($length$563=temp$557.length);var $index$569;($index$569=0);$542:for(;($index$569<$length$563);($index$569++)){var m$578;(m$578=temp$557[$index$569]);var t0$583;var t1$584;var i$588;var arg$589;(t0$583=m$578);if(((t0$583 instanceof Array)&&(((t1$584=t0$583.length)),(t1$584===2)))){(i$588=t0$583[0]);(arg$589=t0$583[1]);(e$541[i$588]=arg$589);}else{$454(m$578);}}(e$541["length"]=args$528.length);(e$541["name"]=["E"].concat(it$0$508.tags).join("."));return e$541;}else{$454($506$518);}}));($474$480.prototype["::check"]=(function(e$619){var it$0$623;var self$624;(it$0$623=this);(self$624=this);var tags$634;if(((!e$619)||(!$361(Error)(e$619)))){return false;}(tags$634=(e$619["::tags"]||[]));var temp$645;(temp$645=it$0$623.tags);var $length$651;($length$651=temp$645.length);var $index$657;($index$657=0);$635:for(;($index$657<$length$651);($index$657++)){var m$666;(m$666=temp$645[$index$657]);var tag$674;(tag$674=m$666);if((tags$634.indexOf(tag$674)===-1)){return false;}else{false;}}return true;}));($474$480.prototype["::deconstruct"]=(function(e$683){var it$0$687;var self$688;(it$0$687=this);(self$688=this);return e$683.args;}));$380($474$480,$380((function(){var accum$699;(accum$699=({}));(accum$699["::name"]="$474");return accum$699;})(),(function(){var accum$703;(accum$703=({}));(accum$703["::egclass"]=true);return accum$703;})()));return $474$480;})();
var $454=(function(value$457,url$458,start$459,end$460){var err$464;(err$464=$473(["match"]).create("Could not find a match for value",({"value":value$457})));if(url$458){(err$464["location"]=["location",url$458,start$459,end$460]);}throw err$464;});
var send$6;var __array_methods$7;var __re_methods$8;(send$6=(function(obj$21,$18$22){var ph$28;var msg$29;var t0$31;(t0$31=$18$22);(msg$29=t0$31);(ph$28=t0$31);var $24$40;($24$40=ph$28);var bridge$26$45;(bridge$26$45=$24$40);if(((typeof(bridge$26$45)==="string")||(typeof(bridge$26$45)==="number"))){return obj$21[msg$29];}else{var other$57;(other$57=$24$40);return obj$21["::send"](msg$29);}}));(Array[":::project"]=(function($63$66){var ph$71;var value$72;var t0$74;(t0$74=$63$66);(value$72=t0$74);(ph$71=t0$74);var $68$83;($68$83=ph$71);if($361(Array)($68$83)){return [true,value$72];}else{$68$83;return [true,[value$72]];}}));(__array_methods$7=$380((function(){var accum$104;(accum$104=({}));(accum$104["::check"]=(function(value$109){if((value$109 instanceof Array)){var i$115;(i$115=0);$112:for(;(i$115<this.length);(i$115++)){if(($397(this,i$115)!==$397(value$109,i$115))){return false;}}return true;}else{return false;}}));return accum$104;})(),$380((function(){var accum$124;(accum$124=({}));(accum$124["::clone"]=(function(){return $380(this.slice(0),this);}));return accum$124;})(),$380((function(){var accum$131;(accum$131=({}));(accum$131[":::project"]=(function(value$136){if((value$136 instanceof Array)){var i$142;(i$142=0);$139:for(;(i$142<this.length);(i$142++)){if(($397(this,i$142)!==$397(value$136,i$142))){return [true,this.concat([value$136])];}}return [true,value$136];}else{return [true,this.concat([value$136])];}}));return accum$131;})(),(function(){var accum$151;(accum$151=({}));(accum$151["::serialize_ast"]=(function(){return ["array"].concat(this.map($398));}));return accum$151;})()))));var temp$161;(temp$161=$437(__array_methods$7));var $length$167;($length$167=temp$161.length);var $index$173;($index$173=0);$9:for(;($index$173<$length$167);($index$173++)){var m$182;(m$182=temp$161[$index$173]);var t0$187;var t1$188;var k$192;var v$193;(t0$187=m$182);if(((t0$187 instanceof Array)&&(((t1$188=t0$187.length)),(t1$188===2)))){(k$192=t0$187[0]);(v$193=t0$187[1]);if((!$397(Array.prototype,k$192))){Object.defineProperty(Array.prototype,k$192,({"enumerable":false,"value":v$193}));}}else{$454(m$182);}}(__re_methods$8=$380((function(){var accum$213;(accum$213=({}));(accum$213["::check"]=(function($217$220){var ph$225;(ph$225=$217$220);var $222$231;($222$231=ph$225);var value$239;if((typeof($222$231)==="string")){(value$239=$222$231);if(value$239.match(this)){return true;}else{return false;}}else{var other$244;(other$244=$222$231);return false;}}));return accum$213;})(),(function(){var accum$247;(accum$247=({}));(accum$247[":::project"]=(function($251$254){var ph$259;(ph$259=$251$254);var $256$265;($256$265=ph$259);var value$273;if((typeof($256$265)==="string")){(value$273=$256$265);var $276$281;($276$281=value$273.match(this));var m$289;if(($276$281===null)){(m$289=$276$281);return [false,null];}else{var m$294;(m$294=$276$281);return [true,m$294];}}else{var other$298;(other$298=$256$265);return [false,null];}}));return accum$247;})()));var temp$304;(temp$304=$437(__re_methods$8));var $length$310;($length$310=temp$304.length);var $index$316;($index$316=0);$12:for(;($index$316<$length$310);($index$316++)){var m$325;(m$325=temp$304[$index$316]);var t0$330;var t1$331;var k$335;var v$336;(t0$330=m$325);if(((t0$330 instanceof Array)&&(((t1$331=t0$330.length)),(t1$331===2)))){(k$335=t0$330[0]);(v$336=t0$330[1]);if((!$397(RegExp.prototype,k$335))){Object.defineProperty(RegExp.prototype,k$335,({"enumerable":false,"value":v$336}));}}else{$454(m$325);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$380(({"enumerable":false}),(function(){var accum$354;(accum$354=({}));(accum$354["value"]=(function(args$359){return this.apply(this,args$359);}));return accum$354;})()));}
var $1437=(function($1439$1442,key$1443){var ph$1451;(ph$1451=$1439$1442);var $1445$1457;($1445$1457=ph$1451);var bridge$1447$1462;(bridge$1447$1462=$1445$1457);if(((bridge$1447$1462===null)||(bridge$1447$1462===(void 0)))){return false;}else{var x$1474;if((typeof($1445$1457)==="string")){(x$1474=$1445$1457);return (key$1443 in String.prototype);}else{var x$1479;if((typeof($1445$1457)==="number")){(x$1479=$1445$1457);return (key$1443 in Number.prototype);}else{var x$1484;(x$1484=$1445$1457);return (key$1443 in x$1484);}}}});
var $1486=(function(type$1489){return (function(value$1493){var f$1497;(f$1497=type$1489[":::project"]);if((f$1497===(void 0))){(f$1497=type$1489["::project"]);if((f$1497===(void 0))){return [true,type$1489(value$1493)];}else{var rval$1510;(rval$1510=false);try{(rval$1510=[true,f$1497(value$1493)]);}catch(excv$1521){var e$1527;(e$1527=excv$1521);(rval$1510=[false,null]);}return rval$1510;}}else{return f$1497.call(type$1489,value$1493);}});});var accum$1393;var accum$1397;var $734$768;var Source$769;var Location$770;var highlight_locations$771;var $735$772;var tokenize$773;var $736$774;var parse$775;var $737$776;var translate$777;var Translator$778;var std$779;var exp$780;var opt$781;var $741$782;var Body$783;var vm$784;var module$785;var path$786;var version$787;var evaluator$788;var generate_from_ast$789;var generate$790;var Generator$791;($734$768=require("./location"));(Source$769=$734$768.Source);(Location$770=$734$768.Location);(highlight_locations$771=$734$768.highlight_locations);($735$772=require("./lex"));(tokenize$773=$735$772.tokenize);($736$774=require("./parse"));(parse$775=$736$774.parse);($737$776=require("./translate-js"));(translate$777=$737$776.translate);(Translator$778=$737$776.Translator);(std$779=require("./stdenv"));(exp$780=require("./expand"));(opt$781=require("./opt"));($741$782=require("./util"));(Body$783=$741$782.Body);(vm$784=require("vm"));(module$785=require("module"));(path$786=require("path"));(version$787="zero");(evaluator$788=(function($855$858){var t0$867;var accum$910;var paths$892;var e_module$893;var e_require$894;var $863$882;var $860$876;var ph$864;var options$865;(t0$867=$855$858);(options$865=t0$867);(ph$864=t0$867);($860$876=ph$864);$860$876;if(module$785._nodeModulePaths){(paths$892=module$785._nodeModulePaths(options$865.cwd));(e_module$893=(new module$785(options$865.showname)));$380(e_module$893,({"filename":options$865.filename,"paths":paths$892}));(e_require$894=(function(path$905){return module$785._load(path$905,e_module$893,true);}));$380(e_require$894,$380(({"main":e_module$893}),$380(((accum$910=({})),((accum$910["resolve"]=(function(path$915){return module$785._resolveFileName(path$915,e_module$893);})),accum$910)),({"paths":paths$892,"cache":require.cache}))));$380(global,({"__filename":options$865.filename,"__dirname":path$786.dirname(options$865.filename),"module":e_module$893,"require":e_require$894}));return (function(code$918){var script$922;(script$922=vm$784.createScript(code$918,options$865.showname));return script$922.runInThisContext();});}else{return (function(code$931){return eval(code$931);});}}));(generate_from_ast$789=(function(ast$938){var ex$945;var tr$946;var rval$947;(ex$945=std$779.expand(["top"],std$779.topscope,std$779.stdenv.fork().mark(["multi",ast$938])));(ex$945=opt$781.hoist(ex$945));(tr$946=Translator$778());(rval$947=tr$946.translate(ex$945,"expr"));return [tr$946.dump_store(),rval$947];}));std$779.stdenv.bind(std$779.topscope,"macro",["macro",(function(context$965,scope$966,form$967,$962$968){var t0$1036;var t1$1037;var prep$1029;var code$1030;var file$1031;var ev$1032;var mac$1033;var mac2$1034;var name$991;var sym$992;var arguments$993;var ast$994;var t0$983;var t1$984;var t2$985;var t3$986;var t4$987;var $970$978;var ph$972;(ph$972=$962$968);($970$978=ph$972);if((($970$978 instanceof Array)&&(((t0$983=$970$978.length)),((t0$983===3)&&(($970$978[0]==="data")&&(((t1$984=$970$978[1])),((t1$984 instanceof Array)&&(((t2$985=t1$984.length)),((t2$985===3)&&((t1$984[0]==="send")&&(((t3$986=t1$984[1])),((name$991=t3$986),((t3$986 instanceof Array)&&(((t4$987=t3$986.length)),((t4$987===2)&&(t3$986[0]==="symbol")))))))))))))))){(sym$992=t3$986[1]);(arguments$993=t1$984[2]);(ast$994=$970$978[2]);(t0$1036=generate_from_ast$789(["send",["symbol","->"],["data",arguments$993,ast$994]]));if(((t0$1036 instanceof Array)&&(((t1$1037=t0$1036.length)),(t1$1037===2)))){(prep$1029=t0$1036[0]);(code$1030=t0$1036[1]);}else{$454(generate_from_ast$789(["send",["symbol","->"],["data",arguments$993,ast$994]]),"/home/olivier/git/earl-grey/src/earl-grey.eg",1687,1727);}(file$1031=form$967.location.source.url);(ev$1032=evaluator$788(({"filename":file$1031,"showname":file$1031,"cwd":file$1031})));(mac$1033=ev$1032((prep$1029+((";("+code$1030)+")"))));(mac2$1034=(function(c$1063,s$1064,f$1065,e$1066){var bindings$1073;var env$1074;var r$1075;(bindings$1073=form$967.env.list_bindings(scope$966));(env$1074=exp$780.Env());(env$1074.scopes[std$779.topscope.name]=bindings$1073);(r$1075=mac$1033(c$1063,s$1064,f$1065,e$1066));return env$1074.mark(r$1075);}));return ["declare_raw",name$991,["macro",mac2$1034]];}else{$454($970$978);}})]);std$779.stdenv.bind(std$779.topscope,"macros",["macro",(function(context$1097,scope$1098,$1092$1099,$1094$1100){var t0$1105;var t0$1114;var t1$1115;var t0$1135;var t1$1136;var $index$1176;var $length$1170;var temp$1164;var acc$1158;var prep$1131;var code$1132;var the_macros$1133;var env$1102;var body$1103;(t0$1105=$1092$1099);if($1437(t0$1105,"env")){(env$1102=t0$1105.env);}else{$454($1092$1099);}(t0$1114=$1094$1100);if(((t0$1114 instanceof Array)&&(((t1$1115=t0$1114.length)),((t1$1115===2)&&(t0$1114[0]==="data"))))){(body$1103=t0$1114[1]);}else{$454($1094$1100);}(t0$1135=generate_from_ast$789(body$1103));if(((t0$1135 instanceof Array)&&(((t1$1136=t0$1135.length)),(t1$1136===2)))){(prep$1131=t0$1135[0]);(code$1132=t0$1135[1]);}else{$454(generate_from_ast$789(body$1103),"/home/olivier/git/earl-grey/src/earl-grey.eg",2655,2678);}(the_macros$1133=eval((((prep$1131+";(")+code$1132)+")")));return ["splice"].concat((((acc$1158=[])),(((temp$1164=$437(the_macros$1133))),((($length$1170=temp$1164.length)),((($index$1176=0)),(function(){$1153:for(;($index$1176<$length$1170);($index$1176++)){var k$1195;var v$1196;var t0$1190;var t1$1191;var m$1185;(m$1185=temp$1164[$index$1176]);(t0$1190=m$1185);if(((t0$1190 instanceof Array)&&(((t1$1191=t0$1190.length)),(t1$1191===2)))){(k$1195=t0$1190[0]);(v$1196=t0$1190[1]);acc$1158.push(["declare_raw",$380(["symbol",k$1195],({"env":env$1102})),["macro",v$1196]]);}else{$454(m$1185,"/home/olivier/git/earl-grey/src/earl-grey.eg",2765,2862);}}})()))),acc$1158));})]);(generate$790=(function(source$1215){return Generator$791().generate(source$1215);}));(Generator$791=(function(){var interactive$1242;var t0$1238;var $1229$1233;var it$0$1224;(it$0$1224=(function(){if((!$361(Generator$791)(this))){return Object.create(Generator$791.prototype);}else{return this;}})());($1229$1233=arguments);(t0$1238=$1229$1233.length);if(((t0$1238>=0)&&(t0$1238<=1))){(interactive$1242=(function(){if((0>=t0$1238)){return false;}else{return $1229$1233[0];}})());(it$0$1224["tr"]=Translator$778(std$779.stdprelude));(it$0$1224["env"]=std$779.stdenv.fork());(it$0$1224["interactive"]=interactive$1242);(it$0$1224["_eval"]=null);}else{$454($1229$1233);}return it$0$1224;}));(Generator$791.prototype["generate"]=(function(){var t0$1332;var t1$1333;var t2$1334;var args$1330;var stmt$1325;var t$1311;var p$1312;var ex$1313;var rval$1314;var source$1297;var dump$1298;var t0$1293;var $1276$1288;var it$0$1278;var self$1279;(it$0$1278=this);(self$1279=this);($1276$1288=arguments);(t0$1293=$1276$1288.length);if(((t0$1293>=1)&&(t0$1293<=2))){(source$1297=$1276$1288[0]);(dump$1298=(function(){if((1>=t0$1293)){return true;}else{return $1276$1288[1];}})());(t$1311=tokenize$773(source$1297));(p$1312=parse$775(t$1311));(ex$1313=(((stmt$1325=(function(){if(it$0$1278.interactive){(t0$1332=$1486(Body$783)(p$1312));if((t0$1332[0]&&(((t1$1333=t0$1332[1])),(((t2$1334=t1$1333.length)),(t2$1334>=0))))){(args$1330=Array.prototype.slice.call(t1$1333,0));}else{$454(p$1312,"/home/olivier/git/earl-grey/src/earl-grey.eg",3661,3662);}return ["interactive"].concat(args$1330);}else{return ["multi",p$1312];}})())),std$779.expand(["top"],std$779.topscope,it$0$1278.env.mark(stmt$1325))));(ex$1313=opt$781.hoist(ex$1313));(rval$1314=it$0$1278.tr.translate(ex$1313,"stmt"));if(dump$1298){return (it$0$1278.tr.dump_store()+rval$1314);}else{return rval$1314;}}else{$454($1276$1288);}}));(Generator$791.prototype["evaluate"]=(function(source$1366){var file$1383;var it$0$1370;var self$1371;(it$0$1370=this);(self$1371=this);if((!it$0$1370._eval)){(file$1383=source$1366.url);(it$0$1370["_eval"]=evaluator$788(({"filename":file$1383,"showname":file$1383,"cwd":file$1383})));}return it$0$1370._eval(it$0$1370.generate(source$1366));}));$380(Generator$791,$380(((accum$1393=({})),((accum$1393["::name"]="Generator"),accum$1393)),((accum$1397=({})),((accum$1397["::egclass"]=true),accum$1397))));Generator$791;(exports["evaluator"]=evaluator$788);(exports["Source"]=Source$769);(exports["Location"]=Location$770);(exports["highlight_locations"]=highlight_locations$771);(exports["tokenize"]=tokenize$773);(exports["parse"]=parse$775);(exports["Generator"]=Generator$791);(exports["generate"]=generate$790);(exports["version"]=version$787);
