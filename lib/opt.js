require("earlgrey-runtime");var hoist$7854;var hoistable$7855;var not_hoistable$7856;var hoist_helper$7857;(hoist$7854=(function(expr$7862){var t0$7869;var t1$7870;var b$7866;var inner$7867;(t0$7869=hoist_helper$7857(expr$7862));if(((t0$7869 instanceof Array)&&(((t1$7870=t0$7869.length)),(t1$7870===2)))){(b$7866=t0$7869[0]);(inner$7867=t0$7869[1]);}else{___match_error(hoist_helper$7857(expr$7862),"/home/olivier/git/eg/src/opt.eg",50,68);}return ["scope",inner$7867,b$7866];}));(hoistable$7855=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);(not_hoistable$7856=["void","js_while","js_for","js_for_in","js_label"]);(hoist_helper$7857=(function($7893$7896){var t0$7913;var x$7949;var x$7955;var bridge$7901$7941;var x$7961;var t0$7982;var t1$7983;var newbody$7979;var inner$7980;var t0$8007;var t1$8008;var newbody$8004;var inner$8005;var $index$8062;var $length$8056;var temp$8050;var acc$8044;var accum$8032;var newargs$8033;var $index$8138;var $length$8132;var temp$8126;var acc$8120;var newargs$8112;var other$8205;var type$8104;var args$8105;var type$8023;var args$8024;var vars$7998;var body$7999;var vars$7968;var body$7969;var $7907$7930;var $7908$7931;var $7909$7932;var bridge$7900$7927;var t0$7928;var $7898$7922;var ph$7910;var expr$7911;(t0$7913=$7893$7896);(expr$7911=t0$7913);(ph$7910=t0$7913);($7898$7922=ph$7910);(bridge$7900$7927=$7898$7922);if(((((bridge$7901$7941=bridge$7900$7927)),((((x$7949=bridge$7901$7941)),((x$7949 instanceof Array)&&(x$7949[0]==="symbol")))||(((x$7955=bridge$7901$7941)),((x$7955 instanceof Array)&&(x$7955[0]==="value")))))||(((x$7961=bridge$7900$7927)),((x$7961 instanceof Array)&&(x$7961[0]==="variable"))))){return [expr$7911,[]];}else{if((($7907$7930=($7898$7922 instanceof Array))&&(((t0$7928=$7898$7922.length)),(($7909$7932=(t0$7928===3))&&($7898$7922[0]==="scope"))))){(vars$7968=$7898$7922[1]);(body$7969=$7898$7922[2]);(t0$7982=hoist_helper$7857(body$7969));if(((t0$7982 instanceof Array)&&(((t1$7983=t0$7982.length)),(t1$7983===2)))){(newbody$7979=t0$7982[0]);(inner$7980=t0$7982[1]);}else{___match_error(hoist_helper$7857(body$7969),"/home/olivier/git/eg/src/opt.eg",1463,1481);}return [newbody$7979,inner$7980.concat(vars$7968)];}else{if(($7909$7932&&($7898$7922[0]==="lambda"))){(vars$7998=$7898$7922[1]);(body$7999=$7898$7922[2]);(t0$8007=hoist_helper$7857(body$7999));if(((t0$8007 instanceof Array)&&(((t1$8008=t0$8007.length)),(t1$8008===2)))){(newbody$8004=t0$8007[0]);(inner$8005=t0$8007[1]);}else{___match_error(hoist_helper$7857(body$7999),"/home/olivier/git/eg/src/opt.eg",1666,1684);}return [["lambda",vars$7998,["scope",inner$8005,newbody$8004]],[]];}else{if(($7907$7930&&(($7909$7932=(t0$7928>=1))&&((type$8023=$7898$7922[0]),((args$8024=Array.prototype.slice.call($7898$7922,1)),(hoistable$7855.indexOf(type$8023)!==-1)))))){(accum$8032=[]);(newargs$8033=(((acc$8044=[])),(((temp$8050=args$8024)),((($length$8056=temp$8050.length)),((($index$8062=0)),(function(){$8039:for(;($index$8062<$length$8056);($index$8062++)){var t0$8087;var t1$8088;var b$8084;var inner$8085;var arg$8079;var m$8071;(m$8071=temp$8050[$index$8062]);(arg$8079=m$8071);acc$8044.push(((((t0$8087=hoist_helper$7857(arg$8079))),(function(){if(((t0$8087 instanceof Array)&&(((t1$8088=t0$8087.length)),(t1$8088===2)))){(b$8084=t0$8087[0]);(inner$8085=t0$8087[1]);}else{return ___match_error(hoist_helper$7857(arg$8079),"/home/olivier/git/eg/src/opt.eg",2027,2044);}})()),(accum$8032=accum$8032.concat(inner$8085)),b$8084));}})()))),acc$8044));return [[type$8023].concat(newargs$8033),accum$8032];}else{if(($7909$7932&&((type$8104=$7898$7922[0]),((args$8105=Array.prototype.slice.call($7898$7922,1)),(not_hoistable$7856.indexOf(type$8104)!==-1))))){(newargs$8112=(((acc$8120=[])),(((temp$8126=args$8105)),((($length$8132=temp$8126.length)),((($index$8138=0)),(function(){$8115:for(;($index$8138<$length$8132);($index$8138++)){var t0$8166;var t1$8167;var other$8200;var t0$8187;var $8160$8182;var b$8163;var inner$8164;var arg$8155;var m$8147;(m$8147=temp$8126[$index$8138]);(arg$8155=m$8147);acc$8120.push(((((t0$8166=hoist_helper$7857(arg$8155))),(function(){if(((t0$8166 instanceof Array)&&(((t1$8167=t0$8166.length)),(t1$8167===2)))){(b$8163=t0$8166[0]);(inner$8164=t0$8166[1]);}else{return ___match_error(hoist_helper$7857(arg$8155),"/home/olivier/git/eg/src/opt.eg",2370,2387);}})()),((($8160$8182=inner$8164)),(function(){if((($8160$8182 instanceof Array)&&(((t0$8187=$8160$8182.length)),(t0$8187===0)))){return b$8163;}else{(other$8200=$8160$8182);return ["scope",inner$8164,b$8163];}})())));}})()))),acc$8120));return [[type$8104].concat(newargs$8112),[]];}else{(other$8205=$7898$7922);throw ErrorFactory(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$8205}));}}}}}}));(exports["hoist"]=hoist$7854);
