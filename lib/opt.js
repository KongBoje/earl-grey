var $8934=function(type$8936){var f$8939;(f$8939=type$8936["::check"]);if((f$8939===(void 0))){return function(value$8944){return (value$8944 instanceof type$8936);};}else{return function(value$8947){return f$8939.call(type$8936,value$8947);};}};
var $8949=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $8950=function(dest$8952,values$8953){var k$8958;(k$8958=null);$8956:for(k$8958 in values$8953){if(values$8953.hasOwnProperty(k$8958)){(dest$8952[k$8958]=values$8953[k$8958]);}}return dest$8952;};
var $8965=function($8966$8968){var ph$8972;(ph$8972=$8966$8968);var $8970$8977;($8970$8977=ph$8972);var bridge$8971$8982;var x$8986;(bridge$8971$8982=$8970$8977);if((((typeof(bridge$8971$8982)==="string")&&((x$8986=bridge$8971$8982),true))||((typeof(bridge$8971$8982)==="number")&&((x$8986=bridge$8971$8982),true)))){return ["value",x$8986];}else{var other$8996;(other$8996=$8970$8977);return other$8996["::serialize_ast"]();}};
var send$8741;(send$8741=function(obj$8746,$8744$8747){var ph$8751;var msg$8752;var t0$8754;(t0$8754=$8744$8747);(msg$8752=t0$8754);(ph$8751=t0$8754);var $8749$8761;($8749$8761=ph$8751);var bridge$8750$8766;(bridge$8750$8766=$8749$8761);if(((typeof(bridge$8750$8766)==="string")||(typeof(bridge$8750$8766)==="number"))){return obj$8746[msg$8752];}else{var other$8777;(other$8777=$8749$8761);return obj$8746["::send"](msg$8752);}});(Array[":::project"]=function($8782$8784){var ph$8787;var value$8788;var t0$8790;(t0$8790=$8782$8784);(value$8788=t0$8790);(ph$8787=t0$8790);var $8786$8797;($8786$8797=ph$8787);if($8934(Array)($8786$8797)){return [true,value$8788];}else{$8786$8797;return [true,[value$8788]];}});(Array.prototype["::check"]=function(value$8814){if((value$8814 instanceof Array)){var i$8819;(i$8819=0);$8817:for(;(i$8819<this.length);(i$8819++)){if(($8949(this,i$8819)!==$8949(value$8814,i$8819))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $8950(this.slice(0),this);});(Array.prototype[":::project"]=function(value$8836){if((value$8836 instanceof Array)){var i$8841;(i$8841=0);$8839:for(;(i$8841<this.length);(i$8841++)){if(($8949(this,i$8841)!==$8949(value$8836,i$8841))){return [true,[value$8836]];}}return [true,value$8836.slice(this.length)];}else{return [true,[value$8836]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($8965));});(RegExp.prototype["::check"]=function($8857$8859){var ph$8862;(ph$8862=$8857$8859);var $8861$8867;($8861$8867=ph$8862);var value$8875;if((typeof($8861$8867)==="string")){(value$8875=$8861$8867);if(value$8875.match(this)){return true;}else{return false;}}else{var other$8880;(other$8880=$8861$8867);return false;}});(RegExp.prototype[":::project"]=function($8885$8887){var ph$8890;(ph$8890=$8885$8887);var $8889$8895;($8889$8895=ph$8890);var value$8903;if((typeof($8889$8895)==="string")){(value$8903=$8889$8895);var $8906$8908;($8906$8908=value$8903.match(this));var m$8916;if(($8906$8908===null)){(m$8916=$8906$8908);return [false,null];}else{var m$8921;(m$8921=$8906$8908);return [true,m$8921];}}else{var other$8925;(other$8925=$8889$8895);return [false,null];}});(Function.prototype["::send"]=function(args$8931){return this.apply(this,args$8931);});
var $9519=function(arr$9521){var results$9525;var l$9526;(results$9525=[]);(l$9526=arr$9521.length);var i$9534;(i$9534=0);$9524:for(;(i$9534<l$9526);(i$9534++)){results$9525.push([i$9534,$8949(arr$9521,i$9534)]);}return results$9525;};
var $9323=function(){var $9324$9326;($9324$9326=function(tags$9330){var it$0$9333;(it$0$9333=function(){if((!$8934($9324$9326)(this))){return Object.create($9324$9326.prototype);}else{return this;}}());(it$0$9333["tags"]=tags$9330);return it$0$9333;});($9324$9326.prototype["create"]=function(){var $9345$9347;($9345$9347=arguments);var t0$9352;var message$9356;var args$9357;(t0$9352=$9345$9347.length);if((t0$9352>=0)){(message$9356=function(){if((0>=t0$9352)){return "";}else{return $9345$9347[0];}}());(args$9357=Array.prototype.slice.call($9345$9347,1));var it$0$9364;(it$0$9364=this);var self$9369;(self$9369=this);var e$9374;(e$9374=Error(message$9356));(e$9374["::tags"]=it$0$9364.tags);(e$9374["args"]=args$9357);var temp$9388;(temp$9388=$9519(args$9357));var $length$9393;($length$9393=temp$9388.length);var $index$9398;($index$9398=0);$9375:for(;($index$9398<$length$9393);($index$9398++)){var m$9406;(m$9406=temp$9388[$index$9398]);var t0$9411;var t1$9412;var i$9416;var arg$9417;(t0$9411=m$9406);if(((t0$9411 instanceof Array)&&(((t1$9412=t0$9411.length)),(t1$9412===2)))){(i$9416=t0$9411[0]);(arg$9417=t0$9411[1]);(e$9374[i$9416]=arg$9417);}else{$9307(m$9406);}}(e$9374["length"]=args$9357.length);(e$9374["name"]=["E"].concat(it$0$9364.tags).join("."));return e$9374;}else{$9307($9345$9347);}});($9324$9326.prototype["::check"]=function(e$9443){var it$0$9446;(it$0$9446=this);var self$9451;(self$9451=this);var tags$9456;if(((!e$9443)||(!$8934(Error)(e$9443)))){return false;}(tags$9456=(e$9443["::tags"]||[]));var temp$9465;(temp$9465=it$0$9446.tags);var $length$9470;($length$9470=temp$9465.length);var $index$9475;($index$9475=0);$9457:for(;($index$9475<$length$9470);($index$9475++)){var m$9483;(m$9483=temp$9465[$index$9475]);var tag$9491;(tag$9491=m$9483);if((tags$9456.indexOf(tag$9491)===-1)){return false;}else{false;}}return true;});($9324$9326.prototype["::deconstruct"]=function(e$9499){var it$0$9502;(it$0$9502=this);var self$9507;(self$9507=this);return e$9499.args;});$8950($9324$9326,$8950(function(){var accum$9512;(accum$9512=({}));(accum$9512["::name"]="$9324");return accum$9512;}(),function(){var accum$9516;(accum$9516=({}));(accum$9516["::egclass"]=true);return accum$9516;}()));return $9324$9326;}();
var $9307=function(value$9309,url$9310,start$9311,end$9312){var err$9315;(err$9315=$9323(["match"]).create("Could not find a match for value",({"value":value$9309})));if(url$9310){(err$9315["location"]=["location",url$9310,start$9311,end$9312]);}throw err$9315;};var hoist$9000;var hoistable$9001;var not_hoistable$9002;var hoist_helper$9003;(hoist$9000=function(expr$9007){var t0$9013;var t1$9014;var b$9010;var inner$9011;(t0$9013=hoist_helper$9003(expr$9007));if(((t0$9013 instanceof Array)&&(((t1$9014=t0$9013.length)),(t1$9014===2)))){(b$9010=t0$9013[0]);(inner$9011=t0$9013[1]);}else{$9307(hoist_helper$9003(expr$9007),"/home/olivier/git/earl-grey/src/opt.eg",50,72);}return ["scope",inner$9011,b$9010];});(hoistable$9001=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);(not_hoistable$9002=["void","js_while","js_for","js_for_in","js_label"]);(hoist_helper$9003=function($9034$9036){var t0$9047;var x$9078;var x$9083;var bridge$9040$9072;var x$9088;var t0$9107;var t1$9108;var newbody$9104;var inner$9105;var t0$9129;var t1$9130;var newbody$9126;var inner$9127;var $index$9175;var $length$9170;var temp$9165;var acc$9160;var accum$9150;var newargs$9151;var $index$9241;var $length$9236;var temp$9231;var acc$9226;var newargs$9220;var other$9300;var type$9213;var args$9214;var type$9143;var args$9144;var vars$9121;var body$9122;var vars$9095;var body$9096;var $9041$9062;var $9042$9063;var $9043$9064;var bridge$9039$9059;var t0$9060;var $9038$9054;var ph$9044;var expr$9045;(t0$9047=$9034$9036);(expr$9045=t0$9047);(ph$9044=t0$9047);($9038$9054=ph$9044);(bridge$9039$9059=$9038$9054);if(((((bridge$9040$9072=bridge$9039$9059)),((((x$9078=bridge$9040$9072)),((x$9078 instanceof Array)&&(x$9078[0]==="symbol")))||(((x$9083=bridge$9040$9072)),((x$9083 instanceof Array)&&(x$9083[0]==="value")))))||(((x$9088=bridge$9039$9059)),((x$9088 instanceof Array)&&(x$9088[0]==="variable"))))){return [expr$9045,[]];}else{if((($9041$9062=($9038$9054 instanceof Array))&&(((t0$9060=$9038$9054.length)),(($9043$9064=(t0$9060===3))&&($9038$9054[0]==="scope"))))){(vars$9095=$9038$9054[1]);(body$9096=$9038$9054[2]);(t0$9107=hoist_helper$9003(body$9096));if(((t0$9107 instanceof Array)&&(((t1$9108=t0$9107.length)),(t1$9108===2)))){(newbody$9104=t0$9107[0]);(inner$9105=t0$9107[1]);}else{$9307(hoist_helper$9003(body$9096),"/home/olivier/git/earl-grey/src/opt.eg",447,472);}return [newbody$9104,inner$9105.concat(vars$9095)];}else{if(($9043$9064&&($9038$9054[0]==="lambda"))){(vars$9121=$9038$9054[1]);(body$9122=$9038$9054[2]);(t0$9129=hoist_helper$9003(body$9122));if(((t0$9129 instanceof Array)&&(((t1$9130=t0$9129.length)),(t1$9130===2)))){(newbody$9126=t0$9129[0]);(inner$9127=t0$9129[1]);}else{$9307(hoist_helper$9003(body$9122),"/home/olivier/git/earl-grey/src/opt.eg",581,606);}return [["lambda",vars$9121,["scope",inner$9127,newbody$9126]],[]];}else{if(($9041$9062&&(($9043$9064=(t0$9060>=1))&&((type$9143=$9038$9054[0]),((args$9144=Array.prototype.slice.call($9038$9054,1)),(hoistable$9001.indexOf(type$9143)!==-1)))))){(accum$9150=[]);(newargs$9151=(((acc$9160=[])),(((temp$9165=args$9144)),((($length$9170=temp$9165.length)),((($index$9175=0)),function(){$9157:for(;($index$9175<$length$9170);($index$9175++)){var t0$9198;var t1$9199;var b$9195;var inner$9196;var arg$9191;var m$9183;(m$9183=temp$9165[$index$9175]);(arg$9191=m$9183);acc$9160.push(((((t0$9198=hoist_helper$9003(arg$9191))),function(){if(((t0$9198 instanceof Array)&&(((t1$9199=t0$9198.length)),(t1$9199===2)))){(b$9195=t0$9198[0]);(inner$9196=t0$9198[1]);}else{return $9307(hoist_helper$9003(arg$9191),"/home/olivier/git/earl-grey/src/opt.eg",779,806);}}()),(accum$9150=accum$9150.concat(inner$9196)),b$9195));}}()))),acc$9160));return [[type$9143].concat(newargs$9151),accum$9150];}else{if(($9043$9064&&((type$9213=$9038$9054[0]),((args$9214=Array.prototype.slice.call($9038$9054,1)),(not_hoistable$9002.indexOf(type$9213)!==-1))))){(newargs$9220=(((acc$9226=[])),(((temp$9231=args$9214)),((($length$9236=temp$9231.length)),((($index$9241=0)),function(){$9223:for(;($index$9241<$length$9236);($index$9241++)){var t0$9265;var t1$9266;var other$9295;var t0$9283;var $9261$9278;var b$9262;var inner$9263;var arg$9257;var m$9249;(m$9249=temp$9231[$index$9241]);(arg$9257=m$9249);acc$9226.push(((((t0$9265=hoist_helper$9003(arg$9257))),function(){if(((t0$9265 instanceof Array)&&(((t1$9266=t0$9265.length)),(t1$9266===2)))){(b$9262=t0$9265[0]);(inner$9263=t0$9265[1]);}else{return $9307(hoist_helper$9003(arg$9257),"/home/olivier/git/earl-grey/src/opt.eg",981,1008);}}()),((($9261$9278=inner$9263)),function(){if((($9261$9278 instanceof Array)&&(((t0$9283=$9261$9278.length)),(t0$9283===0)))){return b$9262;}else{(other$9295=$9261$9278);return ["scope",inner$9263,b$9262];}}())));}}()))),acc$9226));return [[type$9213].concat(newargs$9220),[]];}else{(other$9300=$9038$9054);throw $9323(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$9300}));}}}}}});(exports["hoist"]=hoist$9000);
