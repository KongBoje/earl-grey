var $5288=function(type$5290){var f$5293;(f$5293=type$5290["::check"]);;if((f$5293===(void 0))){return function(value$5298){return (value$5298 instanceof type$5290);};}else{return function(value$5301){return f$5293.call(type$5290,value$5301);};}};
var $5303=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $5304=function(temp$5305$5307){var ph$5311;(ph$5311=temp$5305$5307);;var m$5309$5316;(m$5309$5316=ph$5311);;var bridge$5310$5321;var x$5325;(bridge$5310$5321=m$5309$5316);if((((typeof(bridge$5310$5321)==="string")&&((x$5325=bridge$5310$5321),true))||((typeof(bridge$5310$5321)==="number")&&((x$5325=bridge$5310$5321),true)))){return ["value",x$5325];}else{var other$5332;(other$5332=m$5309$5316);return other$5332["::serialize_ast"]();}};
var send$5151;(send$5151=function(obj$5156,temp$5154$5157){var ph$5161;var msg$5162;var t0$5164;(t0$5164=temp$5154$5157);(msg$5162=t0$5164);(ph$5161=t0$5164);;var m$5159$5168;(m$5159$5168=ph$5161);;var bridge$5160$5173;(bridge$5160$5173=m$5159$5168);if(((typeof(bridge$5160$5173)==="string")||(typeof(bridge$5160$5173)==="number"))){return obj$5156[msg$5162];}else{var other$5181;(other$5181=m$5159$5168);return obj$5156["::send"](msg$5162);}});;(Array[":::project"]=function(temp$5184$5186){var ph$5189;var value$5190;var t0$5192;(t0$5192=temp$5184$5186);(value$5190=t0$5192);(ph$5189=t0$5192);;var m$5188$5196;(m$5188$5196=ph$5189);;if($5288(Array)(m$5188$5196)){return [true,value$5190];}else{m$5188$5196;return [true,[value$5190]];}});(Array.prototype["::check"]=function(value$5210){if((value$5210 instanceof Array)){var i$5215;(i$5215=0);;$5213:for(;(i$5215<this.length);(i$5215++)){if(($5303(this,i$5215)!==$5303(value$5210,i$5215))){return false;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value$5224){if((value$5224 instanceof Array)){var i$5229;(i$5229=0);;$5227:for(;(i$5229<this.length);(i$5229++)){if(($5303(this,i$5229)!==$5303(value$5224,i$5229))){return [true,[value$5224]];}}return [true,value$5224.slice(this.length)];}else{return [true,[value$5224]];}});(Array.prototype[":::deconstruct"]=function(value$5238){return [true,value$5238.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($5304));});(RegExp.prototype["::check"]=function(value$5243){return value$5243.match(this);});(RegExp.prototype[":::project"]=function(value$5246){var m$5248$5250;(m$5248$5250=value$5246.match(this));;var m$5258;if((m$5248$5250===null)){(m$5258=m$5248$5250);return [false,null];}else{var m$5263;(m$5263=m$5248$5250);return [true,m$5263];}});(RegExp.prototype[":::deconstruct"]=function(value$5266){var m$5268$5270;(m$5268$5270=value$5266.match(this));;var m$5278;if((m$5268$5270===null)){(m$5278=m$5268$5270);return [false,null];}else{var m$5283;(m$5283=m$5268$5270);return [true,m$5283];}});(Function.prototype["::send"]=function(args$5286){return this.apply(this,args$5286);});
var $5697=function(dest$5699,values$5700){var k$5705;(k$5705=null);$5703:for(k$5705 in values$5700){if(values$5700.hasOwnProperty(k$5705)){(dest$5699[k$5705]=values$5700[k$5705]);}}return dest$5699;};
var $5591=function(){var $5592$5594;($5592$5594=function(tags$5598){var it$0$5601;(it$0$5601=function(){if((!$5288($5592$5594)(this))){return Object.create($5592$5594.prototype);}else{return this;}}());;(it$0$5601["tags"]=tags$5598);return it$0$5601;});;($5592$5594.prototype["create"]=function(){var m$5610$5612;(m$5610$5612=arguments);;var t0$5617;var message$5621;var args$5622;(t0$5617=m$5610$5612.length);if((t0$5617>=0)){(message$5621=function(){if((0>=t0$5617)){return "";}else{return m$5610$5612[0];}}());(args$5622=Array.prototype.slice.call(m$5610$5612,1));var it$0$5626;(it$0$5626=this);;var e$5631;(e$5631=Error(message$5621));;(e$5631["::tags"]=it$0$5626.tags);(e$5631["args"]=args$5622);(e$5631["name"]=["E"].concat(it$0$5626.tags).join("."));return e$5631;}else{throw Error("mismatch!!");}});($5592$5594.prototype["::check"]=function(e$5640){var it$0$5643;(it$0$5643=this);;var tags$5648;if(((!e$5640)||(!$5288(Error)(e$5640)))){return false;}(tags$5648=(e$5640["::tags"]||[]));;var temp$5656;(temp$5656=it$0$5643.tags);;var len$5661;(len$5661=temp$5656.length);;var i$5666;(i$5666=0);;$5653:for(;(i$5666<len$5661);(i$5666++)){var m$5674;(m$5674=temp$5656[i$5666]);;var tag$5682;(tag$5682=m$5674);if((tags$5648.indexOf(tag$5682)===(-1))){return false;}else{false;;}}return true;});($5592$5594.prototype["::deconstruct"]=function(e$5690){var it$0$5693;(it$0$5693=this);;return e$5690.args;});$5697($5592$5594,({}));return $5592$5594;}();var hoist$5336;var hoistable$5337;var not_hoistable$5338;var hoist_helper$5339;(hoist$5336=function(expr$5343){var t0$5349;var t1$5350;var b$5346;var inner$5347;(t0$5349=hoist_helper$5339(expr$5343));if(((t0$5349 instanceof Array)&&((t1$5350=t0$5349.length),(t1$5350===2)))){(b$5346=t0$5349[0]);(inner$5347=t0$5349[1]);;}else{throw Error("Mismatch");}return ["scope",inner$5347,b$5346];});;(hoistable$5337=["send","array","object","multi","if","assign","js_break","js_continue","js_return","js_delete","js_throw","js_try","js_new"]);;(not_hoistable$5338=["void","js_while","js_for","js_for_in","js_label"]);;(hoist_helper$5339=function(temp$5364$5366){var t0$5377;var x$5399;var x$5404;var bridge$5370$5396;var x$5409;var t0$5425;var t1$5426;var newbody$5422;var inner$5423;var t0$5441;var t1$5442;var newbody$5438;var inner$5439;var i$5480;var len$5475;var temp$5470;var acc$5465;var accum$5456;var newargs$5457;var i$5538;var len$5533;var temp$5528;var acc$5523;var newargs$5518;var other$5587;var type$5511;var args$5512;var type$5449;var args$5450;var vars$5433;var body$5434;var vars$5416;var body$5417;var $5371$5389;var $5372$5390;var $5373$5391;var bridge$5369$5386;var t0$5387;var m$5368$5381;var ph$5374;var expr$5375;(t0$5377=temp$5364$5366);(ph$5374=t0$5377);(expr$5375=t0$5377);;(m$5368$5381=ph$5374);;(bridge$5369$5386=m$5368$5381);if((((bridge$5370$5396=bridge$5369$5386),((((x$5399=bridge$5370$5396)),((x$5399 instanceof Array)&&(x$5399[0]==="symbol")))||(((x$5404=bridge$5370$5396)),((x$5404 instanceof Array)&&(x$5404[0]==="value")))))||(((x$5409=bridge$5369$5386)),((x$5409 instanceof Array)&&(x$5409[0]==="variable"))))){return [expr$5375,[]];}else{if((($5371$5389=(m$5368$5381 instanceof Array))&&((t0$5387=m$5368$5381.length),(($5373$5391=(t0$5387===3))&&(m$5368$5381[0]==="scope"))))){(vars$5416=m$5368$5381[1]);(body$5417=m$5368$5381[2]);(t0$5425=hoist_helper$5339(body$5417));if(((t0$5425 instanceof Array)&&((t1$5426=t0$5425.length),(t1$5426===2)))){(newbody$5422=t0$5425[0]);(inner$5423=t0$5425[1]);;}else{throw Error("Mismatch");}return [newbody$5422,inner$5423.concat(vars$5416)];}else{if(($5373$5391&&(m$5368$5381[0]==="lambda"))){(vars$5433=m$5368$5381[1]);(body$5434=m$5368$5381[2]);(t0$5441=hoist_helper$5339(body$5434));if(((t0$5441 instanceof Array)&&((t1$5442=t0$5441.length),(t1$5442===2)))){(newbody$5438=t0$5441[0]);(inner$5439=t0$5441[1]);;}else{throw Error("Mismatch");}return [["lambda",vars$5433,["scope",inner$5439,newbody$5438]],[]];}else{if(($5371$5389&&(($5373$5391=(t0$5387>=1))&&((type$5449=m$5368$5381[0]),((args$5450=Array.prototype.slice.call(m$5368$5381,1)),(hoistable$5337.indexOf(type$5449)!==(-1))))))){(accum$5456=[]);;(newargs$5457=(((acc$5465=[])),(((temp$5470=args$5450)),(((len$5475=temp$5470.length)),(((i$5480=0)),function(){$5463:for(;(i$5480<len$5475);(i$5480++)){var t0$5502;var t1$5503;var b$5499;var inner$5500;var arg$5496;var m$5488;(m$5488=temp$5470[i$5480]);;(arg$5496=m$5488);acc$5465.push((((t0$5502=hoist_helper$5339(arg$5496)),function(){if(((t0$5502 instanceof Array)&&((t1$5503=t0$5502.length),(t1$5503===2)))){(b$5499=t0$5502[0]);(inner$5500=t0$5502[1]);}else{throw Error("Mismatch");}}()),(accum$5456=accum$5456.concat(inner$5500)),b$5499));}}()))),acc$5465));;return [[type$5449].concat(newargs$5457),accum$5456];}else{if(($5373$5391&&((type$5511=m$5368$5381[0]),((args$5512=Array.prototype.slice.call(m$5368$5381,1)),(not_hoistable$5338.indexOf(type$5511)!==(-1)))))){(newargs$5518=(((acc$5523=[])),(((temp$5528=args$5512)),(((len$5533=temp$5528.length)),(((i$5538=0)),function(){$5521:for(;(i$5538<len$5533);(i$5538++)){var t0$5561;var t1$5562;var other$5582;var t0$5573;var m$5557$5568;var b$5558;var inner$5559;var arg$5554;var m$5546;(m$5546=temp$5528[i$5538]);;(arg$5554=m$5546);acc$5523.push((((t0$5561=hoist_helper$5339(arg$5554)),function(){if(((t0$5561 instanceof Array)&&((t1$5562=t0$5561.length),(t1$5562===2)))){(b$5558=t0$5561[0]);(inner$5559=t0$5561[1]);}else{throw Error("Mismatch");}}()),(((m$5557$5568=inner$5559)),function(){if(((m$5557$5568 instanceof Array)&&((t0$5573=m$5557$5568.length),(t0$5573===0)))){return b$5558;}else{(other$5582=m$5557$5568);return ["scope",inner$5559,b$5558];}}())));}}()))),acc$5523));;return [[type$5511].concat(newargs$5518),[]];}else{(other$5587=m$5368$5381);throw $5591(["syntax","illegal"]).create("Illegal node -- this should not happen.",({"node":other$5587}));}}}}}});;(exports["hoist"]=hoist$5336);
