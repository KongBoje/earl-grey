var $20278=function(type$20281){var f$20285;(f$20285=type$20281["::check"]);if((f$20285===(void 0))){return function(value$20291){return (value$20291 instanceof type$20281);};}else{return function(value$20295){return f$20285.call(type$20281,value$20295);};}};
var $20297=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $20298=function(dest$20301,values$20302){var k$20307;(k$20307=null);$20305:for(k$20307 in values$20302){if(values$20302.hasOwnProperty(k$20307)){(dest$20301[k$20307]=values$20302[k$20307]);}}return dest$20301;};
var $20315=function($20317$20320){var ph$20326;(ph$20326=$20317$20320);var $20322$20332;($20322$20332=ph$20326);var bridge$20324$20337;var x$20341;(bridge$20324$20337=$20322$20332);if((((typeof(bridge$20324$20337)==="string")&&((x$20341=bridge$20324$20337),true))||((typeof(bridge$20324$20337)==="number")&&((x$20341=bridge$20324$20337),true)))){return ["value",x$20341];}else{var other$20352;(other$20352=$20322$20332);return other$20352["::serialize_ast"]();}};
var send$20052;(send$20052=function(obj$20059,$20056$20060){var ph$20066;var msg$20067;var t0$20069;(t0$20069=$20056$20060);(msg$20067=t0$20069);(ph$20066=t0$20069);var $20062$20078;($20062$20078=ph$20066);var bridge$20064$20083;(bridge$20064$20083=$20062$20078);if(((typeof(bridge$20064$20083)==="string")||(typeof(bridge$20064$20083)==="number"))){return obj$20059[msg$20067];}else{var other$20095;(other$20095=$20062$20078);return obj$20059["::send"](msg$20067);}});(Array[":::project"]=function($20101$20104){var ph$20109;var value$20110;var t0$20112;(t0$20112=$20101$20104);(value$20110=t0$20112);(ph$20109=t0$20112);var $20106$20121;($20106$20121=ph$20109);if($20278(Array)($20106$20121)){return [true,value$20110];}else{$20106$20121;return [true,[value$20110]];}});(Array.prototype["::check"]=function(value$20139){if((value$20139 instanceof Array)){var i$20145;(i$20145=0);$20142:for(;(i$20145<this.length);(i$20145++)){if(($20297(this,i$20145)!==$20297(value$20139,i$20145))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $20298(this.slice(0),this);});(Array.prototype[":::project"]=function(value$20164){if((value$20164 instanceof Array)){var i$20170;(i$20170=0);$20167:for(;(i$20170<this.length);(i$20170++)){if(($20297(this,i$20170)!==$20297(value$20164,i$20170))){return [true,[value$20164]];}}return [true,value$20164.slice(this.length)];}else{return [true,[value$20164]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($20315));});(RegExp.prototype["::check"]=function($20188$20191){var ph$20196;(ph$20196=$20188$20191);var $20193$20202;($20193$20202=ph$20196);var value$20210;if((typeof($20193$20202)==="string")){(value$20210=$20193$20202);if(value$20210.match(this)){return true;}else{return false;}}else{var other$20215;(other$20215=$20193$20202);return false;}});(RegExp.prototype[":::project"]=function($20221$20224){var ph$20229;(ph$20229=$20221$20224);var $20226$20235;($20226$20235=ph$20229);var value$20243;if((typeof($20226$20235)==="string")){(value$20243=$20226$20235);var $20246$20251;($20246$20251=value$20243.match(this));var m$20259;if(($20246$20251===null)){(m$20259=$20246$20251);return [false,null];}else{var m$20264;(m$20264=$20246$20251);return [true,m$20264];}}else{var other$20268;(other$20268=$20226$20235);return [false,null];}});(Function.prototype["::send"]=function(args$20275){return this.apply(this,args$20275);});
var $21349=function(type$21352){return function(value$21356){var f$21360;(f$21360=type$21352[":::project"]);if((f$21360===(void 0))){(f$21360=type$21352["::project"]);if((f$21360===(void 0))){return [true,type$21352(value$21356)];}else{var rval$21373;(rval$21373=false);try{(rval$21373=[true,f$21360(value$21356)]);}catch(excv$21384){var e$21390;(e$21390=excv$21384);(rval$21373=[false,null]);}return rval$21373;}}else{return f$21360.call(type$21352,value$21356);}};};
var $21648=function(arr$21651){var results$21657;var l$21658;(results$21657=[]);(l$21658=arr$21651.length);var i$21667;(i$21667=0);$21656:for(;(i$21667<l$21658);(i$21667++)){results$21657.push([i$21667,$20297(arr$21651,i$21667)]);}return results$21657;};
var $21415=function(){var $21416$21422;($21416$21422=function(tags$21427){var it$0$21430;(it$0$21430=function(){if((!$20278($21416$21422)(this))){return Object.create($21416$21422.prototype);}else{return this;}}());(it$0$21430["tags"]=tags$21427);return it$0$21430;});($21416$21422.prototype["create"]=function(){var it$0$21450;var self$21451;(it$0$21450=this);(self$21451=this);var $21448$21460;($21448$21460=arguments);var t0$21465;var message$21469;var args$21470;(t0$21465=$21448$21460.length);if((t0$21465>=0)){(message$21469=function(){if((0>=t0$21465)){return "";}else{return $21448$21460[0];}}());(args$21470=Array.prototype.slice.call($21448$21460,1));var e$21483;(e$21483=Error(message$21469));(e$21483["::tags"]=it$0$21450.tags);(e$21483["args"]=args$21470);var temp$21499;(temp$21499=$21648(args$21470));var $length$21505;($length$21505=temp$21499.length);var $index$21511;($index$21511=0);$21484:for(;($index$21511<$length$21505);($index$21511++)){var m$21520;(m$21520=temp$21499[$index$21511]);var t0$21525;var t1$21526;var i$21530;var arg$21531;(t0$21525=m$21520);if(((t0$21525 instanceof Array)&&(((t1$21526=t0$21525.length)),(t1$21526===2)))){(i$21530=t0$21525[0]);(arg$21531=t0$21525[1]);(e$21483[i$21530]=arg$21531);}else{$21396(m$21520);}}(e$21483["length"]=args$21470.length);(e$21483["name"]=["E"].concat(it$0$21450.tags).join("."));return e$21483;}else{$21396($21448$21460);}});($21416$21422.prototype["::check"]=function(e$21561){var it$0$21565;var self$21566;(it$0$21565=this);(self$21566=this);var tags$21576;if(((!e$21561)||(!$20278(Error)(e$21561)))){return false;}(tags$21576=(e$21561["::tags"]||[]));var temp$21587;(temp$21587=it$0$21565.tags);var $length$21593;($length$21593=temp$21587.length);var $index$21599;($index$21599=0);$21577:for(;($index$21599<$length$21593);($index$21599++)){var m$21608;(m$21608=temp$21587[$index$21599]);var tag$21616;(tag$21616=m$21608);if((tags$21576.indexOf(tag$21616)===-1)){return false;}else{false;}}return true;});($21416$21422.prototype["::deconstruct"]=function(e$21625){var it$0$21629;var self$21630;(it$0$21629=this);(self$21630=this);return e$21625.args;});$20298($21416$21422,$20298(function(){var accum$21641;(accum$21641=({}));(accum$21641["::name"]="$21416");return accum$21641;}(),function(){var accum$21645;(accum$21645=({}));(accum$21645["::egclass"]=true);return accum$21645;}()));return $21416$21422;}();
var $21396=function(value$21399,url$21400,start$21401,end$21402){var err$21406;(err$21406=$21415(["match"]).create("Could not find a match for value",({"value":value$21399})));if(url$21400){(err$21406["location"]=["location",url$21400,start$21401,end$21402]);}throw err$21406;};
var $21181=function(){var $21182$21186;($21182$21186=function($21190$21195,$21192$21196){var it$0$21199;(it$0$21199=function(){if((!$20278($21182$21186)(this))){return Object.create($21182$21186.prototype);}else{return this;}}());var classes$21205;var children$21206;var t0$21208;(t0$21208=$21349(Array)($21190$21195));if(t0$21208[0]){(classes$21205=t0$21208[1]);}else{$21396($21190$21195);}var t0$21217;(t0$21217=$21349(Array)($21192$21196));if(t0$21217[0]){(children$21206=t0$21217[1]);}else{$21396($21192$21196);}(it$0$21199["classes"]=classes$21205.sort());(it$0$21199["children"]=children$21206);return it$0$21199;});$20298(function(){var accum$21240;(accum$21240=({}));(accum$21240["::check"]=function(x$21245){return ((x$21245&&x$21245.classes)&&x$21245.children);});return accum$21240;}(),$20298(function(){var accum$21248;(accum$21248=({}));(accum$21248["::deconstruct"]=function(x$21253){return [x$21253.classes,x$21253.children];});return accum$21248;}(),$20298(function(){var accum$21256;(accum$21256=({}));(accum$21256["::name"]="$21182");return accum$21256;}(),function(){var accum$21260;(accum$21260=({}));(accum$21260["::egclass"]=true);return accum$21260;}())));($21182$21186.prototype["::check"]=function(n$21267){var it$0$21271;var self$21272;(it$0$21271=this);(self$21272=this);var temp$21287;(temp$21287=it$0$21271.classes);var $length$21293;($length$21293=temp$21287.length);var $index$21299;($index$21299=0);$21281:for(;($index$21299<$length$21293);($index$21299++)){var m$21308;(m$21308=temp$21287[$index$21299]);var c$21316;(c$21316=m$21308);if((n$21267.classes.indexOf(c$21316)===-1)){return false;}else{false;}}return true;});$20298($21182$21186,$20298(function(){var accum$21326;(accum$21326=({}));(accum$21326["::check"]=function(x$21331){return ((x$21331&&x$21331.classes)&&x$21331.children);});return accum$21326;}(),$20298(function(){var accum$21334;(accum$21334=({}));(accum$21334["::deconstruct"]=function(x$21339){return [x$21339.classes,x$21339.children];});return accum$21334;}(),$20298(function(){var accum$21342;(accum$21342=({}));(accum$21342["::name"]="$21182");return accum$21342;}(),function(){var accum$21346;(accum$21346=({}));(accum$21346["::egclass"]=true);return accum$21346;}()))));return $21182$21186;}();
var $21674=function(obj$21677){var results$21682;(results$21682=[]);var k$21687;(k$21687=null);$21681:for(k$21687 in obj$21677){if(Object.prototype.hasOwnProperty.call(obj$21677,k$21687)){results$21682.push([k$21687,$20297(obj$21677,k$21687)]);}}return results$21682;};
var $21691=function($21693$21696,key$21697){var ph$21705;(ph$21705=$21693$21696);var $21699$21711;($21699$21711=ph$21705);var bridge$21701$21716;(bridge$21701$21716=$21699$21711);if(((bridge$21701$21716===null)||(bridge$21701$21716===(void 0)))){return false;}else{var x$21728;if((typeof($21699$21711)==="string")){(x$21728=$21699$21711);return (key$21697 in String.prototype);}else{var x$21733;if((typeof($21699$21711)==="number")){(x$21733=$21699$21711);return (key$21697 in Number.prototype);}else{var x$21738;(x$21738=$21699$21711);return (key$21697 in x$21738);}}}};var pr_terminus$20363;var pr$20364;var __lt____gt__$20365;var repr$20366;var escape_html$20367;var quotify$20368;var HTML$20369;(pr_terminus$20363=function(node$20374){var r$20380;var pre$20381;var post$20382;(r$20380=HTML$20369(node$20374,"span"));(pre$20381=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));(post$20382=("</div>"+String.fromCharCode(7)));return console.log(((pre$20381+r$20380)+post$20382));});(pr$20364=function($20396$20399,r$20400){var x$20424;var n$20419;var $20402$20411;var ph$20405;(ph$20405=$20396$20399);($20402$20411=ph$20405);if($20278($21181)($20402$20411)){(n$20419=$20402$20411);return pr_terminus$20363(n$20419);}else{(x$20424=$20402$20411);return pr_terminus$20363((r$20400||repr$20366)(x$20424));}});(__lt____gt__$20365=function($20430$20433,x$20434){if(($20430$20433===null)){}else{$21396($20430$20433);}return pr$20364(x$20434);});(repr$20366=function(){var $index$20553;var $length$20547;var temp$20541;var acc$20535;var $index$20604;var $length$20598;var temp$20592;var acc$20586;var other$20641;var entries$20523;var $20458$20496;var t0$20494;var x$20472;var recur$20473;var $20447$20474;var t0$20466;var t1$20467;var t2$20468;var $20445$20461;($20445$20461=arguments);(t0$20466=$20445$20461.length);if((((t0$20466>=1)&&(t0$20466<=2))&&(((t1$20467=$20445$20461[0])),((x$20472=t1$20467),(($20447$20474=t1$20467),(((t2$20468=function(){if((1>=t0$20466)){return repr$20366;}else{return $20445$20461[1];}}())),$20278(Function)(t2$20468))))))){(recur$20473=t2$20468);if(($20447$20474===true)){return $21181(["special","true"],"true");}else{if(($20447$20474===false)){return $21181(["special","false"],"false");}else{if(($20447$20474===null)){return $21181(["special","nil"],"null");}else{if(($20447$20474===(void 0))){return $21181(["special","nil"],"undefined");}else{if((typeof($20447$20474)==="number")){return $21181(["num"],String(x$20472));}else{if((typeof($20447$20474)==="string")){return $21181(["str"],x$20472);}else{(t0$20494=$20447$20474);if($20278(Array)(t0$20494)){(entries$20523=t0$20494);return $21181(["sequence"],(((acc$20535=[])),(((temp$20541=entries$20523)),((($length$20547=temp$20541.length)),((($index$20553=0)),function(){$20530:for(;($index$20553<$length$20547);($index$20553++)){var x$20570;var m$20562;(m$20562=temp$20541[$index$20553]);(x$20570=m$20562);acc$20535.push(recur$20473(x$20570,repr$20366));}}()))),acc$20535));}else{$20447$20474;if(x$20472["::repr"]){return x$20472["::repr"](recur$20473);}else{if((Object.getPrototypeOf(x$20472)===Object.prototype)){return $21181(["+table","object"],(((acc$20586=[])),(((temp$20592=$21674(x$20472))),((($length$20598=temp$20592.length)),((($index$20604=0)),function(){$20581:for(;($index$20604<$length$20598);($index$20604++)){var k$20623;var v$20624;var t0$20618;var t1$20619;var m$20613;(m$20613=temp$20592[$index$20604]);(t0$20618=m$20613);if(((t0$20618 instanceof Array)&&(((t1$20619=t0$20618.length)),(t1$20619===2)))){(k$20623=t0$20618[0]);(v$20624=t0$20618[1]);acc$20586.push($21181(["+tr"],[$21181(["+th"],recur$20473(k$20623,repr$20366)),$21181(["+td"],recur$20473(v$20624,repr$20366))]));}else{$21396(m$20613,"/home/olivier/git/earl-grey/src/pp.eg",914,1244);}}}()))),acc$20586));}else{(other$20641=$20447$20474);return $21181(["unknown"],other$20641.toString());}}}}}}}}}}else{$21396($20445$20461);}});(escape_html$20367=function($20649$20652){var t0$20656;var repl$20666;var s$20654;(t0$20656=[true,String($20649$20652)]);if(t0$20656[0]){(s$20654=t0$20656[1]);}else{$21396($20649$20652);}(repl$20666=({"&":"&amp;","<":"&lt;",">":"&gt;"}));return s$20654.replace(RegExp("[&<>]","g"),function(x$20672){return $20297(repl$20666,x$20672);});});(quotify$20368=function($20678$20681){var t0$20685;var s$20683;(t0$20685=[true,String($20678$20681)]);if(t0$20685[0]){(s$20683=t0$20685[1]);}else{$21396($20678$20681);}return s$20683.replace(RegExp("[\"\\\\]","g"),function(x$20695){return ("\\"+x$20695);});});(HTML$20369=function($20701$20704,default_tag$20705){var $index$20758;var $length$20752;var temp$20746;var acc$20740;var $index$20843;var $length$20837;var temp$20831;var $index$20978;var $length$20972;var temp$20966;var acc$20960;var $index$21058;var $length$21052;var temp$21046;var acc$21040;var $index$21116;var $length$21110;var temp$21104;var acc$21098;var other$21091;var $21019$21024;var x$21155;var other$21151;var $20793$21139;var tag$20796;var _classes$20797;var id$20798;var kv$20799;var sub$20800;var accum$20801;var children2$20802;var other$21161;var classes$20780;var children$20781;var children$20731;var s$20726;var $20707$20718;var ph$20712;(ph$20712=$20701$20704);($20707$20718=ph$20712);if((typeof($20707$20718)==="string")){(s$20726=$20707$20718);return escape_html$20367(s$20726);}else{if($20278(Array)($20707$20718)){(children$20731=$20707$20718);return (((acc$20740=[])),(((temp$20746=children$20731)),((($length$20752=temp$20746.length)),((($index$20758=0)),function(){$20735:for(;($index$20758<$length$20752);($index$20758++)){var child$20775;var m$20767;(m$20767=temp$20746[$index$20758]);(child$20775=m$20767);acc$20740.push(HTML$20369(child$20775,default_tag$20705));}}()))),acc$20740).join("");}else{if(($20278($21181)($20707$20718)&&($21691($20707$20718,"classes")&&((classes$20780=$20707$20718.classes),$21691($20707$20718,"children"))))){(children$20781=$20707$20718.children);(tag$20796=(default_tag$20705||"span"));(_classes$20797=[]);(id$20798=null);(kv$20799=[]);(sub$20800=[]);(temp$20831=classes$20780);($length$20837=temp$20831.length);($index$20843=0);$20803:for(;($index$20843<$length$20837);($index$20843++)){var s$20932;var m$20909;var m$20886;var k$20881;var k$20866;var v$20867;var $20810$20861;var $20811$20862;var $20812$20863;var t0$20857;var t1$20858;var t2$20859;var m$20852;(m$20852=temp$20831[$index$20843]);(t0$20857=m$20852);if((($20811$20862=(t0$20857 instanceof Array))&&(((t1$20858=t0$20857.length)),((t1$20858===3)&&(t0$20857[0]==="assoc"))))){(k$20866=t0$20857[1]);(v$20867=t0$20857[2]);kv$20799.push([k$20866,v$20867]);}else{if(($20811$20862&&((t1$20858===2)&&(t0$20857[0]==="assoc")))){(k$20881=t0$20857[1]);kv$20799.push([k$20881,(void 0)]);}else{(t0$20857=$21349(RegExp("(?:^\\+((?:.*)))",""))(m$20852));if((t0$20857[0]&&(((t1$20858=t0$20857[1])),(((t2$20859=t1$20858.length)),(t2$20859===2))))){t1$20858[0];(m$20886=t1$20858[1]);(tag$20796=m$20886);}else{(t0$20857=$21349(RegExp("(?:^#((?:.*)))",""))(m$20852));if((t0$20857[0]&&(((t1$20858=t0$20857[1])),(((t2$20859=t1$20858.length)),(t2$20859===2))))){t1$20858[0];(m$20909=t1$20858[1]);(id$20798=m$20909);}else{(t0$20857=m$20852);if((typeof(t0$20857)==="string")){(s$20932=t0$20857);_classes$20797.push(s$20932);}else{$21396(m$20852,"/home/olivier/git/earl-grey/src/pp.eg",1823,2150);}}}}}}(accum$20801=function(){if((tag$20796==="raw")){return [];}else{return ["<",tag$20796];}}());if(id$20798){(accum$20801=accum$20801.concat(" id=\"",id$20798,"\""));}if(_classes$20797.length){(accum$20801=accum$20801.concat(" class=\"",quotify$20368(_classes$20797.join(" ")),"\""));}if(kv$20799){(acc$20960=[]);(temp$20966=kv$20799);($length$20972=temp$20966.length);($index$20978=0);$20955:for(;($index$20978<$length$20972);($index$20978++)){var k$20997;var v$20998;var t0$20992;var t1$20993;var m$20987;(m$20987=temp$20966[$index$20978]);(t0$20992=m$20987);if(((t0$20992 instanceof Array)&&(((t1$20993=t0$20992.length)),(t1$20993===2)))){(k$20997=t0$20992[0]);(v$20998=t0$20992[1]);acc$20960.push(((accum$20801=accum$20801.concat(function(){if((v$20998!==null)){return [" ",k$20997,"=\"",quotify$20368(v$20998),"\""];}else{return [" ",k$20997];}}()))));}else{$21396(m$20987,"/home/olivier/git/earl-grey/src/pp.eg",2414,2614);}}acc$20960;}(children2$20802=((($21019$21024=tag$20796)),function(){if(($21019$21024==="raw")){(acc$21040=[]);(temp$21046=children$20781);($length$21052=temp$21046.length);($index$21058=0);$21034:for(;($index$21058<$length$21052);($index$21058++)){var c$21086;var s$21076;var t0$21072;var m$21067;(m$21067=temp$21046[$index$21058]);(t0$21072=m$21067);if((typeof(t0$21072)==="string")){(s$21076=t0$21072);acc$21040.push(s$21076);}else{(c$21086=m$21067);acc$21040.push(HTML$20369(c$21086,default_tag$20705));}}return acc$21040;}else{(other$21091=$21019$21024);(acc$21098=[]);(temp$21104=children$20781);($length$21110=temp$21104.length);($index$21116=0);$21093:for(;($index$21116<$length$21110);($index$21116++)){var c$21133;var m$21125;(m$21125=temp$21104[$index$21116]);(c$21133=m$21125);acc$21098.push(HTML$20369(c$21133,default_tag$20705));}return acc$21098;}}()));($20793$21139=tag$20796);if(($20793$21139==="raw")){return accum$20801.concat(children2$20802).join("");}else{(other$21151=$20793$21139);(x$21155=[">"].concat(children2$20802).concat(["</",tag$20796,">"]));return accum$20801.concat(x$21155).join("");}}else{(other$21161=$20707$20718);return HTML$20369([true,String(other$21161)][1],default_tag$20705);}}}});(exports["pr_terminus"]=pr_terminus$20363);(exports["pr"]=pr$20364);(exports["<>"]=__lt____gt__$20365);(exports["repr"]=repr$20366);
