var $20188=function(type$20191){var f$20195;(f$20195=type$20191["::check"]);if((f$20195===(void 0))){return function(value$20201){return (value$20201 instanceof type$20191);};}else{return function(value$20205){return f$20195.call(type$20191,value$20205);};}};
var $20207=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $20208=function(dest$20211,values$20212){var k$20217;(k$20217=null);$20215:for(k$20217 in values$20212){if(values$20212.hasOwnProperty(k$20217)){(dest$20211[k$20217]=values$20212[k$20217]);}}return dest$20211;};
var $20225=function($20227$20230){var ph$20236;(ph$20236=$20227$20230);var $20232$20242;($20232$20242=ph$20236);var bridge$20234$20247;var x$20251;(bridge$20234$20247=$20232$20242);if((((typeof(bridge$20234$20247)==="string")&&((x$20251=bridge$20234$20247),true))||((typeof(bridge$20234$20247)==="number")&&((x$20251=bridge$20234$20247),true)))){return ["value",x$20251];}else{var other$20262;(other$20262=$20232$20242);return other$20262["::serialize_ast"]();}};
var send$19962;(send$19962=function(obj$19969,$19966$19970){var ph$19976;var msg$19977;var t0$19979;(t0$19979=$19966$19970);(msg$19977=t0$19979);(ph$19976=t0$19979);var $19972$19988;($19972$19988=ph$19976);var bridge$19974$19993;(bridge$19974$19993=$19972$19988);if(((typeof(bridge$19974$19993)==="string")||(typeof(bridge$19974$19993)==="number"))){return obj$19969[msg$19977];}else{var other$20005;(other$20005=$19972$19988);return obj$19969["::send"](msg$19977);}});(Array[":::project"]=function($20011$20014){var ph$20019;var value$20020;var t0$20022;(t0$20022=$20011$20014);(value$20020=t0$20022);(ph$20019=t0$20022);var $20016$20031;($20016$20031=ph$20019);if($20188(Array)($20016$20031)){return [true,value$20020];}else{$20016$20031;return [true,[value$20020]];}});(Array.prototype["::check"]=function(value$20049){if((value$20049 instanceof Array)){var i$20055;(i$20055=0);$20052:for(;(i$20055<this.length);(i$20055++)){if(($20207(this,i$20055)!==$20207(value$20049,i$20055))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $20208(this.slice(0),this);});(Array.prototype[":::project"]=function(value$20074){if((value$20074 instanceof Array)){var i$20080;(i$20080=0);$20077:for(;(i$20080<this.length);(i$20080++)){if(($20207(this,i$20080)!==$20207(value$20074,i$20080))){return [true,[value$20074]];}}return [true,value$20074.slice(this.length)];}else{return [true,[value$20074]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($20225));});(RegExp.prototype["::check"]=function($20098$20101){var ph$20106;(ph$20106=$20098$20101);var $20103$20112;($20103$20112=ph$20106);var value$20120;if((typeof($20103$20112)==="string")){(value$20120=$20103$20112);if(value$20120.match(this)){return true;}else{return false;}}else{var other$20125;(other$20125=$20103$20112);return false;}});(RegExp.prototype[":::project"]=function($20131$20134){var ph$20139;(ph$20139=$20131$20134);var $20136$20145;($20136$20145=ph$20139);var value$20153;if((typeof($20136$20145)==="string")){(value$20153=$20136$20145);var $20156$20161;($20156$20161=value$20153.match(this));var m$20169;if(($20156$20161===null)){(m$20169=$20156$20161);return [false,null];}else{var m$20174;(m$20174=$20156$20161);return [true,m$20174];}}else{var other$20178;(other$20178=$20136$20145);return [false,null];}});(Function.prototype["::send"]=function(args$20185){return this.apply(this,args$20185);});
var $21259=function(type$21262){return function(value$21266){var f$21270;(f$21270=type$21262[":::project"]);if((f$21270===(void 0))){(f$21270=type$21262["::project"]);if((f$21270===(void 0))){return [true,type$21262(value$21266)];}else{var rval$21283;(rval$21283=false);try{(rval$21283=[true,f$21270(value$21266)]);}catch(excv$21294){var e$21300;(e$21300=excv$21294);(rval$21283=[false,null]);}return rval$21283;}}else{return f$21270.call(type$21262,value$21266);}};};
var $21558=function(arr$21561){var results$21567;var l$21568;(results$21567=[]);(l$21568=arr$21561.length);var i$21577;(i$21577=0);$21566:for(;(i$21577<l$21568);(i$21577++)){results$21567.push([i$21577,$20207(arr$21561,i$21577)]);}return results$21567;};
var $21325=function(){var $21326$21332;($21326$21332=function(tags$21337){var it$0$21340;(it$0$21340=function(){if((!$20188($21326$21332)(this))){return Object.create($21326$21332.prototype);}else{return this;}}());(it$0$21340["tags"]=tags$21337);return it$0$21340;});($21326$21332.prototype["create"]=function(){var it$0$21360;var self$21361;(it$0$21360=this);(self$21361=this);var $21358$21370;($21358$21370=arguments);var t0$21375;var message$21379;var args$21380;(t0$21375=$21358$21370.length);if((t0$21375>=0)){(message$21379=function(){if((0>=t0$21375)){return "";}else{return $21358$21370[0];}}());(args$21380=Array.prototype.slice.call($21358$21370,1));var e$21393;(e$21393=Error(message$21379));(e$21393["::tags"]=it$0$21360.tags);(e$21393["args"]=args$21380);var temp$21409;(temp$21409=$21558(args$21380));var $length$21415;($length$21415=temp$21409.length);var $index$21421;($index$21421=0);$21394:for(;($index$21421<$length$21415);($index$21421++)){var m$21430;(m$21430=temp$21409[$index$21421]);var t0$21435;var t1$21436;var i$21440;var arg$21441;(t0$21435=m$21430);if(((t0$21435 instanceof Array)&&(((t1$21436=t0$21435.length)),(t1$21436===2)))){(i$21440=t0$21435[0]);(arg$21441=t0$21435[1]);(e$21393[i$21440]=arg$21441);}else{$21306(m$21430);}}(e$21393["length"]=args$21380.length);(e$21393["name"]=["E"].concat(it$0$21360.tags).join("."));return e$21393;}else{$21306($21358$21370);}});($21326$21332.prototype["::check"]=function(e$21471){var it$0$21475;var self$21476;(it$0$21475=this);(self$21476=this);var tags$21486;if(((!e$21471)||(!$20188(Error)(e$21471)))){return false;}(tags$21486=(e$21471["::tags"]||[]));var temp$21497;(temp$21497=it$0$21475.tags);var $length$21503;($length$21503=temp$21497.length);var $index$21509;($index$21509=0);$21487:for(;($index$21509<$length$21503);($index$21509++)){var m$21518;(m$21518=temp$21497[$index$21509]);var tag$21526;(tag$21526=m$21518);if((tags$21486.indexOf(tag$21526)===-1)){return false;}else{false;}}return true;});($21326$21332.prototype["::deconstruct"]=function(e$21535){var it$0$21539;var self$21540;(it$0$21539=this);(self$21540=this);return e$21535.args;});$20208($21326$21332,$20208(function(){var accum$21551;(accum$21551=({}));(accum$21551["::name"]="$21326");return accum$21551;}(),function(){var accum$21555;(accum$21555=({}));(accum$21555["::egclass"]=true);return accum$21555;}()));return $21326$21332;}();
var $21306=function(value$21309,url$21310,start$21311,end$21312){var err$21316;(err$21316=$21325(["match"]).create("Could not find a match for value",({"value":value$21309})));if(url$21310){(err$21316["location"]=["location",url$21310,start$21311,end$21312]);}throw err$21316;};
var $21091=function(){var $21092$21096;($21092$21096=function($21100$21105,$21102$21106){var it$0$21109;(it$0$21109=function(){if((!$20188($21092$21096)(this))){return Object.create($21092$21096.prototype);}else{return this;}}());var classes$21115;var children$21116;var t0$21118;(t0$21118=$21259(Array)($21100$21105));if(t0$21118[0]){(classes$21115=t0$21118[1]);}else{$21306($21100$21105);}var t0$21127;(t0$21127=$21259(Array)($21102$21106));if(t0$21127[0]){(children$21116=t0$21127[1]);}else{$21306($21102$21106);}(it$0$21109["classes"]=classes$21115.sort());(it$0$21109["children"]=children$21116);return it$0$21109;});$20208(function(){var accum$21150;(accum$21150=({}));(accum$21150["::check"]=function(x$21155){return ((x$21155&&x$21155.classes)&&x$21155.children);});return accum$21150;}(),$20208(function(){var accum$21158;(accum$21158=({}));(accum$21158["::deconstruct"]=function(x$21163){return [x$21163.classes,x$21163.children];});return accum$21158;}(),$20208(function(){var accum$21166;(accum$21166=({}));(accum$21166["::name"]="$21092");return accum$21166;}(),function(){var accum$21170;(accum$21170=({}));(accum$21170["::egclass"]=true);return accum$21170;}())));($21092$21096.prototype["::check"]=function(n$21177){var it$0$21181;var self$21182;(it$0$21181=this);(self$21182=this);var temp$21197;(temp$21197=it$0$21181.classes);var $length$21203;($length$21203=temp$21197.length);var $index$21209;($index$21209=0);$21191:for(;($index$21209<$length$21203);($index$21209++)){var m$21218;(m$21218=temp$21197[$index$21209]);var c$21226;(c$21226=m$21218);if((n$21177.classes.indexOf(c$21226)===-1)){return false;}else{false;}}return true;});$20208($21092$21096,$20208(function(){var accum$21236;(accum$21236=({}));(accum$21236["::check"]=function(x$21241){return ((x$21241&&x$21241.classes)&&x$21241.children);});return accum$21236;}(),$20208(function(){var accum$21244;(accum$21244=({}));(accum$21244["::deconstruct"]=function(x$21249){return [x$21249.classes,x$21249.children];});return accum$21244;}(),$20208(function(){var accum$21252;(accum$21252=({}));(accum$21252["::name"]="$21092");return accum$21252;}(),function(){var accum$21256;(accum$21256=({}));(accum$21256["::egclass"]=true);return accum$21256;}()))));return $21092$21096;}();
var $21584=function(obj$21587){var results$21592;(results$21592=[]);var k$21597;(k$21597=null);$21591:for(k$21597 in obj$21587){if(Object.prototype.hasOwnProperty.call(obj$21587,k$21597)){results$21592.push([k$21597,$20207(obj$21587,k$21597)]);}}return results$21592;};
var $21601=function($21603$21606,key$21607){var ph$21615;(ph$21615=$21603$21606);var $21609$21621;($21609$21621=ph$21615);var bridge$21611$21626;(bridge$21611$21626=$21609$21621);if(((bridge$21611$21626===null)||(bridge$21611$21626===(void 0)))){return false;}else{var x$21638;if((typeof($21609$21621)==="string")){(x$21638=$21609$21621);return (key$21607 in String.prototype);}else{var x$21643;if((typeof($21609$21621)==="number")){(x$21643=$21609$21621);return (key$21607 in Number.prototype);}else{var x$21648;(x$21648=$21609$21621);return (key$21607 in x$21648);}}}};var pr_terminus$20273;var pr$20274;var __lt____gt__$20275;var repr$20276;var escape_html$20277;var quotify$20278;var HTML$20279;(pr_terminus$20273=function(node$20284){var r$20290;var pre$20291;var post$20292;(r$20290=HTML$20279(node$20284,"span"));(pre$20291=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));(post$20292=("</div>"+String.fromCharCode(7)));return console.log(((pre$20291+r$20290)+post$20292));});(pr$20274=function($20306$20309,r$20310){var x$20334;var n$20329;var $20312$20321;var ph$20315;(ph$20315=$20306$20309);($20312$20321=ph$20315);if($20188($21091)($20312$20321)){(n$20329=$20312$20321);return pr_terminus$20273(n$20329);}else{(x$20334=$20312$20321);return pr_terminus$20273((r$20310||repr$20276)(x$20334));}});(__lt____gt__$20275=function($20340$20343,x$20344){if(($20340$20343===null)){}else{$21306($20340$20343);}return pr$20274(x$20344);});(repr$20276=function(){var $index$20463;var $length$20457;var temp$20451;var acc$20445;var $index$20514;var $length$20508;var temp$20502;var acc$20496;var other$20551;var entries$20433;var $20368$20406;var t0$20404;var x$20382;var recur$20383;var $20357$20384;var t0$20376;var t1$20377;var t2$20378;var $20355$20371;($20355$20371=arguments);(t0$20376=$20355$20371.length);if((((t0$20376>=1)&&(t0$20376<=2))&&(((t1$20377=$20355$20371[0])),((x$20382=t1$20377),(($20357$20384=t1$20377),(((t2$20378=function(){if((1>=t0$20376)){return repr$20276;}else{return $20355$20371[1];}}())),$20188(Function)(t2$20378))))))){(recur$20383=t2$20378);if(($20357$20384===true)){return $21091(["special","true"],"true");}else{if(($20357$20384===false)){return $21091(["special","false"],"false");}else{if(($20357$20384===null)){return $21091(["special","nil"],"null");}else{if(($20357$20384===(void 0))){return $21091(["special","nil"],"undefined");}else{if((typeof($20357$20384)==="number")){return $21091(["num"],String(x$20382));}else{if((typeof($20357$20384)==="string")){return $21091(["str"],x$20382);}else{(t0$20404=$20357$20384);if($20188(Array)(t0$20404)){(entries$20433=t0$20404);return $21091(["sequence"],(((acc$20445=[])),(((temp$20451=entries$20433)),((($length$20457=temp$20451.length)),((($index$20463=0)),function(){$20440:for(;($index$20463<$length$20457);($index$20463++)){var x$20480;var m$20472;(m$20472=temp$20451[$index$20463]);(x$20480=m$20472);acc$20445.push(recur$20383(x$20480,repr$20276));}}()))),acc$20445));}else{$20357$20384;if(x$20382["::repr"]){return x$20382["::repr"](recur$20383);}else{if((Object.getPrototypeOf(x$20382)===Object.prototype)){return $21091(["+table","object"],(((acc$20496=[])),(((temp$20502=$21584(x$20382))),((($length$20508=temp$20502.length)),((($index$20514=0)),function(){$20491:for(;($index$20514<$length$20508);($index$20514++)){var k$20533;var v$20534;var t0$20528;var t1$20529;var m$20523;(m$20523=temp$20502[$index$20514]);(t0$20528=m$20523);if(((t0$20528 instanceof Array)&&(((t1$20529=t0$20528.length)),(t1$20529===2)))){(k$20533=t0$20528[0]);(v$20534=t0$20528[1]);acc$20496.push($21091(["+tr"],[$21091(["+th"],recur$20383(k$20533,repr$20276)),$21091(["+td"],recur$20383(v$20534,repr$20276))]));}else{$21306(m$20523,"/home/olivier/git/earl-grey/src/pp.eg",914,1244);}}}()))),acc$20496));}else{(other$20551=$20357$20384);return $21091(["unknown"],other$20551.toString());}}}}}}}}}}else{$21306($20355$20371);}});(escape_html$20277=function($20559$20562){var t0$20566;var repl$20576;var s$20564;(t0$20566=[true,String($20559$20562)]);if(t0$20566[0]){(s$20564=t0$20566[1]);}else{$21306($20559$20562);}(repl$20576=({"&":"&amp;","<":"&lt;",">":"&gt;"}));return s$20564.replace(RegExp("[&<>]","g"),function(x$20582){return $20207(repl$20576,x$20582);});});(quotify$20278=function($20588$20591){var t0$20595;var s$20593;(t0$20595=[true,String($20588$20591)]);if(t0$20595[0]){(s$20593=t0$20595[1]);}else{$21306($20588$20591);}return s$20593.replace(RegExp("[\"\\\\]","g"),function(x$20605){return ("\\"+x$20605);});});(HTML$20279=function($20611$20614,default_tag$20615){var $index$20668;var $length$20662;var temp$20656;var acc$20650;var $index$20753;var $length$20747;var temp$20741;var $index$20888;var $length$20882;var temp$20876;var acc$20870;var $index$20968;var $length$20962;var temp$20956;var acc$20950;var $index$21026;var $length$21020;var temp$21014;var acc$21008;var other$21001;var $20929$20934;var x$21065;var other$21061;var $20703$21049;var tag$20706;var _classes$20707;var id$20708;var kv$20709;var sub$20710;var accum$20711;var children2$20712;var other$21071;var classes$20690;var children$20691;var children$20641;var s$20636;var $20617$20628;var ph$20622;(ph$20622=$20611$20614);($20617$20628=ph$20622);if((typeof($20617$20628)==="string")){(s$20636=$20617$20628);return escape_html$20277(s$20636);}else{if($20188(Array)($20617$20628)){(children$20641=$20617$20628);return (((acc$20650=[])),(((temp$20656=children$20641)),((($length$20662=temp$20656.length)),((($index$20668=0)),function(){$20645:for(;($index$20668<$length$20662);($index$20668++)){var child$20685;var m$20677;(m$20677=temp$20656[$index$20668]);(child$20685=m$20677);acc$20650.push(HTML$20279(child$20685,default_tag$20615));}}()))),acc$20650).join("");}else{if(($20188($21091)($20617$20628)&&($21601($20617$20628,"classes")&&((classes$20690=$20617$20628.classes),$21601($20617$20628,"children"))))){(children$20691=$20617$20628.children);(tag$20706=(default_tag$20615||"span"));(_classes$20707=[]);(id$20708=null);(kv$20709=[]);(sub$20710=[]);(temp$20741=classes$20690);($length$20747=temp$20741.length);($index$20753=0);$20713:for(;($index$20753<$length$20747);($index$20753++)){var s$20842;var m$20819;var m$20796;var k$20791;var k$20776;var v$20777;var $20720$20771;var $20721$20772;var $20722$20773;var t0$20767;var t1$20768;var t2$20769;var m$20762;(m$20762=temp$20741[$index$20753]);(t0$20767=m$20762);if((($20721$20772=(t0$20767 instanceof Array))&&(((t1$20768=t0$20767.length)),((t1$20768===3)&&(t0$20767[0]==="assoc"))))){(k$20776=t0$20767[1]);(v$20777=t0$20767[2]);kv$20709.push([k$20776,v$20777]);}else{if(($20721$20772&&((t1$20768===2)&&(t0$20767[0]==="assoc")))){(k$20791=t0$20767[1]);kv$20709.push([k$20791,(void 0)]);}else{(t0$20767=$21259(RegExp("(?:^\\+((?:.*)))",""))(m$20762));if((t0$20767[0]&&(((t1$20768=t0$20767[1])),(((t2$20769=t1$20768.length)),(t2$20769===2))))){t1$20768[0];(m$20796=t1$20768[1]);(tag$20706=m$20796);}else{(t0$20767=$21259(RegExp("(?:^#((?:.*)))",""))(m$20762));if((t0$20767[0]&&(((t1$20768=t0$20767[1])),(((t2$20769=t1$20768.length)),(t2$20769===2))))){t1$20768[0];(m$20819=t1$20768[1]);(id$20708=m$20819);}else{(t0$20767=m$20762);if((typeof(t0$20767)==="string")){(s$20842=t0$20767);_classes$20707.push(s$20842);}else{$21306(m$20762,"/home/olivier/git/earl-grey/src/pp.eg",1823,2150);}}}}}}(accum$20711=function(){if((tag$20706==="raw")){return [];}else{return ["<",tag$20706];}}());if(id$20708){(accum$20711=accum$20711.concat(" id=\"",id$20708,"\""));}if(_classes$20707.length){(accum$20711=accum$20711.concat(" class=\"",quotify$20278(_classes$20707.join(" ")),"\""));}if(kv$20709){(acc$20870=[]);(temp$20876=kv$20709);($length$20882=temp$20876.length);($index$20888=0);$20865:for(;($index$20888<$length$20882);($index$20888++)){var k$20907;var v$20908;var t0$20902;var t1$20903;var m$20897;(m$20897=temp$20876[$index$20888]);(t0$20902=m$20897);if(((t0$20902 instanceof Array)&&(((t1$20903=t0$20902.length)),(t1$20903===2)))){(k$20907=t0$20902[0]);(v$20908=t0$20902[1]);acc$20870.push(((accum$20711=accum$20711.concat(function(){if((v$20908!==null)){return [" ",k$20907,"=\"",quotify$20278(v$20908),"\""];}else{return [" ",k$20907];}}()))));}else{$21306(m$20897,"/home/olivier/git/earl-grey/src/pp.eg",2414,2614);}}acc$20870;}(children2$20712=((($20929$20934=tag$20706)),function(){if(($20929$20934==="raw")){(acc$20950=[]);(temp$20956=children$20691);($length$20962=temp$20956.length);($index$20968=0);$20944:for(;($index$20968<$length$20962);($index$20968++)){var c$20996;var s$20986;var t0$20982;var m$20977;(m$20977=temp$20956[$index$20968]);(t0$20982=m$20977);if((typeof(t0$20982)==="string")){(s$20986=t0$20982);acc$20950.push(s$20986);}else{(c$20996=m$20977);acc$20950.push(HTML$20279(c$20996,default_tag$20615));}}return acc$20950;}else{(other$21001=$20929$20934);(acc$21008=[]);(temp$21014=children$20691);($length$21020=temp$21014.length);($index$21026=0);$21003:for(;($index$21026<$length$21020);($index$21026++)){var c$21043;var m$21035;(m$21035=temp$21014[$index$21026]);(c$21043=m$21035);acc$21008.push(HTML$20279(c$21043,default_tag$20615));}return acc$21008;}}()));($20703$21049=tag$20706);if(($20703$21049==="raw")){return accum$20711.concat(children2$20712).join("");}else{(other$21061=$20703$21049);(x$21065=[">"].concat(children2$20712).concat(["</",tag$20706,">"]));return accum$20711.concat(x$21065).join("");}}else{(other$21071=$20617$20628);return HTML$20279([true,String(other$21071)][1],default_tag$20615);}}}});(exports["pr_terminus"]=pr_terminus$20273);(exports["pr"]=pr$20274);(exports["<>"]=__lt____gt__$20275);(exports["repr"]=repr$20276);
