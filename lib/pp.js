var $10908=function(type$10910){var f$10913;(f$10913=type$10910["::check"]);;if((f$10913===(void 0))){return function(value$10918){return (value$10918 instanceof type$10910);};}else{return function(value$10921){return f$10913.call(type$10910,value$10921);};}};
var $10923=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $10924=function($10925$10927){var ph$10931;(ph$10931=$10925$10927);;var $10929$10936;($10929$10936=ph$10931);;var bridge$10930$10941;var x$10945;(bridge$10930$10941=$10929$10936);if((((typeof(bridge$10930$10941)==="string")&&((x$10945=bridge$10930$10941),true))||((typeof(bridge$10930$10941)==="number")&&((x$10945=bridge$10930$10941),true)))){return ["value",x$10945];}else{var other$10952;(other$10952=$10929$10936);return other$10952["::serialize_ast"]();}};
var send$10792;(send$10792=function(obj$10797,$10795$10798){var ph$10802;var msg$10803;var t0$10805;(t0$10805=$10795$10798);(msg$10803=t0$10805);(ph$10802=t0$10805);;var $10800$10809;($10800$10809=ph$10802);;var bridge$10801$10814;(bridge$10801$10814=$10800$10809);if(((typeof(bridge$10801$10814)==="string")||(typeof(bridge$10801$10814)==="number"))){return obj$10797[msg$10803];}else{var other$10822;(other$10822=$10800$10809);return obj$10797["::send"](msg$10803);}});;(Array[":::project"]=function($10825$10827){var ph$10830;var value$10831;var t0$10833;(t0$10833=$10825$10827);(value$10831=t0$10833);(ph$10830=t0$10833);;var $10829$10837;($10829$10837=ph$10830);;if($10908(Array)($10829$10837)){return [true,value$10831];}else{$10829$10837;return [true,[value$10831]];}});(Array.prototype["::check"]=function(value$10851){if((value$10851 instanceof Array)){var i$10856;(i$10856=0);;$10854:for(;(i$10856<this.length);(i$10856++)){if(($10923(this,i$10856)!==$10923(value$10851,i$10856))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$10867){if((value$10867 instanceof Array)){var i$10872;(i$10872=0);;$10870:for(;(i$10872<this.length);(i$10872++)){if(($10923(this,i$10872)!==$10923(value$10867,i$10872))){return [true,[value$10867]];}}return [true,value$10867.slice(this.length)];}else{return [true,[value$10867]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($10924));});(RegExp.prototype["::check"]=function(value$10883){return value$10883.match(this);});(RegExp.prototype[":::project"]=function(value$10886){var $10888$10890;($10888$10890=value$10886.match(this));;var m$10898;if(($10888$10890===null)){(m$10898=$10888$10890);return [false,null];}else{var m$10903;(m$10903=$10888$10890);return [true,m$10903];}});(Function.prototype["::send"]=function(args$10906){return this.apply(this,args$10906);});
var $11663=function(type$11665){return function(value$11668){var f$11671;(f$11671=type$11665[":::project"]);;if((f$11671===(void 0))){var f$11676;(f$11676=type$11665["::project"]);;if((f$11676===(void 0))){return [true,type$11665(value$11668)];}else{var rval$11681;(rval$11681=false);;try{(rval$11681=[true,f$11676(value$11668)]);}catch(excv$11687){var e$11693;(e$11693=excv$11687);(rval$11681=[false,null]);}return rval$11681;}}else{return f$11671.call(type$11665,value$11668);}};};
var $11815=function(dest$11817,values$11818){var k$11823;(k$11823=null);$11821:for(k$11823 in values$11818){if(values$11818.hasOwnProperty(k$11823)){(dest$11817[k$11823]=values$11818[k$11823]);}}return dest$11817;};
var $11708=function(){var $11709$11711;($11709$11711=function(tags$11715){var it$0$11718;(it$0$11718=function(){if((!$10908($11709$11711)(this))){return Object.create($11709$11711.prototype);}else{return this;}}());;(it$0$11718["tags"]=tags$11715);return it$0$11718;});;($11709$11711.prototype["create"]=function(){var $11727$11729;($11727$11729=arguments);;var t0$11734;var message$11738;var args$11739;(t0$11734=$11727$11729.length);if((t0$11734>=0)){(message$11738=function(){if((0>=t0$11734)){return "";}else{return $11727$11729[0];}}());(args$11739=Array.prototype.slice.call($11727$11729,1));var it$0$11743;(it$0$11743=this);;var e$11748;(e$11748=Error(message$11738));;(e$11748["::tags"]=it$0$11743.tags);(e$11748["args"]=args$11739);(e$11748["name"]=["E"].concat(it$0$11743.tags).join("."));return e$11748;}else{$11695($11727$11729);}});($11709$11711.prototype["::check"]=function(e$11757){var it$0$11760;(it$0$11760=this);;var tags$11765;if(((!e$11757)||(!$10908(Error)(e$11757)))){return false;}(tags$11765=(e$11757["::tags"]||[]));;var temp$11774;(temp$11774=it$0$11760.tags);;var $length$11779;($length$11779=temp$11774.length);;var $index$11784;($index$11784=0);;$11766:for(;($index$11784<$length$11779);($index$11784++)){var m$11792;(m$11792=temp$11774[$index$11784]);;var tag$11800;(tag$11800=m$11792);if((tags$11765.indexOf(tag$11800)===(-1))){return false;}else{false;;}}return true;});($11709$11711.prototype["::deconstruct"]=function(e$11808){var it$0$11811;(it$0$11811=this);;return e$11808.args;});$11815($11709$11711,({}));return $11709$11711;}();
var $11695=function(value$11697,url$11698,start$11699,end$11700){var err$11703;(err$11703=$11708(["match"]).create("Could not find a match for value",({"value":value$11697})));;if(url$11698){(err$11703["location"]=["location",url$11698,start$11699,end$11700]);}throw err$11703;};
var $11557=function(){var $11558$11560;($11558$11560=function($11563$11566,$11564$11567){var classes$11569;var children$11570;var t0$11572;(t0$11572=$11663(Array)($11563$11566));if(t0$11572[0]){(classes$11569=t0$11572[1]);;}else{$11695($11563$11566);}var t0$11577;(t0$11577=$11663(Array)($11564$11567));if(t0$11577[0]){(children$11570=t0$11577[1]);;}else{$11695($11564$11567);}var it$0$11582;(it$0$11582=function(){if((!$10908($11558$11560)(this))){return Object.create($11558$11560.prototype);}else{return this;}}());;(it$0$11582["classes"]=classes$11569.sort());(it$0$11582["children"]=children$11570);return it$0$11582;});;$11815(function(){var accum$11590;(accum$11590=({}));(accum$11590["::check"]=function(x$11594){return ((x$11594&&x$11594.classes)&&x$11594.children);});return accum$11590;}(),function(){var accum$11597;(accum$11597=({}));(accum$11597["::deconstruct"]=function(x$11601){return [x$11601.classes,x$11601.children];});return accum$11597;}());($11558$11560.prototype["::check"]=function(n$11606){var it$0$11609;(it$0$11609=this);;var temp$11618;(temp$11618=it$0$11609.classes);;var $length$11623;($length$11623=temp$11618.length);;var $index$11628;($index$11628=0);;$11614:for(;($index$11628<$length$11623);($index$11628++)){var m$11636;(m$11636=temp$11618[$index$11628]);;var c$11644;(c$11644=m$11636);if((n$11606.classes.indexOf(c$11644)===(-1))){return false;}else{false;;}}return true;});$11815($11558$11560,$11815(function(){var accum$11650;(accum$11650=({}));(accum$11650["::check"]=function(x$11654){return ((x$11654&&x$11654.classes)&&x$11654.children);});return accum$11650;}(),function(){var accum$11657;(accum$11657=({}));(accum$11657["::deconstruct"]=function(x$11661){return [x$11661.classes,x$11661.children];});return accum$11657;}()));return $11558$11560;}();
var $11827=function($11828$11830,key$11831){var ph$11835;(ph$11835=$11828$11830);;var $11833$11840;($11833$11840=ph$11835);;var bridge$11834$11845;(bridge$11834$11845=$11833$11840);if(((bridge$11834$11845===null)||(bridge$11834$11845===(void 0)))){return false;}else{var x$11853;if((typeof($11833$11840)==="string")){(x$11853=$11833$11840);return (key$11831 in String.prototype);}else{var x$11858;if((typeof($11833$11840)==="number")){(x$11858=$11833$11840);return (key$11831 in Number.prototype);}else{var x$11863;(x$11863=$11833$11840);return (key$11831 in x$11863);}}}};var $10955$10956;var items$10957;var pr_terminus$10958;var pr$10959;var __lt____gt__$10960;var repr$10961;var escape_html$10962;var quotify$10963;var HTML$10964;($10955$10956=require("./util"));;(items$10957=$10955$10956.items);;(pr_terminus$10958=function(node$10974){var r$10977;var pre$10978;var post$10979;(r$10977=HTML$10964(node$10974,"span"));;(pre$10978=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">"));;(post$10979=("</div>"+String.fromCharCode(7)));;return console.log(((pre$10978+r$10977)+post$10979));});;(pr$10959=function($10992$10994,r$10995){var x$11016;var n$11011;var $10997$11003;var ph$10998;(ph$10998=$10992$10994);;($10997$11003=ph$10998);;if($10908($11557)($10997$11003)){(n$11011=$10997$11003);return pr_terminus$10958(n$11011);}else{(x$11016=$10997$11003);return pr_terminus$10958((r$10995||repr$10961)(x$11016));}});;(__lt____gt__$10960=function($11021$11023,x$11024){if(($11021$11023===null)){;}else{$11695($11021$11023);}return pr$10959(x$11024);});;(repr$10961=function(){var $index$11109;var $length$11104;var temp$11099;var acc$11094;var $index$11153;var $length$11148;var temp$11143;var acc$11138;var other$11180;var entries$11088;var $11036$11061;var t0$11059;var x$11049;var recur$11050;var $11035$11051;var t0$11043;var t1$11044;var t2$11045;var $11034$11038;($11034$11038=arguments);;(t0$11043=$11034$11038.length);if((((t0$11043>=1)&&(t0$11043<=2))&&((t1$11044=$11034$11038[0]),((x$11049=t1$11044),(($11035$11051=t1$11044),((t2$11045=function(){if((1>=t0$11043)){return repr$10961;}else{return $11034$11038[1];}}()),$10908(Function)(t2$11045))))))){(recur$11050=t2$11045);if(($11035$11051===true)){return $11557(["special","true"],"true");}else{if(($11035$11051===false)){return $11557(["special","false"],"false");}else{if(($11035$11051===null)){return $11557(["special","nil"],"null");}else{if(($11035$11051===(void 0))){return $11557(["special","nil"],"undefined");}else{if((typeof($11035$11051)==="number")){return $11557(["num"],String(x$11049));}else{if((typeof($11035$11051)==="string")){return $11557(["str"],x$11049);}else{(t0$11059=$11035$11051);if($10908(Array)(t0$11059)){(entries$11088=t0$11059);return $11557(["sequence"],(((acc$11094=[])),(((temp$11099=entries$11088)),((($length$11104=temp$11099.length)),((($index$11109=0)),function(){$11091:for(;($index$11109<$length$11104);($index$11109++)){var x$11125;var m$11117;(m$11117=temp$11099[$index$11109]);;(x$11125=m$11117);acc$11094.push(recur$11050(x$11125,repr$10961));}}()))),acc$11094));}else{$11035$11051;if(x$11049["::repr"]){return x$11049["::repr"](recur$11050);}else{if((Object.getPrototypeOf(x$11049)===Object.prototype)){return $11557(["table"],(((acc$11138=[])),(((temp$11143=items$10957(x$11049))),((($length$11148=temp$11143.length)),((($index$11153=0)),function(){$11135:for(;($index$11153<$length$11148);($index$11153++)){var k$11171;var v$11172;var t0$11166;var t1$11167;var m$11161;(m$11161=temp$11143[$index$11153]);;(t0$11166=m$11161);if(((t0$11166 instanceof Array)&&((t1$11167=t0$11166.length),(t1$11167===2)))){(k$11171=t0$11166[0]);(v$11172=t0$11166[1]);acc$11138.push($11557(["pairing"],[recur$11050(k$11171,repr$10961),recur$11050(v$11172,repr$10961)]));}else{$11695(m$11161,"/home/olivier/git/earl-grey/src/pp.eg",944,1064);;}}}()))),acc$11138));}else{(other$11180=$11035$11051);return $11557(["unknown"],other$11180.toString());}}}}}}}}}}else{$11695($11034$11038);}});;(escape_html$10962=function($11187$11189){var t0$11193;var repl$11198;var s$11191;(t0$11193=[true,String($11187$11189)]);if(t0$11193[0]){(s$11191=t0$11193[1]);;}else{$11695($11187$11189);}(repl$11198=({"&":"&amp;","<":"&lt;",">":"&gt;"}));;return s$11191.replace(RegExp("[&<>]","g"),function(x$11203){return $10923(repl$11198,x$11203);});});;(quotify$10963=function($11208$11210){var t0$11214;var s$11212;(t0$11214=[true,String($11208$11210)]);if(t0$11214[0]){(s$11212=t0$11214[1]);;}else{$11695($11208$11210);}return s$11212.replace(RegExp("[\"\\\\]","g"),function(x$11219){return ("\\"+x$11219);});});;(HTML$10964=function($11224$11226,default_tag$11227){var $index$11270;var $length$11265;var temp$11260;var acc$11255;var $index$11335;var $length$11330;var temp$11325;var $index$11412;var $length$11407;var temp$11402;var acc$11397;var $index$11467;var $length$11462;var temp$11457;var acc$11452;var $index$11513;var $length$11508;var temp$11503;var acc$11498;var other$11493;var $11437$11439;var x$11547;var other$11544;var $11296$11532;var tag$11297;var _classes$11298;var id$11299;var kv$11300;var sub$11301;var accum$11302;var other$11553;var classes$11290;var children$11291;var children$11248;var s$11243;var $11229$11235;var ph$11230;(ph$11230=$11224$11226);;($11229$11235=ph$11230);;if((typeof($11229$11235)==="string")){(s$11243=$11229$11235);return escape_html$10962(s$11243);}else{if($10908(Array)($11229$11235)){(children$11248=$11229$11235);return (((acc$11255=[])),(((temp$11260=children$11248)),((($length$11265=temp$11260.length)),((($index$11270=0)),function(){$11252:for(;($index$11270<$length$11265);($index$11270++)){var child$11286;var m$11278;(m$11278=temp$11260[$index$11270]);;(child$11286=m$11278);acc$11255.push(HTML$10964(child$11286,default_tag$11227));}}()))),acc$11255).join("");}else{if(($10908($11557)($11229$11235)&&($11827($11229$11235,"classes")&&((classes$11290=$11229$11235.classes),$11827($11229$11235,"children"))))){(children$11291=$11229$11235.children);(tag$11297=(default_tag$11227||"span"));;(_classes$11298=[]);;(id$11299=null);;(kv$11300=[]);;(sub$11301=[]);;(temp$11325=classes$11290);;($length$11330=temp$11325.length);;($index$11335=0);;$11303:for(;($index$11335<$length$11330);($index$11335++)){var s$11383;var m$11376;var m$11369;var k$11364;var k$11357;var v$11358;var $11305$11352;var $11306$11353;var $11307$11354;var t0$11348;var t1$11349;var t2$11350;var m$11343;(m$11343=temp$11325[$index$11335]);;(t0$11348=m$11343);if((($11306$11353=(t0$11348 instanceof Array))&&((t1$11349=t0$11348.length),((t1$11349===3)&&(t0$11348[0]==="assoc"))))){(k$11357=t0$11348[1]);(v$11358=t0$11348[2]);kv$11300.push([k$11357,v$11358]);}else{if(($11306$11353&&((t1$11349===2)&&(t0$11348[0]==="assoc")))){(k$11364=t0$11348[1]);kv$11300.push([k$11364,(void 0)]);}else{(t0$11348=$11663(RegExp("(?:^\\+((?:.*)))",""))(m$11343));if((t0$11348[0]&&((t1$11349=t0$11348[1]),((t2$11350=t1$11349.length),(t2$11350===2))))){t1$11349[0];(m$11369=t1$11349[1]);(tag$11297=m$11369);}else{(t0$11348=$11663(RegExp("(?:^#((?:.*)))",""))(m$11343));if((t0$11348[0]&&((t1$11349=t0$11348[1]),((t2$11350=t1$11349.length),(t2$11350===2))))){t1$11349[0];(m$11376=t1$11349[1]);(id$11299=m$11376);}else{(t0$11348=m$11343);if((typeof(t0$11348)==="string")){(s$11383=t0$11348);_classes$11298.push(s$11383);}else{$11695(m$11343,"/home/olivier/git/earl-grey/src/pp.eg",1635,1956);;}}}}}}(accum$11302=function(){if((tag$11297==="raw")){return [];}else{return ["<",tag$11297];}}());;if(id$11299){(accum$11302=accum$11302.concat(" id=\"",id$11299,"\""));}if(_classes$11298.length){(accum$11302=accum$11302.concat(" class=\"",quotify$10963(_classes$11298.join(" ")),"\""));}if(kv$11300){(acc$11397=[]);;(temp$11402=kv$11300);;($length$11407=temp$11402.length);;($index$11412=0);;$11394:for(;($index$11412<$length$11407);($index$11412++)){var k$11430;var v$11431;var t0$11425;var t1$11426;var m$11420;(m$11420=temp$11402[$index$11412]);;(t0$11425=m$11420);if(((t0$11425 instanceof Array)&&((t1$11426=t0$11425.length),(t1$11426===2)))){(k$11430=t0$11425[0]);(v$11431=t0$11425[1]);acc$11397.push((accum$11302=accum$11302.concat(function(){if((v$11431!==null)){return [" ",k$11430,"=\"",quotify$10963(v$11431),"\""];}else{return [" ",k$11430];}}())));}else{$11695(m$11420,"/home/olivier/git/earl-grey/src/pp.eg",2210,2407);;}}acc$11397;}(children$11291=((($11437$11439=tag$11297)),function(){if(($11437$11439==="raw")){(acc$11452=[]);;(temp$11457=children$11291);;($length$11462=temp$11457.length);;($index$11467=0);;$11449:for(;($index$11467<$length$11462);($index$11467++)){var c$11489;var s$11484;var t0$11480;var m$11475;(m$11475=temp$11457[$index$11467]);;(t0$11480=m$11475);if((typeof(t0$11480)==="string")){(s$11484=t0$11480);acc$11452.push(s$11484);}else{(c$11489=m$11475);acc$11452.push(HTML$10964(c$11489,default_tag$11227));}}return acc$11452;}else{(other$11493=$11437$11439);(acc$11498=[]);;(temp$11503=children$11291);;($length$11508=temp$11503.length);;($index$11513=0);;$11495:for(;($index$11513<$length$11508);($index$11513++)){var c$11529;var m$11521;(m$11521=temp$11503[$index$11513]);;(c$11529=m$11521);acc$11498.push(HTML$10964(c$11529,default_tag$11227));}return acc$11498;}}()));($11296$11532=tag$11297);;if(($11296$11532==="raw")){return accum$11302.concat(children$11291).join("");}else{(other$11544=$11296$11532);(x$11547=[">"].concat(children$11291).concat(["</",tag$11297,">"]));;return accum$11302.concat(x$11547).join("");}}else{(other$11553=$11229$11235);return HTML$10964([true,String(other$11553)][1],default_tag$11227);}}}});;(exports["pr_terminus"]=pr_terminus$10958);(exports["pr"]=pr$10959);(exports["<>"]=__lt____gt__$10960);(exports["repr"]=repr$10961);
