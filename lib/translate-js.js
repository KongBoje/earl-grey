var $38282=(function(type$38285){var f$38289;(f$38289=type$38285["::check"]);if((f$38289===(void 0))){return (function(value$38295){return (value$38295 instanceof type$38285);});}else{return (function(value$38299){return f$38289.call(type$38285,value$38299);});}});
var $38301=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $38302=(function(dest$38305,values$38306){var k$38311;(k$38311=null);$38309:for(k$38311 in values$38306){if(values$38306.hasOwnProperty(k$38311)){(dest$38305[k$38311]=values$38306[k$38311]);}}return dest$38305;});
var $38319=(function($38321$38324){var ph$38330;(ph$38330=$38321$38324);var $38326$38336;($38326$38336=ph$38330);var bridge$38328$38341;var x$38345;(bridge$38328$38341=$38326$38336);if((((typeof(bridge$38328$38341)==="string")&&((x$38345=bridge$38328$38341),true))||((typeof(bridge$38328$38341)==="number")&&((x$38345=bridge$38328$38341),true)))){return ["value",x$38345];}else{var other$38356;(other$38356=$38326$38336);return other$38356["::serialize_ast"]();}});
var send$38056;(send$38056=(function(obj$38063,$38060$38064){var ph$38070;var msg$38071;var t0$38073;(t0$38073=$38060$38064);(msg$38071=t0$38073);(ph$38070=t0$38073);var $38066$38082;($38066$38082=ph$38070);var bridge$38068$38087;(bridge$38068$38087=$38066$38082);if(((typeof(bridge$38068$38087)==="string")||(typeof(bridge$38068$38087)==="number"))){return obj$38063[msg$38071];}else{var other$38099;(other$38099=$38066$38082);return obj$38063["::send"](msg$38071);}}));(Array[":::project"]=(function($38105$38108){var ph$38113;var value$38114;var t0$38116;(t0$38116=$38105$38108);(value$38114=t0$38116);(ph$38113=t0$38116);var $38110$38125;($38110$38125=ph$38113);if($38282(Array)($38110$38125)){return [true,value$38114];}else{$38110$38125;return [true,[value$38114]];}}));(Array.prototype["::check"]=(function(value$38143){if((value$38143 instanceof Array)){var i$38149;(i$38149=0);$38146:for(;(i$38149<this.length);(i$38149++)){if(($38301(this,i$38149)!==$38301(value$38143,i$38149))){return false;}}return true;}else{return false;}}));(Array.prototype["::clone"]=(function(){return $38302(this.slice(0),this);}));(Array.prototype[":::project"]=(function(value$38168){if((value$38168 instanceof Array)){var i$38174;(i$38174=0);$38171:for(;(i$38174<this.length);(i$38174++)){if(($38301(this,i$38174)!==$38301(value$38168,i$38174))){return [true,[value$38168]];}}return [true,value$38168.slice(this.length)];}else{return [true,[value$38168]];}}));(Array.prototype["::serialize_ast"]=(function(){return ["array"].concat(this.map($38319));}));(RegExp.prototype["::check"]=(function($38192$38195){var ph$38200;(ph$38200=$38192$38195);var $38197$38206;($38197$38206=ph$38200);var value$38214;if((typeof($38197$38206)==="string")){(value$38214=$38197$38206);if(value$38214.match(this)){return true;}else{return false;}}else{var other$38219;(other$38219=$38197$38206);return false;}}));(RegExp.prototype[":::project"]=(function($38225$38228){var ph$38233;(ph$38233=$38225$38228);var $38230$38239;($38230$38239=ph$38233);var value$38247;if((typeof($38230$38239)==="string")){(value$38247=$38230$38239);var $38250$38255;($38250$38255=value$38247.match(this));var m$38263;if(($38250$38255===null)){(m$38263=$38250$38255);return [false,null];}else{var m$38268;(m$38268=$38250$38255);return [true,m$38268];}}else{var other$38272;(other$38272=$38230$38239);return [false,null];}}));(Function.prototype["::send"]=(function(args$38279){return this.apply(this,args$38279);}));
var $40722=(function(arr$40725){var results$40731;var l$40732;(results$40731=[]);(l$40732=arr$40725.length);var i$40741;(i$40741=0);$40730:for(;(i$40741<l$40732);(i$40741++)){results$40731.push([i$40741,$38301(arr$40725,i$40741)]);}return results$40731;});
var $40489=(function(){var $40490$40496;($40490$40496=(function(tags$40501){var it$0$40504;(it$0$40504=(function(){if((!$38282($40490$40496)(this))){return Object.create($40490$40496.prototype);}else{return this;}})());(it$0$40504["tags"]=tags$40501);return it$0$40504;}));($40490$40496.prototype["create"]=(function(){var it$0$40524;var self$40525;(it$0$40524=this);(self$40525=this);var $40522$40534;($40522$40534=arguments);var t0$40539;var message$40543;var args$40544;(t0$40539=$40522$40534.length);if((t0$40539>=0)){(message$40543=(function(){if((0>=t0$40539)){return "";}else{return $40522$40534[0];}})());(args$40544=Array.prototype.slice.call($40522$40534,1));var e$40557;(e$40557=Error(message$40543));(e$40557["::tags"]=it$0$40524.tags);(e$40557["args"]=args$40544);var temp$40573;(temp$40573=$40722(args$40544));var $length$40579;($length$40579=temp$40573.length);var $index$40585;($index$40585=0);$40558:for(;($index$40585<$length$40579);($index$40585++)){var m$40594;(m$40594=temp$40573[$index$40585]);var t0$40599;var t1$40600;var i$40604;var arg$40605;(t0$40599=m$40594);if(((t0$40599 instanceof Array)&&(((t1$40600=t0$40599.length)),(t1$40600===2)))){(i$40604=t0$40599[0]);(arg$40605=t0$40599[1]);(e$40557[i$40604]=arg$40605);}else{$40470(m$40594);}}(e$40557["length"]=args$40544.length);(e$40557["name"]=["E"].concat(it$0$40524.tags).join("."));return e$40557;}else{$40470($40522$40534);}}));($40490$40496.prototype["::check"]=(function(e$40635){var it$0$40639;var self$40640;(it$0$40639=this);(self$40640=this);var tags$40650;if(((!e$40635)||(!$38282(Error)(e$40635)))){return false;}(tags$40650=(e$40635["::tags"]||[]));var temp$40661;(temp$40661=it$0$40639.tags);var $length$40667;($length$40667=temp$40661.length);var $index$40673;($index$40673=0);$40651:for(;($index$40673<$length$40667);($index$40673++)){var m$40682;(m$40682=temp$40661[$index$40673]);var tag$40690;(tag$40690=m$40682);if((tags$40650.indexOf(tag$40690)===-1)){return false;}else{false;}}return true;}));($40490$40496.prototype["::deconstruct"]=(function(e$40699){var it$0$40703;var self$40704;(it$0$40703=this);(self$40704=this);return e$40699.args;}));$38302($40490$40496,$38302((function(){var accum$40715;(accum$40715=({}));(accum$40715["::name"]="$40490");return accum$40715;})(),(function(){var accum$40719;(accum$40719=({}));(accum$40719["::egclass"]=true);return accum$40719;})()));return $40490$40496;})();
var $40470=(function(value$40473,url$40474,start$40475,end$40476){var err$40480;(err$40480=$40489(["match"]).create("Could not find a match for value",({"value":value$40473})));if(url$40474){(err$40480["location"]=["location",url$40474,start$40475,end$40476]);}throw err$40480;});
var $40748=(function(type$40751){return (function(value$40755){var f$40759;(f$40759=type$40751[":::project"]);if((f$40759===(void 0))){(f$40759=type$40751["::project"]);if((f$40759===(void 0))){return [true,type$40751(value$40755)];}else{var rval$40772;(rval$40772=false);try{(rval$40772=[true,f$40759(value$40755)]);}catch(excv$40783){var e$40789;(e$40789=excv$40783);(rval$40772=[false,null]);}return rval$40772;}}else{return f$40759.call(type$40751,value$40755);}});});
var $40795=(function($40797$40800,key$40801){var ph$40809;(ph$40809=$40797$40800);var $40803$40815;($40803$40815=ph$40809);var bridge$40805$40820;(bridge$40805$40820=$40803$40815);if(((bridge$40805$40820===null)||(bridge$40805$40820===(void 0)))){return false;}else{var x$40832;if((typeof($40803$40815)==="string")){(x$40832=$40803$40815);return (key$40801 in String.prototype);}else{var x$40837;if((typeof($40803$40815)==="number")){(x$40837=$40803$40815);return (key$40801 in Number.prototype);}else{var x$40842;(x$40842=$40803$40815);return (key$40801 in x$40842);}}}});var accum$40435;var accum$40439;var $38360$38378;var gensym$38379;var $38361$38380;var __lt____gt__$38381;var js_op_table2$38382;var js_op_table$38383;var Translator$38384;var translate$38385;($38360$38378=require("./util"));(gensym$38379=$38360$38378.gensym);($38361$38380=require("./pp"));(__lt____gt__$38381=$38361$38380["<>"]);(js_op_table2$38382=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$38383=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$38384=(function(){var prelude$38428;var t0$38424;var $38415$38419;var it$0$38410;(it$0$38410=(function(){if((!$38282(Translator$38384)(this))){return Object.create(Translator$38384.prototype);}else{return this;}})());($38415$38419=arguments);(t0$38424=$38415$38419.length);if(((t0$38424>=0)&&(t0$38424<=1))){(prelude$38428=(function(){if((0>=t0$38424)){return null;}else{return $38415$38419[0];}})());(it$0$38410["cache"]=({}));(it$0$38410["prepend"]=[]);if(prelude$38428){it$0$38410.prepend.push(it$0$38410.translate($38319(prelude$38428),"stmt"));}}else{$40470($38415$38419);}return it$0$38410;}));(Translator$38384.prototype["register_value"]=(function(v$38452,id$38453){var temp$38484;var name$38493;var $38466$38471;var it$0$38457;var self$38458;(it$0$38457=this);(self$38458=this);($38466$38471=$38301(it$0$38457.cache,id$38453));if(($38466$38471===(void 0))){(temp$38484=["symbol",gensym$38379()]);(it$0$38457.cache[id$38453]=temp$38484);it$0$38457.prepend.push(it$0$38457.translate(["declare",temp$38484,$38319(v$38452)],"stmt"));return temp$38484;}else{(name$38493=$38466$38471);return name$38493;}}));(Translator$38384.prototype["register_raw"]=(function(raw$38499,id$38500){var temp$38531;var name$38540;var $38513$38518;var it$0$38504;var self$38505;(it$0$38504=this);(self$38505=this);($38513$38518=$38301(it$0$38504.cache,id$38500));if(($38513$38518===(void 0))){(temp$38531=["symbol",gensym$38379()]);(it$0$38504.cache[id$38500]=temp$38531);it$0$38504.prepend.push(it$0$38504.translate(["declare",temp$38531,["raw",raw$38499]],"stmt"));return temp$38531;}else{(name$38540=$38513$38518);return name$38540;}}));(Translator$38384.prototype["dump_store"]=(function(){var rval$38561;var it$0$38549;var self$38550;(it$0$38549=this);(self$38550=this);(rval$38561=it$0$38549.prepend.join("\n"));(it$0$38549["prepend"]=[]);return rval$38561;}));(Translator$38384.prototype["mangle"]=(function(name$38572){var i$38599;var tr$38589;var r$38590;var it$0$38576;var self$38577;(it$0$38576=this);(self$38577=this);(tr$38589=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$38590=[]);(i$38599=0);$38588:for(;(i$38599<name$38572.length);(++i$38599)){var c$38608;(c$38608=$38301(name$38572,i$38599));r$38590.push(($38301(tr$38589,c$38608)||c$38608));}return r$38590.join("");}));(Translator$38384.prototype["body"]=(function(orig$38616,mode$38617){var t0$38641;var t1$38642;var t2$38643;var x$38682;var stmts$38693;var ret$38694;var other$38707;var $38633$38670;var b$38638;var trst$38639;var it$0$38621;var self$38622;(it$0$38621=this);(self$38622=this);(t0$38641=$40748(["multi"])(orig$38616));if((t0$38641[0]&&(((t1$38642=t0$38641[1])),(((t2$38643=t1$38642.length)),(t2$38643>=0))))){(b$38638=Array.prototype.slice.call(t1$38642,0));}else{$40470(orig$38616,"/home/olivier/git/earl-grey/src/translate-js.eg",3071,3075);}(trst$38639=(function(stmt$38665){return it$0$38621.translate(stmt$38665,"stmt");}));($38633$38670=mode$38617);if(($38633$38670==="expr")){(x$38682=["send",["lambda",[],orig$38616],["array"]]);return it$0$38621.translate(x$38682,mode$38617);}else{if(($38633$38670==="return")){(stmts$38693=b$38638.slice(0,-1));(ret$38694=$38301(b$38638,(b$38638.length-1)));return (stmts$38693.map(trst$38639).join("")+it$0$38621.translate(ret$38694,"return"));}else{if(($38633$38670==="stmt")){return b$38638.map(trst$38639).join("");}else{(other$38707=$38633$38670);throw $40489(["syntax","mode"]).create("Unknown mode",({"mode":mode$38617}));}}}}));(Translator$38384.prototype["expr"]=(function(x$38713,mode$38714){var other$38754;var $38727$38734;var it$0$38718;var self$38719;(it$0$38718=this);(self$38719=this);($38727$38734=mode$38714);if(($38727$38734==="expr")){return x$38713;}else{if(($38727$38734==="stmt")){return (x$38713+";");}else{if(($38727$38734==="return")){return (("return "+x$38713)+";");}else{(other$38754=$38727$38734);throw "OopsI";}}}}));(Translator$38384.prototype["op"]=(function(op$38760,a$38761,b$38762){var $38784$38798;var $38785$38799;var $38786$38800;var t0$38794;var t1$38795;var t2$38796;var $38780$38789;var e$38777;var it$0$38766;var self$38767;(it$0$38766=this);(self$38767=this);(e$38777=((($38780$38789=[a$38761,b$38762])),(function(){if((($38784$38798=($38780$38789 instanceof Array))&&(((t0$38794=$38780$38789.length)),(($38786$38800=(t0$38794===2))&&(((t1$38795=$38780$38789[0])),((t1$38795 instanceof Array)&&(((t2$38796=t1$38795.length)),((t2$38796===1)&&(t1$38795[0]==="void"))))))))){$38780$38789[1];return (op$38760+it$0$38766.translate(b$38762,"expr"));}else{if(($38786$38800&&($38780$38789[0],(((t1$38795=$38780$38789[1])),((t1$38795 instanceof Array)&&(((t2$38796=t1$38795.length)),((t2$38796===1)&&(t1$38795[0]==="void")))))))){return (it$0$38766.translate(a$38761,"expr")+op$38760);}else{$38780$38789;return ((it$0$38766.translate(a$38761,"expr")+op$38760)+it$0$38766.translate(b$38762,"expr"));}}})()));return (("("+e$38777)+")");}));(Translator$38384.prototype["translate"]=(function(expr$38843,mode$38844){var repl$38969;var it$0$39008;var it$0$39002;var it$0$38996;var it$0$38990;var bridge$38950$39027;var bridge$38949$39020;var other$39042;var id$39036;var bridge$38948$38960;var $38943$38955;var r$38940;var t0$39081;var t0$39088;var trf$39108;var trmsg$39109;var trf$39153;var trmsg$39154;var trf$39168;var trmsg$39169;var otherwise$39163;var $39135$39140;var x$39229;var x$39219;var $39202$39214;var $39203$39215;var $39204$39216;var t0$39212;var $39198$39207;var $index$39269;var $length$39263;var temp$39257;var acc$39251;var trf$39239;var trargs$39240;var op$39195;var code$39308;var code$39322;var t0$39300;var t1$39301;var trf$39329;var trmsg$39330;var codevar$39298;var f$39349;var r$39344;var f$39424;var f$39470;var v$39464;var all_strings$39366;var r$39367;var $index$39557;var $length$39551;var temp$39545;var acc$39539;var a$39524;var b$39525;var name$39517;var a$39621;var b$39622;var other$39616;var $39599$39604;var a$39659;var b$39660;var c$39661;var other$39653;var $39636$39641;var a$39714;var other$39710;var bridge$39689$39698;var $39687$39693;var a$39752;var b$39753;var other$39747;var bridge$39726$39735;var $39724$39730;var a$39781;var b$39782;var c$39783;var a$39802;var b$39803;var $index$39913;var $length$39907;var temp$39901;var acc$39895;var $index$39959;var $length$39953;var temp$39947;var acc$39941;var xs$39887;var $39825$39875;var $39821$39869;var isdecl$39826;var $index$40029;var $length$40023;var temp$40017;var acc$40011;var decls$40003;var f$40062;var r$40057;var other$40184;var $40167$40172;var a$40214;var b$40215;var other$40209;var $40192$40197;var a$40254;var b$40255;var c$40256;var d$40257;var other$40247;var $40230$40235;var a$40300;var b$40301;var c$40302;var other$40294;var $40277$40282;var t0$40346;var t0$40354;var a$40392;var b$40393;var other$40387;var $40370$40375;var other$40421;var t0$40408;var $40364$40403;var r$40367;var other$40430;var x$40425;var attempt$40314;var v$40315;var body$40316;var finally$40317;var x$40272;var y$40273;var body$40274;var x$40224;var y$40225;var z$40226;var body$40227;var test$40188;var body$40189;var label$40153;var body$40154;var value$40148;var value$40143;var value$40138;var label$40123;var label$40108;var value$40103;var args$40052;var vars$39997;var body$39998;var s$39992;var args$39987;var args$39816;var lhs$39795;var rhs$39796;var obj$39762;var msg$39763;var rhs$39764;var binding$39720;var value$39721;var binding$39673;var test$39631;var pos$39632;var neg$39633;var test$39583;var pos$39584;var bindings$39511;var body$39512;var args$39360;var args$39339;var f$39292;var msg$39293;var f$39178;var args$39179;var f$39118;var msg$39119;var s$39120;var f$39072;var msg$39073;var f$39047;var v$38935;var s$38921;var $38896$38915;var $38897$38916;var $38898$38917;var $38899$38918;var t0$38907;var t1$38908;var t2$38909;var t3$38910;var t4$38911;var bridge$38863$38912;var bridge$38893$38913;var $38857$38902;var it$0$38848;var self$38849;(it$0$38848=this);(self$38849=this);($38857$38902=expr$38843);if((($38896$38915=($38857$38902 instanceof Array))&&(((t0$38907=$38857$38902.length)),((t0$38907===2)&&($38857$38902[0]==="symbol"))))){(s$38921=$38857$38902[1]);return it$0$38848.expr(it$0$38848.mangle(s$38921),mode$38844);}else{if(($38896$38915&&((t0$38907===1)&&($38857$38902[0]==="void")))){return it$0$38848.expr("null",mode$38844);}else{if(($38896$38915&&((t0$38907===2)&&($38857$38902[0]==="value")))){(v$38935=$38857$38902[1]);(r$38940=((($38943$38955=v$38935)),(function(){if((typeof($38943$38955)==="string")){(repl$38969=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$38935=v$38935.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),(function(m$38977){return $38301(repl$38969,m$38977);})));return (("\""+v$38935)+"\"");}else{if(($38943$38955===(void 0))){return "(void 0)";}else{if($38282(RegExp)($38943$38955)){(it$0$38990=String(v$38935));(it$0$38996=it$0$38990.slice(1,-1));(it$0$39002=it$0$38996.replace(RegExp("/","g"),"\\/"));(it$0$39008=it$0$39002.replace(RegExp("\n","g"),"\\n"));return "/".concat(it$0$39008).concat("/");}else{(bridge$38948$38960=$38943$38955);if(((((bridge$38949$39020=bridge$38948$38960)),((((bridge$38950$39027=bridge$38949$39020)),((typeof(bridge$38950$39027)==="number")||(bridge$38950$39027===true)))||(bridge$38949$39020===false)))||(bridge$38948$38960===null))){return String(v$38935);}else{if(($40795($38943$38955,"::id")&&((id$39036=$38943$38955["::id"]),id$39036))){return it$0$38848.translate(it$0$38848.register_value(v$38935,id$39036),mode$38844);}else{(other$39042=$38943$38955);throw $40489(["cannot_serialize"]).create("Cannot serialize value",({"value":v$38935}));}}}}}})()));return it$0$38848.expr(r$38940,mode$38844);}else{if(($38896$38915&&(($38898$38917=(t0$38907===3))&&(($38899$38918=($38857$38902[0]==="send"))&&(((t1$38908=$38857$38902[1])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&((t1$38908[0]==="variable")&&((t1$38908[1]==="___node")&&(((t3$38910=$38857$38902[2])),((t3$38910 instanceof Array)&&(((t4$38911=t3$38910.length)),((t4$38911===2)&&(t3$38910[0]==="value"))))))))))))))){(f$39047=t3$38910[1]);return f$39047;}else{if(($38899$38918&&(((bridge$38863$38912=$38857$38902[1])),((((bridge$38863$38912 instanceof Array)&&(((t0$39081=bridge$38863$38912.length)),((t0$39081===2)&&((bridge$38863$38912[0]==="symbol")&&(bridge$38863$38912[1]==="___js_fetch")))))||((bridge$38863$38912 instanceof Array)&&(((t0$39088=bridge$38863$38912.length)),((t0$39088===2)&&((bridge$38863$38912[0]==="variable")&&(bridge$38863$38912[1]==="___js_fetch"))))))&&(((t1$38908=$38857$38902[2])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===3)&&(t1$38908[0]==="array"))))))))){(f$39072=t1$38908[1]);(msg$39073=t1$38908[2]);(trf$39108=it$0$38848.translate(f$39072,"expr"));(trmsg$39109=it$0$38848.translate(msg$39073,"expr"));return it$0$38848.expr((((trf$39108+"[")+trmsg$39109)+"]"),mode$38844);}else{if(($38899$38918&&((f$39118=$38857$38902[1]),(((t1$38908=$38857$38902[2])),((msg$39119=t1$38908),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&(t1$38908[0]==="value"))))))))){(s$39120=t1$38908[1]);($39135$39140=null);$39135$39140;if(((typeof(s$39120)==="string")&&s$39120.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$39153=it$0$38848.translate(f$39118,"expr"));(trmsg$39154=it$0$38848.translate(["symbol",s$39120],"expr"));return it$0$38848.expr(((trf$39153+".")+trmsg$39154),mode$38844);}else{(otherwise$39163=$39135$39140);(trf$39168=it$0$38848.translate(f$39118,"expr"));(trmsg$39169=it$0$38848.translate(msg$39119,"expr"));return it$0$38848.expr((((trf$39168+"[")+trmsg$39169)+"]"),mode$38844);}}else{if(($38899$38918&&((f$39178=$38857$38902[1]),(((t1$38908=$38857$38902[2])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909>=1)&&(t1$38908[0]==="array")))))))){(args$39179=Array.prototype.slice.call(t1$38908,1));(op$39195=((($39198$39207=f$39178)),(function(){if((($39202$39214=($39198$39207 instanceof Array))&&(((t0$39212=$39198$39207.length)),(($39204$39216=(t0$39212===2))&&($39198$39207[0]==="symbol"))))){(x$39219=$39198$39207[1]);return $38301(js_op_table$38383,x$39219);}else{if(($39204$39216&&($39198$39207[0]==="variable"))){(x$39229=$39198$39207[1]);return $38301(js_op_table2$38382,x$39229);}else{$39198$39207;return null;}}})()));if(op$39195){return it$0$38848.expr(it$0$38848.op(op$39195,args$39179[0],args$39179[1]),mode$38844);}else{(trf$39239=it$0$38848.translate(f$39178,"expr"));(trargs$39240=(((acc$39251=[])),(((temp$39257=args$39179)),((($length$39263=temp$39257.length)),((($index$39269=0)),(function(){$39246:for(;($index$39269<$length$39263);($index$39269++)){var x$39286;var m$39278;(m$39278=temp$39257[$index$39269]);(x$39286=m$39278);acc$39251.push(it$0$38848.translate(x$39286,"expr"));}})()))),acc$39251));return it$0$38848.expr((((trf$39239+"(")+trargs$39240.join(","))+")"),mode$38844);}}else{if($38899$38918){(f$39292=$38857$38902[1]);(msg$39293=$38857$38902[2]);(t0$39300=(((code$39308="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$38848.register_raw(code$39308,"~send")));if(((t0$39300 instanceof Array)&&(((t1$39301=t0$39300.length)),((t1$39301===2)&&(t0$39300[0]==="symbol"))))){(codevar$39298=t0$39300[1]);}else{$40470((((code$39322="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$38848.register_raw(code$39322,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6698,6908);}(trf$39329=it$0$38848.translate(f$39292,"expr"));(trmsg$39330=it$0$38848.translate(msg$39293,"expr"));return it$0$38848.expr((((((codevar$39298+"(")+trf$39329)+",")+trmsg$39330)+")"),mode$38844);}else{if(($38896$38915&&(($38898$38917=(t0$38907>=1))&&($38857$38902[0]==="array")))){(args$39339=Array.prototype.slice.call($38857$38902,1));(r$39344=(((f$39349=(function(x$39354){return it$0$38848.translate(x$39354,"expr");}))),(("["+args$39339.map(f$39349).join(","))+"]")));return it$0$38848.expr(r$39344,mode$38844);}else{if(($38898$38917&&($38857$38902[0]==="object"))){(args$39360=Array.prototype.slice.call($38857$38902,1));(all_strings$39366=args$39360.every((function($39371$39374){var t0$39382;var t1$39383;var other$39417;var v$39407;var t0$39403;var $39376$39398;var ph$39379;var y$39380;(t0$39382=$39371$39374);if(((t0$39382 instanceof Array)&&(((t1$39383=t0$39382.length)),((t1$39383===3)&&(t0$39382[0]==="array"))))){(ph$39379=t0$39382[1]);(y$39380=t0$39382[2]);}else{$40470($39371$39374);}($39376$39398=ph$39379);if((($39376$39398 instanceof Array)&&(((t0$39403=$39376$39398.length)),((t0$39403===2)&&($39376$39398[0]==="value"))))){(v$39407=$39376$39398[1]);return true;}else{(other$39417=$39376$39398);return false;}})));(r$39367=(function(){if(all_strings$39366){(f$39424=(function($39428$39431){var t0$39436;var t1$39437;var a$39453;var b$39454;var x$39433;var y$39434;(t0$39436=$39428$39431);if(((t0$39436 instanceof Array)&&(((t1$39437=t0$39436.length)),((t1$39437===3)&&(t0$39436[0]==="array"))))){(x$39433=t0$39436[1]);(y$39434=t0$39436[2]);}else{$40470($39428$39431);}(a$39453=it$0$38848.translate(x$39433,"expr"));(b$39454=it$0$38848.translate(y$39434,"expr"));return ((a$39453+":")+b$39454);}));return (("({"+args$39360.map(f$39424).join(","))+"})");}else{(v$39464=gensym$38379());(f$39470=(function($39474$39477){var t0$39482;var t1$39483;var a$39499;var b$39500;var x$39479;var y$39480;(t0$39482=$39474$39477);if(((t0$39482 instanceof Array)&&(((t1$39483=t0$39482.length)),((t1$39483===3)&&(t0$39482[0]==="array"))))){(x$39479=t0$39482[1]);(y$39480=t0$39482[2]);}else{$40470($39474$39477);}(a$39499=it$0$38848.translate(x$39479,"expr"));(b$39500=it$0$38848.translate(y$39480,"expr"));return (((((v$39464+"[")+a$39499)+"]=")+b$39500)+";");}));return ((((((("(function(){"+"var ")+v$39464)+"={};")+args$39360.map(f$39470).join(""))+";return ")+v$39464)+";}())");}})());return it$0$38848.expr(r$39367,mode$38844);}else{if(($38896$38915&&((t0$38907===3)&&($38857$38902[0]==="lambda")))){(bindings$39511=$38857$38902[1]);(body$39512=$38857$38902[2]);(name$39517=(function(){if($38282(RegExp("^[$_a-zA-Z]*$",""))(expr$38843.name)){return (expr$38843.name+" ");}else{return "";}})());(a$39524=(((acc$39539=[])),(((temp$39545=bindings$39511)),((($length$39551=temp$39545.length)),((($index$39557=0)),(function(){$39534:for(;($index$39557<$length$39551);($index$39557++)){var x$39574;var m$39566;(m$39566=temp$39545[$index$39557]);(x$39574=m$39566);acc$39539.push(it$0$38848.translate(x$39574,"expr"));}})()))),acc$39539).join(","));(b$39525=it$0$38848.body(body$39512,"return"));return it$0$38848.expr((((((("(function"+name$39517)+"(")+a$39524)+"){")+b$39525)+"})"),mode$38844);}else{if(($38896$38915&&(($38898$38917=(t0$38907===4))&&(($38899$38918=($38857$38902[0]==="if"))&&((test$39583=$38857$38902[1]),((pos$39584=$38857$38902[2]),(((t1$38908=$38857$38902[3])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&((t1$38908[0]==="value")&&(t1$38908[1]===(void 0))))))))))))){($39599$39604=mode$38844);if(($39599$39604==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$39616=$39599$39604);(a$39621=it$0$38848.translate(test$39583,"expr"));(b$39622=it$0$38848.translate(pos$39584,mode$38844));return (((("if("+a$39621)+"){")+b$39622)+"}");}}else{if($38899$38918){(test$39631=$38857$38902[1]);(pos$39632=$38857$38902[2]);(neg$39633=$38857$38902[3]);($39636$39641=mode$38844);if(($39636$39641==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$39653=$39636$39641);(a$39659=it$0$38848.translate(test$39631,"expr"));(b$39660=it$0$38848.translate(pos$39632,mode$38844));(c$39661=it$0$38848.translate(neg$39633,mode$38844));return (((((("if("+a$39659)+"){")+b$39660)+"}else{")+c$39661)+"}");}}else{if(($38896$38915&&(($38898$38917=(t0$38907===3))&&(($38899$38918=($38857$38902[0]==="declare"))&&((binding$39673=$38857$38902[1]),(((t1$38908=$38857$38902[2])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&((t1$38908[0]==="value")&&(t1$38908[1]===(void 0)))))))))))){($39687$39693=mode$38844);(bridge$39689$39698=$39687$39693);if(((bridge$39689$39698==="expr")||(bridge$39689$39698==="return"))){throw "Invalid in expr ctx";}else{(other$39710=$39687$39693);(a$39714=it$0$38848.translate(binding$39673,"expr"));return (("var "+a$39714)+";");}}else{if($38899$38918){(binding$39720=$38857$38902[1]);(value$39721=$38857$38902[2]);($39724$39730=mode$38844);(bridge$39726$39735=$39724$39730);if(((bridge$39726$39735==="expr")||(bridge$39726$39735==="return"))){throw "Invalid in expr ctx";}else{(other$39747=$39724$39730);(a$39752=it$0$38848.translate(binding$39720,"expr"));(b$39753=it$0$38848.translate(value$39721,"expr"));return (((("var "+a$39752)+"=")+b$39753)+";");}}else{if(($38898$38917&&(($38899$38918=($38857$38902[0]==="assign"))&&(((t1$38908=$38857$38902[1])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===3)&&(t1$38908[0]==="send")))))))){(obj$39762=t1$38908[1]);(msg$39763=t1$38908[2]);(rhs$39764=$38857$38902[2]);(a$39781=it$0$38848.translate(obj$39762,"expr"));(b$39782=it$0$38848.translate(msg$39763,"expr"));(c$39783=it$0$38848.translate(rhs$39764,"expr"));return it$0$38848.expr((((((("("+a$39781)+"[")+b$39782)+"]=")+c$39783)+")"),mode$38844);}else{if($38899$38918){(lhs$39795=$38857$38902[1]);(rhs$39796=$38857$38902[2]);(a$39802=it$0$38848.translate(lhs$39795,"expr"));(b$39803=it$0$38848.translate(rhs$39796,"expr"));return it$0$38848.expr((((("("+a$39802)+"=")+b$39803)+")"),mode$38844);}else{if(($38896$38915&&((t0$38907===1)&&($38857$38902[0]==="multi")))){return "";}else{if(($38896$38915&&(($38898$38917=(t0$38907>=1))&&($38857$38902[0]==="multi")))){(args$39816=Array.prototype.slice.call($38857$38902,1));(isdecl$39826=(function($39830$39833){var other$39864;var variable$39853;var value$39854;var t0$39849;var $39835$39844;var ph$39838;(ph$39838=$39830$39833);($39835$39844=ph$39838);if((($39835$39844 instanceof Array)&&(((t0$39849=$39835$39844.length)),((t0$39849===3)&&($39835$39844[0]==="declare"))))){(variable$39853=$39835$39844[1]);(value$39854=$39835$39844[2]);return true;}else{(other$39864=$39835$39844);return false;}}));($39821$39869=null);$39821$39869;if((args$39816.length===1)){return it$0$38848.translate(args$39816[0],mode$38844);}else{if(((mode$38844==="expr")&&(!args$39816.some(isdecl$39826)))){(xs$39887=(((acc$39895=[])),(((temp$39901=args$39816)),((($length$39907=temp$39901.length)),((($index$39913=0)),(function(){$39890:for(;($index$39913<$length$39907);($index$39913++)){var x$39930;var m$39922;(m$39922=temp$39901[$index$39913]);(x$39930=m$39922);acc$39895.push(it$0$38848.translate(x$39930,"expr"));}})()))),acc$39895));(xs$39887=(((acc$39941=[])),(((temp$39947=xs$39887)),((($length$39953=temp$39947.length)),((($index$39959=0)),(function(){$39936:for(;($index$39959<$length$39953);($index$39959++)){var x$39976;var m$39968;(m$39968=temp$39947[$index$39959]);(x$39976=m$39968);if((x$39976!=="")){acc$39941.push(x$39976);}else{false;}}})()))),acc$39941));return (("("+xs$39887.join(","))+")");}else{return it$0$38848.body(expr$38843,mode$38844);}}}else{if(($38898$38917&&($38857$38902[0]==="splice"))){(args$39987=Array.prototype.slice.call($38857$38902,1));return it$0$38848.translate(["multi"].concat(args$39987),mode$38844);}else{if(($38896$38915&&((t0$38907===2)&&($38857$38902[0]==="variable")))){(s$39992=$38857$38902[1]);return it$0$38848.expr(it$0$38848.mangle(s$39992),mode$38844);}else{if(($38896$38915&&((t0$38907===3)&&($38857$38902[0]==="scope")))){(vars$39997=$38857$38902[1]);(body$39998=$38857$38902[2]);(decls$40003=(((acc$40011=[])),(((temp$40017=vars$39997)),((($length$40023=temp$40017.length)),((($index$40029=0)),(function(){$40006:for(;($index$40029<$length$40023);($index$40029++)){var v$40046;var m$40038;(m$40038=temp$40017[$index$40029]);(v$40046=m$40038);acc$40011.push(["declare",v$40046,["value",(void 0)]]);}})()))),acc$40011));return it$0$38848.translate(["multi"].concat(decls$40003).concat([body$39998]),mode$38844);}else{if(($38896$38915&&((t0$38907>=1)&&($38857$38902[0]==="object2")))){(args$40052=Array.prototype.slice.call($38857$38902,1));(r$40057=(((f$40062=(function($40066$40069){var t0$40074;var t1$40075;var a$40091;var b$40092;var x$40071;var y$40072;(t0$40074=$40066$40069);if(((t0$40074 instanceof Array)&&(((t1$40075=t0$40074.length)),(t1$40075===2)))){(x$40071=t0$40074[0]);(y$40072=t0$40074[1]);}else{$40470($40066$40069);}(a$40091=it$0$38848.translate(x$40071,"expr"));(b$40092=it$0$38848.translate(y$40072,"expr"));return ((a$40091+":")+b$40092);}))),(("({"+args$40052.map(f$40062).join(","))+"})")));return it$0$38848.expr(r$40057,mode$38844);}else{if(($38896$38915&&((t0$38907===2)&&($38857$38902[0]==="js_new")))){(value$40103=$38857$38902[1]);return it$0$38848.expr((("(new "+it$0$38848.translate(value$40103,"expr"))+")"),mode$38844);}else{if(($38896$38915&&(($38898$38917=((t0$38907>=1)&&(t0$38907<=2)))&&(($38857$38902[0]==="js_break")&&(((t1$38908=(function(){if((1>=t0$38907)){return ["value",null];}else{return $38857$38902[1];}})())),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&(t1$38908[0]==="value"))))))))){(label$40108=t1$38908[1]);if((mode$38844==="expr")){throw "Invalid break in ctx";}else{return (("break"+(function(){if(label$40108){return (" "+label$40108);}else{return "";}})())+";");}}else{if(($38898$38917&&(($38857$38902[0]==="js_continue")&&(((t1$38908=(function(){if((1>=t0$38907)){return ["value",null];}else{return $38857$38902[1];}})())),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&(t1$38908[0]==="value")))))))){(label$40123=t1$38908[1]);if((mode$38844==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+(function(){if(label$40123){return (" "+label$40123);}else{return "";}})())+";");}}else{if(($38896$38915&&(($38898$38917=(t0$38907===2))&&($38857$38902[0]==="js_return")))){(value$40138=$38857$38902[1]);if((mode$38844==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$38848.translate(value$40138,"expr"))+";");}}else{if(($38898$38917&&($38857$38902[0]==="js_delete"))){(value$40143=$38857$38902[1]);if((mode$38844==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$38848.translate(value$40143,"expr"))+";");}}else{if(($38898$38917&&($38857$38902[0]==="js_throw"))){(value$40148=$38857$38902[1]);if((mode$38844==="expr")){return (("function(){throw "+it$0$38848.translate(value$40148,"expr"))+";}()");}else{return (("throw "+it$0$38848.translate(value$40148,"expr"))+";");}}else{if(($38896$38915&&(($38898$38917=(t0$38907===3))&&(($38857$38902[0]==="js_label")&&(((t1$38908=$38857$38902[1])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===2)&&(t1$38908[0]==="value"))))))))){(label$40153=t1$38908[1]);(body$40154=$38857$38902[2]);($40167$40172=mode$38844);if(($40167$40172==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$40184=$40167$40172);return ((label$40153+":")+it$0$38848.translate(body$40154,other$40184));}}else{if(($38898$38917&&($38857$38902[0]==="js_while"))){(test$40188=$38857$38902[1]);(body$40189=$38857$38902[2]);($40192$40197=mode$38844);if(($40192$40197==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$40209=$40192$40197);(a$40214=it$0$38848.translate(test$40188,"expr"));(b$40215=it$0$38848.translate(body$40189,"stmt"));return (((("while("+a$40214)+"){")+b$40215)+"}");}}else{if(($38896$38915&&((t0$38907===5)&&($38857$38902[0]==="js_for")))){(x$40224=$38857$38902[1]);(y$40225=$38857$38902[2]);(z$40226=$38857$38902[3]);(body$40227=$38857$38902[4]);($40230$40235=mode$38844);if(($40230$40235==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$40247=$40230$40235);(a$40254=it$0$38848.translate(x$40224,"expr"));(b$40255=it$0$38848.translate(y$40225,"expr"));(c$40256=it$0$38848.translate(z$40226,"expr"));(d$40257=it$0$38848.translate(body$40227,"stmt"));return (((((((("for("+a$40254)+";")+b$40255)+";")+c$40256)+"){")+d$40257)+"}");}}else{if(($38896$38915&&(($38898$38917=(t0$38907===4))&&($38857$38902[0]==="js_for_in")))){(x$40272=$38857$38902[1]);(y$40273=$38857$38902[2]);(body$40274=$38857$38902[3]);($40277$40282=mode$38844);if(($40277$40282==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$40294=$40277$40282);(a$40300=it$0$38848.translate(x$40272,"expr"));(b$40301=it$0$38848.translate(y$40273,"expr"));(c$40302=it$0$38848.translate(body$40274,"stmt"));return (((((("for("+a$40300)+" in ")+b$40301)+"){")+c$40302)+"}");}}else{if(($38898$38917&&(($38857$38902[0]==="js_try")&&((attempt$40314=$38857$38902[1]),(((t1$38908=$38857$38902[2])),((t1$38908 instanceof Array)&&(((t2$38909=t1$38908.length)),((t2$38909===3)&&((t1$38908[0]==="lambda")&&(((t3$38910=t1$38908[1])),((t3$38910 instanceof Array)&&(((t4$38911=t3$38910.length)),((t4$38911===1)&&(((bridge$38893$38913=t3$38910[0])),(((bridge$38893$38913 instanceof Array)&&(((t0$40346=bridge$38893$38913.length)),((t0$40346===2)&&((bridge$38893$38913[0]==="symbol")&&((v$40315=bridge$38893$38913[1]),true)))))||((bridge$38893$38913 instanceof Array)&&(((t0$40354=bridge$38893$38913.length)),((t0$40354===2)&&((bridge$38893$38913[0]==="variable")&&((v$40315=bridge$38893$38913[1]),true)))))))))))))))))))){(body$40316=t1$38908[2]);(finally$40317=$38857$38902[3]);(r$40367=((($40370$40375=mode$38844)),(function(){if(($40370$40375==="expr")){return it$0$38848.body(expr$38843,"expr");}else{(other$40387=$40370$40375);(a$40392=it$0$38848.translate(attempt$40314,"stmt"));(b$40393=it$0$38848.translate(body$40316,"stmt"));return (((((("try{"+a$40392)+"}catch(")+v$40315)+"){")+b$40393)+"}");}})()));($40364$40403=finally$40317);if((($40364$40403 instanceof Array)&&(((t0$40408=$40364$40403.length)),((t0$40408===1)&&($40364$40403[0]==="void"))))){return r$40367;}else{(other$40421=$40364$40403);return (((r$40367+"finally{")+it$0$38848.translate(other$40421,"stmt"))+"}");}}else{if(($38896$38915&&((t0$38907===2)&&($38857$38902[0]==="raw")))){(x$40425=$38857$38902[1]);return x$40425;}else{(other$40430=$38857$38902);throw other$40430;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}));$38302(Translator$38384,$38302(((accum$40435=({})),((accum$40435["::name"]="Translator"),accum$40435)),((accum$40439=({})),((accum$40439["::egclass"]=true),accum$40439))));Translator$38384;(translate$38385=(function(expr$40446,mode$40447){var tr$40452;var t$40453;(tr$40452=Translator$38384());(t$40453=tr$40452.translate(expr$40446,mode$40447));return (tr$40452.dump_store()+t$40453);}));(exports["Translator"]=Translator$38384);(exports["translate"]=translate$38385);
