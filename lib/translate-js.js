var $40406=(function(type$40409){var f$40413;(f$40413=type$40409["::check"]);if((f$40413===(void 0))){return (function(value$40419){return (value$40419 instanceof type$40409);});}else{return (function(value$40423){return f$40413.call(type$40409,value$40423);});}});
var $40425=(function(dest$40428,values$40429){var k$40434;(k$40434=null);$40432:for(k$40434 in values$40429){if(values$40429.hasOwnProperty(k$40434)){(dest$40428[k$40434]=values$40429[k$40434]);}}return dest$40428;});
var $40442=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $40443=(function($40445$40448){var ph$40454;(ph$40454=$40445$40448);var $40450$40460;($40450$40460=ph$40454);var bridge$40452$40465;var x$40469;(bridge$40452$40465=$40450$40460);if((((typeof(bridge$40452$40465)==="string")&&((x$40469=bridge$40452$40465),true))||((typeof(bridge$40452$40465)==="number")&&((x$40469=bridge$40452$40465),true)))){return ["value",x$40469];}else{var other$40480;(other$40480=$40450$40460);return other$40480["::serialize_ast"]();}});
var $40482=(function(obj$40485){var results$40490;(results$40490=[]);var k$40495;(k$40495=null);$40489:for(k$40495 in obj$40485){if(Object.prototype.hasOwnProperty.call(obj$40485,k$40495)){results$40490.push([k$40495,$40442(obj$40485,k$40495)]);}}return results$40490;});
var $40751=(function(arr$40754){var results$40760;var l$40761;(results$40760=[]);(l$40761=arr$40754.length);var i$40770;(i$40770=0);$40759:for(;(i$40770<l$40761);(i$40770++)){results$40760.push([i$40770,$40442(arr$40754,i$40770)]);}return results$40760;});
var $40518=(function(){var $40519$40525;($40519$40525=(function(tags$40530){var it$0$40533;(it$0$40533=(function(){if((!$40406($40519$40525)(this))){return Object.create($40519$40525.prototype);}else{return this;}})());(it$0$40533["tags"]=tags$40530);return it$0$40533;}));($40519$40525.prototype["create"]=(function(){var it$0$40553;var self$40554;(it$0$40553=this);(self$40554=this);var $40551$40563;($40551$40563=arguments);var t0$40568;var message$40572;var args$40573;(t0$40568=$40551$40563.length);if((t0$40568>=0)){(message$40572=(function(){if((0>=t0$40568)){return "";}else{return $40551$40563[0];}})());(args$40573=Array.prototype.slice.call($40551$40563,1));var e$40586;(e$40586=Error(message$40572));(e$40586["::tags"]=it$0$40553.tags);(e$40586["args"]=args$40573);var temp$40602;(temp$40602=$40751(args$40573));var $length$40608;($length$40608=temp$40602.length);var $index$40614;($index$40614=0);$40587:for(;($index$40614<$length$40608);($index$40614++)){var m$40623;(m$40623=temp$40602[$index$40614]);var t0$40628;var t1$40629;var i$40633;var arg$40634;(t0$40628=m$40623);if(((t0$40628 instanceof Array)&&(((t1$40629=t0$40628.length)),(t1$40629===2)))){(i$40633=t0$40628[0]);(arg$40634=t0$40628[1]);(e$40586[i$40633]=arg$40634);}else{$40499(m$40623);}}(e$40586["length"]=args$40573.length);(e$40586["name"]=["E"].concat(it$0$40553.tags).join("."));return e$40586;}else{$40499($40551$40563);}}));($40519$40525.prototype["::check"]=(function(e$40664){var it$0$40668;var self$40669;(it$0$40668=this);(self$40669=this);var tags$40679;if(((!e$40664)||(!$40406(Error)(e$40664)))){return false;}(tags$40679=(e$40664["::tags"]||[]));var temp$40690;(temp$40690=it$0$40668.tags);var $length$40696;($length$40696=temp$40690.length);var $index$40702;($index$40702=0);$40680:for(;($index$40702<$length$40696);($index$40702++)){var m$40711;(m$40711=temp$40690[$index$40702]);var tag$40719;(tag$40719=m$40711);if((tags$40679.indexOf(tag$40719)===-1)){return false;}else{false;}}return true;}));($40519$40525.prototype["::deconstruct"]=(function(e$40728){var it$0$40732;var self$40733;(it$0$40732=this);(self$40733=this);return e$40728.args;}));$40425($40519$40525,$40425((function(){var accum$40744;(accum$40744=({}));(accum$40744["::name"]="$40519");return accum$40744;})(),(function(){var accum$40748;(accum$40748=({}));(accum$40748["::egclass"]=true);return accum$40748;})()));return $40519$40525;})();
var $40499=(function(value$40502,url$40503,start$40504,end$40505){var err$40509;(err$40509=$40518(["match"]).create("Could not find a match for value",({"value":value$40502})));if(url$40503){(err$40509["location"]=["location",url$40503,start$40504,end$40505]);}throw err$40509;});
var send$40051;var __array_methods$40052;var __re_methods$40053;(send$40051=(function(obj$40066,$40063$40067){var ph$40073;var msg$40074;var t0$40076;(t0$40076=$40063$40067);(msg$40074=t0$40076);(ph$40073=t0$40076);var $40069$40085;($40069$40085=ph$40073);var bridge$40071$40090;(bridge$40071$40090=$40069$40085);if(((typeof(bridge$40071$40090)==="string")||(typeof(bridge$40071$40090)==="number"))){return obj$40066[msg$40074];}else{var other$40102;(other$40102=$40069$40085);return obj$40066["::send"](msg$40074);}}));(Array[":::project"]=(function($40108$40111){var ph$40116;var value$40117;var t0$40119;(t0$40119=$40108$40111);(value$40117=t0$40119);(ph$40116=t0$40119);var $40113$40128;($40113$40128=ph$40116);if($40406(Array)($40113$40128)){return [true,value$40117];}else{$40113$40128;return [true,[value$40117]];}}));(__array_methods$40052=$40425((function(){var accum$40149;(accum$40149=({}));(accum$40149["::check"]=(function(value$40154){if((value$40154 instanceof Array)){var i$40160;(i$40160=0);$40157:for(;(i$40160<this.length);(i$40160++)){if(($40442(this,i$40160)!==$40442(value$40154,i$40160))){return false;}}return true;}else{return false;}}));return accum$40149;})(),$40425((function(){var accum$40169;(accum$40169=({}));(accum$40169["::clone"]=(function(){return $40425(this.slice(0),this);}));return accum$40169;})(),$40425((function(){var accum$40176;(accum$40176=({}));(accum$40176[":::project"]=(function(value$40181){if((value$40181 instanceof Array)){var i$40187;(i$40187=0);$40184:for(;(i$40187<this.length);(i$40187++)){if(($40442(this,i$40187)!==$40442(value$40181,i$40187))){return [true,this.concat([value$40181])];}}return [true,value$40181];}else{return [true,this.concat([value$40181])];}}));return accum$40176;})(),(function(){var accum$40196;(accum$40196=({}));(accum$40196["::serialize_ast"]=(function(){return ["array"].concat(this.map($40443));}));return accum$40196;})()))));var temp$40206;(temp$40206=$40482(__array_methods$40052));var $length$40212;($length$40212=temp$40206.length);var $index$40218;($index$40218=0);$40054:for(;($index$40218<$length$40212);($index$40218++)){var m$40227;(m$40227=temp$40206[$index$40218]);var t0$40232;var t1$40233;var k$40237;var v$40238;(t0$40232=m$40227);if(((t0$40232 instanceof Array)&&(((t1$40233=t0$40232.length)),(t1$40233===2)))){(k$40237=t0$40232[0]);(v$40238=t0$40232[1]);if((!$40442(Array.prototype,k$40237))){Object.defineProperty(Array.prototype,k$40237,({"enumerable":false,"value":v$40238}));}}else{$40499(m$40227);}}(__re_methods$40053=$40425((function(){var accum$40258;(accum$40258=({}));(accum$40258["::check"]=(function($40262$40265){var ph$40270;(ph$40270=$40262$40265);var $40267$40276;($40267$40276=ph$40270);var value$40284;if((typeof($40267$40276)==="string")){(value$40284=$40267$40276);if(value$40284.match(this)){return true;}else{return false;}}else{var other$40289;(other$40289=$40267$40276);return false;}}));return accum$40258;})(),(function(){var accum$40292;(accum$40292=({}));(accum$40292[":::project"]=(function($40296$40299){var ph$40304;(ph$40304=$40296$40299);var $40301$40310;($40301$40310=ph$40304);var value$40318;if((typeof($40301$40310)==="string")){(value$40318=$40301$40310);var $40321$40326;($40321$40326=value$40318.match(this));var m$40334;if(($40321$40326===null)){(m$40334=$40321$40326);return [false,null];}else{var m$40339;(m$40339=$40321$40326);return [true,m$40339];}}else{var other$40343;(other$40343=$40301$40310);return [false,null];}}));return accum$40292;})()));var temp$40349;(temp$40349=$40482(__re_methods$40053));var $length$40355;($length$40355=temp$40349.length);var $index$40361;($index$40361=0);$40057:for(;($index$40361<$length$40355);($index$40361++)){var m$40370;(m$40370=temp$40349[$index$40361]);var t0$40375;var t1$40376;var k$40380;var v$40381;(t0$40375=m$40370);if(((t0$40375 instanceof Array)&&(((t1$40376=t0$40375.length)),(t1$40376===2)))){(k$40380=t0$40375[0]);(v$40381=t0$40375[1]);if((!$40442(RegExp.prototype,k$40380))){Object.defineProperty(RegExp.prototype,k$40380,({"enumerable":false,"value":v$40381}));}}else{$40499(m$40370);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$40425(({"enumerable":false}),(function(){var accum$40399;(accum$40399=({}));(accum$40399["value"]=(function(args$40404){return this.apply(this,args$40404);}));return accum$40399;})()));}
var $42894=(function(type$42897){return (function(value$42901){var f$42905;(f$42905=type$42897[":::project"]);if((f$42905===(void 0))){(f$42905=type$42897["::project"]);if((f$42905===(void 0))){return [true,type$42897(value$42901)];}else{var rval$42918;(rval$42918=false);try{(rval$42918=[true,f$42905(value$42901)]);}catch(excv$42929){var e$42935;(e$42935=excv$42929);(rval$42918=[false,null]);}return rval$42918;}}else{return f$42905.call(type$42897,value$42901);}});});
var $42941=(function($42943$42946,key$42947){var ph$42955;(ph$42955=$42943$42946);var $42949$42961;($42949$42961=ph$42955);var bridge$42951$42966;(bridge$42951$42966=$42949$42961);if(((bridge$42951$42966===null)||(bridge$42951$42966===(void 0)))){return false;}else{var x$42978;if((typeof($42949$42961)==="string")){(x$42978=$42949$42961);return (key$42947 in String.prototype);}else{var x$42983;if((typeof($42949$42961)==="number")){(x$42983=$42949$42961);return (key$42947 in Number.prototype);}else{var x$42988;(x$42988=$42949$42961);return (key$42947 in x$42988);}}}});var accum$42859;var accum$42863;var $40779$40798;var gensym$40799;var Body$40800;var $40780$40801;var __lt____gt__$40802;var js_op_table2$40803;var js_op_table$40804;var Translator$40805;var translate$40806;($40779$40798=require("./util"));(gensym$40799=$40779$40798.gensym);(Body$40800=$40779$40798.Body);($40780$40801=require("./pp"));(__lt____gt__$40802=$40780$40801["<>"]);(js_op_table2$40803=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$40804=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$40805=(function(){var prelude$40852;var t0$40848;var $40839$40843;var it$0$40834;(it$0$40834=(function(){if((!$40406(Translator$40805)(this))){return Object.create(Translator$40805.prototype);}else{return this;}})());($40839$40843=arguments);(t0$40848=$40839$40843.length);if(((t0$40848>=0)&&(t0$40848<=1))){(prelude$40852=(function(){if((0>=t0$40848)){return null;}else{return $40839$40843[0];}})());(it$0$40834["cache"]=({}));(it$0$40834["prepend"]=[]);if(prelude$40852){it$0$40834.prepend.push(it$0$40834.translate($40443(prelude$40852),"stmt"));}}else{$40499($40839$40843);}return it$0$40834;}));(Translator$40805.prototype["register_value"]=(function(v$40876,id$40877){var temp$40908;var name$40917;var $40890$40895;var it$0$40881;var self$40882;(it$0$40881=this);(self$40882=this);($40890$40895=$40442(it$0$40881.cache,id$40877));if(($40890$40895===(void 0))){(temp$40908=["symbol",gensym$40799()]);(it$0$40881.cache[id$40877]=temp$40908);it$0$40881.prepend.push(it$0$40881.translate(["declare",temp$40908,$40443(v$40876)],"stmt"));return temp$40908;}else{(name$40917=$40890$40895);return name$40917;}}));(Translator$40805.prototype["register_raw"]=(function(raw$40923,id$40924){var temp$40955;var name$40964;var $40937$40942;var it$0$40928;var self$40929;(it$0$40928=this);(self$40929=this);($40937$40942=$40442(it$0$40928.cache,id$40924));if(($40937$40942===(void 0))){(temp$40955=["symbol",gensym$40799()]);(it$0$40928.cache[id$40924]=temp$40955);it$0$40928.prepend.push(it$0$40928.translate(["declare",temp$40955,["raw",raw$40923]],"stmt"));return temp$40955;}else{(name$40964=$40937$40942);return name$40964;}}));(Translator$40805.prototype["dump_store"]=(function(){var rval$40985;var it$0$40973;var self$40974;(it$0$40973=this);(self$40974=this);(rval$40985=it$0$40973.prepend.join("\n"));(it$0$40973["prepend"]=[]);return rval$40985;}));(Translator$40805.prototype["mangle"]=(function(name$40996){var i$41023;var tr$41013;var r$41014;var it$0$41000;var self$41001;(it$0$41000=this);(self$41001=this);(tr$41013=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$41014=[]);(i$41023=0);$41012:for(;(i$41023<name$40996.length);(++i$41023)){var c$41032;(c$41032=$40442(name$40996,i$41023));r$41014.push(($40442(tr$41013,c$41032)||c$41032));}return r$41014.join("");}));(Translator$40805.prototype["body"]=(function(orig$41040,mode$41041){var t0$41065;var t1$41066;var t2$41067;var x$41106;var stmts$41117;var ret$41118;var other$41131;var $41057$41094;var b$41062;var trst$41063;var it$0$41045;var self$41046;(it$0$41045=this);(self$41046=this);(t0$41065=$42894(Body$40800)(orig$41040));if((t0$41065[0]&&(((t1$41066=t0$41065[1])),(((t2$41067=t1$41066.length)),(t2$41067>=0))))){(b$41062=Array.prototype.slice.call(t1$41066,0));}else{$40499(orig$41040,"/home/olivier/git/earl-grey/src/translate-js.eg",3075,3079);}(trst$41063=(function(stmt$41089){return it$0$41045.translate(stmt$41089,"stmt");}));($41057$41094=mode$41041);if(($41057$41094==="expr")){(x$41106=["send",["lambda",[],orig$41040],["array"]]);return it$0$41045.translate(x$41106,mode$41041);}else{if(($41057$41094==="return")){(stmts$41117=b$41062.slice(0,-1));(ret$41118=$40442(b$41062,(b$41062.length-1)));return (stmts$41117.map(trst$41063).join("")+it$0$41045.translate(ret$41118,"return"));}else{if(($41057$41094==="stmt")){return b$41062.map(trst$41063).join("");}else{(other$41131=$41057$41094);throw $40518(["syntax","mode"]).create("Unknown mode",({"mode":mode$41041}));}}}}));(Translator$40805.prototype["expr"]=(function(x$41137,mode$41138){var other$41178;var $41151$41158;var it$0$41142;var self$41143;(it$0$41142=this);(self$41143=this);($41151$41158=mode$41138);if(($41151$41158==="expr")){return x$41137;}else{if(($41151$41158==="stmt")){return (x$41137+";");}else{if(($41151$41158==="return")){return (("return "+x$41137)+";");}else{(other$41178=$41151$41158);throw "OopsI";}}}}));(Translator$40805.prototype["op"]=(function(op$41184,a$41185,b$41186){var $41208$41222;var $41209$41223;var $41210$41224;var t0$41218;var t1$41219;var t2$41220;var $41204$41213;var e$41201;var it$0$41190;var self$41191;(it$0$41190=this);(self$41191=this);(e$41201=((($41204$41213=[a$41185,b$41186])),(function(){if((($41208$41222=($41204$41213 instanceof Array))&&(((t0$41218=$41204$41213.length)),(($41210$41224=(t0$41218===2))&&(((t1$41219=$41204$41213[0])),((t1$41219 instanceof Array)&&(((t2$41220=t1$41219.length)),((t2$41220===1)&&(t1$41219[0]==="void"))))))))){$41204$41213[1];return (op$41184+it$0$41190.translate(b$41186,"expr"));}else{if(($41210$41224&&($41204$41213[0],(((t1$41219=$41204$41213[1])),((t1$41219 instanceof Array)&&(((t2$41220=t1$41219.length)),((t2$41220===1)&&(t1$41219[0]==="void")))))))){return (it$0$41190.translate(a$41185,"expr")+op$41184);}else{$41204$41213;return ((it$0$41190.translate(a$41185,"expr")+op$41184)+it$0$41190.translate(b$41186,"expr"));}}})()));return (("("+e$41201)+")");}));(Translator$40805.prototype["translate"]=(function(expr$41267,mode$41268){var repl$41393;var it$0$41432;var it$0$41426;var it$0$41420;var it$0$41414;var bridge$41374$41451;var bridge$41373$41444;var other$41466;var id$41460;var bridge$41372$41384;var $41367$41379;var r$41364;var t0$41505;var t0$41512;var trf$41532;var trmsg$41533;var trf$41577;var trmsg$41578;var trf$41592;var trmsg$41593;var otherwise$41587;var $41559$41564;var x$41653;var x$41643;var $41626$41638;var $41627$41639;var $41628$41640;var t0$41636;var $41622$41631;var $index$41693;var $length$41687;var temp$41681;var acc$41675;var trf$41663;var trargs$41664;var op$41619;var code$41732;var code$41746;var t0$41724;var t1$41725;var trf$41753;var trmsg$41754;var codevar$41722;var f$41773;var r$41768;var f$41848;var f$41894;var v$41888;var all_strings$41790;var r$41791;var $index$41981;var $length$41975;var temp$41969;var acc$41963;var a$41948;var b$41949;var name$41941;var a$42045;var b$42046;var other$42040;var $42023$42028;var a$42083;var b$42084;var c$42085;var other$42077;var $42060$42065;var a$42138;var other$42134;var bridge$42113$42122;var $42111$42117;var a$42176;var b$42177;var other$42171;var bridge$42150$42159;var $42148$42154;var a$42205;var b$42206;var c$42207;var a$42226;var b$42227;var $index$42337;var $length$42331;var temp$42325;var acc$42319;var $index$42383;var $length$42377;var temp$42371;var acc$42365;var xs$42311;var $42249$42299;var $42245$42293;var isdecl$42250;var $index$42453;var $length$42447;var temp$42441;var acc$42435;var decls$42427;var f$42486;var r$42481;var other$42608;var $42591$42596;var a$42638;var b$42639;var other$42633;var $42616$42621;var a$42678;var b$42679;var c$42680;var d$42681;var other$42671;var $42654$42659;var a$42724;var b$42725;var c$42726;var other$42718;var $42701$42706;var t0$42770;var t0$42778;var a$42816;var b$42817;var other$42811;var $42794$42799;var other$42845;var t0$42832;var $42788$42827;var r$42791;var other$42854;var x$42849;var attempt$42738;var v$42739;var body$42740;var finally$42741;var x$42696;var y$42697;var body$42698;var x$42648;var y$42649;var z$42650;var body$42651;var test$42612;var body$42613;var label$42577;var body$42578;var value$42572;var value$42567;var value$42562;var label$42547;var label$42532;var value$42527;var args$42476;var vars$42421;var body$42422;var s$42416;var args$42411;var args$42240;var lhs$42219;var rhs$42220;var obj$42186;var msg$42187;var rhs$42188;var binding$42144;var value$42145;var binding$42097;var test$42055;var pos$42056;var neg$42057;var test$42007;var pos$42008;var bindings$41935;var body$41936;var args$41784;var args$41763;var f$41716;var msg$41717;var f$41602;var args$41603;var f$41542;var msg$41543;var s$41544;var f$41496;var msg$41497;var f$41471;var v$41359;var s$41345;var $41320$41339;var $41321$41340;var $41322$41341;var $41323$41342;var t0$41331;var t1$41332;var t2$41333;var t3$41334;var t4$41335;var bridge$41287$41336;var bridge$41317$41337;var $41281$41326;var it$0$41272;var self$41273;(it$0$41272=this);(self$41273=this);($41281$41326=expr$41267);if((($41320$41339=($41281$41326 instanceof Array))&&(((t0$41331=$41281$41326.length)),((t0$41331===2)&&($41281$41326[0]==="symbol"))))){(s$41345=$41281$41326[1]);return it$0$41272.expr(it$0$41272.mangle(s$41345),mode$41268);}else{if(($41320$41339&&((t0$41331===1)&&($41281$41326[0]==="void")))){return it$0$41272.expr("null",mode$41268);}else{if(($41320$41339&&((t0$41331===2)&&($41281$41326[0]==="value")))){(v$41359=$41281$41326[1]);(r$41364=((($41367$41379=v$41359)),(function(){if((typeof($41367$41379)==="string")){(repl$41393=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$41359=v$41359.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),(function(m$41401){return $40442(repl$41393,m$41401);})));return (("\""+v$41359)+"\"");}else{if(($41367$41379===(void 0))){return "(void 0)";}else{if($40406(RegExp)($41367$41379)){(it$0$41414=String(v$41359));(it$0$41420=it$0$41414.slice(1,-1));(it$0$41426=it$0$41420.replace(RegExp("/","g"),"\\/"));(it$0$41432=it$0$41426.replace(RegExp("\\n","g"),"\\n"));return "/".concat(it$0$41432).concat("/");}else{(bridge$41372$41384=$41367$41379);if(((((bridge$41373$41444=bridge$41372$41384)),((((bridge$41374$41451=bridge$41373$41444)),((typeof(bridge$41374$41451)==="number")||(bridge$41374$41451===true)))||(bridge$41373$41444===false)))||(bridge$41372$41384===null))){return String(v$41359);}else{if(($42941($41367$41379,"::id")&&((id$41460=$41367$41379["::id"]),id$41460))){return it$0$41272.translate(it$0$41272.register_value(v$41359,id$41460),mode$41268);}else{(other$41466=$41367$41379);throw $40518(["cannot_serialize"]).create("Cannot serialize value",({"value":v$41359}));}}}}}})()));return it$0$41272.expr(r$41364,mode$41268);}else{if(($41320$41339&&(($41322$41341=(t0$41331===3))&&(($41323$41342=($41281$41326[0]==="send"))&&(((t1$41332=$41281$41326[1])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&((t1$41332[0]==="variable")&&((t1$41332[1]==="___node")&&(((t3$41334=$41281$41326[2])),((t3$41334 instanceof Array)&&(((t4$41335=t3$41334.length)),((t4$41335===2)&&(t3$41334[0]==="value"))))))))))))))){(f$41471=t3$41334[1]);return f$41471;}else{if(($41323$41342&&(((bridge$41287$41336=$41281$41326[1])),((((bridge$41287$41336 instanceof Array)&&(((t0$41505=bridge$41287$41336.length)),((t0$41505===2)&&((bridge$41287$41336[0]==="symbol")&&(bridge$41287$41336[1]==="___js_fetch")))))||((bridge$41287$41336 instanceof Array)&&(((t0$41512=bridge$41287$41336.length)),((t0$41512===2)&&((bridge$41287$41336[0]==="variable")&&(bridge$41287$41336[1]==="___js_fetch"))))))&&(((t1$41332=$41281$41326[2])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===3)&&(t1$41332[0]==="array"))))))))){(f$41496=t1$41332[1]);(msg$41497=t1$41332[2]);(trf$41532=it$0$41272.translate(f$41496,"expr"));(trmsg$41533=it$0$41272.translate(msg$41497,"expr"));return it$0$41272.expr((((trf$41532+"[")+trmsg$41533)+"]"),mode$41268);}else{if(($41323$41342&&((f$41542=$41281$41326[1]),(((t1$41332=$41281$41326[2])),((msg$41543=t1$41332),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&(t1$41332[0]==="value"))))))))){(s$41544=t1$41332[1]);($41559$41564=null);$41559$41564;if(((typeof(s$41544)==="string")&&s$41544.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$41577=it$0$41272.translate(f$41542,"expr"));(trmsg$41578=it$0$41272.translate(["symbol",s$41544],"expr"));return it$0$41272.expr(((trf$41577+".")+trmsg$41578),mode$41268);}else{(otherwise$41587=$41559$41564);(trf$41592=it$0$41272.translate(f$41542,"expr"));(trmsg$41593=it$0$41272.translate(msg$41543,"expr"));return it$0$41272.expr((((trf$41592+"[")+trmsg$41593)+"]"),mode$41268);}}else{if(($41323$41342&&((f$41602=$41281$41326[1]),(((t1$41332=$41281$41326[2])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333>=1)&&(t1$41332[0]==="array")))))))){(args$41603=Array.prototype.slice.call(t1$41332,1));(op$41619=((($41622$41631=f$41602)),(function(){if((($41626$41638=($41622$41631 instanceof Array))&&(((t0$41636=$41622$41631.length)),(($41628$41640=(t0$41636===2))&&($41622$41631[0]==="symbol"))))){(x$41643=$41622$41631[1]);return $40442(js_op_table$40804,x$41643);}else{if(($41628$41640&&($41622$41631[0]==="variable"))){(x$41653=$41622$41631[1]);return $40442(js_op_table2$40803,x$41653);}else{$41622$41631;return null;}}})()));if(op$41619){return it$0$41272.expr(it$0$41272.op(op$41619,args$41603[0],args$41603[1]),mode$41268);}else{(trf$41663=it$0$41272.translate(f$41602,"expr"));(trargs$41664=(((acc$41675=[])),(((temp$41681=args$41603)),((($length$41687=temp$41681.length)),((($index$41693=0)),(function(){$41670:for(;($index$41693<$length$41687);($index$41693++)){var x$41710;var m$41702;(m$41702=temp$41681[$index$41693]);(x$41710=m$41702);acc$41675.push(it$0$41272.translate(x$41710,"expr"));}})()))),acc$41675));return it$0$41272.expr((((trf$41663+"(")+trargs$41664.join(","))+")"),mode$41268);}}else{if($41323$41342){(f$41716=$41281$41326[1]);(msg$41717=$41281$41326[2]);(t0$41724=(((code$41732="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41272.register_raw(code$41732,"~send")));if(((t0$41724 instanceof Array)&&(((t1$41725=t0$41724.length)),((t1$41725===2)&&(t0$41724[0]==="symbol"))))){(codevar$41722=t0$41724[1]);}else{$40499((((code$41746="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41272.register_raw(code$41746,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6702,6912);}(trf$41753=it$0$41272.translate(f$41716,"expr"));(trmsg$41754=it$0$41272.translate(msg$41717,"expr"));return it$0$41272.expr((((((codevar$41722+"(")+trf$41753)+",")+trmsg$41754)+")"),mode$41268);}else{if(($41320$41339&&(($41322$41341=(t0$41331>=1))&&($41281$41326[0]==="array")))){(args$41763=Array.prototype.slice.call($41281$41326,1));(r$41768=(((f$41773=(function(x$41778){return it$0$41272.translate(x$41778,"expr");}))),(("["+args$41763.map(f$41773).join(","))+"]")));return it$0$41272.expr(r$41768,mode$41268);}else{if(($41322$41341&&($41281$41326[0]==="object"))){(args$41784=Array.prototype.slice.call($41281$41326,1));(all_strings$41790=args$41784.every((function($41795$41798){var t0$41806;var t1$41807;var other$41841;var v$41831;var t0$41827;var $41800$41822;var ph$41803;var y$41804;(t0$41806=$41795$41798);if(((t0$41806 instanceof Array)&&(((t1$41807=t0$41806.length)),((t1$41807===3)&&(t0$41806[0]==="array"))))){(ph$41803=t0$41806[1]);(y$41804=t0$41806[2]);}else{$40499($41795$41798);}($41800$41822=ph$41803);if((($41800$41822 instanceof Array)&&(((t0$41827=$41800$41822.length)),((t0$41827===2)&&($41800$41822[0]==="value"))))){(v$41831=$41800$41822[1]);return true;}else{(other$41841=$41800$41822);return false;}})));(r$41791=(function(){if(all_strings$41790){(f$41848=(function($41852$41855){var t0$41860;var t1$41861;var a$41877;var b$41878;var x$41857;var y$41858;(t0$41860=$41852$41855);if(((t0$41860 instanceof Array)&&(((t1$41861=t0$41860.length)),((t1$41861===3)&&(t0$41860[0]==="array"))))){(x$41857=t0$41860[1]);(y$41858=t0$41860[2]);}else{$40499($41852$41855);}(a$41877=it$0$41272.translate(x$41857,"expr"));(b$41878=it$0$41272.translate(y$41858,"expr"));return ((a$41877+":")+b$41878);}));return (("({"+args$41784.map(f$41848).join(","))+"})");}else{(v$41888=gensym$40799());(f$41894=(function($41898$41901){var t0$41906;var t1$41907;var a$41923;var b$41924;var x$41903;var y$41904;(t0$41906=$41898$41901);if(((t0$41906 instanceof Array)&&(((t1$41907=t0$41906.length)),((t1$41907===3)&&(t0$41906[0]==="array"))))){(x$41903=t0$41906[1]);(y$41904=t0$41906[2]);}else{$40499($41898$41901);}(a$41923=it$0$41272.translate(x$41903,"expr"));(b$41924=it$0$41272.translate(y$41904,"expr"));return (((((v$41888+"[")+a$41923)+"]=")+b$41924)+";");}));return ((((((("(function(){"+"var ")+v$41888)+"={};")+args$41784.map(f$41894).join(""))+";return ")+v$41888)+";}())");}})());return it$0$41272.expr(r$41791,mode$41268);}else{if(($41320$41339&&((t0$41331===3)&&($41281$41326[0]==="lambda")))){(bindings$41935=$41281$41326[1]);(body$41936=$41281$41326[2]);(name$41941=(function(){if($40406(RegExp("^[$_a-zA-Z]*$",""))(expr$41267.name)){return (expr$41267.name+" ");}else{return "";}})());(a$41948=(((acc$41963=[])),(((temp$41969=bindings$41935)),((($length$41975=temp$41969.length)),((($index$41981=0)),(function(){$41958:for(;($index$41981<$length$41975);($index$41981++)){var x$41998;var m$41990;(m$41990=temp$41969[$index$41981]);(x$41998=m$41990);acc$41963.push(it$0$41272.translate(x$41998,"expr"));}})()))),acc$41963).join(","));(b$41949=it$0$41272.body(body$41936,"return"));return it$0$41272.expr((((((("(function"+name$41941)+"(")+a$41948)+"){")+b$41949)+"})"),mode$41268);}else{if(($41320$41339&&(($41322$41341=(t0$41331===4))&&(($41323$41342=($41281$41326[0]==="if"))&&((test$42007=$41281$41326[1]),((pos$42008=$41281$41326[2]),(((t1$41332=$41281$41326[3])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&((t1$41332[0]==="value")&&(t1$41332[1]===(void 0))))))))))))){($42023$42028=mode$41268);if(($42023$42028==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42040=$42023$42028);(a$42045=it$0$41272.translate(test$42007,"expr"));(b$42046=it$0$41272.translate(pos$42008,mode$41268));return (((("if("+a$42045)+"){")+b$42046)+"}");}}else{if($41323$41342){(test$42055=$41281$41326[1]);(pos$42056=$41281$41326[2]);(neg$42057=$41281$41326[3]);($42060$42065=mode$41268);if(($42060$42065==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42077=$42060$42065);(a$42083=it$0$41272.translate(test$42055,"expr"));(b$42084=it$0$41272.translate(pos$42056,mode$41268));(c$42085=it$0$41272.translate(neg$42057,mode$41268));return (((((("if("+a$42083)+"){")+b$42084)+"}else{")+c$42085)+"}");}}else{if(($41320$41339&&(($41322$41341=(t0$41331===3))&&(($41323$41342=($41281$41326[0]==="declare"))&&((binding$42097=$41281$41326[1]),(((t1$41332=$41281$41326[2])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&((t1$41332[0]==="value")&&(t1$41332[1]===(void 0)))))))))))){($42111$42117=mode$41268);(bridge$42113$42122=$42111$42117);if(((bridge$42113$42122==="expr")||(bridge$42113$42122==="return"))){throw "Invalid in expr ctx";}else{(other$42134=$42111$42117);(a$42138=it$0$41272.translate(binding$42097,"expr"));return (("var "+a$42138)+";");}}else{if($41323$41342){(binding$42144=$41281$41326[1]);(value$42145=$41281$41326[2]);($42148$42154=mode$41268);(bridge$42150$42159=$42148$42154);if(((bridge$42150$42159==="expr")||(bridge$42150$42159==="return"))){throw "Invalid in expr ctx";}else{(other$42171=$42148$42154);(a$42176=it$0$41272.translate(binding$42144,"expr"));(b$42177=it$0$41272.translate(value$42145,"expr"));return (((("var "+a$42176)+"=")+b$42177)+";");}}else{if(($41322$41341&&(($41323$41342=($41281$41326[0]==="assign"))&&(((t1$41332=$41281$41326[1])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===3)&&(t1$41332[0]==="send")))))))){(obj$42186=t1$41332[1]);(msg$42187=t1$41332[2]);(rhs$42188=$41281$41326[2]);(a$42205=it$0$41272.translate(obj$42186,"expr"));(b$42206=it$0$41272.translate(msg$42187,"expr"));(c$42207=it$0$41272.translate(rhs$42188,"expr"));return it$0$41272.expr((((((("("+a$42205)+"[")+b$42206)+"]=")+c$42207)+")"),mode$41268);}else{if($41323$41342){(lhs$42219=$41281$41326[1]);(rhs$42220=$41281$41326[2]);(a$42226=it$0$41272.translate(lhs$42219,"expr"));(b$42227=it$0$41272.translate(rhs$42220,"expr"));return it$0$41272.expr((((("("+a$42226)+"=")+b$42227)+")"),mode$41268);}else{if(($41320$41339&&((t0$41331===1)&&($41281$41326[0]==="multi")))){return "";}else{if(($41320$41339&&(($41322$41341=(t0$41331>=1))&&($41281$41326[0]==="multi")))){(args$42240=Array.prototype.slice.call($41281$41326,1));(isdecl$42250=(function($42254$42257){var other$42288;var variable$42277;var value$42278;var t0$42273;var $42259$42268;var ph$42262;(ph$42262=$42254$42257);($42259$42268=ph$42262);if((($42259$42268 instanceof Array)&&(((t0$42273=$42259$42268.length)),((t0$42273===3)&&($42259$42268[0]==="declare"))))){(variable$42277=$42259$42268[1]);(value$42278=$42259$42268[2]);return true;}else{(other$42288=$42259$42268);return false;}}));($42245$42293=null);$42245$42293;if((args$42240.length===1)){return it$0$41272.translate(args$42240[0],mode$41268);}else{if(((mode$41268==="expr")&&(!args$42240.some(isdecl$42250)))){(xs$42311=(((acc$42319=[])),(((temp$42325=args$42240)),((($length$42331=temp$42325.length)),((($index$42337=0)),(function(){$42314:for(;($index$42337<$length$42331);($index$42337++)){var x$42354;var m$42346;(m$42346=temp$42325[$index$42337]);(x$42354=m$42346);acc$42319.push(it$0$41272.translate(x$42354,"expr"));}})()))),acc$42319));(xs$42311=(((acc$42365=[])),(((temp$42371=xs$42311)),((($length$42377=temp$42371.length)),((($index$42383=0)),(function(){$42360:for(;($index$42383<$length$42377);($index$42383++)){var x$42400;var m$42392;(m$42392=temp$42371[$index$42383]);(x$42400=m$42392);if((x$42400!=="")){acc$42365.push(x$42400);}else{false;}}})()))),acc$42365));return (("("+xs$42311.join(","))+")");}else{return it$0$41272.body(expr$41267,mode$41268);}}}else{if(($41322$41341&&($41281$41326[0]==="splice"))){(args$42411=Array.prototype.slice.call($41281$41326,1));return it$0$41272.translate(["multi"].concat(args$42411),mode$41268);}else{if(($41320$41339&&((t0$41331===2)&&($41281$41326[0]==="variable")))){(s$42416=$41281$41326[1]);return it$0$41272.expr(it$0$41272.mangle(s$42416),mode$41268);}else{if(($41320$41339&&((t0$41331===3)&&($41281$41326[0]==="scope")))){(vars$42421=$41281$41326[1]);(body$42422=$41281$41326[2]);(decls$42427=(((acc$42435=[])),(((temp$42441=vars$42421)),((($length$42447=temp$42441.length)),((($index$42453=0)),(function(){$42430:for(;($index$42453<$length$42447);($index$42453++)){var v$42470;var m$42462;(m$42462=temp$42441[$index$42453]);(v$42470=m$42462);acc$42435.push(["declare",v$42470,["value",(void 0)]]);}})()))),acc$42435));return it$0$41272.translate(["multi"].concat(decls$42427).concat([body$42422]),mode$41268);}else{if(($41320$41339&&((t0$41331>=1)&&($41281$41326[0]==="object2")))){(args$42476=Array.prototype.slice.call($41281$41326,1));(r$42481=(((f$42486=(function($42490$42493){var t0$42498;var t1$42499;var a$42515;var b$42516;var x$42495;var y$42496;(t0$42498=$42490$42493);if(((t0$42498 instanceof Array)&&(((t1$42499=t0$42498.length)),(t1$42499===2)))){(x$42495=t0$42498[0]);(y$42496=t0$42498[1]);}else{$40499($42490$42493);}(a$42515=it$0$41272.translate(x$42495,"expr"));(b$42516=it$0$41272.translate(y$42496,"expr"));return ((a$42515+":")+b$42516);}))),(("({"+args$42476.map(f$42486).join(","))+"})")));return it$0$41272.expr(r$42481,mode$41268);}else{if(($41320$41339&&((t0$41331===2)&&($41281$41326[0]==="js_new")))){(value$42527=$41281$41326[1]);return it$0$41272.expr((("(new "+it$0$41272.translate(value$42527,"expr"))+")"),mode$41268);}else{if(($41320$41339&&(($41322$41341=((t0$41331>=1)&&(t0$41331<=2)))&&(($41281$41326[0]==="js_break")&&(((t1$41332=(function(){if((1>=t0$41331)){return ["value",null];}else{return $41281$41326[1];}})())),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&(t1$41332[0]==="value"))))))))){(label$42532=t1$41332[1]);if((mode$41268==="expr")){throw "Invalid break in ctx";}else{return (("break"+(function(){if(label$42532){return (" "+label$42532);}else{return "";}})())+";");}}else{if(($41322$41341&&(($41281$41326[0]==="js_continue")&&(((t1$41332=(function(){if((1>=t0$41331)){return ["value",null];}else{return $41281$41326[1];}})())),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&(t1$41332[0]==="value")))))))){(label$42547=t1$41332[1]);if((mode$41268==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+(function(){if(label$42547){return (" "+label$42547);}else{return "";}})())+";");}}else{if(($41320$41339&&(($41322$41341=(t0$41331===2))&&($41281$41326[0]==="js_return")))){(value$42562=$41281$41326[1]);if((mode$41268==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$41272.translate(value$42562,"expr"))+";");}}else{if(($41322$41341&&($41281$41326[0]==="js_delete"))){(value$42567=$41281$41326[1]);if((mode$41268==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$41272.translate(value$42567,"expr"))+";");}}else{if(($41322$41341&&($41281$41326[0]==="js_throw"))){(value$42572=$41281$41326[1]);if((mode$41268==="expr")){return (("function(){throw "+it$0$41272.translate(value$42572,"expr"))+";}()");}else{return (("throw "+it$0$41272.translate(value$42572,"expr"))+";");}}else{if(($41320$41339&&(($41322$41341=(t0$41331===3))&&(($41281$41326[0]==="js_label")&&(((t1$41332=$41281$41326[1])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===2)&&(t1$41332[0]==="value"))))))))){(label$42577=t1$41332[1]);(body$42578=$41281$41326[2]);($42591$42596=mode$41268);if(($42591$42596==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42608=$42591$42596);return ((label$42577+":")+it$0$41272.translate(body$42578,other$42608));}}else{if(($41322$41341&&($41281$41326[0]==="js_while"))){(test$42612=$41281$41326[1]);(body$42613=$41281$41326[2]);($42616$42621=mode$41268);if(($42616$42621==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42633=$42616$42621);(a$42638=it$0$41272.translate(test$42612,"expr"));(b$42639=it$0$41272.translate(body$42613,"stmt"));return (((("while("+a$42638)+"){")+b$42639)+"}");}}else{if(($41320$41339&&((t0$41331===5)&&($41281$41326[0]==="js_for")))){(x$42648=$41281$41326[1]);(y$42649=$41281$41326[2]);(z$42650=$41281$41326[3]);(body$42651=$41281$41326[4]);($42654$42659=mode$41268);if(($42654$42659==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42671=$42654$42659);(a$42678=it$0$41272.translate(x$42648,"expr"));(b$42679=it$0$41272.translate(y$42649,"expr"));(c$42680=it$0$41272.translate(z$42650,"expr"));(d$42681=it$0$41272.translate(body$42651,"stmt"));return (((((((("for("+a$42678)+";")+b$42679)+";")+c$42680)+"){")+d$42681)+"}");}}else{if(($41320$41339&&(($41322$41341=(t0$41331===4))&&($41281$41326[0]==="js_for_in")))){(x$42696=$41281$41326[1]);(y$42697=$41281$41326[2]);(body$42698=$41281$41326[3]);($42701$42706=mode$41268);if(($42701$42706==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42718=$42701$42706);(a$42724=it$0$41272.translate(x$42696,"expr"));(b$42725=it$0$41272.translate(y$42697,"expr"));(c$42726=it$0$41272.translate(body$42698,"stmt"));return (((((("for("+a$42724)+" in ")+b$42725)+"){")+c$42726)+"}");}}else{if(($41322$41341&&(($41281$41326[0]==="js_try")&&((attempt$42738=$41281$41326[1]),(((t1$41332=$41281$41326[2])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===3)&&((t1$41332[0]==="lambda")&&(((t3$41334=t1$41332[1])),((t3$41334 instanceof Array)&&(((t4$41335=t3$41334.length)),((t4$41335===1)&&(((bridge$41317$41337=t3$41334[0])),(((bridge$41317$41337 instanceof Array)&&(((t0$42770=bridge$41317$41337.length)),((t0$42770===2)&&((bridge$41317$41337[0]==="symbol")&&((v$42739=bridge$41317$41337[1]),true)))))||((bridge$41317$41337 instanceof Array)&&(((t0$42778=bridge$41317$41337.length)),((t0$42778===2)&&((bridge$41317$41337[0]==="variable")&&((v$42739=bridge$41317$41337[1]),true)))))))))))))))))))){(body$42740=t1$41332[2]);(finally$42741=$41281$41326[3]);(r$42791=((($42794$42799=mode$41268)),(function(){if(($42794$42799==="expr")){return it$0$41272.body(expr$41267,"expr");}else{(other$42811=$42794$42799);(a$42816=it$0$41272.translate(attempt$42738,"stmt"));(b$42817=it$0$41272.translate(body$42740,"stmt"));return (((((("try{"+a$42816)+"}catch(")+v$42739)+"){")+b$42817)+"}");}})()));($42788$42827=finally$42741);if((($42788$42827 instanceof Array)&&(((t0$42832=$42788$42827.length)),((t0$42832===1)&&($42788$42827[0]==="void"))))){return r$42791;}else{(other$42845=$42788$42827);return (((r$42791+"finally{")+it$0$41272.translate(other$42845,"stmt"))+"}");}}else{if(($41320$41339&&((t0$41331===2)&&($41281$41326[0]==="raw")))){(x$42849=$41281$41326[1]);return x$42849;}else{(other$42854=$41281$41326);throw other$42854;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}));$40425(Translator$40805,$40425(((accum$42859=({})),((accum$42859["::name"]="Translator"),accum$42859)),((accum$42863=({})),((accum$42863["::egclass"]=true),accum$42863))));Translator$40805;(translate$40806=(function(expr$42870,mode$42871){var tr$42876;var t$42877;(tr$42876=Translator$40805());(t$42877=tr$42876.translate(expr$42870,mode$42871));return (tr$42876.dump_store()+t$42877);}));(exports["Translator"]=Translator$40805);(exports["translate"]=translate$40806);
