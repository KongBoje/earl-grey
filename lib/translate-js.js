var τ2127=function(type){var τ2128=type["::check"];var f;if((τ2128===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ2128),true)){return function(value){return f.call(type,value);};}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2128}));}}};
var τ2129=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};
var τ2119=function(){var τ2120=function(tags){var τ2121=function(){if((!τ2127(τ2120)(this))){return Object.create(τ2120.prototype);}else{return this;}}();(τ2121["tags"]=tags);return τ2121;};τ2129(τ2120);(τ2120.prototype["create"]=function(){var τ2122=Array.prototype.slice.call(arguments,0);var τp0;var message;var args;if(((τ2122 instanceof Array)&&(((τp0=τ2122.length),true)&&((τp0>=0)&&((message=function(){if((0>=τp0)){return "";}else{return τ2122[0];}}()),true,(args=τ2122.slice(1)),true))))){var τ2121=this;var e=Error(message);(e["::tags"]=τ2121.tags);(e["args"]=args);(e["name"]=["E"].concat(τ2121.tags).join("."));return e;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2122}));}});(τ2120.prototype["::check"]=function(e){var τ2121=this;if(((!e)||(!τ2127(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var τ2123=τ2121.tags;var τ2124=τ2123.length;for(var τ2125=0;(τ2125<τ2124);(τ2125++)){var τ2126=τ2123[τ2125];var tag;var other;if(((tag=τ2126),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=τ2126),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2126}));}}}false;return true;});(τ2120.prototype["::deconstruct"]=function(e){var τ2121=this;return e.args;});return τ2120;}();
var τ2130=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ2131=function(τ2132){var τ2133=τ2132;var x;var x;var other;if((((typeof(τ2133)==="string")&&((x=τ2133),true))||((typeof(τ2133)==="number")&&((x=τ2133),true)))){return ["value",x];}else{if(((other=τ2133),true)){return other["::serialize_ast"]();}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2133}));}}};
var send=function(obj,τ2112){var msg;var τ2111;(msg=τ2112);true;(τ2111=τ2112);var τ2113=τ2111;var other;if(((typeof(τ2113)==="string")||(typeof(τ2113)==="number"))){return obj[msg];}else{if(((other=τ2113),true)){return obj["::send"](msg);}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2113}));}}};(Array[":::project"]=function(τ2115){var value;var τ2114;(value=τ2115);true;(τ2114=τ2115);var τ2116=τ2114;var _;if(τ2127(Array)(τ2116)){return [true,value];}else{if(((_=τ2116),true)){return [true,[value]];}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2116}));}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ2130(["array"],this.map(τ2131));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ2117=value.match(this);var m;var m;if(((τ2117===null)&&((m=τ2117),true))){return [false,null];}else{if(((m=τ2117),true)){return [true,m];}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2117}));}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ2118=value.match(this);var m;var m;if(((τ2118===null)&&((m=τ2118),true))){return [false,null];}else{if(((m=τ2118),true)){return [true,m];}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2118}));}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});
var τ2216=function(τ2217,key){var τ2218=τ2217;var x;var x;var x;if(((τ2218===null)||(τ2218===(void 0)))){return false;}else{if(((typeof(τ2218)==="string")&&((x=τ2218),true))){return (key in String.prototype);}else{if(((typeof(τ2218)==="number")&&((x=τ2218),true))){return (key in Number.prototype);}else{if(((x=τ2218),true)){return (key in x);}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2218}));}}}}};var τ2134=require("./util");var items=τ2134.items;var τ2135=require("./helpers");var aslist=τ2135.aslist;var gensym=τ2135.gensym;var τ2136=require("./pp");var __lt____gt__=τ2136["<>"];var js_op_table2=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"});var js_op_table=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"});var Translator=function(){var τ2138=Array.prototype.slice.call(arguments,0);var τp0;var prelude;if(((τ2138 instanceof Array)&&(((τp0=τ2138.length),true)&&(((τp0>=0)&&(τp0<=1))&&((prelude=function(){if((0>=τp0)){return null;}else{return τ2138[0];}}()),true))))){var τ2137=function(){if((!τ2127(Translator)(this))){return Object.create(Translator.prototype);}else{return this;}}();(τ2137["cache"]=({}));(τ2137["prepend"]=[]);if(prelude){τ2137.prepend.push(τ2137.translate(τ2131(prelude),"stmt"));}else{null;}return τ2137;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2138}));}};τ2129(Translator);(Translator.prototype["register_value"]=function(v,id){var τ2137=this;var τ2139=send(τ2137.cache,id);var name;if((τ2139===(void 0))){var temp=gensym();(τ2137.cache[id]=temp);τ2137.prepend.push(τ2137.translate(["declare",temp,τ2131(v)],"stmt"));return temp;}else{if(((name=τ2139),true)){return name;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2139}));}}});(Translator.prototype["register_raw"]=function(raw,id){var τ2137=this;var τ2140=send(τ2137.cache,id);var name;if((τ2140===(void 0))){var temp=gensym();(τ2137.cache[id]=temp);τ2137.prepend.push(τ2137.translate(["declare",temp,["raw",raw]],"stmt"));return temp;}else{if(((name=τ2140),true)){return name;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2140}));}}});(Translator.prototype["dump_store"]=function(){var τ2137=this;var rval=τ2137.prepend.join("\n");(τ2137["prepend"]=[]);return rval;});(Translator.prototype["mangle"]=function(name){var τ2137=this;var tr=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"});var r=[];for(var i=0;(i<name.length);(++i)){var c=send(name,i);r.push((send(tr,c)||c));}return r.join("");});(Translator.prototype["body"]=function(b,mode){var τ2137=this;var orig=b;(b=aslist(b));var trst=function(stmt){return τ2137.translate(stmt,"stmt");};var τ2141=mode;var other;if((τ2141==="expr")){var x=["send",["lambda",[],orig],["array"]];return τ2137.translate(x,mode);}else{if((τ2141==="return")){var stmts=b.slice(0,(-1));var ret=send(b,(b.length-1));return (stmts.map(trst).join("")+τ2137.translate(ret,"return"));}else{if((τ2141==="stmt")){return b.map(trst).join("");}else{if(((other=τ2141),true)){throw τ2119(["syntax","mode"]).create("Unknown mode",({"mode":mode}));}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2141}));}}}}});(Translator.prototype["expr"]=function(x,mode){var τ2137=this;var τ2142=mode;var other;if((τ2142==="expr")){return x;}else{if((τ2142==="stmt")){return (x+";");}else{if((τ2142==="return")){return (("return "+x)+";");}else{if(((other=τ2142),true)){throw "OopsI";}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2142}));}}}}});(Translator.prototype["op"]=function(op,a,b){var τ2137=this;var e=function(){var τ2143=[a,b];var τp0;var τp1;var τp2;var τp3;var _;var τp0;var _;var τp1;var τp2;var τp3;var _;var τ2144=false;var τ2145=false;var τ2146=false;if(((τ2144=(τ2143 instanceof Array))&&((τ2145=((τp0=τ2143.length),true))&&((τ2146=(τp0===2))&&(((τp1=τ2143[0]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===1)&&(((τp3=τp1[0]),(τp3==="void"))&&((_=τ2143[1]),true))))))))){return (op+τ2137.translate(b,"expr"));}else{if((τ2146&&(((_=τ2143[0]),true,(τp1=τ2143[1]),(τp1 instanceof Array))&&(((τp2=τp1.length),true)&&((τp2===1)&&((τp3=τp1[0]),(τp3==="void"))))))){return (τ2137.translate(a,"expr")+op);}else{if(((_=τ2143),true)){return ((τ2137.translate(a,"expr")+op)+τ2137.translate(b,"expr"));}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2143}));}}}}();return (("("+e)+")");});(Translator.prototype["translate"]=function(expr,mode){var τ2137=this;var τ2147=expr;var τp0;var τp1;var s;var τp0;var τp1;var τp0;var τp1;var v;var τp0;var τp1;var τp2;var τp3;var τp4;var τp5;var τp6;var τp7;var τp8;var f;var τp0;var τp1;var τp2;var τ2151;var τ2152;var τ2153;var τ2148;var τ2149;var τ2150;var τp3;var τp4;var τp5;var f;var msg;var τp0;var τp1;var f;var τp2;var msg;var τp3;var τp4;var s;var τp0;var τp1;var f;var τp2;var τp3;var τp4;var args;var τp0;var τp1;var f;var msg;var τp0;var τp1;var args;var τp0;var τp1;var args;var τp0;var τp1;var bindings;var body;var τp0;var τp1;var test;var pos;var τp2;var τp3;var τp4;var τp5;var τp0;var τp1;var test;var pos;var neg;var τp0;var τp1;var binding;var τp2;var τp3;var τp4;var τp5;var τp0;var τp1;var binding;var value;var τp0;var τp1;var τp2;var τp3;var τp4;var obj;var msg;var rhs;var τp0;var τp1;var lhs;var rhs;var τp0;var τp1;var τp0;var τp1;var args;var τp0;var τp1;var args;var τp0;var τp1;var s;var τp0;var τp1;var vars;var body;var τp0;var τp1;var args;var τp0;var τp1;var value;var τp0;var τp1;var τp2;var τp3;var τp4;var label;var τp0;var τp1;var τp2;var τp3;var τp4;var label;var τp0;var τp1;var value;var τp0;var τp1;var value;var τp0;var τp1;var value;var τp0;var τp1;var τp2;var τp3;var τp4;var label;var body;var τp0;var τp1;var test;var body;var τp0;var τp1;var x;var y;var z;var body;var τp0;var τp1;var x;var y;var body;var τp0;var τp1;var attempt;var τp2;var τp3;var τp4;var τp5;var τp6;var τp7;var τ2156;var τ2157;var v;var τ2154;var τ2155;var v;var body;var τp8;var τp9;var τp10;var τp0;var τp1;var x;var other;var τ2158=false;var τ2159=false;var τ2160=false;var τ2161=false;if(((τ2158=(τ2147 instanceof Array))&&((τ2159=((τp0=τ2147.length),true))&&((τp0===2)&&(((τp1=τ2147[0]),(τp1==="symbol"))&&((s=τ2147[1]),true)))))){return τ2137.expr(τ2137.mangle(s),mode);}else{if((τ2159&&((τp0===1)&&((τp1=τ2147[0]),(τp1==="void"))))){return τ2137.expr("null",mode);}else{if((τ2159&&((τp0===2)&&(((τp1=τ2147[0]),(τp1==="value"))&&((v=τ2147[1]),true))))){var r=function(){var τ2162=v;var id;var other;if((typeof(τ2162)==="string")){var repl=({"\"":"\\\"","\n":"\\n","\\":"\\\\"});(v=v.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m){return send(repl,m);}));return (("\""+v)+"\"");}else{if((τ2162===(void 0))){return "(void 0)";}else{if(τ2127(RegExp)(τ2162)){var τ2163=String(v);(τ2163=τ2163.slice(1,(-1)));(τ2163=τ2163.replace(RegExp("/","g"),"\\/"));(τ2163=τ2163.replace(RegExp("\n","g"),"\\n"));(τ2163="/".concat(τ2163).concat("/"));return τ2163;}else{if(((((typeof(τ2162)==="number")||(τ2162===true))||(τ2162===false))||(τ2162===null))){return String(v);}else{if((τ2216(τ2162,"::id")&&((id=τ2162["::id"]),true,id))){return τ2137.translate(τ2137.register_value(v,id),mode);}else{if(((other=τ2162),true)){throw τ2119(["cannot_serialize"]).create("Cannot serialize value",({"value":v}));}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2162}));}}}}}}}();return τ2137.expr(r,mode);}else{if((τ2159&&((τ2160=(τp0===3))&&((τ2161=((τp1=τ2147[0]),(τp1==="send")))&&(((τp2=τ2147[1]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="symbol"))&&(((τp5=τp2[1]),(τp5==="___node"))&&(((τp6=τ2147[2]),(τp6 instanceof Array))&&(((τp7=τp6.length),true)&&((τp7===2)&&(((τp8=τp6[0]),(τp8==="value"))&&((f=τp6[1]),true)))))))))))))){return f;}else{if((τ2161&&(((τp2=τ2147[1]),(((τp2 instanceof Array)&&(((τ2148=τp2.length),true)&&((τ2148===2)&&(((τ2149=τp2[0]),(τ2149==="symbol"))&&((τ2150=τp2[1]),(τ2150==="___js_fetch"))))))||((τp2 instanceof Array)&&(((τ2151=τp2.length),true)&&((τ2151===2)&&(((τ2152=τp2[0]),(τ2152==="variable"))&&((τ2153=τp2[1]),(τ2153==="___js_fetch"))))))))&&(((τp3=τ2147[2]),(τp3 instanceof Array))&&(((τp4=τp3.length),true)&&((τp4===3)&&(((τp5=τp3[0]),(τp5==="array"))&&((f=τp3[1]),true,(msg=τp3[2]),true)))))))){var trf=τ2137.translate(f,"expr");var trmsg=τ2137.translate(msg,"expr");return τ2137.expr((((trf+"[")+trmsg)+"]"),mode);}else{if((τ2161&&(((f=τ2147[1]),true,(τp2=τ2147[2]),(msg=τp2),true,(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((s=τp2[1]),true))))))){var τ2164=null;var otherwise;if(((typeof(s)==="string")&&s.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){var trf=τ2137.translate(f,"expr");var trmsg=τ2137.translate(["symbol",s],"expr");return τ2137.expr(((trf+".")+trmsg),mode);}else{if(((otherwise=τ2164),true)){var trf=τ2137.translate(f,"expr");var trmsg=τ2137.translate(msg,"expr");return τ2137.expr((((trf+"[")+trmsg)+"]"),mode);}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2164}));}}}else{if((τ2161&&(((f=τ2147[1]),true,(τp2=τ2147[2]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3>=1)&&(((τp4=τp2[0]),(τp4==="array"))&&((args=τp2.slice(1)),true))))))){var op=function(){var τ2165=f;var τp0;var τp1;var x;var τp0;var τp1;var x;var _;var τ2166=false;var τ2167=false;var τ2168=false;if(((τ2166=(τ2165 instanceof Array))&&((τ2167=((τp0=τ2165.length),true))&&((τ2168=(τp0===2))&&(((τp1=τ2165[0]),(τp1==="symbol"))&&((x=τ2165[1]),true)))))){return send(js_op_table,x);}else{if((τ2168&&(((τp1=τ2165[0]),(τp1==="variable"))&&((x=τ2165[1]),true)))){return send(js_op_table2,x);}else{if(((_=τ2165),true)){return null;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2165}));}}}}();if(op){return τ2137.expr(τ2137.op(op,args[0],args[1]),mode);}else{var trf=τ2137.translate(f,"expr");var trargs=function(){var τ2169=[];var τ2170=args;var τ2171=τ2170.length;for(var τ2172=0;(τ2172<τ2171);(τ2172++)){var τ2173=τ2170[τ2172];var x;var other;if(((x=τ2173),true)){τ2169.push(τ2137.translate(x,"expr"));}else{if(((other=τ2173),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2173}));}}}return τ2169;}();return τ2137.expr((((trf+"(")+trargs.join(","))+")"),mode);}}else{if((τ2161&&((f=τ2147[1]),true,(msg=τ2147[2]),true))){var τp0;var τp1;var τp2;var codevar;if((((τp0=function(){var code="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})";return τ2137.register_raw(code,"~send");}()),(τp0 instanceof Array))&&(((τp1=τp0.length),true)&&((τp1===2)&&(((τp2=τp0[0]),(τp2==="symbol"))&&((codevar=τp0[1]),true)))))){undefined;}else{throw τ2119(["match"]).create("The value failed to match");}var trf=τ2137.translate(f,"expr");var trmsg=τ2137.translate(msg,"expr");return τ2137.expr((((((codevar+"(")+trf)+",")+trmsg)+")"),mode);}else{if((τ2159&&((τ2160=(τp0>=1))&&(((τp1=τ2147[0]),(τp1==="array"))&&((args=τ2147.slice(1)),true))))){var r=function(){var f=function(x){return τ2137.translate(x,"expr");};return (("["+args.map(f).join(","))+"]");}();return τ2137.expr(r,mode);}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="object"))&&((args=τ2147.slice(1)),true)))){var r=function(){var f=function(τ2174){var τp0;var τp1;var x;var y;if(((τ2174 instanceof Array)&&(((τp0=τ2174.length),true)&&((τp0===3)&&(((τp1=τ2174[0]),(τp1==="array"))&&((x=τ2174[1]),true,(y=τ2174[2]),true)))))){undefined;}else{throw τ2119(["match"]).create("The value failed to match");}var a=τ2137.translate(x,"expr");var b=τ2137.translate(y,"expr");return ((a+":")+b);};return (("({"+args.map(f).join(","))+"})");}();return τ2137.expr(r,mode);}else{if((τ2159&&((τp0===3)&&(((τp1=τ2147[0]),(τp1==="lambda"))&&((bindings=τ2147[1]),true,(body=τ2147[2]),true))))){var a=function(){var τ2183=[];var τ2184=bindings;var τ2185=τ2184.length;for(var τ2186=0;(τ2186<τ2185);(τ2186++)){var τ2187=τ2184[τ2186];var x;var other;if(((x=τ2187),true)){τ2183.push(τ2137.translate(x,"expr"));}else{if(((other=τ2187),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2187}));}}}return τ2183;}().join(",");var b=τ2137.body(body,"return");return τ2137.expr((((("function("+a)+"){")+b)+"}"),mode);}else{if((τ2159&&((τ2160=(τp0===4))&&((τ2161=((τp1=τ2147[0]),(τp1==="if")))&&(((test=τ2147[1]),true,(pos=τ2147[2]),true,(τp2=τ2147[3]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((τp5=τp2[1]),(τp5===(void 0))))))))))){var τ2188=mode;var other;if((τ2188==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2188),true)){var a=τ2137.translate(test,"expr");var b=τ2137.translate(pos,mode);return (((("if("+a)+"){")+b)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2188}));}}}else{if((τ2161&&((test=τ2147[1]),true,(pos=τ2147[2]),true,(neg=τ2147[3]),true))){var τ2189=mode;var other;if((τ2189==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2189),true)){var a=τ2137.translate(test,"expr");var b=τ2137.translate(pos,mode);var c=τ2137.translate(neg,mode);return (((((("if("+a)+"){")+b)+"}else{")+c)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2189}));}}}else{if((τ2159&&((τ2160=(τp0===3))&&((τ2161=((τp1=τ2147[0]),(τp1==="declare")))&&(((binding=τ2147[1]),true,(τp2=τ2147[2]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((τp5=τp2[1]),(τp5===(void 0))))))))))){var τ2190=mode;var other;if(((τ2190==="expr")||(τ2190==="return"))){throw "Invalid in expr ctx";}else{if(((other=τ2190),true)){var a=τ2137.translate(binding,"expr");return (("var "+a)+";");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2190}));}}}else{if((τ2161&&((binding=τ2147[1]),true,(value=τ2147[2]),true))){var τ2191=mode;var other;if(((τ2191==="expr")||(τ2191==="return"))){throw "Invalid in expr ctx";}else{if(((other=τ2191),true)){var a=τ2137.translate(binding,"expr");var b=τ2137.translate(value,"expr");return (((("var "+a)+"=")+b)+";");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2191}));}}}else{if((τ2160&&((τ2161=((τp1=τ2147[0]),(τp1==="assign")))&&(((τp2=τ2147[1]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===3)&&(((τp4=τp2[0]),(τp4==="send"))&&((obj=τp2[1]),true,(msg=τp2[2]),true,(rhs=τ2147[2]),true)))))))){var a=τ2137.translate(obj,"expr");var b=τ2137.translate(msg,"expr");var c=τ2137.translate(rhs,"expr");return τ2137.expr((((((("("+a)+"[")+b)+"]=")+c)+")"),mode);}else{if((τ2161&&((lhs=τ2147[1]),true,(rhs=τ2147[2]),true))){var a=τ2137.translate(lhs,"expr");var b=τ2137.translate(rhs,"expr");return τ2137.expr((((("("+a)+"=")+b)+")"),mode);}else{if((τ2159&&((τp0===1)&&((τp1=τ2147[0]),(τp1==="multi"))))){if((mode==="stmt")){return ";";}else{return "";}}else{if((τ2159&&((τ2160=(τp0>=1))&&(((τp1=τ2147[0]),(τp1==="multi"))&&((args=τ2147.slice(1)),true))))){var isdecl=function(τ2193){var τ2194=τ2193;var τp0;var τp1;var variable;var value;var other;if(((τ2194 instanceof Array)&&(((τp0=τ2194.length),true)&&((τp0===3)&&(((τp1=τ2194[0]),(τp1==="declare"))&&((variable=τ2194[1]),true,(value=τ2194[2]),true)))))){return true;}else{if(((other=τ2194),true)){return false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2194}));}}};var τ2192=null;var _;if((args.length===1)){return τ2137.translate(args[0],mode);}else{if(((mode==="expr")&&(!args.some(isdecl)))){var xs=function(){var τ2195=[];var τ2196=args;var τ2197=τ2196.length;for(var τ2198=0;(τ2198<τ2197);(τ2198++)){var τ2199=τ2196[τ2198];var x;var other;if(((x=τ2199),true)){τ2195.push(τ2137.translate(x,"expr"));}else{if(((other=τ2199),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2199}));}}}return τ2195;}();(xs=function(){var τ2200=[];var τ2201=xs;var τ2202=τ2201.length;for(var τ2203=0;(τ2203<τ2202);(τ2203++)){var τ2204=τ2201[τ2203];var x;var other;if(((x=τ2204),true,(x!==""))){τ2200.push(x);}else{if(((other=τ2204),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2204}));}}}return τ2200;}());return (("("+xs.join(","))+")");}else{if(((_=τ2192),true)){return τ2137.body(expr,mode);}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2192}));}}}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="splice"))&&((args=τ2147.slice(1)),true)))){return τ2137.translate(τ2130(["multi"],args),mode);}else{if((τ2159&&((τp0===2)&&(((τp1=τ2147[0]),(τp1==="variable"))&&((s=τ2147[1]),true))))){return τ2137.expr(τ2137.mangle(s),mode);}else{if((τ2159&&((τp0===3)&&(((τp1=τ2147[0]),(τp1==="scope"))&&((vars=τ2147[1]),true,(body=τ2147[2]),true))))){var decls=function(){var τ2205=[];var τ2206=vars;var τ2207=τ2206.length;for(var τ2208=0;(τ2208<τ2207);(τ2208++)){var τ2209=τ2206[τ2208];var v;var other;if(((v=τ2209),true)){τ2205.push(["declare",v,["value",undefined]]);}else{if(((other=τ2209),true)){false;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2209}));}}}return τ2205;}();return τ2137.translate(τ2130(["multi"],decls,[body]),mode);}else{if((τ2159&&((τp0>=1)&&(((τp1=τ2147[0]),(τp1==="object2"))&&((args=τ2147.slice(1)),true))))){var r=function(){var f=function(τ2210){var τp0;var x;var y;if(((τ2210 instanceof Array)&&(((τp0=τ2210.length),true)&&((τp0===2)&&((x=τ2210[0]),true,(y=τ2210[1]),true))))){undefined;}else{throw τ2119(["match"]).create("The value failed to match");}var a=τ2137.translate(x,"expr");var b=τ2137.translate(y,"expr");return ((a+":")+b);};return (("({"+args.map(f).join(","))+"})");}();return τ2137.expr(r,mode);}else{if((τ2159&&((τp0===2)&&(((τp1=τ2147[0]),(τp1==="js_new"))&&((value=τ2147[1]),true))))){return τ2137.expr((("(new "+τ2137.translate(value,"expr"))+")"),mode);}else{if((τ2159&&((τ2160=((τp0>=1)&&(τp0<=2)))&&(((τp1=τ2147[0]),(τp1==="js_break"))&&(((τp2=function(){if((1>=τp0)){return ["value",null];}else{return τ2147[1];}}()),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((label=τp2[1]),true))))))))){if((mode==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label){return (" "+label);}else{return "";}}())+";");}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="js_continue"))&&(((τp2=function(){if((1>=τp0)){return ["value",null];}else{return τ2147[1];}}()),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((label=τp2[1]),true)))))))){if((mode==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label){return (" "+label);}else{return "";}}())+";");}}else{if((τ2159&&((τ2160=(τp0===2))&&(((τp1=τ2147[0]),(τp1==="js_return"))&&((value=τ2147[1]),true))))){if((mode==="expr")){throw "Invalid return in ctx";}else{return (("return "+τ2137.translate(value,"expr"))+";");}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="js_delete"))&&((value=τ2147[1]),true)))){if((mode==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+τ2137.translate(value,"expr"))+";");}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="js_throw"))&&((value=τ2147[1]),true)))){if((mode==="expr")){return (("function(){throw "+τ2137.translate(value,"expr"))+";}()");}else{return (("throw "+τ2137.translate(value,"expr"))+";");}}else{if((τ2159&&((τ2160=(τp0===3))&&(((τp1=τ2147[0]),(τp1==="js_label"))&&(((τp2=τ2147[1]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===2)&&(((τp4=τp2[0]),(τp4==="value"))&&((label=τp2[1]),true,(body=τ2147[2]),true))))))))){var τ2211=mode;var other;if((τ2211==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2211),true)){return ((label+":")+τ2137.translate(body,other));}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2211}));}}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="js_while"))&&((test=τ2147[1]),true,(body=τ2147[2]),true)))){var τ2212=mode;var other;if((τ2212==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2212),true)){var a=τ2137.translate(test,"expr");var b=τ2137.translate(body,"stmt");return (((("while("+a)+"){")+b)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2212}));}}}else{if((τ2159&&((τp0===5)&&(((τp1=τ2147[0]),(τp1==="js_for"))&&((x=τ2147[1]),true,(y=τ2147[2]),true,(z=τ2147[3]),true,(body=τ2147[4]),true))))){var τ2213=mode;var other;if((τ2213==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2213),true)){var a=τ2137.translate(x,"stmt");var b=τ2137.translate(y,"stmt");var c=τ2137.translate(z,"expr");var d=τ2137.translate(body,"stmt");return (((((("for("+a)+b)+c)+"){")+d)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2213}));}}}else{if((τ2159&&((τ2160=(τp0===4))&&(((τp1=τ2147[0]),(τp1==="js_for_in"))&&((x=τ2147[1]),true,(y=τ2147[2]),true,(body=τ2147[3]),true))))){var τ2214=mode;var other;if((τ2214==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2214),true)){var a=τ2137.translate(x,"expr");var b=τ2137.translate(y,"expr");var c=τ2137.translate(body,"stmt");return (((((("for("+a)+" in ")+b)+"){")+c)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2214}));}}}else{if((τ2160&&(((τp1=τ2147[0]),(τp1==="js_try"))&&(((attempt=τ2147[1]),true,(τp2=τ2147[2]),(τp2 instanceof Array))&&(((τp3=τp2.length),true)&&((τp3===3)&&(((τp4=τp2[0]),(τp4==="lambda"))&&(((τp5=τp2[1]),(τp5 instanceof Array))&&(((τp6=τp5.length),true)&&((τp6===1)&&(((τp7=τp5[0]),(((τp7 instanceof Array)&&(((τ2154=τp7.length),true)&&((τ2154===2)&&(((τ2155=τp7[0]),(τ2155==="symbol"))&&((v=τp7[1]),true)))))||((τp7 instanceof Array)&&(((τ2156=τp7.length),true)&&((τ2156===2)&&(((τ2157=τp7[0]),(τ2157==="variable"))&&((v=τp7[1]),true)))))))&&(((body=τp2[2]),true,(τp8=τ2147[3]),(τp8 instanceof Array))&&(((τp9=τp8.length),true)&&((τp9===1)&&((τp10=τp8[0]),(τp10==="void")))))))))))))))){var τ2215=mode;var other;if((τ2215==="expr")){return τ2137.body(expr,"expr");}else{if(((other=τ2215),true)){var a=τ2137.translate(attempt,"stmt");var b=τ2137.translate(body,"stmt");return (((((("try{"+a)+"}catch(")+v)+"){")+b)+"}");}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2215}));}}}else{if((τ2159&&((τp0===2)&&(((τp1=τ2147[0]),(τp1==="raw"))&&((x=τ2147[1]),true))))){return x;}else{if(((other=τ2147),true)){throw other;}else{throw τ2119(["match"]).create("Could not find a match",({"value":τ2147}));}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});Translator;var translate=function(expr,mode){var tr=Translator();var t=tr.translate(expr,mode);return (tr.dump_store()+t);};(exports["Translator"]=Translator);(exports["translate"]=translate);
