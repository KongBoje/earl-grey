var $22980=function(type$22982){var f$22985;(f$22985=type$22982["::check"]);;if((f$22985===(void 0))){return function(value$22990){return (value$22990 instanceof type$22982);};}else{return function(value$22993){return f$22985.call(type$22982,value$22993);};}};
var $22995=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $22996=function($22997$22999){var ph$23003;(ph$23003=$22997$22999);;var $23001$23008;($23001$23008=ph$23003);;var bridge$23002$23013;var x$23017;(bridge$23002$23013=$23001$23008);if((((typeof(bridge$23002$23013)==="string")&&((x$23017=bridge$23002$23013),true))||((typeof(bridge$23002$23013)==="number")&&((x$23017=bridge$23002$23013),true)))){return ["value",x$23017];}else{var other$23024;(other$23024=$23001$23008);return other$23024["::serialize_ast"]();}};
var send$22820;(send$22820=function(obj$22825,$22823$22826){var ph$22830;var msg$22831;var t0$22833;(t0$22833=$22823$22826);(msg$22831=t0$22833);(ph$22830=t0$22833);;var $22828$22837;($22828$22837=ph$22830);;var bridge$22829$22842;(bridge$22829$22842=$22828$22837);if(((typeof(bridge$22829$22842)==="string")||(typeof(bridge$22829$22842)==="number"))){return obj$22825[msg$22831];}else{var other$22850;(other$22850=$22828$22837);return obj$22825["::send"](msg$22831);}});;(Array[":::project"]=function($22853$22855){var ph$22858;var value$22859;var t0$22861;(t0$22861=$22853$22855);(value$22859=t0$22861);(ph$22858=t0$22861);;var $22857$22865;($22857$22865=ph$22858);;if($22980(Array)($22857$22865)){return [true,value$22859];}else{$22857$22865;return [true,[value$22859]];}});(Array.prototype["::check"]=function(value$22879){if((value$22879 instanceof Array)){var i$22884;(i$22884=0);;$22882:for(;(i$22884<this.length);(i$22884++)){if(($22995(this,i$22884)!==$22995(value$22879,i$22884))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$22895){if((value$22895 instanceof Array)){var i$22900;(i$22900=0);;$22898:for(;(i$22900<this.length);(i$22900++)){if(($22995(this,i$22900)!==$22995(value$22895,i$22900))){return [true,[value$22895]];}}return [true,value$22895.slice(this.length)];}else{return [true,[value$22895]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($22996));});(RegExp.prototype["::check"]=function($22910$22912){var ph$22915;(ph$22915=$22910$22912);;var $22914$22920;($22914$22920=ph$22915);;var value$22928;if((typeof($22914$22920)==="string")){(value$22928=$22914$22920);if(value$22928.match(this)){return true;}else{return false;}}else{var other$22933;(other$22933=$22914$22920);return false;}});(RegExp.prototype[":::project"]=function($22935$22937){var ph$22940;(ph$22940=$22935$22937);;var $22939$22945;($22939$22945=ph$22940);;var value$22953;if((typeof($22939$22945)==="string")){(value$22953=$22939$22945);var $22956$22958;($22956$22958=value$22953.match(this));;var m$22966;if(($22956$22958===null)){(m$22966=$22956$22958);return [false,null];}else{var m$22971;(m$22971=$22956$22958);return [true,m$22971];}}else{var other$22975;(other$22975=$22939$22945);return [false,null];}});(Function.prototype["::send"]=function(args$22978){return this.apply(this,args$22978);});
var $24739=function(arr$24741){var results$24745;var l$24746;(results$24745=[]);;(l$24746=arr$24741.length);;var i$24754;(i$24754=0);;$24744:for(;(i$24754<l$24746);(i$24754++)){results$24745.push([i$24754,$22995(arr$24741,i$24754)]);}return results$24745;};
var $24761=function(dest$24763,values$24764){var k$24769;(k$24769=null);$24767:for(k$24769 in values$24764){if(values$24764.hasOwnProperty(k$24769)){(dest$24763[k$24769]=values$24764[k$24769]);}}return dest$24763;};
var $24570=function(){var $24571$24573;($24571$24573=function(tags$24577){var it$0$24580;(it$0$24580=function(){if((!$22980($24571$24573)(this))){return Object.create($24571$24573.prototype);}else{return this;}}());;(it$0$24580["tags"]=tags$24577);return it$0$24580;});;($24571$24573.prototype["create"]=function(){var $24589$24591;($24589$24591=arguments);;var t0$24596;var message$24600;var args$24601;(t0$24596=$24589$24591.length);if((t0$24596>=0)){(message$24600=function(){if((0>=t0$24596)){return "";}else{return $24589$24591[0];}}());(args$24601=Array.prototype.slice.call($24589$24591,1));var it$0$24605;(it$0$24605=this);;var self$24610;(self$24610=this);;var e$24615;(e$24615=Error(message$24600));;(e$24615["::tags"]=it$0$24605.tags);(e$24615["args"]=args$24601);var temp$24623;(temp$24623=$24739(args$24601));;var $length$24628;($length$24628=temp$24623.length);;var $index$24633;($index$24633=0);;$24616:for(;($index$24633<$length$24628);($index$24633++)){var m$24641;(m$24641=temp$24623[$index$24633]);;var t0$24646;var t1$24647;var i$24651;var arg$24652;(t0$24646=m$24641);if(((t0$24646 instanceof Array)&&((t1$24647=t0$24646.length),(t1$24647===2)))){(i$24651=t0$24646[0]);(arg$24652=t0$24646[1]);(e$24615[i$24651]=arg$24652);}else{$24557(m$24641);;}}(e$24615["length"]=args$24601.length);(e$24615["name"]=["E"].concat(it$0$24605.tags).join("."));return e$24615;}else{$24557($24589$24591);}});($24571$24573.prototype["::check"]=function(e$24663){var it$0$24666;(it$0$24666=this);;var self$24671;(self$24671=this);;var tags$24676;if(((!e$24663)||(!$22980(Error)(e$24663)))){return false;}(tags$24676=(e$24663["::tags"]||[]));;var temp$24685;(temp$24685=it$0$24666.tags);;var $length$24690;($length$24690=temp$24685.length);;var $index$24695;($index$24695=0);;$24677:for(;($index$24695<$length$24690);($index$24695++)){var m$24703;(m$24703=temp$24685[$index$24695]);;var tag$24711;(tag$24711=m$24703);if((tags$24676.indexOf(tag$24711)===-1)){return false;}else{false;;}}return true;});($24571$24573.prototype["::deconstruct"]=function(e$24719){var it$0$24722;(it$0$24722=this);;var self$24727;(self$24727=this);;return e$24719.args;});$24761($24571$24573,$24761(function(){var accum$24732;(accum$24732=({}));(accum$24732["::name"]="$24571");return accum$24732;}(),function(){var accum$24736;(accum$24736=({}));(accum$24736["::egclass"]=true);return accum$24736;}()));return $24571$24573;}();
var $24557=function(value$24559,url$24560,start$24561,end$24562){var err$24565;(err$24565=$24570(["match"]).create("Could not find a match for value",({"value":value$24559})));;if(url$24560){(err$24565["location"]=["location",url$24560,start$24561,end$24562]);}throw err$24565;};
var $24773=function(type$24775){return function(value$24778){var f$24781;(f$24781=type$24775[":::project"]);;if((f$24781===(void 0))){var f$24786;(f$24786=type$24775["::project"]);;if((f$24786===(void 0))){return [true,type$24775(value$24778)];}else{var rval$24791;(rval$24791=false);;try{(rval$24791=[true,f$24786(value$24778)]);}catch(excv$24797){var e$24803;(e$24803=excv$24797);(rval$24791=[false,null]);}return rval$24791;}}else{return f$24781.call(type$24775,value$24778);}};};
var $24805=function($24806$24808,key$24809){var ph$24813;(ph$24813=$24806$24808);;var $24811$24818;($24811$24818=ph$24813);;var bridge$24812$24823;(bridge$24812$24823=$24811$24818);if(((bridge$24812$24823===null)||(bridge$24812$24823===(void 0)))){return false;}else{var x$24831;if((typeof($24811$24818)==="string")){(x$24831=$24811$24818);return (key$24809 in String.prototype);}else{var x$24836;if((typeof($24811$24818)==="number")){(x$24836=$24811$24818);return (key$24809 in Number.prototype);}else{var x$24841;(x$24841=$24811$24818);return (key$24809 in x$24841);}}}};var accum$24533;var accum$24537;var $23027$23029;var items$23030;var gensym$23031;var $23028$23032;var __lt____gt__$23033;var js_op_table2$23034;var js_op_table$23035;var Translator$23036;var translate$23037;($23027$23029=require("./util"));;(items$23030=$23027$23029.items);;(gensym$23031=$23027$23029.gensym);;($23028$23032=require("./pp"));;(__lt____gt__$23033=$23028$23032["<>"]);;(js_op_table2$23034=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$23035=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$23036=function(){var it$0$23077;var prelude$23073;var t0$23069;var $23062$23064;($23062$23064=arguments);;(t0$23069=$23062$23064.length);if(((t0$23069>=0)&&(t0$23069<=1))){(prelude$23073=function(){if((0>=t0$23069)){return null;}else{return $23062$23064[0];}}());(it$0$23077=function(){if((!$22980(Translator$23036)(this))){return Object.create(Translator$23036.prototype);}else{return this;}}());;(it$0$23077["cache"]=({}));(it$0$23077["prepend"]=[]);if(prelude$23073){it$0$23077.prepend.push(it$0$23077.translate($22996(prelude$23073),"stmt"));}return it$0$23077;}else{$24557($23062$23064);}});;(Translator$23036.prototype["register_value"]=function(v$23090,id$23091){var temp$23116;var name$23122;var $23099$23105;var self$23100;var it$0$23094;(it$0$23094=this);;(self$23100=this);;($23099$23105=$22995(it$0$23094.cache,id$23091));;if(($23099$23105===(void 0))){(temp$23116=["symbol",gensym$23031()]);;(it$0$23094.cache[id$23091]=temp$23116);it$0$23094.prepend.push(it$0$23094.translate(["declare",temp$23116,$22996(v$23090)],"stmt"));return temp$23116;}else{(name$23122=$23099$23105);return name$23122;}});(Translator$23036.prototype["register_raw"]=function(raw$23127,id$23128){var temp$23153;var name$23159;var $23136$23142;var self$23137;var it$0$23131;(it$0$23131=this);;(self$23137=this);;($23136$23142=$22995(it$0$23131.cache,id$23128));;if(($23136$23142===(void 0))){(temp$23153=["symbol",gensym$23031()]);;(it$0$23131.cache[id$23128]=temp$23153);it$0$23131.prepend.push(it$0$23131.translate(["declare",temp$23153,["raw",raw$23127]],"stmt"));return temp$23153;}else{(name$23159=$23136$23142);return name$23159;}});(Translator$23036.prototype["dump_store"]=function(){var rval$23176;var self$23171;var it$0$23166;(it$0$23166=this);;(self$23171=this);;(rval$23176=it$0$23166.prepend.join("\n"));;(it$0$23166["prepend"]=[]);return rval$23176;});(Translator$23036.prototype["mangle"]=function(name$23183){var i$23206;var tr$23197;var r$23198;var self$23191;var it$0$23186;(it$0$23186=this);;(self$23191=this);;(tr$23197=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$23198=[]);;(i$23206=0);;$23196:for(;(i$23206<name$23183.length);(++i$23206)){var c$23214;(c$23214=$22995(name$23183,i$23206));;r$23198.push(($22995(tr$23197,c$23214)||c$23214));}return r$23198.join("");});(Translator$23036.prototype["body"]=function(orig$23221,mode$23222){var t0$23239;var t1$23240;var t2$23241;var x$23265;var stmts$23274;var ret$23275;var other$23288;var $23235$23254;var b$23236;var trst$23237;var self$23230;var it$0$23225;(it$0$23225=this);;(self$23230=this);;(t0$23239=$24773(["multi"])(orig$23221));if((t0$23239[0]&&((t1$23240=t0$23239[1]),((t2$23241=t1$23240.length),(t2$23241>=0))))){(b$23236=Array.prototype.slice.call(t1$23240,0));;}else{$24557(orig$23221,"/home/olivier/git/earl-grey/src/translate-js.eg",3265,3269);}(trst$23237=function(stmt$23250){return it$0$23225.translate(stmt$23250,"stmt");});;($23235$23254=mode$23222);;if(($23235$23254==="expr")){(x$23265=["send",["lambda",[],orig$23221],["array"]]);;return it$0$23225.translate(x$23265,mode$23222);}else{if(($23235$23254==="return")){(stmts$23274=b$23236.slice(0,-1));;(ret$23275=$22995(b$23236,(b$23236.length-1)));;return (stmts$23274.map(trst$23237).join("")+it$0$23225.translate(ret$23275,"return"));}else{if(($23235$23254==="stmt")){return b$23236.map(trst$23237).join("");}else{(other$23288=$23235$23254);throw $24570(["syntax","mode"]).create("Unknown mode",({"mode":mode$23222}));}}}});(Translator$23036.prototype["expr"]=function(x$23293,mode$23294){var other$23328;var $23302$23308;var self$23303;var it$0$23297;(it$0$23297=this);;(self$23303=this);;($23302$23308=mode$23294);;if(($23302$23308==="expr")){return x$23293;}else{if(($23302$23308==="stmt")){return (x$23293+";");}else{if(($23302$23308==="return")){return (("return "+x$23293)+";");}else{(other$23328=$23302$23308);throw "OopsI";}}}});(Translator$23036.prototype["op"]=function(op$23333,a$23334,b$23335){var $23352$23365;var $23353$23366;var $23354$23367;var t0$23361;var t1$23362;var t2$23363;var $23351$23356;var e$23348;var self$23343;var it$0$23338;(it$0$23338=this);;(self$23343=this);;(e$23348=((($23351$23356=[a$23334,b$23335])),function(){if((($23352$23365=($23351$23356 instanceof Array))&&((t0$23361=$23351$23356.length),(($23354$23367=(t0$23361===2))&&((t1$23362=$23351$23356[0]),((t1$23362 instanceof Array)&&((t2$23363=t1$23362.length),((t2$23363===1)&&(t1$23362[0]==="void"))))))))){$23351$23356[1];return (op$23333+it$0$23338.translate(b$23335,"expr"));}else{if(($23354$23367&&($23351$23356[0],((t1$23362=$23351$23356[1]),((t1$23362 instanceof Array)&&((t2$23363=t1$23362.length),((t2$23363===1)&&(t1$23362[0]==="void")))))))){return (it$0$23338.translate(a$23334,"expr")+op$23333);}else{$23351$23356;return ((it$0$23338.translate(a$23334,"expr")+op$23333)+it$0$23338.translate(b$23335,"expr"));}}}()));;return (("("+e$23348)+")");});(Translator$23036.prototype["translate"]=function(expr$23389,mode$23390){var repl$23465;var it$0$23496;var it$0$23491;var it$0$23486;var it$0$23481;var bridge$23451$23507;var bridge$23450$23504;var other$23518;var id$23512;var bridge$23449$23458;var $23448$23453;var r$23445;var t0$23537;var t0$23540;var trf$23546;var trmsg$23547;var trf$23578;var trmsg$23579;var trf$23591;var trmsg$23592;var otherwise$23588;var $23565$23567;var x$23635;var x$23629;var $23613$23624;var $23614$23625;var $23615$23626;var t0$23622;var $23612$23617;var $index$23668;var $length$23663;var temp$23658;var acc$23653;var trf$23643;var trargs$23644;var op$23609;var code$23700;var code$23708;var t0$23696;var t1$23697;var trf$23713;var trmsg$23714;var codevar$23694;var f$23731;var r$23727;var f$23785;var f$23817;var v$23812;var all_strings$23745;var r$23746;var $index$23877;var $length$23872;var temp$23867;var acc$23862;var a$23851;var b$23852;var a$23926;var b$23927;var other$23923;var $23909$23911;var a$23958;var b$23959;var c$23960;var other$23955;var $23941$23943;var a$23997;var other$23994;var bridge$23979$23986;var $23978$23981;var a$24026;var b$24027;var other$24023;var bridge$24008$24015;var $24007$24010;var a$24044;var b$24045;var c$24046;var a$24063;var b$24064;var $index$24153;var $length$24148;var temp$24143;var acc$24138;var $index$24190;var $length$24185;var temp$24180;var acc$24175;var xs$24132;var $24082$24122;var $24081$24116;var isdecl$24083;var $index$24252;var $length$24247;var temp$24242;var acc$24237;var decls$24231;var f$24281;var r$24277;var other$24364;var $24350$24352;var a$24389;var b$24390;var other$24386;var $24372$24374;var a$24422;var b$24423;var c$24424;var d$24425;var other$24419;var $24405$24407;var a$24462;var b$24463;var c$24464;var other$24459;var $24445$24447;var t0$24487;var t0$24491;var a$24515;var b$24516;var other$24512;var $24498$24500;var other$24530;var x$24525;var attempt$24476;var v$24477;var body$24478;var x$24440;var y$24441;var body$24442;var x$24399;var y$24400;var z$24401;var body$24402;var test$24368;var body$24369;var label$24344;var body$24345;var value$24339;var value$24334;var value$24329;var label$24322;var label$24315;var value$24310;var args$24273;var vars$24226;var body$24227;var s$24221;var args$24216;var args$24077;var lhs$24058;var rhs$24059;var obj$24036;var msg$24037;var rhs$24038;var binding$24003;var value$24004;var binding$23972;var test$23936;var pos$23937;var neg$23938;var test$23901;var pos$23902;var bindings$23846;var body$23847;var args$23741;var args$23723;var f$23689;var msg$23690;var f$23601;var args$23602;var f$23556;var msg$23557;var s$23558;var f$23532;var msg$23533;var f$23523;var v$23441;var s$23431;var $23401$23425;var $23402$23426;var $23403$23427;var $23404$23428;var t0$23415;var t1$23416;var t2$23417;var t3$23418;var t4$23419;var bridge$23399$23420;var bridge$23400$23421;var t5$23422;var t6$23423;var $23398$23410;var self$23405;var it$0$23393;(it$0$23393=this);;(self$23405=this);;($23398$23410=expr$23389);;if((($23401$23425=($23398$23410 instanceof Array))&&((t0$23415=$23398$23410.length),((t0$23415===2)&&($23398$23410[0]==="symbol"))))){(s$23431=$23398$23410[1]);return it$0$23393.expr(it$0$23393.mangle(s$23431),mode$23390);}else{if(($23401$23425&&((t0$23415===1)&&($23398$23410[0]==="void")))){return it$0$23393.expr("null",mode$23390);}else{if(($23401$23425&&((t0$23415===2)&&($23398$23410[0]==="value")))){(v$23441=$23398$23410[1]);(r$23445=((($23448$23453=v$23441)),function(){if((typeof($23448$23453)==="string")){(repl$23465=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$23441=v$23441.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$23470){return $22995(repl$23465,m$23470);}));return (("\""+v$23441)+"\"");}else{if(($23448$23453===(void 0))){return "(void 0)";}else{if($22980(RegExp)($23448$23453)){(it$0$23481=String(v$23441));;(it$0$23486=it$0$23481.slice(1,-1));;(it$0$23491=it$0$23486.replace(RegExp("/","g"),"\\/"));;(it$0$23496=it$0$23491.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$23496).concat("/");}else{(bridge$23449$23458=$23448$23453);if((((bridge$23450$23504=bridge$23449$23458),(((bridge$23451$23507=bridge$23450$23504),((typeof(bridge$23451$23507)==="number")||(bridge$23451$23507===true)))||(bridge$23450$23504===false)))||(bridge$23449$23458===null))){return String(v$23441);}else{if(($24805($23448$23453,"::id")&&((id$23512=$23448$23453["::id"]),id$23512))){return it$0$23393.translate(it$0$23393.register_value(v$23441,id$23512),mode$23390);}else{(other$23518=$23448$23453);throw $24570(["cannot_serialize"]).create("Cannot serialize value",({"value":v$23441}));}}}}}}()));;return it$0$23393.expr(r$23445,mode$23390);}else{if(($23401$23425&&(($23403$23427=(t0$23415===3))&&(($23404$23428=($23398$23410[0]==="send"))&&((t1$23416=$23398$23410[1]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&((t1$23416[0]==="variable")&&((t1$23416[1]==="___node")&&((t3$23418=$23398$23410[2]),((t3$23418 instanceof Array)&&((t4$23419=t3$23418.length),((t4$23419===2)&&(t3$23418[0]==="value"))))))))))))))){(f$23523=t3$23418[1]);return f$23523;}else{if(($23404$23428&&((bridge$23399$23420=$23398$23410[1]),((((bridge$23399$23420 instanceof Array)&&((t0$23537=bridge$23399$23420.length),((t0$23537===2)&&((bridge$23399$23420[0]==="symbol")&&(bridge$23399$23420[1]==="___js_fetch")))))||((bridge$23399$23420 instanceof Array)&&((t0$23540=bridge$23399$23420.length),((t0$23540===2)&&((bridge$23399$23420[0]==="variable")&&(bridge$23399$23420[1]==="___js_fetch"))))))&&((t1$23416=$23398$23410[2]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===3)&&(t1$23416[0]==="array"))))))))){(f$23532=t1$23416[1]);(msg$23533=t1$23416[2]);(trf$23546=it$0$23393.translate(f$23532,"expr"));;(trmsg$23547=it$0$23393.translate(msg$23533,"expr"));;return it$0$23393.expr((((trf$23546+"[")+trmsg$23547)+"]"),mode$23390);}else{if(($23404$23428&&((f$23556=$23398$23410[1]),((t1$23416=$23398$23410[2]),((msg$23557=t1$23416),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&(t1$23416[0]==="value"))))))))){(s$23558=t1$23416[1]);($23565$23567=null);;$23565$23567;if(((typeof(s$23558)==="string")&&s$23558.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$23578=it$0$23393.translate(f$23556,"expr"));;(trmsg$23579=it$0$23393.translate(["symbol",s$23558],"expr"));;return it$0$23393.expr(((trf$23578+".")+trmsg$23579),mode$23390);}else{(otherwise$23588=$23565$23567);(trf$23591=it$0$23393.translate(f$23556,"expr"));;(trmsg$23592=it$0$23393.translate(msg$23557,"expr"));;return it$0$23393.expr((((trf$23591+"[")+trmsg$23592)+"]"),mode$23390);}}else{if(($23404$23428&&((f$23601=$23398$23410[1]),((t1$23416=$23398$23410[2]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417>=1)&&(t1$23416[0]==="array")))))))){(args$23602=Array.prototype.slice.call(t1$23416,1));(op$23609=((($23612$23617=f$23601)),function(){if((($23613$23624=($23612$23617 instanceof Array))&&((t0$23622=$23612$23617.length),(($23615$23626=(t0$23622===2))&&($23612$23617[0]==="symbol"))))){(x$23629=$23612$23617[1]);return $22995(js_op_table$23035,x$23629);}else{if(($23615$23626&&($23612$23617[0]==="variable"))){(x$23635=$23612$23617[1]);return $22995(js_op_table2$23034,x$23635);}else{$23612$23617;return null;}}}()));;if(op$23609){return it$0$23393.expr(it$0$23393.op(op$23609,args$23602[0],args$23602[1]),mode$23390);}else{(trf$23643=it$0$23393.translate(f$23601,"expr"));;(trargs$23644=(((acc$23653=[])),(((temp$23658=args$23602)),((($length$23663=temp$23658.length)),((($index$23668=0)),function(){$23650:for(;($index$23668<$length$23663);($index$23668++)){var x$23684;var m$23676;(m$23676=temp$23658[$index$23668]);;(x$23684=m$23676);acc$23653.push(it$0$23393.translate(x$23684,"expr"));}}()))),acc$23653));;return it$0$23393.expr((((trf$23643+"(")+trargs$23644.join(","))+")"),mode$23390);}}else{if($23404$23428){(f$23689=$23398$23410[1]);(msg$23690=$23398$23410[2]);(t0$23696=(((code$23700="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23393.register_raw(code$23700,"~send")));if(((t0$23696 instanceof Array)&&((t1$23697=t0$23696.length),((t1$23697===2)&&(t0$23696[0]==="symbol"))))){(codevar$23694=t0$23696[1]);;}else{$24557((((code$23708="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23393.register_raw(code$23708,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6897,7107);}(trf$23713=it$0$23393.translate(f$23689,"expr"));;(trmsg$23714=it$0$23393.translate(msg$23690,"expr"));;return it$0$23393.expr((((((codevar$23694+"(")+trf$23713)+",")+trmsg$23714)+")"),mode$23390);}else{if(($23401$23425&&(($23403$23427=(t0$23415>=1))&&($23398$23410[0]==="array")))){(args$23723=Array.prototype.slice.call($23398$23410,1));(r$23727=(((f$23731=function(x$23735){return it$0$23393.translate(x$23735,"expr");})),(("["+args$23723.map(f$23731).join(","))+"]")));;return it$0$23393.expr(r$23727,mode$23390);}else{if(($23403$23427&&($23398$23410[0]==="object"))){(args$23741=Array.prototype.slice.call($23398$23410,1));(all_strings$23745=args$23741.every(function($23749$23751){var t0$23757;var t1$23758;var other$23779;var v$23773;var t0$23769;var $23753$23764;var ph$23754;var y$23755;(t0$23757=$23749$23751);if(((t0$23757 instanceof Array)&&((t1$23758=t0$23757.length),((t1$23758===3)&&(t0$23757[0]==="array"))))){(ph$23754=t0$23757[1]);(y$23755=t0$23757[2]);;}else{$24557($23749$23751);}($23753$23764=ph$23754);;if((($23753$23764 instanceof Array)&&((t0$23769=$23753$23764.length),((t0$23769===2)&&($23753$23764[0]==="value"))))){(v$23773=$23753$23764[1]);return true;}else{(other$23779=$23753$23764);return false;}}));;(r$23746=function(){if(all_strings$23745){(f$23785=function($23788$23790){var t0$23795;var t1$23796;var a$23802;var b$23803;var x$23792;var y$23793;(t0$23795=$23788$23790);if(((t0$23795 instanceof Array)&&((t1$23796=t0$23795.length),((t1$23796===3)&&(t0$23795[0]==="array"))))){(x$23792=t0$23795[1]);(y$23793=t0$23795[2]);;}else{$24557($23788$23790);}(a$23802=it$0$23393.translate(x$23792,"expr"));;(b$23803=it$0$23393.translate(y$23793,"expr"));;return ((a$23802+":")+b$23803);});;return (("({"+args$23741.map(f$23785).join(","))+"})");}else{(v$23812=gensym$23031());;(f$23817=function($23820$23822){var t0$23827;var t1$23828;var a$23834;var b$23835;var x$23824;var y$23825;(t0$23827=$23820$23822);if(((t0$23827 instanceof Array)&&((t1$23828=t0$23827.length),((t1$23828===3)&&(t0$23827[0]==="array"))))){(x$23824=t0$23827[1]);(y$23825=t0$23827[2]);;}else{$24557($23820$23822);}(a$23834=it$0$23393.translate(x$23824,"expr"));;(b$23835=it$0$23393.translate(y$23825,"expr"));;return (((((v$23812+"[")+a$23834)+"]=")+b$23835)+";");});;return ((((((("(function(){"+"var ")+v$23812)+"={};")+args$23741.map(f$23817).join(""))+";return ")+v$23812)+";}())");}}());;return it$0$23393.expr(r$23746,mode$23390);}else{if(($23401$23425&&((t0$23415===3)&&($23398$23410[0]==="lambda")))){(bindings$23846=$23398$23410[1]);(body$23847=$23398$23410[2]);(a$23851=(((acc$23862=[])),(((temp$23867=bindings$23846)),((($length$23872=temp$23867.length)),((($index$23877=0)),function(){$23859:for(;($index$23877<$length$23872);($index$23877++)){var x$23893;var m$23885;(m$23885=temp$23867[$index$23877]);;(x$23893=m$23885);acc$23862.push(it$0$23393.translate(x$23893,"expr"));}}()))),acc$23862).join(","));;(b$23852=it$0$23393.body(body$23847,"return"));;return it$0$23393.expr((((("function("+a$23851)+"){")+b$23852)+"}"),mode$23390);}else{if(($23401$23425&&(($23403$23427=(t0$23415===4))&&(($23404$23428=($23398$23410[0]==="if"))&&((test$23901=$23398$23410[1]),((pos$23902=$23398$23410[2]),((t1$23416=$23398$23410[3]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&((t1$23416[0]==="value")&&(t1$23416[1]===(void 0))))))))))))){($23909$23911=mode$23390);;if(($23909$23911==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$23923=$23909$23911);(a$23926=it$0$23393.translate(test$23901,"expr"));;(b$23927=it$0$23393.translate(pos$23902,mode$23390));;return (((("if("+a$23926)+"){")+b$23927)+"}");}}else{if($23404$23428){(test$23936=$23398$23410[1]);(pos$23937=$23398$23410[2]);(neg$23938=$23398$23410[3]);($23941$23943=mode$23390);;if(($23941$23943==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$23955=$23941$23943);(a$23958=it$0$23393.translate(test$23936,"expr"));;(b$23959=it$0$23393.translate(pos$23937,mode$23390));;(c$23960=it$0$23393.translate(neg$23938,mode$23390));;return (((((("if("+a$23958)+"){")+b$23959)+"}else{")+c$23960)+"}");}}else{if(($23401$23425&&(($23403$23427=(t0$23415===3))&&(($23404$23428=($23398$23410[0]==="declare"))&&((binding$23972=$23398$23410[1]),((t1$23416=$23398$23410[2]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&((t1$23416[0]==="value")&&(t1$23416[1]===(void 0)))))))))))){($23978$23981=mode$23390);;(bridge$23979$23986=$23978$23981);if(((bridge$23979$23986==="expr")||(bridge$23979$23986==="return"))){throw "Invalid in expr ctx";}else{(other$23994=$23978$23981);(a$23997=it$0$23393.translate(binding$23972,"expr"));;return (("var "+a$23997)+";");}}else{if($23404$23428){(binding$24003=$23398$23410[1]);(value$24004=$23398$23410[2]);($24007$24010=mode$23390);;(bridge$24008$24015=$24007$24010);if(((bridge$24008$24015==="expr")||(bridge$24008$24015==="return"))){throw "Invalid in expr ctx";}else{(other$24023=$24007$24010);(a$24026=it$0$23393.translate(binding$24003,"expr"));;(b$24027=it$0$23393.translate(value$24004,"expr"));;return (((("var "+a$24026)+"=")+b$24027)+";");}}else{if(($23403$23427&&(($23404$23428=($23398$23410[0]==="assign"))&&((t1$23416=$23398$23410[1]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===3)&&(t1$23416[0]==="send")))))))){(obj$24036=t1$23416[1]);(msg$24037=t1$23416[2]);(rhs$24038=$23398$23410[2]);(a$24044=it$0$23393.translate(obj$24036,"expr"));;(b$24045=it$0$23393.translate(msg$24037,"expr"));;(c$24046=it$0$23393.translate(rhs$24038,"expr"));;return it$0$23393.expr((((((("("+a$24044)+"[")+b$24045)+"]=")+c$24046)+")"),mode$23390);}else{if($23404$23428){(lhs$24058=$23398$23410[1]);(rhs$24059=$23398$23410[2]);(a$24063=it$0$23393.translate(lhs$24058,"expr"));;(b$24064=it$0$23393.translate(rhs$24059,"expr"));;return it$0$23393.expr((((("("+a$24063)+"=")+b$24064)+")"),mode$23390);}else{if(($23401$23425&&((t0$23415===1)&&($23398$23410[0]==="multi")))){if((mode$23390==="stmt")){return ";";}else{return "";}}else{if(($23401$23425&&(($23403$23427=(t0$23415>=1))&&($23398$23410[0]==="multi")))){(args$24077=Array.prototype.slice.call($23398$23410,1));(isdecl$24083=function($24086$24088){var other$24112;var variable$24105;var value$24106;var t0$24101;var $24090$24096;var ph$24091;(ph$24091=$24086$24088);;($24090$24096=ph$24091);;if((($24090$24096 instanceof Array)&&((t0$24101=$24090$24096.length),((t0$24101===3)&&($24090$24096[0]==="declare"))))){(variable$24105=$24090$24096[1]);(value$24106=$24090$24096[2]);return true;}else{(other$24112=$24090$24096);return false;}});;($24081$24116=null);;$24081$24116;if((args$24077.length===1)){return it$0$23393.translate(args$24077[0],mode$23390);}else{if(((mode$23390==="expr")&&(!args$24077.some(isdecl$24083)))){(xs$24132=(((acc$24138=[])),(((temp$24143=args$24077)),((($length$24148=temp$24143.length)),((($index$24153=0)),function(){$24135:for(;($index$24153<$length$24148);($index$24153++)){var x$24169;var m$24161;(m$24161=temp$24143[$index$24153]);;(x$24169=m$24161);acc$24138.push(it$0$23393.translate(x$24169,"expr"));}}()))),acc$24138));;(xs$24132=(((acc$24175=[])),(((temp$24180=xs$24132)),((($length$24185=temp$24180.length)),((($index$24190=0)),function(){$24172:for(;($index$24190<$length$24185);($index$24190++)){var x$24206;var m$24198;(m$24198=temp$24180[$index$24190]);;(x$24206=m$24198);if((x$24206!=="")){acc$24175.push(x$24206);}else{false;;}}}()))),acc$24175));return (("("+xs$24132.join(","))+")");}else{return it$0$23393.body(expr$23389,mode$23390);}}}else{if(($23403$23427&&($23398$23410[0]==="splice"))){(args$24216=Array.prototype.slice.call($23398$23410,1));return it$0$23393.translate(["multi"].concat(args$24216),mode$23390);}else{if(($23401$23425&&((t0$23415===2)&&($23398$23410[0]==="variable")))){(s$24221=$23398$23410[1]);return it$0$23393.expr(it$0$23393.mangle(s$24221),mode$23390);}else{if(($23401$23425&&((t0$23415===3)&&($23398$23410[0]==="scope")))){(vars$24226=$23398$23410[1]);(body$24227=$23398$23410[2]);(decls$24231=(((acc$24237=[])),(((temp$24242=vars$24226)),((($length$24247=temp$24242.length)),((($index$24252=0)),function(){$24234:for(;($index$24252<$length$24247);($index$24252++)){var v$24268;var m$24260;(m$24260=temp$24242[$index$24252]);;(v$24268=m$24260);acc$24237.push(["declare",v$24268,["value",(void 0)]]);}}()))),acc$24237));;return it$0$23393.translate(["multi"].concat(decls$24231).concat([body$24227]),mode$23390);}else{if(($23401$23425&&((t0$23415>=1)&&($23398$23410[0]==="object2")))){(args$24273=Array.prototype.slice.call($23398$23410,1));(r$24277=(((f$24281=function($24284$24286){var t0$24291;var t1$24292;var a$24298;var b$24299;var x$24288;var y$24289;(t0$24291=$24284$24286);if(((t0$24291 instanceof Array)&&((t1$24292=t0$24291.length),(t1$24292===2)))){(x$24288=t0$24291[0]);(y$24289=t0$24291[1]);;}else{$24557($24284$24286);}(a$24298=it$0$23393.translate(x$24288,"expr"));;(b$24299=it$0$23393.translate(y$24289,"expr"));;return ((a$24298+":")+b$24299);})),(("({"+args$24273.map(f$24281).join(","))+"})")));;return it$0$23393.expr(r$24277,mode$23390);}else{if(($23401$23425&&((t0$23415===2)&&($23398$23410[0]==="js_new")))){(value$24310=$23398$23410[1]);return it$0$23393.expr((("(new "+it$0$23393.translate(value$24310,"expr"))+")"),mode$23390);}else{if(($23401$23425&&(($23403$23427=((t0$23415>=1)&&(t0$23415<=2)))&&(($23398$23410[0]==="js_break")&&((t1$23416=function(){if((1>=t0$23415)){return ["value",null];}else{return $23398$23410[1];}}()),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&(t1$23416[0]==="value"))))))))){(label$24315=t1$23416[1]);if((mode$23390==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$24315){return (" "+label$24315);}else{return "";}}())+";");}}else{if(($23403$23427&&(($23398$23410[0]==="js_continue")&&((t1$23416=function(){if((1>=t0$23415)){return ["value",null];}else{return $23398$23410[1];}}()),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&(t1$23416[0]==="value")))))))){(label$24322=t1$23416[1]);if((mode$23390==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$24322){return (" "+label$24322);}else{return "";}}())+";");}}else{if(($23401$23425&&(($23403$23427=(t0$23415===2))&&($23398$23410[0]==="js_return")))){(value$24329=$23398$23410[1]);if((mode$23390==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$23393.translate(value$24329,"expr"))+";");}}else{if(($23403$23427&&($23398$23410[0]==="js_delete"))){(value$24334=$23398$23410[1]);if((mode$23390==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$23393.translate(value$24334,"expr"))+";");}}else{if(($23403$23427&&($23398$23410[0]==="js_throw"))){(value$24339=$23398$23410[1]);if((mode$23390==="expr")){return (("function(){throw "+it$0$23393.translate(value$24339,"expr"))+";}()");}else{return (("throw "+it$0$23393.translate(value$24339,"expr"))+";");}}else{if(($23401$23425&&(($23403$23427=(t0$23415===3))&&(($23398$23410[0]==="js_label")&&((t1$23416=$23398$23410[1]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===2)&&(t1$23416[0]==="value"))))))))){(label$24344=t1$23416[1]);(body$24345=$23398$23410[2]);($24350$24352=mode$23390);;if(($24350$24352==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$24364=$24350$24352);return ((label$24344+":")+it$0$23393.translate(body$24345,other$24364));}}else{if(($23403$23427&&($23398$23410[0]==="js_while"))){(test$24368=$23398$23410[1]);(body$24369=$23398$23410[2]);($24372$24374=mode$23390);;if(($24372$24374==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$24386=$24372$24374);(a$24389=it$0$23393.translate(test$24368,"expr"));;(b$24390=it$0$23393.translate(body$24369,"stmt"));;return (((("while("+a$24389)+"){")+b$24390)+"}");}}else{if(($23401$23425&&((t0$23415===5)&&($23398$23410[0]==="js_for")))){(x$24399=$23398$23410[1]);(y$24400=$23398$23410[2]);(z$24401=$23398$23410[3]);(body$24402=$23398$23410[4]);($24405$24407=mode$23390);;if(($24405$24407==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$24419=$24405$24407);(a$24422=it$0$23393.translate(x$24399,"stmt"));;(b$24423=it$0$23393.translate(y$24400,"stmt"));;(c$24424=it$0$23393.translate(z$24401,"expr"));;(d$24425=it$0$23393.translate(body$24402,"stmt"));;return (((((("for("+a$24422)+b$24423)+c$24424)+"){")+d$24425)+"}");}}else{if(($23401$23425&&(($23403$23427=(t0$23415===4))&&($23398$23410[0]==="js_for_in")))){(x$24440=$23398$23410[1]);(y$24441=$23398$23410[2]);(body$24442=$23398$23410[3]);($24445$24447=mode$23390);;if(($24445$24447==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$24459=$24445$24447);(a$24462=it$0$23393.translate(x$24440,"expr"));;(b$24463=it$0$23393.translate(y$24441,"expr"));;(c$24464=it$0$23393.translate(body$24442,"stmt"));;return (((((("for("+a$24462)+" in ")+b$24463)+"){")+c$24464)+"}");}}else{if(($23403$23427&&(($23398$23410[0]==="js_try")&&((attempt$24476=$23398$23410[1]),((t1$23416=$23398$23410[2]),((t1$23416 instanceof Array)&&((t2$23417=t1$23416.length),((t2$23417===3)&&((t1$23416[0]==="lambda")&&((t3$23418=t1$23416[1]),((t3$23418 instanceof Array)&&((t4$23419=t3$23418.length),((t4$23419===1)&&((bridge$23400$23421=t3$23418[0]),((((bridge$23400$23421 instanceof Array)&&((t0$24487=bridge$23400$23421.length),((t0$24487===2)&&((bridge$23400$23421[0]==="symbol")&&((v$24477=bridge$23400$23421[1]),true)))))||((bridge$23400$23421 instanceof Array)&&((t0$24491=bridge$23400$23421.length),((t0$24491===2)&&((bridge$23400$23421[0]==="variable")&&((v$24477=bridge$23400$23421[1]),true))))))&&((body$24478=t1$23416[2]),((t5$23422=$23398$23410[3]),((t5$23422 instanceof Array)&&((t6$23423=t5$23422.length),((t6$23423===1)&&(t5$23422[0]==="void"))))))))))))))))))))){($24498$24500=mode$23390);;if(($24498$24500==="expr")){return it$0$23393.body(expr$23389,"expr");}else{(other$24512=$24498$24500);(a$24515=it$0$23393.translate(attempt$24476,"stmt"));;(b$24516=it$0$23393.translate(body$24478,"stmt"));;return (((((("try{"+a$24515)+"}catch(")+v$24477)+"){")+b$24516)+"}");}}else{if(($23401$23425&&((t0$23415===2)&&($23398$23410[0]==="raw")))){(x$24525=$23398$23410[1]);return x$24525;}else{(other$24530=$23398$23410);throw other$24530;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$24761(Translator$23036,$24761(((accum$24533=({})),((accum$24533["::name"]="Translator"),accum$24533)),((accum$24537=({})),((accum$24537["::egclass"]=true),accum$24537))));Translator$23036;(translate$23037=function(expr$24543,mode$24544){var tr$24547;var t$24548;(tr$24547=Translator$23036());;(t$24548=tr$24547.translate(expr$24543,mode$24544));;return (tr$24547.dump_store()+t$24548);});;(exports["Translator"]=Translator$23036);(exports["translate"]=translate$23037);
