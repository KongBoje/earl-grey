var $40389=(function(type$40392){var f$40396;(f$40396=type$40392["::check"]);if((f$40396===(void 0))){return (function(value$40402){return (value$40402 instanceof type$40392);});}else{return (function(value$40406){return f$40396.call(type$40392,value$40406);});}});
var $40408=(function(dest$40411,values$40412){var k$40417;(k$40417=null);$40415:for(k$40417 in values$40412){if(values$40412.hasOwnProperty(k$40417)){(dest$40411[k$40417]=values$40412[k$40417]);}}return dest$40411;});
var $40425=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $40426=(function($40428$40431){var ph$40437;(ph$40437=$40428$40431);var $40433$40443;($40433$40443=ph$40437);var bridge$40435$40448;var x$40452;(bridge$40435$40448=$40433$40443);if((((typeof(bridge$40435$40448)==="string")&&((x$40452=bridge$40435$40448),true))||((typeof(bridge$40435$40448)==="number")&&((x$40452=bridge$40435$40448),true)))){return ["value",x$40452];}else{var other$40463;(other$40463=$40433$40443);return other$40463["::serialize_ast"]();}});
var $40465=(function(obj$40468){var results$40473;(results$40473=[]);var k$40478;(k$40478=null);$40472:for(k$40478 in obj$40468){if(Object.prototype.hasOwnProperty.call(obj$40468,k$40478)){results$40473.push([k$40478,$40425(obj$40468,k$40478)]);}}return results$40473;});
var $40734=(function(arr$40737){var results$40743;var l$40744;(results$40743=[]);(l$40744=arr$40737.length);var i$40753;(i$40753=0);$40742:for(;(i$40753<l$40744);(i$40753++)){results$40743.push([i$40753,$40425(arr$40737,i$40753)]);}return results$40743;});
var $40501=(function(){var $40502$40508;($40502$40508=(function(tags$40513){var it$0$40516;(it$0$40516=(function(){if((!$40389($40502$40508)(this))){return Object.create($40502$40508.prototype);}else{return this;}})());(it$0$40516["tags"]=tags$40513);return it$0$40516;}));($40502$40508.prototype["create"]=(function(){var it$0$40536;var self$40537;(it$0$40536=this);(self$40537=this);var $40534$40546;($40534$40546=arguments);var t0$40551;var message$40555;var args$40556;(t0$40551=$40534$40546.length);if((t0$40551>=0)){(message$40555=(function(){if((0>=t0$40551)){return "";}else{return $40534$40546[0];}})());(args$40556=Array.prototype.slice.call($40534$40546,1));var e$40569;(e$40569=Error(message$40555));(e$40569["::tags"]=it$0$40536.tags);(e$40569["args"]=args$40556);var temp$40585;(temp$40585=$40734(args$40556));var $length$40591;($length$40591=temp$40585.length);var $index$40597;($index$40597=0);$40570:for(;($index$40597<$length$40591);($index$40597++)){var m$40606;(m$40606=temp$40585[$index$40597]);var t0$40611;var t1$40612;var i$40616;var arg$40617;(t0$40611=m$40606);if(((t0$40611 instanceof Array)&&(((t1$40612=t0$40611.length)),(t1$40612===2)))){(i$40616=t0$40611[0]);(arg$40617=t0$40611[1]);(e$40569[i$40616]=arg$40617);}else{$40482(m$40606);}}(e$40569["length"]=args$40556.length);(e$40569["name"]=["E"].concat(it$0$40536.tags).join("."));return e$40569;}else{$40482($40534$40546);}}));($40502$40508.prototype["::check"]=(function(e$40647){var it$0$40651;var self$40652;(it$0$40651=this);(self$40652=this);var tags$40662;if(((!e$40647)||(!$40389(Error)(e$40647)))){return false;}(tags$40662=(e$40647["::tags"]||[]));var temp$40673;(temp$40673=it$0$40651.tags);var $length$40679;($length$40679=temp$40673.length);var $index$40685;($index$40685=0);$40663:for(;($index$40685<$length$40679);($index$40685++)){var m$40694;(m$40694=temp$40673[$index$40685]);var tag$40702;(tag$40702=m$40694);if((tags$40662.indexOf(tag$40702)===-1)){return false;}else{false;}}return true;}));($40502$40508.prototype["::deconstruct"]=(function(e$40711){var it$0$40715;var self$40716;(it$0$40715=this);(self$40716=this);return e$40711.args;}));$40408($40502$40508,$40408((function(){var accum$40727;(accum$40727=({}));(accum$40727["::name"]="$40502");return accum$40727;})(),(function(){var accum$40731;(accum$40731=({}));(accum$40731["::egclass"]=true);return accum$40731;})()));return $40502$40508;})();
var $40482=(function(value$40485,url$40486,start$40487,end$40488){var err$40492;(err$40492=$40501(["match"]).create("Could not find a match for value",({"value":value$40485})));if(url$40486){(err$40492["location"]=["location",url$40486,start$40487,end$40488]);}throw err$40492;});
var send$40034;var __array_methods$40035;var __re_methods$40036;(send$40034=(function(obj$40049,$40046$40050){var ph$40056;var msg$40057;var t0$40059;(t0$40059=$40046$40050);(msg$40057=t0$40059);(ph$40056=t0$40059);var $40052$40068;($40052$40068=ph$40056);var bridge$40054$40073;(bridge$40054$40073=$40052$40068);if(((typeof(bridge$40054$40073)==="string")||(typeof(bridge$40054$40073)==="number"))){return obj$40049[msg$40057];}else{var other$40085;(other$40085=$40052$40068);return obj$40049["::send"](msg$40057);}}));(Array[":::project"]=(function($40091$40094){var ph$40099;var value$40100;var t0$40102;(t0$40102=$40091$40094);(value$40100=t0$40102);(ph$40099=t0$40102);var $40096$40111;($40096$40111=ph$40099);if($40389(Array)($40096$40111)){return [true,value$40100];}else{$40096$40111;return [true,[value$40100]];}}));(__array_methods$40035=$40408((function(){var accum$40132;(accum$40132=({}));(accum$40132["::check"]=(function(value$40137){if((value$40137 instanceof Array)){var i$40143;(i$40143=0);$40140:for(;(i$40143<this.length);(i$40143++)){if(($40425(this,i$40143)!==$40425(value$40137,i$40143))){return false;}}return true;}else{return false;}}));return accum$40132;})(),$40408((function(){var accum$40152;(accum$40152=({}));(accum$40152["::clone"]=(function(){return $40408(this.slice(0),this);}));return accum$40152;})(),$40408((function(){var accum$40159;(accum$40159=({}));(accum$40159[":::project"]=(function(value$40164){if((value$40164 instanceof Array)){var i$40170;(i$40170=0);$40167:for(;(i$40170<this.length);(i$40170++)){if(($40425(this,i$40170)!==$40425(value$40164,i$40170))){return [true,this.concat([value$40164])];}}return [true,value$40164];}else{return [true,this.concat([value$40164])];}}));return accum$40159;})(),(function(){var accum$40179;(accum$40179=({}));(accum$40179["::serialize_ast"]=(function(){return ["array"].concat(this.map($40426));}));return accum$40179;})()))));var temp$40189;(temp$40189=$40465(__array_methods$40035));var $length$40195;($length$40195=temp$40189.length);var $index$40201;($index$40201=0);$40037:for(;($index$40201<$length$40195);($index$40201++)){var m$40210;(m$40210=temp$40189[$index$40201]);var t0$40215;var t1$40216;var k$40220;var v$40221;(t0$40215=m$40210);if(((t0$40215 instanceof Array)&&(((t1$40216=t0$40215.length)),(t1$40216===2)))){(k$40220=t0$40215[0]);(v$40221=t0$40215[1]);if((!$40425(Array.prototype,k$40220))){Object.defineProperty(Array.prototype,k$40220,({"enumerable":false,"value":v$40221}));}}else{$40482(m$40210);}}(__re_methods$40036=$40408((function(){var accum$40241;(accum$40241=({}));(accum$40241["::check"]=(function($40245$40248){var ph$40253;(ph$40253=$40245$40248);var $40250$40259;($40250$40259=ph$40253);var value$40267;if((typeof($40250$40259)==="string")){(value$40267=$40250$40259);if(value$40267.match(this)){return true;}else{return false;}}else{var other$40272;(other$40272=$40250$40259);return false;}}));return accum$40241;})(),(function(){var accum$40275;(accum$40275=({}));(accum$40275[":::project"]=(function($40279$40282){var ph$40287;(ph$40287=$40279$40282);var $40284$40293;($40284$40293=ph$40287);var value$40301;if((typeof($40284$40293)==="string")){(value$40301=$40284$40293);var $40304$40309;($40304$40309=value$40301.match(this));var m$40317;if(($40304$40309===null)){(m$40317=$40304$40309);return [false,null];}else{var m$40322;(m$40322=$40304$40309);return [true,m$40322];}}else{var other$40326;(other$40326=$40284$40293);return [false,null];}}));return accum$40275;})()));var temp$40332;(temp$40332=$40465(__re_methods$40036));var $length$40338;($length$40338=temp$40332.length);var $index$40344;($index$40344=0);$40040:for(;($index$40344<$length$40338);($index$40344++)){var m$40353;(m$40353=temp$40332[$index$40344]);var t0$40358;var t1$40359;var k$40363;var v$40364;(t0$40358=m$40353);if(((t0$40358 instanceof Array)&&(((t1$40359=t0$40358.length)),(t1$40359===2)))){(k$40363=t0$40358[0]);(v$40364=t0$40358[1]);if((!$40425(RegExp.prototype,k$40363))){Object.defineProperty(RegExp.prototype,k$40363,({"enumerable":false,"value":v$40364}));}}else{$40482(m$40353);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$40408(({"enumerable":false}),(function(){var accum$40382;(accum$40382=({}));(accum$40382["value"]=(function(args$40387){return this.apply(this,args$40387);}));return accum$40382;})()));}
var $42877=(function(type$42880){return (function(value$42884){var f$42888;(f$42888=type$42880[":::project"]);if((f$42888===(void 0))){(f$42888=type$42880["::project"]);if((f$42888===(void 0))){return [true,type$42880(value$42884)];}else{var rval$42901;(rval$42901=false);try{(rval$42901=[true,f$42888(value$42884)]);}catch(excv$42912){var e$42918;(e$42918=excv$42912);(rval$42901=[false,null]);}return rval$42901;}}else{return f$42888.call(type$42880,value$42884);}});});
var $42924=(function($42926$42929,key$42930){var ph$42938;(ph$42938=$42926$42929);var $42932$42944;($42932$42944=ph$42938);var bridge$42934$42949;(bridge$42934$42949=$42932$42944);if(((bridge$42934$42949===null)||(bridge$42934$42949===(void 0)))){return false;}else{var x$42961;if((typeof($42932$42944)==="string")){(x$42961=$42932$42944);return (key$42930 in String.prototype);}else{var x$42966;if((typeof($42932$42944)==="number")){(x$42966=$42932$42944);return (key$42930 in Number.prototype);}else{var x$42971;(x$42971=$42932$42944);return (key$42930 in x$42971);}}}});var accum$42842;var accum$42846;var $40762$40781;var gensym$40782;var Body$40783;var $40763$40784;var __lt____gt__$40785;var js_op_table2$40786;var js_op_table$40787;var Translator$40788;var translate$40789;($40762$40781=require("./util"));(gensym$40782=$40762$40781.gensym);(Body$40783=$40762$40781.Body);($40763$40784=require("./pp"));(__lt____gt__$40785=$40763$40784["<>"]);(js_op_table2$40786=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$40787=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$40788=(function(){var prelude$40835;var t0$40831;var $40822$40826;var it$0$40817;(it$0$40817=(function(){if((!$40389(Translator$40788)(this))){return Object.create(Translator$40788.prototype);}else{return this;}})());($40822$40826=arguments);(t0$40831=$40822$40826.length);if(((t0$40831>=0)&&(t0$40831<=1))){(prelude$40835=(function(){if((0>=t0$40831)){return null;}else{return $40822$40826[0];}})());(it$0$40817["cache"]=({}));(it$0$40817["prepend"]=[]);if(prelude$40835){it$0$40817.prepend.push(it$0$40817.translate($40426(prelude$40835),"stmt"));}}else{$40482($40822$40826);}return it$0$40817;}));(Translator$40788.prototype["register_value"]=(function(v$40859,id$40860){var temp$40891;var name$40900;var $40873$40878;var it$0$40864;var self$40865;(it$0$40864=this);(self$40865=this);($40873$40878=$40425(it$0$40864.cache,id$40860));if(($40873$40878===(void 0))){(temp$40891=["symbol",gensym$40782()]);(it$0$40864.cache[id$40860]=temp$40891);it$0$40864.prepend.push(it$0$40864.translate(["declare",temp$40891,$40426(v$40859)],"stmt"));return temp$40891;}else{(name$40900=$40873$40878);return name$40900;}}));(Translator$40788.prototype["register_raw"]=(function(raw$40906,id$40907){var temp$40938;var name$40947;var $40920$40925;var it$0$40911;var self$40912;(it$0$40911=this);(self$40912=this);($40920$40925=$40425(it$0$40911.cache,id$40907));if(($40920$40925===(void 0))){(temp$40938=["symbol",gensym$40782()]);(it$0$40911.cache[id$40907]=temp$40938);it$0$40911.prepend.push(it$0$40911.translate(["declare",temp$40938,["raw",raw$40906]],"stmt"));return temp$40938;}else{(name$40947=$40920$40925);return name$40947;}}));(Translator$40788.prototype["dump_store"]=(function(){var rval$40968;var it$0$40956;var self$40957;(it$0$40956=this);(self$40957=this);(rval$40968=it$0$40956.prepend.join("\n"));(it$0$40956["prepend"]=[]);return rval$40968;}));(Translator$40788.prototype["mangle"]=(function(name$40979){var i$41006;var tr$40996;var r$40997;var it$0$40983;var self$40984;(it$0$40983=this);(self$40984=this);(tr$40996=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$40997=[]);(i$41006=0);$40995:for(;(i$41006<name$40979.length);(++i$41006)){var c$41015;(c$41015=$40425(name$40979,i$41006));r$40997.push(($40425(tr$40996,c$41015)||c$41015));}return r$40997.join("");}));(Translator$40788.prototype["body"]=(function(orig$41023,mode$41024){var t0$41048;var t1$41049;var t2$41050;var x$41089;var stmts$41100;var ret$41101;var other$41114;var $41040$41077;var b$41045;var trst$41046;var it$0$41028;var self$41029;(it$0$41028=this);(self$41029=this);(t0$41048=$42877(Body$40783)(orig$41023));if((t0$41048[0]&&(((t1$41049=t0$41048[1])),(((t2$41050=t1$41049.length)),(t2$41050>=0))))){(b$41045=Array.prototype.slice.call(t1$41049,0));}else{$40482(orig$41023,"/home/olivier/git/earl-grey/src/translate-js.eg",3075,3079);}(trst$41046=(function(stmt$41072){return it$0$41028.translate(stmt$41072,"stmt");}));($41040$41077=mode$41024);if(($41040$41077==="expr")){(x$41089=["send",["lambda",[],orig$41023],["array"]]);return it$0$41028.translate(x$41089,mode$41024);}else{if(($41040$41077==="return")){(stmts$41100=b$41045.slice(0,-1));(ret$41101=$40425(b$41045,(b$41045.length-1)));return (stmts$41100.map(trst$41046).join("")+it$0$41028.translate(ret$41101,"return"));}else{if(($41040$41077==="stmt")){return b$41045.map(trst$41046).join("");}else{(other$41114=$41040$41077);throw $40501(["syntax","mode"]).create("Unknown mode",({"mode":mode$41024}));}}}}));(Translator$40788.prototype["expr"]=(function(x$41120,mode$41121){var other$41161;var $41134$41141;var it$0$41125;var self$41126;(it$0$41125=this);(self$41126=this);($41134$41141=mode$41121);if(($41134$41141==="expr")){return x$41120;}else{if(($41134$41141==="stmt")){return (x$41120+";");}else{if(($41134$41141==="return")){return (("return "+x$41120)+";");}else{(other$41161=$41134$41141);throw "OopsI";}}}}));(Translator$40788.prototype["op"]=(function(op$41167,a$41168,b$41169){var $41191$41205;var $41192$41206;var $41193$41207;var t0$41201;var t1$41202;var t2$41203;var $41187$41196;var e$41184;var it$0$41173;var self$41174;(it$0$41173=this);(self$41174=this);(e$41184=((($41187$41196=[a$41168,b$41169])),(function(){if((($41191$41205=($41187$41196 instanceof Array))&&(((t0$41201=$41187$41196.length)),(($41193$41207=(t0$41201===2))&&(((t1$41202=$41187$41196[0])),((t1$41202 instanceof Array)&&(((t2$41203=t1$41202.length)),((t2$41203===1)&&(t1$41202[0]==="void"))))))))){$41187$41196[1];return (op$41167+it$0$41173.translate(b$41169,"expr"));}else{if(($41193$41207&&($41187$41196[0],(((t1$41202=$41187$41196[1])),((t1$41202 instanceof Array)&&(((t2$41203=t1$41202.length)),((t2$41203===1)&&(t1$41202[0]==="void")))))))){return (it$0$41173.translate(a$41168,"expr")+op$41167);}else{$41187$41196;return ((it$0$41173.translate(a$41168,"expr")+op$41167)+it$0$41173.translate(b$41169,"expr"));}}})()));return (("("+e$41184)+")");}));(Translator$40788.prototype["translate"]=(function(expr$41250,mode$41251){var repl$41376;var it$0$41415;var it$0$41409;var it$0$41403;var it$0$41397;var bridge$41357$41434;var bridge$41356$41427;var other$41449;var id$41443;var bridge$41355$41367;var $41350$41362;var r$41347;var t0$41488;var t0$41495;var trf$41515;var trmsg$41516;var trf$41560;var trmsg$41561;var trf$41575;var trmsg$41576;var otherwise$41570;var $41542$41547;var x$41636;var x$41626;var $41609$41621;var $41610$41622;var $41611$41623;var t0$41619;var $41605$41614;var $index$41676;var $length$41670;var temp$41664;var acc$41658;var trf$41646;var trargs$41647;var op$41602;var code$41715;var code$41729;var t0$41707;var t1$41708;var trf$41736;var trmsg$41737;var codevar$41705;var f$41756;var r$41751;var f$41831;var f$41877;var v$41871;var all_strings$41773;var r$41774;var $index$41964;var $length$41958;var temp$41952;var acc$41946;var a$41931;var b$41932;var name$41924;var a$42028;var b$42029;var other$42023;var $42006$42011;var a$42066;var b$42067;var c$42068;var other$42060;var $42043$42048;var a$42121;var other$42117;var bridge$42096$42105;var $42094$42100;var a$42159;var b$42160;var other$42154;var bridge$42133$42142;var $42131$42137;var a$42188;var b$42189;var c$42190;var a$42209;var b$42210;var $index$42320;var $length$42314;var temp$42308;var acc$42302;var $index$42366;var $length$42360;var temp$42354;var acc$42348;var xs$42294;var $42232$42282;var $42228$42276;var isdecl$42233;var $index$42436;var $length$42430;var temp$42424;var acc$42418;var decls$42410;var f$42469;var r$42464;var other$42591;var $42574$42579;var a$42621;var b$42622;var other$42616;var $42599$42604;var a$42661;var b$42662;var c$42663;var d$42664;var other$42654;var $42637$42642;var a$42707;var b$42708;var c$42709;var other$42701;var $42684$42689;var t0$42753;var t0$42761;var a$42799;var b$42800;var other$42794;var $42777$42782;var other$42828;var t0$42815;var $42771$42810;var r$42774;var other$42837;var x$42832;var attempt$42721;var v$42722;var body$42723;var finally$42724;var x$42679;var y$42680;var body$42681;var x$42631;var y$42632;var z$42633;var body$42634;var test$42595;var body$42596;var label$42560;var body$42561;var value$42555;var value$42550;var value$42545;var label$42530;var label$42515;var value$42510;var args$42459;var vars$42404;var body$42405;var s$42399;var args$42394;var args$42223;var lhs$42202;var rhs$42203;var obj$42169;var msg$42170;var rhs$42171;var binding$42127;var value$42128;var binding$42080;var test$42038;var pos$42039;var neg$42040;var test$41990;var pos$41991;var bindings$41918;var body$41919;var args$41767;var args$41746;var f$41699;var msg$41700;var f$41585;var args$41586;var f$41525;var msg$41526;var s$41527;var f$41479;var msg$41480;var f$41454;var v$41342;var s$41328;var $41303$41322;var $41304$41323;var $41305$41324;var $41306$41325;var t0$41314;var t1$41315;var t2$41316;var t3$41317;var t4$41318;var bridge$41270$41319;var bridge$41300$41320;var $41264$41309;var it$0$41255;var self$41256;(it$0$41255=this);(self$41256=this);($41264$41309=expr$41250);if((($41303$41322=($41264$41309 instanceof Array))&&(((t0$41314=$41264$41309.length)),((t0$41314===2)&&($41264$41309[0]==="symbol"))))){(s$41328=$41264$41309[1]);return it$0$41255.expr(it$0$41255.mangle(s$41328),mode$41251);}else{if(($41303$41322&&((t0$41314===1)&&($41264$41309[0]==="void")))){return it$0$41255.expr("null",mode$41251);}else{if(($41303$41322&&((t0$41314===2)&&($41264$41309[0]==="value")))){(v$41342=$41264$41309[1]);(r$41347=((($41350$41362=v$41342)),(function(){if((typeof($41350$41362)==="string")){(repl$41376=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$41342=v$41342.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),(function(m$41384){return $40425(repl$41376,m$41384);})));return (("\""+v$41342)+"\"");}else{if(($41350$41362===(void 0))){return "(void 0)";}else{if($40389(RegExp)($41350$41362)){(it$0$41397=String(v$41342));(it$0$41403=it$0$41397.slice(1,-1));(it$0$41409=it$0$41403.replace(RegExp("/","g"),"\\/"));(it$0$41415=it$0$41409.replace(RegExp("\\n","g"),"\\n"));return "/".concat(it$0$41415).concat("/");}else{(bridge$41355$41367=$41350$41362);if(((((bridge$41356$41427=bridge$41355$41367)),((((bridge$41357$41434=bridge$41356$41427)),((typeof(bridge$41357$41434)==="number")||(bridge$41357$41434===true)))||(bridge$41356$41427===false)))||(bridge$41355$41367===null))){return String(v$41342);}else{if(($42924($41350$41362,"::id")&&((id$41443=$41350$41362["::id"]),id$41443))){return it$0$41255.translate(it$0$41255.register_value(v$41342,id$41443),mode$41251);}else{(other$41449=$41350$41362);throw $40501(["cannot_serialize"]).create("Cannot serialize value",({"value":v$41342}));}}}}}})()));return it$0$41255.expr(r$41347,mode$41251);}else{if(($41303$41322&&(($41305$41324=(t0$41314===3))&&(($41306$41325=($41264$41309[0]==="send"))&&(((t1$41315=$41264$41309[1])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&((t1$41315[0]==="variable")&&((t1$41315[1]==="___node")&&(((t3$41317=$41264$41309[2])),((t3$41317 instanceof Array)&&(((t4$41318=t3$41317.length)),((t4$41318===2)&&(t3$41317[0]==="value"))))))))))))))){(f$41454=t3$41317[1]);return f$41454;}else{if(($41306$41325&&(((bridge$41270$41319=$41264$41309[1])),((((bridge$41270$41319 instanceof Array)&&(((t0$41488=bridge$41270$41319.length)),((t0$41488===2)&&((bridge$41270$41319[0]==="symbol")&&(bridge$41270$41319[1]==="___js_fetch")))))||((bridge$41270$41319 instanceof Array)&&(((t0$41495=bridge$41270$41319.length)),((t0$41495===2)&&((bridge$41270$41319[0]==="variable")&&(bridge$41270$41319[1]==="___js_fetch"))))))&&(((t1$41315=$41264$41309[2])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===3)&&(t1$41315[0]==="array"))))))))){(f$41479=t1$41315[1]);(msg$41480=t1$41315[2]);(trf$41515=it$0$41255.translate(f$41479,"expr"));(trmsg$41516=it$0$41255.translate(msg$41480,"expr"));return it$0$41255.expr((((trf$41515+"[")+trmsg$41516)+"]"),mode$41251);}else{if(($41306$41325&&((f$41525=$41264$41309[1]),(((t1$41315=$41264$41309[2])),((msg$41526=t1$41315),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&(t1$41315[0]==="value"))))))))){(s$41527=t1$41315[1]);($41542$41547=null);$41542$41547;if(((typeof(s$41527)==="string")&&s$41527.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$41560=it$0$41255.translate(f$41525,"expr"));(trmsg$41561=it$0$41255.translate(["symbol",s$41527],"expr"));return it$0$41255.expr(((trf$41560+".")+trmsg$41561),mode$41251);}else{(otherwise$41570=$41542$41547);(trf$41575=it$0$41255.translate(f$41525,"expr"));(trmsg$41576=it$0$41255.translate(msg$41526,"expr"));return it$0$41255.expr((((trf$41575+"[")+trmsg$41576)+"]"),mode$41251);}}else{if(($41306$41325&&((f$41585=$41264$41309[1]),(((t1$41315=$41264$41309[2])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316>=1)&&(t1$41315[0]==="array")))))))){(args$41586=Array.prototype.slice.call(t1$41315,1));(op$41602=((($41605$41614=f$41585)),(function(){if((($41609$41621=($41605$41614 instanceof Array))&&(((t0$41619=$41605$41614.length)),(($41611$41623=(t0$41619===2))&&($41605$41614[0]==="symbol"))))){(x$41626=$41605$41614[1]);return $40425(js_op_table$40787,x$41626);}else{if(($41611$41623&&($41605$41614[0]==="variable"))){(x$41636=$41605$41614[1]);return $40425(js_op_table2$40786,x$41636);}else{$41605$41614;return null;}}})()));if(op$41602){return it$0$41255.expr(it$0$41255.op(op$41602,args$41586[0],args$41586[1]),mode$41251);}else{(trf$41646=it$0$41255.translate(f$41585,"expr"));(trargs$41647=(((acc$41658=[])),(((temp$41664=args$41586)),((($length$41670=temp$41664.length)),((($index$41676=0)),(function(){$41653:for(;($index$41676<$length$41670);($index$41676++)){var x$41693;var m$41685;(m$41685=temp$41664[$index$41676]);(x$41693=m$41685);acc$41658.push(it$0$41255.translate(x$41693,"expr"));}})()))),acc$41658));return it$0$41255.expr((((trf$41646+"(")+trargs$41647.join(","))+")"),mode$41251);}}else{if($41306$41325){(f$41699=$41264$41309[1]);(msg$41700=$41264$41309[2]);(t0$41707=(((code$41715="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41255.register_raw(code$41715,"~send")));if(((t0$41707 instanceof Array)&&(((t1$41708=t0$41707.length)),((t1$41708===2)&&(t0$41707[0]==="symbol"))))){(codevar$41705=t0$41707[1]);}else{$40482((((code$41729="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41255.register_raw(code$41729,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6702,6912);}(trf$41736=it$0$41255.translate(f$41699,"expr"));(trmsg$41737=it$0$41255.translate(msg$41700,"expr"));return it$0$41255.expr((((((codevar$41705+"(")+trf$41736)+",")+trmsg$41737)+")"),mode$41251);}else{if(($41303$41322&&(($41305$41324=(t0$41314>=1))&&($41264$41309[0]==="array")))){(args$41746=Array.prototype.slice.call($41264$41309,1));(r$41751=(((f$41756=(function(x$41761){return it$0$41255.translate(x$41761,"expr");}))),(("["+args$41746.map(f$41756).join(","))+"]")));return it$0$41255.expr(r$41751,mode$41251);}else{if(($41305$41324&&($41264$41309[0]==="object"))){(args$41767=Array.prototype.slice.call($41264$41309,1));(all_strings$41773=args$41767.every((function($41778$41781){var t0$41789;var t1$41790;var other$41824;var v$41814;var t0$41810;var $41783$41805;var ph$41786;var y$41787;(t0$41789=$41778$41781);if(((t0$41789 instanceof Array)&&(((t1$41790=t0$41789.length)),((t1$41790===3)&&(t0$41789[0]==="array"))))){(ph$41786=t0$41789[1]);(y$41787=t0$41789[2]);}else{$40482($41778$41781);}($41783$41805=ph$41786);if((($41783$41805 instanceof Array)&&(((t0$41810=$41783$41805.length)),((t0$41810===2)&&($41783$41805[0]==="value"))))){(v$41814=$41783$41805[1]);return true;}else{(other$41824=$41783$41805);return false;}})));(r$41774=(function(){if(all_strings$41773){(f$41831=(function($41835$41838){var t0$41843;var t1$41844;var a$41860;var b$41861;var x$41840;var y$41841;(t0$41843=$41835$41838);if(((t0$41843 instanceof Array)&&(((t1$41844=t0$41843.length)),((t1$41844===3)&&(t0$41843[0]==="array"))))){(x$41840=t0$41843[1]);(y$41841=t0$41843[2]);}else{$40482($41835$41838);}(a$41860=it$0$41255.translate(x$41840,"expr"));(b$41861=it$0$41255.translate(y$41841,"expr"));return ((a$41860+":")+b$41861);}));return (("({"+args$41767.map(f$41831).join(","))+"})");}else{(v$41871=gensym$40782());(f$41877=(function($41881$41884){var t0$41889;var t1$41890;var a$41906;var b$41907;var x$41886;var y$41887;(t0$41889=$41881$41884);if(((t0$41889 instanceof Array)&&(((t1$41890=t0$41889.length)),((t1$41890===3)&&(t0$41889[0]==="array"))))){(x$41886=t0$41889[1]);(y$41887=t0$41889[2]);}else{$40482($41881$41884);}(a$41906=it$0$41255.translate(x$41886,"expr"));(b$41907=it$0$41255.translate(y$41887,"expr"));return (((((v$41871+"[")+a$41906)+"]=")+b$41907)+";");}));return ((((((("(function(){"+"var ")+v$41871)+"={};")+args$41767.map(f$41877).join(""))+";return ")+v$41871)+";}())");}})());return it$0$41255.expr(r$41774,mode$41251);}else{if(($41303$41322&&((t0$41314===3)&&($41264$41309[0]==="lambda")))){(bindings$41918=$41264$41309[1]);(body$41919=$41264$41309[2]);(name$41924=(function(){if($40389(RegExp("^[$_a-zA-Z]*$",""))(expr$41250.name)){return (expr$41250.name+" ");}else{return "";}})());(a$41931=(((acc$41946=[])),(((temp$41952=bindings$41918)),((($length$41958=temp$41952.length)),((($index$41964=0)),(function(){$41941:for(;($index$41964<$length$41958);($index$41964++)){var x$41981;var m$41973;(m$41973=temp$41952[$index$41964]);(x$41981=m$41973);acc$41946.push(it$0$41255.translate(x$41981,"expr"));}})()))),acc$41946).join(","));(b$41932=it$0$41255.body(body$41919,"return"));return it$0$41255.expr((((((("(function"+name$41924)+"(")+a$41931)+"){")+b$41932)+"})"),mode$41251);}else{if(($41303$41322&&(($41305$41324=(t0$41314===4))&&(($41306$41325=($41264$41309[0]==="if"))&&((test$41990=$41264$41309[1]),((pos$41991=$41264$41309[2]),(((t1$41315=$41264$41309[3])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&((t1$41315[0]==="value")&&(t1$41315[1]===(void 0))))))))))))){($42006$42011=mode$41251);if(($42006$42011==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42023=$42006$42011);(a$42028=it$0$41255.translate(test$41990,"expr"));(b$42029=it$0$41255.translate(pos$41991,mode$41251));return (((("if("+a$42028)+"){")+b$42029)+"}");}}else{if($41306$41325){(test$42038=$41264$41309[1]);(pos$42039=$41264$41309[2]);(neg$42040=$41264$41309[3]);($42043$42048=mode$41251);if(($42043$42048==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42060=$42043$42048);(a$42066=it$0$41255.translate(test$42038,"expr"));(b$42067=it$0$41255.translate(pos$42039,mode$41251));(c$42068=it$0$41255.translate(neg$42040,mode$41251));return (((((("if("+a$42066)+"){")+b$42067)+"}else{")+c$42068)+"}");}}else{if(($41303$41322&&(($41305$41324=(t0$41314===3))&&(($41306$41325=($41264$41309[0]==="declare"))&&((binding$42080=$41264$41309[1]),(((t1$41315=$41264$41309[2])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&((t1$41315[0]==="value")&&(t1$41315[1]===(void 0)))))))))))){($42094$42100=mode$41251);(bridge$42096$42105=$42094$42100);if(((bridge$42096$42105==="expr")||(bridge$42096$42105==="return"))){throw "Invalid in expr ctx";}else{(other$42117=$42094$42100);(a$42121=it$0$41255.translate(binding$42080,"expr"));return (("var "+a$42121)+";");}}else{if($41306$41325){(binding$42127=$41264$41309[1]);(value$42128=$41264$41309[2]);($42131$42137=mode$41251);(bridge$42133$42142=$42131$42137);if(((bridge$42133$42142==="expr")||(bridge$42133$42142==="return"))){throw "Invalid in expr ctx";}else{(other$42154=$42131$42137);(a$42159=it$0$41255.translate(binding$42127,"expr"));(b$42160=it$0$41255.translate(value$42128,"expr"));return (((("var "+a$42159)+"=")+b$42160)+";");}}else{if(($41305$41324&&(($41306$41325=($41264$41309[0]==="assign"))&&(((t1$41315=$41264$41309[1])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===3)&&(t1$41315[0]==="send")))))))){(obj$42169=t1$41315[1]);(msg$42170=t1$41315[2]);(rhs$42171=$41264$41309[2]);(a$42188=it$0$41255.translate(obj$42169,"expr"));(b$42189=it$0$41255.translate(msg$42170,"expr"));(c$42190=it$0$41255.translate(rhs$42171,"expr"));return it$0$41255.expr((((((("("+a$42188)+"[")+b$42189)+"]=")+c$42190)+")"),mode$41251);}else{if($41306$41325){(lhs$42202=$41264$41309[1]);(rhs$42203=$41264$41309[2]);(a$42209=it$0$41255.translate(lhs$42202,"expr"));(b$42210=it$0$41255.translate(rhs$42203,"expr"));return it$0$41255.expr((((("("+a$42209)+"=")+b$42210)+")"),mode$41251);}else{if(($41303$41322&&((t0$41314===1)&&($41264$41309[0]==="multi")))){return "";}else{if(($41303$41322&&(($41305$41324=(t0$41314>=1))&&($41264$41309[0]==="multi")))){(args$42223=Array.prototype.slice.call($41264$41309,1));(isdecl$42233=(function($42237$42240){var other$42271;var variable$42260;var value$42261;var t0$42256;var $42242$42251;var ph$42245;(ph$42245=$42237$42240);($42242$42251=ph$42245);if((($42242$42251 instanceof Array)&&(((t0$42256=$42242$42251.length)),((t0$42256===3)&&($42242$42251[0]==="declare"))))){(variable$42260=$42242$42251[1]);(value$42261=$42242$42251[2]);return true;}else{(other$42271=$42242$42251);return false;}}));($42228$42276=null);$42228$42276;if((args$42223.length===1)){return it$0$41255.translate(args$42223[0],mode$41251);}else{if(((mode$41251==="expr")&&(!args$42223.some(isdecl$42233)))){(xs$42294=(((acc$42302=[])),(((temp$42308=args$42223)),((($length$42314=temp$42308.length)),((($index$42320=0)),(function(){$42297:for(;($index$42320<$length$42314);($index$42320++)){var x$42337;var m$42329;(m$42329=temp$42308[$index$42320]);(x$42337=m$42329);acc$42302.push(it$0$41255.translate(x$42337,"expr"));}})()))),acc$42302));(xs$42294=(((acc$42348=[])),(((temp$42354=xs$42294)),((($length$42360=temp$42354.length)),((($index$42366=0)),(function(){$42343:for(;($index$42366<$length$42360);($index$42366++)){var x$42383;var m$42375;(m$42375=temp$42354[$index$42366]);(x$42383=m$42375);if((x$42383!=="")){acc$42348.push(x$42383);}else{false;}}})()))),acc$42348));return (("("+xs$42294.join(","))+")");}else{return it$0$41255.body(expr$41250,mode$41251);}}}else{if(($41305$41324&&($41264$41309[0]==="splice"))){(args$42394=Array.prototype.slice.call($41264$41309,1));return it$0$41255.translate(["multi"].concat(args$42394),mode$41251);}else{if(($41303$41322&&((t0$41314===2)&&($41264$41309[0]==="variable")))){(s$42399=$41264$41309[1]);return it$0$41255.expr(it$0$41255.mangle(s$42399),mode$41251);}else{if(($41303$41322&&((t0$41314===3)&&($41264$41309[0]==="scope")))){(vars$42404=$41264$41309[1]);(body$42405=$41264$41309[2]);(decls$42410=(((acc$42418=[])),(((temp$42424=vars$42404)),((($length$42430=temp$42424.length)),((($index$42436=0)),(function(){$42413:for(;($index$42436<$length$42430);($index$42436++)){var v$42453;var m$42445;(m$42445=temp$42424[$index$42436]);(v$42453=m$42445);acc$42418.push(["declare",v$42453,["value",(void 0)]]);}})()))),acc$42418));return it$0$41255.translate(["multi"].concat(decls$42410).concat([body$42405]),mode$41251);}else{if(($41303$41322&&((t0$41314>=1)&&($41264$41309[0]==="object2")))){(args$42459=Array.prototype.slice.call($41264$41309,1));(r$42464=(((f$42469=(function($42473$42476){var t0$42481;var t1$42482;var a$42498;var b$42499;var x$42478;var y$42479;(t0$42481=$42473$42476);if(((t0$42481 instanceof Array)&&(((t1$42482=t0$42481.length)),(t1$42482===2)))){(x$42478=t0$42481[0]);(y$42479=t0$42481[1]);}else{$40482($42473$42476);}(a$42498=it$0$41255.translate(x$42478,"expr"));(b$42499=it$0$41255.translate(y$42479,"expr"));return ((a$42498+":")+b$42499);}))),(("({"+args$42459.map(f$42469).join(","))+"})")));return it$0$41255.expr(r$42464,mode$41251);}else{if(($41303$41322&&((t0$41314===2)&&($41264$41309[0]==="js_new")))){(value$42510=$41264$41309[1]);return it$0$41255.expr((("(new "+it$0$41255.translate(value$42510,"expr"))+")"),mode$41251);}else{if(($41303$41322&&(($41305$41324=((t0$41314>=1)&&(t0$41314<=2)))&&(($41264$41309[0]==="js_break")&&(((t1$41315=(function(){if((1>=t0$41314)){return ["value",null];}else{return $41264$41309[1];}})())),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&(t1$41315[0]==="value"))))))))){(label$42515=t1$41315[1]);if((mode$41251==="expr")){throw "Invalid break in ctx";}else{return (("break"+(function(){if(label$42515){return (" "+label$42515);}else{return "";}})())+";");}}else{if(($41305$41324&&(($41264$41309[0]==="js_continue")&&(((t1$41315=(function(){if((1>=t0$41314)){return ["value",null];}else{return $41264$41309[1];}})())),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&(t1$41315[0]==="value")))))))){(label$42530=t1$41315[1]);if((mode$41251==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+(function(){if(label$42530){return (" "+label$42530);}else{return "";}})())+";");}}else{if(($41303$41322&&(($41305$41324=(t0$41314===2))&&($41264$41309[0]==="js_return")))){(value$42545=$41264$41309[1]);if((mode$41251==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$41255.translate(value$42545,"expr"))+";");}}else{if(($41305$41324&&($41264$41309[0]==="js_delete"))){(value$42550=$41264$41309[1]);if((mode$41251==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$41255.translate(value$42550,"expr"))+";");}}else{if(($41305$41324&&($41264$41309[0]==="js_throw"))){(value$42555=$41264$41309[1]);if((mode$41251==="expr")){return (("function(){throw "+it$0$41255.translate(value$42555,"expr"))+";}()");}else{return (("throw "+it$0$41255.translate(value$42555,"expr"))+";");}}else{if(($41303$41322&&(($41305$41324=(t0$41314===3))&&(($41264$41309[0]==="js_label")&&(((t1$41315=$41264$41309[1])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===2)&&(t1$41315[0]==="value"))))))))){(label$42560=t1$41315[1]);(body$42561=$41264$41309[2]);($42574$42579=mode$41251);if(($42574$42579==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42591=$42574$42579);return ((label$42560+":")+it$0$41255.translate(body$42561,other$42591));}}else{if(($41305$41324&&($41264$41309[0]==="js_while"))){(test$42595=$41264$41309[1]);(body$42596=$41264$41309[2]);($42599$42604=mode$41251);if(($42599$42604==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42616=$42599$42604);(a$42621=it$0$41255.translate(test$42595,"expr"));(b$42622=it$0$41255.translate(body$42596,"stmt"));return (((("while("+a$42621)+"){")+b$42622)+"}");}}else{if(($41303$41322&&((t0$41314===5)&&($41264$41309[0]==="js_for")))){(x$42631=$41264$41309[1]);(y$42632=$41264$41309[2]);(z$42633=$41264$41309[3]);(body$42634=$41264$41309[4]);($42637$42642=mode$41251);if(($42637$42642==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42654=$42637$42642);(a$42661=it$0$41255.translate(x$42631,"expr"));(b$42662=it$0$41255.translate(y$42632,"expr"));(c$42663=it$0$41255.translate(z$42633,"expr"));(d$42664=it$0$41255.translate(body$42634,"stmt"));return (((((((("for("+a$42661)+";")+b$42662)+";")+c$42663)+"){")+d$42664)+"}");}}else{if(($41303$41322&&(($41305$41324=(t0$41314===4))&&($41264$41309[0]==="js_for_in")))){(x$42679=$41264$41309[1]);(y$42680=$41264$41309[2]);(body$42681=$41264$41309[3]);($42684$42689=mode$41251);if(($42684$42689==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42701=$42684$42689);(a$42707=it$0$41255.translate(x$42679,"expr"));(b$42708=it$0$41255.translate(y$42680,"expr"));(c$42709=it$0$41255.translate(body$42681,"stmt"));return (((((("for("+a$42707)+" in ")+b$42708)+"){")+c$42709)+"}");}}else{if(($41305$41324&&(($41264$41309[0]==="js_try")&&((attempt$42721=$41264$41309[1]),(((t1$41315=$41264$41309[2])),((t1$41315 instanceof Array)&&(((t2$41316=t1$41315.length)),((t2$41316===3)&&((t1$41315[0]==="lambda")&&(((t3$41317=t1$41315[1])),((t3$41317 instanceof Array)&&(((t4$41318=t3$41317.length)),((t4$41318===1)&&(((bridge$41300$41320=t3$41317[0])),(((bridge$41300$41320 instanceof Array)&&(((t0$42753=bridge$41300$41320.length)),((t0$42753===2)&&((bridge$41300$41320[0]==="symbol")&&((v$42722=bridge$41300$41320[1]),true)))))||((bridge$41300$41320 instanceof Array)&&(((t0$42761=bridge$41300$41320.length)),((t0$42761===2)&&((bridge$41300$41320[0]==="variable")&&((v$42722=bridge$41300$41320[1]),true)))))))))))))))))))){(body$42723=t1$41315[2]);(finally$42724=$41264$41309[3]);(r$42774=((($42777$42782=mode$41251)),(function(){if(($42777$42782==="expr")){return it$0$41255.body(expr$41250,"expr");}else{(other$42794=$42777$42782);(a$42799=it$0$41255.translate(attempt$42721,"stmt"));(b$42800=it$0$41255.translate(body$42723,"stmt"));return (((((("try{"+a$42799)+"}catch(")+v$42722)+"){")+b$42800)+"}");}})()));($42771$42810=finally$42724);if((($42771$42810 instanceof Array)&&(((t0$42815=$42771$42810.length)),((t0$42815===1)&&($42771$42810[0]==="void"))))){return r$42774;}else{(other$42828=$42771$42810);return (((r$42774+"finally{")+it$0$41255.translate(other$42828,"stmt"))+"}");}}else{if(($41303$41322&&((t0$41314===2)&&($41264$41309[0]==="raw")))){(x$42832=$41264$41309[1]);return x$42832;}else{(other$42837=$41264$41309);throw other$42837;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}));$40408(Translator$40788,$40408(((accum$42842=({})),((accum$42842["::name"]="Translator"),accum$42842)),((accum$42846=({})),((accum$42846["::egclass"]=true),accum$42846))));Translator$40788;(translate$40789=(function(expr$42853,mode$42854){var tr$42859;var t$42860;(tr$42859=Translator$40788());(t$42860=tr$42859.translate(expr$42853,mode$42854));return (tr$42859.dump_store()+t$42860);}));(exports["Translator"]=Translator$40788);(exports["translate"]=translate$40789);
