var $23313=function(type$23315){var f$23318;(f$23318=type$23315["::check"]);;if((f$23318===(void 0))){return function(value$23323){return (value$23323 instanceof type$23315);};}else{return function(value$23326){return f$23318.call(type$23315,value$23326);};}};
var $23328=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $23329=function(dest$23331,values$23332){var k$23337;(k$23337=null);$23335:for(k$23337 in values$23332){if(values$23332.hasOwnProperty(k$23337)){(dest$23331[k$23337]=values$23332[k$23337]);}}return dest$23331;};
var $23341=function($23342$23344){var ph$23348;(ph$23348=$23342$23344);;var $23346$23353;($23346$23353=ph$23348);;var bridge$23347$23358;var x$23362;(bridge$23347$23358=$23346$23353);if((((typeof(bridge$23347$23358)==="string")&&((x$23362=bridge$23347$23358),true))||((typeof(bridge$23347$23358)==="number")&&((x$23362=bridge$23347$23358),true)))){return ["value",x$23362];}else{var other$23369;(other$23369=$23346$23353);return other$23369["::serialize_ast"]();}};
var send$23153;(send$23153=function(obj$23158,$23156$23159){var ph$23163;var msg$23164;var t0$23166;(t0$23166=$23156$23159);(msg$23164=t0$23166);(ph$23163=t0$23166);;var $23161$23170;($23161$23170=ph$23163);;var bridge$23162$23175;(bridge$23162$23175=$23161$23170);if(((typeof(bridge$23162$23175)==="string")||(typeof(bridge$23162$23175)==="number"))){return obj$23158[msg$23164];}else{var other$23183;(other$23183=$23161$23170);return obj$23158["::send"](msg$23164);}});;(Array[":::project"]=function($23186$23188){var ph$23191;var value$23192;var t0$23194;(t0$23194=$23186$23188);(value$23192=t0$23194);(ph$23191=t0$23194);;var $23190$23198;($23190$23198=ph$23191);;if($23313(Array)($23190$23198)){return [true,value$23192];}else{$23190$23198;return [true,[value$23192]];}});(Array.prototype["::check"]=function(value$23212){if((value$23212 instanceof Array)){var i$23217;(i$23217=0);;$23215:for(;(i$23217<this.length);(i$23217++)){if(($23328(this,i$23217)!==$23328(value$23212,i$23217))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $23329(this.slice(0),this);});(Array.prototype[":::project"]=function(value$23228){if((value$23228 instanceof Array)){var i$23233;(i$23233=0);;$23231:for(;(i$23233<this.length);(i$23233++)){if(($23328(this,i$23233)!==$23328(value$23228,i$23233))){return [true,[value$23228]];}}return [true,value$23228.slice(this.length)];}else{return [true,[value$23228]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($23341));});(RegExp.prototype["::check"]=function($23243$23245){var ph$23248;(ph$23248=$23243$23245);;var $23247$23253;($23247$23253=ph$23248);;var value$23261;if((typeof($23247$23253)==="string")){(value$23261=$23247$23253);if(value$23261.match(this)){return true;}else{return false;}}else{var other$23266;(other$23266=$23247$23253);return false;}});(RegExp.prototype[":::project"]=function($23268$23270){var ph$23273;(ph$23273=$23268$23270);;var $23272$23278;($23272$23278=ph$23273);;var value$23286;if((typeof($23272$23278)==="string")){(value$23286=$23272$23278);var $23289$23291;($23289$23291=value$23286.match(this));;var m$23299;if(($23289$23291===null)){(m$23299=$23289$23291);return [false,null];}else{var m$23304;(m$23304=$23289$23291);return [true,m$23304];}}else{var other$23308;(other$23308=$23272$23278);return [false,null];}});(Function.prototype["::send"]=function(args$23311){return this.apply(this,args$23311);});
var $25081=function(arr$25083){var results$25087;var l$25088;(results$25087=[]);;(l$25088=arr$25083.length);;var i$25096;(i$25096=0);;$25086:for(;(i$25096<l$25088);(i$25096++)){results$25087.push([i$25096,$23328(arr$25083,i$25096)]);}return results$25087;};
var $24912=function(){var $24913$24915;($24913$24915=function(tags$24919){var it$0$24922;(it$0$24922=function(){if((!$23313($24913$24915)(this))){return Object.create($24913$24915.prototype);}else{return this;}}());;(it$0$24922["tags"]=tags$24919);return it$0$24922;});;($24913$24915.prototype["create"]=function(){var $24931$24933;($24931$24933=arguments);;var t0$24938;var message$24942;var args$24943;(t0$24938=$24931$24933.length);if((t0$24938>=0)){(message$24942=function(){if((0>=t0$24938)){return "";}else{return $24931$24933[0];}}());(args$24943=Array.prototype.slice.call($24931$24933,1));var it$0$24947;(it$0$24947=this);;var self$24952;(self$24952=this);;var e$24957;(e$24957=Error(message$24942));;(e$24957["::tags"]=it$0$24947.tags);(e$24957["args"]=args$24943);var temp$24965;(temp$24965=$25081(args$24943));;var $length$24970;($length$24970=temp$24965.length);;var $index$24975;($index$24975=0);;$24958:for(;($index$24975<$length$24970);($index$24975++)){var m$24983;(m$24983=temp$24965[$index$24975]);;var t0$24988;var t1$24989;var i$24993;var arg$24994;(t0$24988=m$24983);if(((t0$24988 instanceof Array)&&((t1$24989=t0$24988.length),(t1$24989===2)))){(i$24993=t0$24988[0]);(arg$24994=t0$24988[1]);(e$24957[i$24993]=arg$24994);}else{$24899(m$24983);;}}(e$24957["length"]=args$24943.length);(e$24957["name"]=["E"].concat(it$0$24947.tags).join("."));return e$24957;}else{$24899($24931$24933);}});($24913$24915.prototype["::check"]=function(e$25005){var it$0$25008;(it$0$25008=this);;var self$25013;(self$25013=this);;var tags$25018;if(((!e$25005)||(!$23313(Error)(e$25005)))){return false;}(tags$25018=(e$25005["::tags"]||[]));;var temp$25027;(temp$25027=it$0$25008.tags);;var $length$25032;($length$25032=temp$25027.length);;var $index$25037;($index$25037=0);;$25019:for(;($index$25037<$length$25032);($index$25037++)){var m$25045;(m$25045=temp$25027[$index$25037]);;var tag$25053;(tag$25053=m$25045);if((tags$25018.indexOf(tag$25053)===-1)){return false;}else{false;;}}return true;});($24913$24915.prototype["::deconstruct"]=function(e$25061){var it$0$25064;(it$0$25064=this);;var self$25069;(self$25069=this);;return e$25061.args;});$23329($24913$24915,$23329(function(){var accum$25074;(accum$25074=({}));(accum$25074["::name"]="$24913");return accum$25074;}(),function(){var accum$25078;(accum$25078=({}));(accum$25078["::egclass"]=true);return accum$25078;}()));return $24913$24915;}();
var $24899=function(value$24901,url$24902,start$24903,end$24904){var err$24907;(err$24907=$24912(["match"]).create("Could not find a match for value",({"value":value$24901})));;if(url$24902){(err$24907["location"]=["location",url$24902,start$24903,end$24904]);}throw err$24907;};
var $25103=function(type$25105){return function(value$25108){var f$25111;(f$25111=type$25105[":::project"]);;if((f$25111===(void 0))){(f$25111=type$25105["::project"]);if((f$25111===(void 0))){return [true,type$25105(value$25108)];}else{var rval$25117;(rval$25117=false);;try{(rval$25117=[true,f$25111(value$25108)]);}catch(excv$25123){var e$25129;(e$25129=excv$25123);(rval$25117=[false,null]);}return rval$25117;}}else{return f$25111.call(type$25105,value$25108);}};};
var $25131=function($25132$25134,key$25135){var ph$25139;(ph$25139=$25132$25134);;var $25137$25144;($25137$25144=ph$25139);;var bridge$25138$25149;(bridge$25138$25149=$25137$25144);if(((bridge$25138$25149===null)||(bridge$25138$25149===(void 0)))){return false;}else{var x$25157;if((typeof($25137$25144)==="string")){(x$25157=$25137$25144);return (key$25135 in String.prototype);}else{var x$25162;if((typeof($25137$25144)==="number")){(x$25162=$25137$25144);return (key$25135 in Number.prototype);}else{var x$25167;(x$25167=$25137$25144);return (key$25135 in x$25167);}}}};var accum$24875;var accum$24879;var $23373$23375;var gensym$23376;var $23374$23377;var __lt____gt__$23378;var js_op_table2$23379;var js_op_table$23380;var Translator$23381;var translate$23382;($23373$23375=require("./util"));;(gensym$23376=$23373$23375.gensym);;($23374$23377=require("./pp"));;(__lt____gt__$23378=$23374$23377["<>"]);;(js_op_table2$23379=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));;(js_op_table$23380=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));;(Translator$23381=function(){var it$0$23419;var prelude$23415;var t0$23411;var $23404$23406;($23404$23406=arguments);;(t0$23411=$23404$23406.length);if(((t0$23411>=0)&&(t0$23411<=1))){(prelude$23415=function(){if((0>=t0$23411)){return null;}else{return $23404$23406[0];}}());(it$0$23419=function(){if((!$23313(Translator$23381)(this))){return Object.create(Translator$23381.prototype);}else{return this;}}());;(it$0$23419["cache"]=({}));(it$0$23419["prepend"]=[]);if(prelude$23415){it$0$23419.prepend.push(it$0$23419.translate($23341(prelude$23415),"stmt"));}return it$0$23419;}else{$24899($23404$23406);}});;(Translator$23381.prototype["register_value"]=function(v$23432,id$23433){var temp$23458;var name$23464;var $23441$23447;var self$23442;var it$0$23436;(it$0$23436=this);;(self$23442=this);;($23441$23447=$23328(it$0$23436.cache,id$23433));;if(($23441$23447===(void 0))){(temp$23458=["symbol",gensym$23376()]);;(it$0$23436.cache[id$23433]=temp$23458);it$0$23436.prepend.push(it$0$23436.translate(["declare",temp$23458,$23341(v$23432)],"stmt"));return temp$23458;}else{(name$23464=$23441$23447);return name$23464;}});(Translator$23381.prototype["register_raw"]=function(raw$23469,id$23470){var temp$23495;var name$23501;var $23478$23484;var self$23479;var it$0$23473;(it$0$23473=this);;(self$23479=this);;($23478$23484=$23328(it$0$23473.cache,id$23470));;if(($23478$23484===(void 0))){(temp$23495=["symbol",gensym$23376()]);;(it$0$23473.cache[id$23470]=temp$23495);it$0$23473.prepend.push(it$0$23473.translate(["declare",temp$23495,["raw",raw$23469]],"stmt"));return temp$23495;}else{(name$23501=$23478$23484);return name$23501;}});(Translator$23381.prototype["dump_store"]=function(){var rval$23518;var self$23513;var it$0$23508;(it$0$23508=this);;(self$23513=this);;(rval$23518=it$0$23508.prepend.join("\n"));;(it$0$23508["prepend"]=[]);return rval$23518;});(Translator$23381.prototype["mangle"]=function(name$23525){var i$23548;var tr$23539;var r$23540;var self$23533;var it$0$23528;(it$0$23528=this);;(self$23533=this);;(tr$23539=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));;(r$23540=[]);;(i$23548=0);;$23538:for(;(i$23548<name$23525.length);(++i$23548)){var c$23556;(c$23556=$23328(name$23525,i$23548));;r$23540.push(($23328(tr$23539,c$23556)||c$23556));}return r$23540.join("");});(Translator$23381.prototype["body"]=function(orig$23563,mode$23564){var t0$23581;var t1$23582;var t2$23583;var x$23607;var stmts$23616;var ret$23617;var other$23630;var $23577$23596;var b$23578;var trst$23579;var self$23572;var it$0$23567;(it$0$23567=this);;(self$23572=this);;(t0$23581=$25103(["multi"])(orig$23563));if((t0$23581[0]&&((t1$23582=t0$23581[1]),((t2$23583=t1$23582.length),(t2$23583>=0))))){(b$23578=Array.prototype.slice.call(t1$23582,0));;}else{$24899(orig$23563,"/home/olivier/git/earl-grey/src/translate-js.eg",3258,3262);}(trst$23579=function(stmt$23592){return it$0$23567.translate(stmt$23592,"stmt");});;($23577$23596=mode$23564);;if(($23577$23596==="expr")){(x$23607=["send",["lambda",[],orig$23563],["array"]]);;return it$0$23567.translate(x$23607,mode$23564);}else{if(($23577$23596==="return")){(stmts$23616=b$23578.slice(0,-1));;(ret$23617=$23328(b$23578,(b$23578.length-1)));;return (stmts$23616.map(trst$23579).join("")+it$0$23567.translate(ret$23617,"return"));}else{if(($23577$23596==="stmt")){return b$23578.map(trst$23579).join("");}else{(other$23630=$23577$23596);throw $24912(["syntax","mode"]).create("Unknown mode",({"mode":mode$23564}));}}}});(Translator$23381.prototype["expr"]=function(x$23635,mode$23636){var other$23670;var $23644$23650;var self$23645;var it$0$23639;(it$0$23639=this);;(self$23645=this);;($23644$23650=mode$23636);;if(($23644$23650==="expr")){return x$23635;}else{if(($23644$23650==="stmt")){return (x$23635+";");}else{if(($23644$23650==="return")){return (("return "+x$23635)+";");}else{(other$23670=$23644$23650);throw "OopsI";}}}});(Translator$23381.prototype["op"]=function(op$23675,a$23676,b$23677){var $23694$23707;var $23695$23708;var $23696$23709;var t0$23703;var t1$23704;var t2$23705;var $23693$23698;var e$23690;var self$23685;var it$0$23680;(it$0$23680=this);;(self$23685=this);;(e$23690=((($23693$23698=[a$23676,b$23677])),function(){if((($23694$23707=($23693$23698 instanceof Array))&&((t0$23703=$23693$23698.length),(($23696$23709=(t0$23703===2))&&((t1$23704=$23693$23698[0]),((t1$23704 instanceof Array)&&((t2$23705=t1$23704.length),((t2$23705===1)&&(t1$23704[0]==="void"))))))))){$23693$23698[1];return (op$23675+it$0$23680.translate(b$23677,"expr"));}else{if(($23696$23709&&($23693$23698[0],((t1$23704=$23693$23698[1]),((t1$23704 instanceof Array)&&((t2$23705=t1$23704.length),((t2$23705===1)&&(t1$23704[0]==="void")))))))){return (it$0$23680.translate(a$23676,"expr")+op$23675);}else{$23693$23698;return ((it$0$23680.translate(a$23676,"expr")+op$23675)+it$0$23680.translate(b$23677,"expr"));}}}()));;return (("("+e$23690)+")");});(Translator$23381.prototype["translate"]=function(expr$23731,mode$23732){var repl$23807;var it$0$23838;var it$0$23833;var it$0$23828;var it$0$23823;var bridge$23793$23849;var bridge$23792$23846;var other$23860;var id$23854;var bridge$23791$23800;var $23790$23795;var r$23787;var t0$23879;var t0$23882;var trf$23888;var trmsg$23889;var trf$23920;var trmsg$23921;var trf$23933;var trmsg$23934;var otherwise$23930;var $23907$23909;var x$23977;var x$23971;var $23955$23966;var $23956$23967;var $23957$23968;var t0$23964;var $23954$23959;var $index$24010;var $length$24005;var temp$24000;var acc$23995;var trf$23985;var trargs$23986;var op$23951;var code$24042;var code$24050;var t0$24038;var t1$24039;var trf$24055;var trmsg$24056;var codevar$24036;var f$24073;var r$24069;var f$24127;var f$24159;var v$24154;var all_strings$24087;var r$24088;var $index$24219;var $length$24214;var temp$24209;var acc$24204;var a$24193;var b$24194;var a$24268;var b$24269;var other$24265;var $24251$24253;var a$24300;var b$24301;var c$24302;var other$24297;var $24283$24285;var a$24339;var other$24336;var bridge$24321$24328;var $24320$24323;var a$24368;var b$24369;var other$24365;var bridge$24350$24357;var $24349$24352;var a$24386;var b$24387;var c$24388;var a$24405;var b$24406;var $index$24495;var $length$24490;var temp$24485;var acc$24480;var $index$24532;var $length$24527;var temp$24522;var acc$24517;var xs$24474;var $24424$24464;var $24423$24458;var isdecl$24425;var $index$24594;var $length$24589;var temp$24584;var acc$24579;var decls$24573;var f$24623;var r$24619;var other$24706;var $24692$24694;var a$24731;var b$24732;var other$24728;var $24714$24716;var a$24764;var b$24765;var c$24766;var d$24767;var other$24761;var $24747$24749;var a$24804;var b$24805;var c$24806;var other$24801;var $24787$24789;var t0$24829;var t0$24833;var a$24857;var b$24858;var other$24854;var $24840$24842;var other$24872;var x$24867;var attempt$24818;var v$24819;var body$24820;var x$24782;var y$24783;var body$24784;var x$24741;var y$24742;var z$24743;var body$24744;var test$24710;var body$24711;var label$24686;var body$24687;var value$24681;var value$24676;var value$24671;var label$24664;var label$24657;var value$24652;var args$24615;var vars$24568;var body$24569;var s$24563;var args$24558;var args$24419;var lhs$24400;var rhs$24401;var obj$24378;var msg$24379;var rhs$24380;var binding$24345;var value$24346;var binding$24314;var test$24278;var pos$24279;var neg$24280;var test$24243;var pos$24244;var bindings$24188;var body$24189;var args$24083;var args$24065;var f$24031;var msg$24032;var f$23943;var args$23944;var f$23898;var msg$23899;var s$23900;var f$23874;var msg$23875;var f$23865;var v$23783;var s$23773;var $23743$23767;var $23744$23768;var $23745$23769;var $23746$23770;var t0$23757;var t1$23758;var t2$23759;var t3$23760;var t4$23761;var bridge$23741$23762;var bridge$23742$23763;var t5$23764;var t6$23765;var $23740$23752;var self$23747;var it$0$23735;(it$0$23735=this);;(self$23747=this);;($23740$23752=expr$23731);;if((($23743$23767=($23740$23752 instanceof Array))&&((t0$23757=$23740$23752.length),((t0$23757===2)&&($23740$23752[0]==="symbol"))))){(s$23773=$23740$23752[1]);return it$0$23735.expr(it$0$23735.mangle(s$23773),mode$23732);}else{if(($23743$23767&&((t0$23757===1)&&($23740$23752[0]==="void")))){return it$0$23735.expr("null",mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="value")))){(v$23783=$23740$23752[1]);(r$23787=((($23790$23795=v$23783)),function(){if((typeof($23790$23795)==="string")){(repl$23807=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));;(v$23783=v$23783.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$23812){return $23328(repl$23807,m$23812);}));return (("\""+v$23783)+"\"");}else{if(($23790$23795===(void 0))){return "(void 0)";}else{if($23313(RegExp)($23790$23795)){(it$0$23823=String(v$23783));;(it$0$23828=it$0$23823.slice(1,-1));;(it$0$23833=it$0$23828.replace(RegExp("/","g"),"\\/"));;(it$0$23838=it$0$23833.replace(RegExp("\n","g"),"\\n"));;return "/".concat(it$0$23838).concat("/");}else{(bridge$23791$23800=$23790$23795);if((((bridge$23792$23846=bridge$23791$23800),(((bridge$23793$23849=bridge$23792$23846),((typeof(bridge$23793$23849)==="number")||(bridge$23793$23849===true)))||(bridge$23792$23846===false)))||(bridge$23791$23800===null))){return String(v$23783);}else{if(($25131($23790$23795,"::id")&&((id$23854=$23790$23795["::id"]),id$23854))){return it$0$23735.translate(it$0$23735.register_value(v$23783,id$23854),mode$23732);}else{(other$23860=$23790$23795);throw $24912(["cannot_serialize"]).create("Cannot serialize value",({"value":v$23783}));}}}}}}()));;return it$0$23735.expr(r$23787,mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23746$23770=($23740$23752[0]==="send"))&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="variable")&&((t1$23758[1]==="___node")&&((t3$23760=$23740$23752[2]),((t3$23760 instanceof Array)&&((t4$23761=t3$23760.length),((t4$23761===2)&&(t3$23760[0]==="value"))))))))))))))){(f$23865=t3$23760[1]);return f$23865;}else{if(($23746$23770&&((bridge$23741$23762=$23740$23752[1]),((((bridge$23741$23762 instanceof Array)&&((t0$23879=bridge$23741$23762.length),((t0$23879===2)&&((bridge$23741$23762[0]==="symbol")&&(bridge$23741$23762[1]==="___js_fetch")))))||((bridge$23741$23762 instanceof Array)&&((t0$23882=bridge$23741$23762.length),((t0$23882===2)&&((bridge$23741$23762[0]==="variable")&&(bridge$23741$23762[1]==="___js_fetch"))))))&&((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&(t1$23758[0]==="array"))))))))){(f$23874=t1$23758[1]);(msg$23875=t1$23758[2]);(trf$23888=it$0$23735.translate(f$23874,"expr"));;(trmsg$23889=it$0$23735.translate(msg$23875,"expr"));;return it$0$23735.expr((((trf$23888+"[")+trmsg$23889)+"]"),mode$23732);}else{if(($23746$23770&&((f$23898=$23740$23752[1]),((t1$23758=$23740$23752[2]),((msg$23899=t1$23758),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(s$23900=t1$23758[1]);($23907$23909=null);;$23907$23909;if(((typeof(s$23900)==="string")&&s$23900.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$23920=it$0$23735.translate(f$23898,"expr"));;(trmsg$23921=it$0$23735.translate(["symbol",s$23900],"expr"));;return it$0$23735.expr(((trf$23920+".")+trmsg$23921),mode$23732);}else{(otherwise$23930=$23907$23909);(trf$23933=it$0$23735.translate(f$23898,"expr"));;(trmsg$23934=it$0$23735.translate(msg$23899,"expr"));;return it$0$23735.expr((((trf$23933+"[")+trmsg$23934)+"]"),mode$23732);}}else{if(($23746$23770&&((f$23943=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759>=1)&&(t1$23758[0]==="array")))))))){(args$23944=Array.prototype.slice.call(t1$23758,1));(op$23951=((($23954$23959=f$23943)),function(){if((($23955$23966=($23954$23959 instanceof Array))&&((t0$23964=$23954$23959.length),(($23957$23968=(t0$23964===2))&&($23954$23959[0]==="symbol"))))){(x$23971=$23954$23959[1]);return $23328(js_op_table$23380,x$23971);}else{if(($23957$23968&&($23954$23959[0]==="variable"))){(x$23977=$23954$23959[1]);return $23328(js_op_table2$23379,x$23977);}else{$23954$23959;return null;}}}()));;if(op$23951){return it$0$23735.expr(it$0$23735.op(op$23951,args$23944[0],args$23944[1]),mode$23732);}else{(trf$23985=it$0$23735.translate(f$23943,"expr"));;(trargs$23986=(((acc$23995=[])),(((temp$24000=args$23944)),((($length$24005=temp$24000.length)),((($index$24010=0)),function(){$23992:for(;($index$24010<$length$24005);($index$24010++)){var x$24026;var m$24018;(m$24018=temp$24000[$index$24010]);;(x$24026=m$24018);acc$23995.push(it$0$23735.translate(x$24026,"expr"));}}()))),acc$23995));;return it$0$23735.expr((((trf$23985+"(")+trargs$23986.join(","))+")"),mode$23732);}}else{if($23746$23770){(f$24031=$23740$23752[1]);(msg$24032=$23740$23752[2]);(t0$24038=(((code$24042="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23735.register_raw(code$24042,"~send")));if(((t0$24038 instanceof Array)&&((t1$24039=t0$24038.length),((t1$24039===2)&&(t0$24038[0]==="symbol"))))){(codevar$24036=t0$24038[1]);;}else{$24899((((code$24050="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$23735.register_raw(code$24050,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6890,7100);}(trf$24055=it$0$23735.translate(f$24031,"expr"));;(trmsg$24056=it$0$23735.translate(msg$24032,"expr"));;return it$0$23735.expr((((((codevar$24036+"(")+trf$24055)+",")+trmsg$24056)+")"),mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757>=1))&&($23740$23752[0]==="array")))){(args$24065=Array.prototype.slice.call($23740$23752,1));(r$24069=(((f$24073=function(x$24077){return it$0$23735.translate(x$24077,"expr");})),(("["+args$24065.map(f$24073).join(","))+"]")));;return it$0$23735.expr(r$24069,mode$23732);}else{if(($23745$23769&&($23740$23752[0]==="object"))){(args$24083=Array.prototype.slice.call($23740$23752,1));(all_strings$24087=args$24083.every(function($24091$24093){var t0$24099;var t1$24100;var other$24121;var v$24115;var t0$24111;var $24095$24106;var ph$24096;var y$24097;(t0$24099=$24091$24093);if(((t0$24099 instanceof Array)&&((t1$24100=t0$24099.length),((t1$24100===3)&&(t0$24099[0]==="array"))))){(ph$24096=t0$24099[1]);(y$24097=t0$24099[2]);;}else{$24899($24091$24093);}($24095$24106=ph$24096);;if((($24095$24106 instanceof Array)&&((t0$24111=$24095$24106.length),((t0$24111===2)&&($24095$24106[0]==="value"))))){(v$24115=$24095$24106[1]);return true;}else{(other$24121=$24095$24106);return false;}}));;(r$24088=function(){if(all_strings$24087){(f$24127=function($24130$24132){var t0$24137;var t1$24138;var a$24144;var b$24145;var x$24134;var y$24135;(t0$24137=$24130$24132);if(((t0$24137 instanceof Array)&&((t1$24138=t0$24137.length),((t1$24138===3)&&(t0$24137[0]==="array"))))){(x$24134=t0$24137[1]);(y$24135=t0$24137[2]);;}else{$24899($24130$24132);}(a$24144=it$0$23735.translate(x$24134,"expr"));;(b$24145=it$0$23735.translate(y$24135,"expr"));;return ((a$24144+":")+b$24145);});;return (("({"+args$24083.map(f$24127).join(","))+"})");}else{(v$24154=gensym$23376());;(f$24159=function($24162$24164){var t0$24169;var t1$24170;var a$24176;var b$24177;var x$24166;var y$24167;(t0$24169=$24162$24164);if(((t0$24169 instanceof Array)&&((t1$24170=t0$24169.length),((t1$24170===3)&&(t0$24169[0]==="array"))))){(x$24166=t0$24169[1]);(y$24167=t0$24169[2]);;}else{$24899($24162$24164);}(a$24176=it$0$23735.translate(x$24166,"expr"));;(b$24177=it$0$23735.translate(y$24167,"expr"));;return (((((v$24154+"[")+a$24176)+"]=")+b$24177)+";");});;return ((((((("(function(){"+"var ")+v$24154)+"={};")+args$24083.map(f$24159).join(""))+";return ")+v$24154)+";}())");}}());;return it$0$23735.expr(r$24088,mode$23732);}else{if(($23743$23767&&((t0$23757===3)&&($23740$23752[0]==="lambda")))){(bindings$24188=$23740$23752[1]);(body$24189=$23740$23752[2]);(a$24193=(((acc$24204=[])),(((temp$24209=bindings$24188)),((($length$24214=temp$24209.length)),((($index$24219=0)),function(){$24201:for(;($index$24219<$length$24214);($index$24219++)){var x$24235;var m$24227;(m$24227=temp$24209[$index$24219]);;(x$24235=m$24227);acc$24204.push(it$0$23735.translate(x$24235,"expr"));}}()))),acc$24204).join(","));;(b$24194=it$0$23735.body(body$24189,"return"));;return it$0$23735.expr((((("function("+a$24193)+"){")+b$24194)+"}"),mode$23732);}else{if(($23743$23767&&(($23745$23769=(t0$23757===4))&&(($23746$23770=($23740$23752[0]==="if"))&&((test$24243=$23740$23752[1]),((pos$24244=$23740$23752[2]),((t1$23758=$23740$23752[3]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="value")&&(t1$23758[1]===(void 0))))))))))))){($24251$24253=mode$23732);;if(($24251$24253==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24265=$24251$24253);(a$24268=it$0$23735.translate(test$24243,"expr"));;(b$24269=it$0$23735.translate(pos$24244,mode$23732));;return (((("if("+a$24268)+"){")+b$24269)+"}");}}else{if($23746$23770){(test$24278=$23740$23752[1]);(pos$24279=$23740$23752[2]);(neg$24280=$23740$23752[3]);($24283$24285=mode$23732);;if(($24283$24285==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24297=$24283$24285);(a$24300=it$0$23735.translate(test$24278,"expr"));;(b$24301=it$0$23735.translate(pos$24279,mode$23732));;(c$24302=it$0$23735.translate(neg$24280,mode$23732));;return (((((("if("+a$24300)+"){")+b$24301)+"}else{")+c$24302)+"}");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23746$23770=($23740$23752[0]==="declare"))&&((binding$24314=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&((t1$23758[0]==="value")&&(t1$23758[1]===(void 0)))))))))))){($24320$24323=mode$23732);;(bridge$24321$24328=$24320$24323);if(((bridge$24321$24328==="expr")||(bridge$24321$24328==="return"))){throw "Invalid in expr ctx";}else{(other$24336=$24320$24323);(a$24339=it$0$23735.translate(binding$24314,"expr"));;return (("var "+a$24339)+";");}}else{if($23746$23770){(binding$24345=$23740$23752[1]);(value$24346=$23740$23752[2]);($24349$24352=mode$23732);;(bridge$24350$24357=$24349$24352);if(((bridge$24350$24357==="expr")||(bridge$24350$24357==="return"))){throw "Invalid in expr ctx";}else{(other$24365=$24349$24352);(a$24368=it$0$23735.translate(binding$24345,"expr"));;(b$24369=it$0$23735.translate(value$24346,"expr"));;return (((("var "+a$24368)+"=")+b$24369)+";");}}else{if(($23745$23769&&(($23746$23770=($23740$23752[0]==="assign"))&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&(t1$23758[0]==="send")))))))){(obj$24378=t1$23758[1]);(msg$24379=t1$23758[2]);(rhs$24380=$23740$23752[2]);(a$24386=it$0$23735.translate(obj$24378,"expr"));;(b$24387=it$0$23735.translate(msg$24379,"expr"));;(c$24388=it$0$23735.translate(rhs$24380,"expr"));;return it$0$23735.expr((((((("("+a$24386)+"[")+b$24387)+"]=")+c$24388)+")"),mode$23732);}else{if($23746$23770){(lhs$24400=$23740$23752[1]);(rhs$24401=$23740$23752[2]);(a$24405=it$0$23735.translate(lhs$24400,"expr"));;(b$24406=it$0$23735.translate(rhs$24401,"expr"));;return it$0$23735.expr((((("("+a$24405)+"=")+b$24406)+")"),mode$23732);}else{if(($23743$23767&&((t0$23757===1)&&($23740$23752[0]==="multi")))){if((mode$23732==="stmt")){return ";";}else{return "";}}else{if(($23743$23767&&(($23745$23769=(t0$23757>=1))&&($23740$23752[0]==="multi")))){(args$24419=Array.prototype.slice.call($23740$23752,1));(isdecl$24425=function($24428$24430){var other$24454;var variable$24447;var value$24448;var t0$24443;var $24432$24438;var ph$24433;(ph$24433=$24428$24430);;($24432$24438=ph$24433);;if((($24432$24438 instanceof Array)&&((t0$24443=$24432$24438.length),((t0$24443===3)&&($24432$24438[0]==="declare"))))){(variable$24447=$24432$24438[1]);(value$24448=$24432$24438[2]);return true;}else{(other$24454=$24432$24438);return false;}});;($24423$24458=null);;$24423$24458;if((args$24419.length===1)){return it$0$23735.translate(args$24419[0],mode$23732);}else{if(((mode$23732==="expr")&&(!args$24419.some(isdecl$24425)))){(xs$24474=(((acc$24480=[])),(((temp$24485=args$24419)),((($length$24490=temp$24485.length)),((($index$24495=0)),function(){$24477:for(;($index$24495<$length$24490);($index$24495++)){var x$24511;var m$24503;(m$24503=temp$24485[$index$24495]);;(x$24511=m$24503);acc$24480.push(it$0$23735.translate(x$24511,"expr"));}}()))),acc$24480));;(xs$24474=(((acc$24517=[])),(((temp$24522=xs$24474)),((($length$24527=temp$24522.length)),((($index$24532=0)),function(){$24514:for(;($index$24532<$length$24527);($index$24532++)){var x$24548;var m$24540;(m$24540=temp$24522[$index$24532]);;(x$24548=m$24540);if((x$24548!=="")){acc$24517.push(x$24548);}else{false;;}}}()))),acc$24517));return (("("+xs$24474.join(","))+")");}else{return it$0$23735.body(expr$23731,mode$23732);}}}else{if(($23745$23769&&($23740$23752[0]==="splice"))){(args$24558=Array.prototype.slice.call($23740$23752,1));return it$0$23735.translate(["multi"].concat(args$24558),mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="variable")))){(s$24563=$23740$23752[1]);return it$0$23735.expr(it$0$23735.mangle(s$24563),mode$23732);}else{if(($23743$23767&&((t0$23757===3)&&($23740$23752[0]==="scope")))){(vars$24568=$23740$23752[1]);(body$24569=$23740$23752[2]);(decls$24573=(((acc$24579=[])),(((temp$24584=vars$24568)),((($length$24589=temp$24584.length)),((($index$24594=0)),function(){$24576:for(;($index$24594<$length$24589);($index$24594++)){var v$24610;var m$24602;(m$24602=temp$24584[$index$24594]);;(v$24610=m$24602);acc$24579.push(["declare",v$24610,["value",(void 0)]]);}}()))),acc$24579));;return it$0$23735.translate(["multi"].concat(decls$24573).concat([body$24569]),mode$23732);}else{if(($23743$23767&&((t0$23757>=1)&&($23740$23752[0]==="object2")))){(args$24615=Array.prototype.slice.call($23740$23752,1));(r$24619=(((f$24623=function($24626$24628){var t0$24633;var t1$24634;var a$24640;var b$24641;var x$24630;var y$24631;(t0$24633=$24626$24628);if(((t0$24633 instanceof Array)&&((t1$24634=t0$24633.length),(t1$24634===2)))){(x$24630=t0$24633[0]);(y$24631=t0$24633[1]);;}else{$24899($24626$24628);}(a$24640=it$0$23735.translate(x$24630,"expr"));;(b$24641=it$0$23735.translate(y$24631,"expr"));;return ((a$24640+":")+b$24641);})),(("({"+args$24615.map(f$24623).join(","))+"})")));;return it$0$23735.expr(r$24619,mode$23732);}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="js_new")))){(value$24652=$23740$23752[1]);return it$0$23735.expr((("(new "+it$0$23735.translate(value$24652,"expr"))+")"),mode$23732);}else{if(($23743$23767&&(($23745$23769=((t0$23757>=1)&&(t0$23757<=2)))&&(($23740$23752[0]==="js_break")&&((t1$23758=function(){if((1>=t0$23757)){return ["value",null];}else{return $23740$23752[1];}}()),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(label$24657=t1$23758[1]);if((mode$23732==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$24657){return (" "+label$24657);}else{return "";}}())+";");}}else{if(($23745$23769&&(($23740$23752[0]==="js_continue")&&((t1$23758=function(){if((1>=t0$23757)){return ["value",null];}else{return $23740$23752[1];}}()),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value")))))))){(label$24664=t1$23758[1]);if((mode$23732==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$24664){return (" "+label$24664);}else{return "";}}())+";");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===2))&&($23740$23752[0]==="js_return")))){(value$24671=$23740$23752[1]);if((mode$23732==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$23735.translate(value$24671,"expr"))+";");}}else{if(($23745$23769&&($23740$23752[0]==="js_delete"))){(value$24676=$23740$23752[1]);if((mode$23732==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$23735.translate(value$24676,"expr"))+";");}}else{if(($23745$23769&&($23740$23752[0]==="js_throw"))){(value$24681=$23740$23752[1]);if((mode$23732==="expr")){return (("function(){throw "+it$0$23735.translate(value$24681,"expr"))+";}()");}else{return (("throw "+it$0$23735.translate(value$24681,"expr"))+";");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===3))&&(($23740$23752[0]==="js_label")&&((t1$23758=$23740$23752[1]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===2)&&(t1$23758[0]==="value"))))))))){(label$24686=t1$23758[1]);(body$24687=$23740$23752[2]);($24692$24694=mode$23732);;if(($24692$24694==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24706=$24692$24694);return ((label$24686+":")+it$0$23735.translate(body$24687,other$24706));}}else{if(($23745$23769&&($23740$23752[0]==="js_while"))){(test$24710=$23740$23752[1]);(body$24711=$23740$23752[2]);($24714$24716=mode$23732);;if(($24714$24716==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24728=$24714$24716);(a$24731=it$0$23735.translate(test$24710,"expr"));;(b$24732=it$0$23735.translate(body$24711,"stmt"));;return (((("while("+a$24731)+"){")+b$24732)+"}");}}else{if(($23743$23767&&((t0$23757===5)&&($23740$23752[0]==="js_for")))){(x$24741=$23740$23752[1]);(y$24742=$23740$23752[2]);(z$24743=$23740$23752[3]);(body$24744=$23740$23752[4]);($24747$24749=mode$23732);;if(($24747$24749==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24761=$24747$24749);(a$24764=it$0$23735.translate(x$24741,"stmt"));;(b$24765=it$0$23735.translate(y$24742,"stmt"));;(c$24766=it$0$23735.translate(z$24743,"expr"));;(d$24767=it$0$23735.translate(body$24744,"stmt"));;return (((((("for("+a$24764)+b$24765)+c$24766)+"){")+d$24767)+"}");}}else{if(($23743$23767&&(($23745$23769=(t0$23757===4))&&($23740$23752[0]==="js_for_in")))){(x$24782=$23740$23752[1]);(y$24783=$23740$23752[2]);(body$24784=$23740$23752[3]);($24787$24789=mode$23732);;if(($24787$24789==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24801=$24787$24789);(a$24804=it$0$23735.translate(x$24782,"expr"));;(b$24805=it$0$23735.translate(y$24783,"expr"));;(c$24806=it$0$23735.translate(body$24784,"stmt"));;return (((((("for("+a$24804)+" in ")+b$24805)+"){")+c$24806)+"}");}}else{if(($23745$23769&&(($23740$23752[0]==="js_try")&&((attempt$24818=$23740$23752[1]),((t1$23758=$23740$23752[2]),((t1$23758 instanceof Array)&&((t2$23759=t1$23758.length),((t2$23759===3)&&((t1$23758[0]==="lambda")&&((t3$23760=t1$23758[1]),((t3$23760 instanceof Array)&&((t4$23761=t3$23760.length),((t4$23761===1)&&((bridge$23742$23763=t3$23760[0]),((((bridge$23742$23763 instanceof Array)&&((t0$24829=bridge$23742$23763.length),((t0$24829===2)&&((bridge$23742$23763[0]==="symbol")&&((v$24819=bridge$23742$23763[1]),true)))))||((bridge$23742$23763 instanceof Array)&&((t0$24833=bridge$23742$23763.length),((t0$24833===2)&&((bridge$23742$23763[0]==="variable")&&((v$24819=bridge$23742$23763[1]),true))))))&&((body$24820=t1$23758[2]),((t5$23764=$23740$23752[3]),((t5$23764 instanceof Array)&&((t6$23765=t5$23764.length),((t6$23765===1)&&(t5$23764[0]==="void"))))))))))))))))))))){($24840$24842=mode$23732);;if(($24840$24842==="expr")){return it$0$23735.body(expr$23731,"expr");}else{(other$24854=$24840$24842);(a$24857=it$0$23735.translate(attempt$24818,"stmt"));;(b$24858=it$0$23735.translate(body$24820,"stmt"));;return (((((("try{"+a$24857)+"}catch(")+v$24819)+"){")+b$24858)+"}");}}else{if(($23743$23767&&((t0$23757===2)&&($23740$23752[0]==="raw")))){(x$24867=$23740$23752[1]);return x$24867;}else{(other$24872=$23740$23752);throw other$24872;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$23329(Translator$23381,$23329(((accum$24875=({})),((accum$24875["::name"]="Translator"),accum$24875)),((accum$24879=({})),((accum$24879["::egclass"]=true),accum$24879))));Translator$23381;(translate$23382=function(expr$24885,mode$24886){var tr$24889;var t$24890;(tr$24889=Translator$23381());;(t$24890=tr$24889.translate(expr$24885,mode$24886));;return (tr$24889.dump_store()+t$24890);});;(exports["Translator"]=Translator$23381);(exports["translate"]=translate$23382);
