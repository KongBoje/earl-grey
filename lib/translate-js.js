var $36683=function(type$36686){var f$36690;(f$36690=type$36686["::check"]);if((f$36690===(void 0))){return function(value$36696){return (value$36696 instanceof type$36686);};}else{return function(value$36700){return f$36690.call(type$36686,value$36700);};}};
var $36702=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $36703=function(dest$36706,values$36707){var k$36712;(k$36712=null);$36710:for(k$36712 in values$36707){if(values$36707.hasOwnProperty(k$36712)){(dest$36706[k$36712]=values$36707[k$36712]);}}return dest$36706;};
var $36720=function($36722$36725){var ph$36731;(ph$36731=$36722$36725);var $36727$36737;($36727$36737=ph$36731);var bridge$36729$36742;var x$36746;(bridge$36729$36742=$36727$36737);if((((typeof(bridge$36729$36742)==="string")&&((x$36746=bridge$36729$36742),true))||((typeof(bridge$36729$36742)==="number")&&((x$36746=bridge$36729$36742),true)))){return ["value",x$36746];}else{var other$36757;(other$36757=$36727$36737);return other$36757["::serialize_ast"]();}};
var send$36457;(send$36457=function(obj$36464,$36461$36465){var ph$36471;var msg$36472;var t0$36474;(t0$36474=$36461$36465);(msg$36472=t0$36474);(ph$36471=t0$36474);var $36467$36483;($36467$36483=ph$36471);var bridge$36469$36488;(bridge$36469$36488=$36467$36483);if(((typeof(bridge$36469$36488)==="string")||(typeof(bridge$36469$36488)==="number"))){return obj$36464[msg$36472];}else{var other$36500;(other$36500=$36467$36483);return obj$36464["::send"](msg$36472);}});(Array[":::project"]=function($36506$36509){var ph$36514;var value$36515;var t0$36517;(t0$36517=$36506$36509);(value$36515=t0$36517);(ph$36514=t0$36517);var $36511$36526;($36511$36526=ph$36514);if($36683(Array)($36511$36526)){return [true,value$36515];}else{$36511$36526;return [true,[value$36515]];}});(Array.prototype["::check"]=function(value$36544){if((value$36544 instanceof Array)){var i$36550;(i$36550=0);$36547:for(;(i$36550<this.length);(i$36550++)){if(($36702(this,i$36550)!==$36702(value$36544,i$36550))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $36703(this.slice(0),this);});(Array.prototype[":::project"]=function(value$36569){if((value$36569 instanceof Array)){var i$36575;(i$36575=0);$36572:for(;(i$36575<this.length);(i$36575++)){if(($36702(this,i$36575)!==$36702(value$36569,i$36575))){return [true,[value$36569]];}}return [true,value$36569.slice(this.length)];}else{return [true,[value$36569]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($36720));});(RegExp.prototype["::check"]=function($36593$36596){var ph$36601;(ph$36601=$36593$36596);var $36598$36607;($36598$36607=ph$36601);var value$36615;if((typeof($36598$36607)==="string")){(value$36615=$36598$36607);if(value$36615.match(this)){return true;}else{return false;}}else{var other$36620;(other$36620=$36598$36607);return false;}});(RegExp.prototype[":::project"]=function($36626$36629){var ph$36634;(ph$36634=$36626$36629);var $36631$36640;($36631$36640=ph$36634);var value$36648;if((typeof($36631$36640)==="string")){(value$36648=$36631$36640);var $36651$36656;($36651$36656=value$36648.match(this));var m$36664;if(($36651$36656===null)){(m$36664=$36651$36656);return [false,null];}else{var m$36669;(m$36669=$36651$36656);return [true,m$36669];}}else{var other$36673;(other$36673=$36631$36640);return [false,null];}});(Function.prototype["::send"]=function(args$36680){return this.apply(this,args$36680);});
var $39123=function(arr$39126){var results$39132;var l$39133;(results$39132=[]);(l$39133=arr$39126.length);var i$39142;(i$39142=0);$39131:for(;(i$39142<l$39133);(i$39142++)){results$39132.push([i$39142,$36702(arr$39126,i$39142)]);}return results$39132;};
var $38890=function(){var $38891$38897;($38891$38897=function(tags$38902){var it$0$38905;(it$0$38905=function(){if((!$36683($38891$38897)(this))){return Object.create($38891$38897.prototype);}else{return this;}}());(it$0$38905["tags"]=tags$38902);return it$0$38905;});($38891$38897.prototype["create"]=function(){var it$0$38925;var self$38926;(it$0$38925=this);(self$38926=this);var $38923$38935;($38923$38935=arguments);var t0$38940;var message$38944;var args$38945;(t0$38940=$38923$38935.length);if((t0$38940>=0)){(message$38944=function(){if((0>=t0$38940)){return "";}else{return $38923$38935[0];}}());(args$38945=Array.prototype.slice.call($38923$38935,1));var e$38958;(e$38958=Error(message$38944));(e$38958["::tags"]=it$0$38925.tags);(e$38958["args"]=args$38945);var temp$38974;(temp$38974=$39123(args$38945));var $length$38980;($length$38980=temp$38974.length);var $index$38986;($index$38986=0);$38959:for(;($index$38986<$length$38980);($index$38986++)){var m$38995;(m$38995=temp$38974[$index$38986]);var t0$39000;var t1$39001;var i$39005;var arg$39006;(t0$39000=m$38995);if(((t0$39000 instanceof Array)&&(((t1$39001=t0$39000.length)),(t1$39001===2)))){(i$39005=t0$39000[0]);(arg$39006=t0$39000[1]);(e$38958[i$39005]=arg$39006);}else{$38871(m$38995);}}(e$38958["length"]=args$38945.length);(e$38958["name"]=["E"].concat(it$0$38925.tags).join("."));return e$38958;}else{$38871($38923$38935);}});($38891$38897.prototype["::check"]=function(e$39036){var it$0$39040;var self$39041;(it$0$39040=this);(self$39041=this);var tags$39051;if(((!e$39036)||(!$36683(Error)(e$39036)))){return false;}(tags$39051=(e$39036["::tags"]||[]));var temp$39062;(temp$39062=it$0$39040.tags);var $length$39068;($length$39068=temp$39062.length);var $index$39074;($index$39074=0);$39052:for(;($index$39074<$length$39068);($index$39074++)){var m$39083;(m$39083=temp$39062[$index$39074]);var tag$39091;(tag$39091=m$39083);if((tags$39051.indexOf(tag$39091)===-1)){return false;}else{false;}}return true;});($38891$38897.prototype["::deconstruct"]=function(e$39100){var it$0$39104;var self$39105;(it$0$39104=this);(self$39105=this);return e$39100.args;});$36703($38891$38897,$36703(function(){var accum$39116;(accum$39116=({}));(accum$39116["::name"]="$38891");return accum$39116;}(),function(){var accum$39120;(accum$39120=({}));(accum$39120["::egclass"]=true);return accum$39120;}()));return $38891$38897;}();
var $38871=function(value$38874,url$38875,start$38876,end$38877){var err$38881;(err$38881=$38890(["match"]).create("Could not find a match for value",({"value":value$38874})));if(url$38875){(err$38881["location"]=["location",url$38875,start$38876,end$38877]);}throw err$38881;};
var $39149=function(type$39152){return function(value$39156){var f$39160;(f$39160=type$39152[":::project"]);if((f$39160===(void 0))){(f$39160=type$39152["::project"]);if((f$39160===(void 0))){return [true,type$39152(value$39156)];}else{var rval$39173;(rval$39173=false);try{(rval$39173=[true,f$39160(value$39156)]);}catch(excv$39184){var e$39190;(e$39190=excv$39184);(rval$39173=[false,null]);}return rval$39173;}}else{return f$39160.call(type$39152,value$39156);}};};
var $39196=function($39198$39201,key$39202){var ph$39210;(ph$39210=$39198$39201);var $39204$39216;($39204$39216=ph$39210);var bridge$39206$39221;(bridge$39206$39221=$39204$39216);if(((bridge$39206$39221===null)||(bridge$39206$39221===(void 0)))){return false;}else{var x$39233;if((typeof($39204$39216)==="string")){(x$39233=$39204$39216);return (key$39202 in String.prototype);}else{var x$39238;if((typeof($39204$39216)==="number")){(x$39238=$39204$39216);return (key$39202 in Number.prototype);}else{var x$39243;(x$39243=$39204$39216);return (key$39202 in x$39243);}}}};var accum$38836;var accum$38840;var $36761$36779;var gensym$36780;var $36762$36781;var __lt____gt__$36782;var js_op_table2$36783;var js_op_table$36784;var Translator$36785;var translate$36786;($36761$36779=require("./util"));(gensym$36780=$36761$36779.gensym);($36762$36781=require("./pp"));(__lt____gt__$36782=$36762$36781["<>"]);(js_op_table2$36783=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$36784=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$36785=function(){var prelude$36829;var t0$36825;var $36816$36820;var it$0$36811;(it$0$36811=function(){if((!$36683(Translator$36785)(this))){return Object.create(Translator$36785.prototype);}else{return this;}}());($36816$36820=arguments);(t0$36825=$36816$36820.length);if(((t0$36825>=0)&&(t0$36825<=1))){(prelude$36829=function(){if((0>=t0$36825)){return null;}else{return $36816$36820[0];}}());(it$0$36811["cache"]=({}));(it$0$36811["prepend"]=[]);if(prelude$36829){it$0$36811.prepend.push(it$0$36811.translate($36720(prelude$36829),"stmt"));}}else{$38871($36816$36820);}return it$0$36811;});(Translator$36785.prototype["register_value"]=function(v$36853,id$36854){var temp$36885;var name$36894;var $36867$36872;var it$0$36858;var self$36859;(it$0$36858=this);(self$36859=this);($36867$36872=$36702(it$0$36858.cache,id$36854));if(($36867$36872===(void 0))){(temp$36885=["symbol",gensym$36780()]);(it$0$36858.cache[id$36854]=temp$36885);it$0$36858.prepend.push(it$0$36858.translate(["declare",temp$36885,$36720(v$36853)],"stmt"));return temp$36885;}else{(name$36894=$36867$36872);return name$36894;}});(Translator$36785.prototype["register_raw"]=function(raw$36900,id$36901){var temp$36932;var name$36941;var $36914$36919;var it$0$36905;var self$36906;(it$0$36905=this);(self$36906=this);($36914$36919=$36702(it$0$36905.cache,id$36901));if(($36914$36919===(void 0))){(temp$36932=["symbol",gensym$36780()]);(it$0$36905.cache[id$36901]=temp$36932);it$0$36905.prepend.push(it$0$36905.translate(["declare",temp$36932,["raw",raw$36900]],"stmt"));return temp$36932;}else{(name$36941=$36914$36919);return name$36941;}});(Translator$36785.prototype["dump_store"]=function(){var rval$36962;var it$0$36950;var self$36951;(it$0$36950=this);(self$36951=this);(rval$36962=it$0$36950.prepend.join("\n"));(it$0$36950["prepend"]=[]);return rval$36962;});(Translator$36785.prototype["mangle"]=function(name$36973){var i$37000;var tr$36990;var r$36991;var it$0$36977;var self$36978;(it$0$36977=this);(self$36978=this);(tr$36990=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$36991=[]);(i$37000=0);$36989:for(;(i$37000<name$36973.length);(++i$37000)){var c$37009;(c$37009=$36702(name$36973,i$37000));r$36991.push(($36702(tr$36990,c$37009)||c$37009));}return r$36991.join("");});(Translator$36785.prototype["body"]=function(orig$37017,mode$37018){var t0$37042;var t1$37043;var t2$37044;var x$37083;var stmts$37094;var ret$37095;var other$37108;var $37034$37071;var b$37039;var trst$37040;var it$0$37022;var self$37023;(it$0$37022=this);(self$37023=this);(t0$37042=$39149(["multi"])(orig$37017));if((t0$37042[0]&&(((t1$37043=t0$37042[1])),(((t2$37044=t1$37043.length)),(t2$37044>=0))))){(b$37039=Array.prototype.slice.call(t1$37043,0));}else{$38871(orig$37017,"/home/olivier/git/earl-grey/src/translate-js.eg",3071,3075);}(trst$37040=function(stmt$37066){return it$0$37022.translate(stmt$37066,"stmt");});($37034$37071=mode$37018);if(($37034$37071==="expr")){(x$37083=["send",["lambda",[],orig$37017],["array"]]);return it$0$37022.translate(x$37083,mode$37018);}else{if(($37034$37071==="return")){(stmts$37094=b$37039.slice(0,-1));(ret$37095=$36702(b$37039,(b$37039.length-1)));return (stmts$37094.map(trst$37040).join("")+it$0$37022.translate(ret$37095,"return"));}else{if(($37034$37071==="stmt")){return b$37039.map(trst$37040).join("");}else{(other$37108=$37034$37071);throw $38890(["syntax","mode"]).create("Unknown mode",({"mode":mode$37018}));}}}});(Translator$36785.prototype["expr"]=function(x$37114,mode$37115){var other$37155;var $37128$37135;var it$0$37119;var self$37120;(it$0$37119=this);(self$37120=this);($37128$37135=mode$37115);if(($37128$37135==="expr")){return x$37114;}else{if(($37128$37135==="stmt")){return (x$37114+";");}else{if(($37128$37135==="return")){return (("return "+x$37114)+";");}else{(other$37155=$37128$37135);throw "OopsI";}}}});(Translator$36785.prototype["op"]=function(op$37161,a$37162,b$37163){var $37185$37199;var $37186$37200;var $37187$37201;var t0$37195;var t1$37196;var t2$37197;var $37181$37190;var e$37178;var it$0$37167;var self$37168;(it$0$37167=this);(self$37168=this);(e$37178=((($37181$37190=[a$37162,b$37163])),function(){if((($37185$37199=($37181$37190 instanceof Array))&&(((t0$37195=$37181$37190.length)),(($37187$37201=(t0$37195===2))&&(((t1$37196=$37181$37190[0])),((t1$37196 instanceof Array)&&(((t2$37197=t1$37196.length)),((t2$37197===1)&&(t1$37196[0]==="void"))))))))){$37181$37190[1];return (op$37161+it$0$37167.translate(b$37163,"expr"));}else{if(($37187$37201&&($37181$37190[0],(((t1$37196=$37181$37190[1])),((t1$37196 instanceof Array)&&(((t2$37197=t1$37196.length)),((t2$37197===1)&&(t1$37196[0]==="void")))))))){return (it$0$37167.translate(a$37162,"expr")+op$37161);}else{$37181$37190;return ((it$0$37167.translate(a$37162,"expr")+op$37161)+it$0$37167.translate(b$37163,"expr"));}}}()));return (("("+e$37178)+")");});(Translator$36785.prototype["translate"]=function(expr$37244,mode$37245){var repl$37370;var it$0$37409;var it$0$37403;var it$0$37397;var it$0$37391;var bridge$37351$37428;var bridge$37350$37421;var other$37443;var id$37437;var bridge$37349$37361;var $37344$37356;var r$37341;var t0$37482;var t0$37489;var trf$37509;var trmsg$37510;var trf$37554;var trmsg$37555;var trf$37569;var trmsg$37570;var otherwise$37564;var $37536$37541;var x$37630;var x$37620;var $37603$37615;var $37604$37616;var $37605$37617;var t0$37613;var $37599$37608;var $index$37670;var $length$37664;var temp$37658;var acc$37652;var trf$37640;var trargs$37641;var op$37596;var code$37709;var code$37723;var t0$37701;var t1$37702;var trf$37730;var trmsg$37731;var codevar$37699;var f$37750;var r$37745;var f$37825;var f$37871;var v$37865;var all_strings$37767;var r$37768;var $index$37958;var $length$37952;var temp$37946;var acc$37940;var a$37925;var b$37926;var name$37918;var a$38022;var b$38023;var other$38017;var $38000$38005;var a$38060;var b$38061;var c$38062;var other$38054;var $38037$38042;var a$38115;var other$38111;var bridge$38090$38099;var $38088$38094;var a$38153;var b$38154;var other$38148;var bridge$38127$38136;var $38125$38131;var a$38182;var b$38183;var c$38184;var a$38203;var b$38204;var $index$38314;var $length$38308;var temp$38302;var acc$38296;var $index$38360;var $length$38354;var temp$38348;var acc$38342;var xs$38288;var $38226$38276;var $38222$38270;var isdecl$38227;var $index$38430;var $length$38424;var temp$38418;var acc$38412;var decls$38404;var f$38463;var r$38458;var other$38585;var $38568$38573;var a$38615;var b$38616;var other$38610;var $38593$38598;var a$38655;var b$38656;var c$38657;var d$38658;var other$38648;var $38631$38636;var a$38701;var b$38702;var c$38703;var other$38695;var $38678$38683;var t0$38747;var t0$38755;var a$38793;var b$38794;var other$38788;var $38771$38776;var other$38822;var t0$38809;var $38765$38804;var r$38768;var other$38831;var x$38826;var attempt$38715;var v$38716;var body$38717;var finally$38718;var x$38673;var y$38674;var body$38675;var x$38625;var y$38626;var z$38627;var body$38628;var test$38589;var body$38590;var label$38554;var body$38555;var value$38549;var value$38544;var value$38539;var label$38524;var label$38509;var value$38504;var args$38453;var vars$38398;var body$38399;var s$38393;var args$38388;var args$38217;var lhs$38196;var rhs$38197;var obj$38163;var msg$38164;var rhs$38165;var binding$38121;var value$38122;var binding$38074;var test$38032;var pos$38033;var neg$38034;var test$37984;var pos$37985;var bindings$37912;var body$37913;var args$37761;var args$37740;var f$37693;var msg$37694;var f$37579;var args$37580;var f$37519;var msg$37520;var s$37521;var f$37473;var msg$37474;var f$37448;var v$37336;var s$37322;var $37297$37316;var $37298$37317;var $37299$37318;var $37300$37319;var t0$37308;var t1$37309;var t2$37310;var t3$37311;var t4$37312;var bridge$37264$37313;var bridge$37294$37314;var $37258$37303;var it$0$37249;var self$37250;(it$0$37249=this);(self$37250=this);($37258$37303=expr$37244);if((($37297$37316=($37258$37303 instanceof Array))&&(((t0$37308=$37258$37303.length)),((t0$37308===2)&&($37258$37303[0]==="symbol"))))){(s$37322=$37258$37303[1]);return it$0$37249.expr(it$0$37249.mangle(s$37322),mode$37245);}else{if(($37297$37316&&((t0$37308===1)&&($37258$37303[0]==="void")))){return it$0$37249.expr("null",mode$37245);}else{if(($37297$37316&&((t0$37308===2)&&($37258$37303[0]==="value")))){(v$37336=$37258$37303[1]);(r$37341=((($37344$37356=v$37336)),function(){if((typeof($37344$37356)==="string")){(repl$37370=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$37336=v$37336.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$37378){return $36702(repl$37370,m$37378);}));return (("\""+v$37336)+"\"");}else{if(($37344$37356===(void 0))){return "(void 0)";}else{if($36683(RegExp)($37344$37356)){(it$0$37391=String(v$37336));(it$0$37397=it$0$37391.slice(1,-1));(it$0$37403=it$0$37397.replace(RegExp("/","g"),"\\/"));(it$0$37409=it$0$37403.replace(RegExp("\n","g"),"\\n"));return "/".concat(it$0$37409).concat("/");}else{(bridge$37349$37361=$37344$37356);if(((((bridge$37350$37421=bridge$37349$37361)),((((bridge$37351$37428=bridge$37350$37421)),((typeof(bridge$37351$37428)==="number")||(bridge$37351$37428===true)))||(bridge$37350$37421===false)))||(bridge$37349$37361===null))){return String(v$37336);}else{if(($39196($37344$37356,"::id")&&((id$37437=$37344$37356["::id"]),id$37437))){return it$0$37249.translate(it$0$37249.register_value(v$37336,id$37437),mode$37245);}else{(other$37443=$37344$37356);throw $38890(["cannot_serialize"]).create("Cannot serialize value",({"value":v$37336}));}}}}}}()));return it$0$37249.expr(r$37341,mode$37245);}else{if(($37297$37316&&(($37299$37318=(t0$37308===3))&&(($37300$37319=($37258$37303[0]==="send"))&&(((t1$37309=$37258$37303[1])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&((t1$37309[0]==="variable")&&((t1$37309[1]==="___node")&&(((t3$37311=$37258$37303[2])),((t3$37311 instanceof Array)&&(((t4$37312=t3$37311.length)),((t4$37312===2)&&(t3$37311[0]==="value"))))))))))))))){(f$37448=t3$37311[1]);return f$37448;}else{if(($37300$37319&&(((bridge$37264$37313=$37258$37303[1])),((((bridge$37264$37313 instanceof Array)&&(((t0$37482=bridge$37264$37313.length)),((t0$37482===2)&&((bridge$37264$37313[0]==="symbol")&&(bridge$37264$37313[1]==="___js_fetch")))))||((bridge$37264$37313 instanceof Array)&&(((t0$37489=bridge$37264$37313.length)),((t0$37489===2)&&((bridge$37264$37313[0]==="variable")&&(bridge$37264$37313[1]==="___js_fetch"))))))&&(((t1$37309=$37258$37303[2])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===3)&&(t1$37309[0]==="array"))))))))){(f$37473=t1$37309[1]);(msg$37474=t1$37309[2]);(trf$37509=it$0$37249.translate(f$37473,"expr"));(trmsg$37510=it$0$37249.translate(msg$37474,"expr"));return it$0$37249.expr((((trf$37509+"[")+trmsg$37510)+"]"),mode$37245);}else{if(($37300$37319&&((f$37519=$37258$37303[1]),(((t1$37309=$37258$37303[2])),((msg$37520=t1$37309),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&(t1$37309[0]==="value"))))))))){(s$37521=t1$37309[1]);($37536$37541=null);$37536$37541;if(((typeof(s$37521)==="string")&&s$37521.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$37554=it$0$37249.translate(f$37519,"expr"));(trmsg$37555=it$0$37249.translate(["symbol",s$37521],"expr"));return it$0$37249.expr(((trf$37554+".")+trmsg$37555),mode$37245);}else{(otherwise$37564=$37536$37541);(trf$37569=it$0$37249.translate(f$37519,"expr"));(trmsg$37570=it$0$37249.translate(msg$37520,"expr"));return it$0$37249.expr((((trf$37569+"[")+trmsg$37570)+"]"),mode$37245);}}else{if(($37300$37319&&((f$37579=$37258$37303[1]),(((t1$37309=$37258$37303[2])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310>=1)&&(t1$37309[0]==="array")))))))){(args$37580=Array.prototype.slice.call(t1$37309,1));(op$37596=((($37599$37608=f$37579)),function(){if((($37603$37615=($37599$37608 instanceof Array))&&(((t0$37613=$37599$37608.length)),(($37605$37617=(t0$37613===2))&&($37599$37608[0]==="symbol"))))){(x$37620=$37599$37608[1]);return $36702(js_op_table$36784,x$37620);}else{if(($37605$37617&&($37599$37608[0]==="variable"))){(x$37630=$37599$37608[1]);return $36702(js_op_table2$36783,x$37630);}else{$37599$37608;return null;}}}()));if(op$37596){return it$0$37249.expr(it$0$37249.op(op$37596,args$37580[0],args$37580[1]),mode$37245);}else{(trf$37640=it$0$37249.translate(f$37579,"expr"));(trargs$37641=(((acc$37652=[])),(((temp$37658=args$37580)),((($length$37664=temp$37658.length)),((($index$37670=0)),function(){$37647:for(;($index$37670<$length$37664);($index$37670++)){var x$37687;var m$37679;(m$37679=temp$37658[$index$37670]);(x$37687=m$37679);acc$37652.push(it$0$37249.translate(x$37687,"expr"));}}()))),acc$37652));return it$0$37249.expr((((trf$37640+"(")+trargs$37641.join(","))+")"),mode$37245);}}else{if($37300$37319){(f$37693=$37258$37303[1]);(msg$37694=$37258$37303[2]);(t0$37701=(((code$37709="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37249.register_raw(code$37709,"~send")));if(((t0$37701 instanceof Array)&&(((t1$37702=t0$37701.length)),((t1$37702===2)&&(t0$37701[0]==="symbol"))))){(codevar$37699=t0$37701[1]);}else{$38871((((code$37723="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37249.register_raw(code$37723,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6698,6908);}(trf$37730=it$0$37249.translate(f$37693,"expr"));(trmsg$37731=it$0$37249.translate(msg$37694,"expr"));return it$0$37249.expr((((((codevar$37699+"(")+trf$37730)+",")+trmsg$37731)+")"),mode$37245);}else{if(($37297$37316&&(($37299$37318=(t0$37308>=1))&&($37258$37303[0]==="array")))){(args$37740=Array.prototype.slice.call($37258$37303,1));(r$37745=(((f$37750=function(x$37755){return it$0$37249.translate(x$37755,"expr");})),(("["+args$37740.map(f$37750).join(","))+"]")));return it$0$37249.expr(r$37745,mode$37245);}else{if(($37299$37318&&($37258$37303[0]==="object"))){(args$37761=Array.prototype.slice.call($37258$37303,1));(all_strings$37767=args$37761.every(function($37772$37775){var t0$37783;var t1$37784;var other$37818;var v$37808;var t0$37804;var $37777$37799;var ph$37780;var y$37781;(t0$37783=$37772$37775);if(((t0$37783 instanceof Array)&&(((t1$37784=t0$37783.length)),((t1$37784===3)&&(t0$37783[0]==="array"))))){(ph$37780=t0$37783[1]);(y$37781=t0$37783[2]);}else{$38871($37772$37775);}($37777$37799=ph$37780);if((($37777$37799 instanceof Array)&&(((t0$37804=$37777$37799.length)),((t0$37804===2)&&($37777$37799[0]==="value"))))){(v$37808=$37777$37799[1]);return true;}else{(other$37818=$37777$37799);return false;}}));(r$37768=function(){if(all_strings$37767){(f$37825=function($37829$37832){var t0$37837;var t1$37838;var a$37854;var b$37855;var x$37834;var y$37835;(t0$37837=$37829$37832);if(((t0$37837 instanceof Array)&&(((t1$37838=t0$37837.length)),((t1$37838===3)&&(t0$37837[0]==="array"))))){(x$37834=t0$37837[1]);(y$37835=t0$37837[2]);}else{$38871($37829$37832);}(a$37854=it$0$37249.translate(x$37834,"expr"));(b$37855=it$0$37249.translate(y$37835,"expr"));return ((a$37854+":")+b$37855);});return (("({"+args$37761.map(f$37825).join(","))+"})");}else{(v$37865=gensym$36780());(f$37871=function($37875$37878){var t0$37883;var t1$37884;var a$37900;var b$37901;var x$37880;var y$37881;(t0$37883=$37875$37878);if(((t0$37883 instanceof Array)&&(((t1$37884=t0$37883.length)),((t1$37884===3)&&(t0$37883[0]==="array"))))){(x$37880=t0$37883[1]);(y$37881=t0$37883[2]);}else{$38871($37875$37878);}(a$37900=it$0$37249.translate(x$37880,"expr"));(b$37901=it$0$37249.translate(y$37881,"expr"));return (((((v$37865+"[")+a$37900)+"]=")+b$37901)+";");});return ((((((("(function(){"+"var ")+v$37865)+"={};")+args$37761.map(f$37871).join(""))+";return ")+v$37865)+";}())");}}());return it$0$37249.expr(r$37768,mode$37245);}else{if(($37297$37316&&((t0$37308===3)&&($37258$37303[0]==="lambda")))){(bindings$37912=$37258$37303[1]);(body$37913=$37258$37303[2]);(name$37918=function(){if($36683(RegExp("^[$_a-zA-Z]*$",""))(expr$37244.name)){return (expr$37244.name+" ");}else{return "";}}());(a$37925=(((acc$37940=[])),(((temp$37946=bindings$37912)),((($length$37952=temp$37946.length)),((($index$37958=0)),function(){$37935:for(;($index$37958<$length$37952);($index$37958++)){var x$37975;var m$37967;(m$37967=temp$37946[$index$37958]);(x$37975=m$37967);acc$37940.push(it$0$37249.translate(x$37975,"expr"));}}()))),acc$37940).join(","));(b$37926=it$0$37249.body(body$37913,"return"));return it$0$37249.expr((((((("function"+name$37918)+"(")+a$37925)+"){")+b$37926)+"}"),mode$37245);}else{if(($37297$37316&&(($37299$37318=(t0$37308===4))&&(($37300$37319=($37258$37303[0]==="if"))&&((test$37984=$37258$37303[1]),((pos$37985=$37258$37303[2]),(((t1$37309=$37258$37303[3])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&((t1$37309[0]==="value")&&(t1$37309[1]===(void 0))))))))))))){($38000$38005=mode$37245);if(($38000$38005==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38017=$38000$38005);(a$38022=it$0$37249.translate(test$37984,"expr"));(b$38023=it$0$37249.translate(pos$37985,mode$37245));return (((("if("+a$38022)+"){")+b$38023)+"}");}}else{if($37300$37319){(test$38032=$37258$37303[1]);(pos$38033=$37258$37303[2]);(neg$38034=$37258$37303[3]);($38037$38042=mode$37245);if(($38037$38042==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38054=$38037$38042);(a$38060=it$0$37249.translate(test$38032,"expr"));(b$38061=it$0$37249.translate(pos$38033,mode$37245));(c$38062=it$0$37249.translate(neg$38034,mode$37245));return (((((("if("+a$38060)+"){")+b$38061)+"}else{")+c$38062)+"}");}}else{if(($37297$37316&&(($37299$37318=(t0$37308===3))&&(($37300$37319=($37258$37303[0]==="declare"))&&((binding$38074=$37258$37303[1]),(((t1$37309=$37258$37303[2])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&((t1$37309[0]==="value")&&(t1$37309[1]===(void 0)))))))))))){($38088$38094=mode$37245);(bridge$38090$38099=$38088$38094);if(((bridge$38090$38099==="expr")||(bridge$38090$38099==="return"))){throw "Invalid in expr ctx";}else{(other$38111=$38088$38094);(a$38115=it$0$37249.translate(binding$38074,"expr"));return (("var "+a$38115)+";");}}else{if($37300$37319){(binding$38121=$37258$37303[1]);(value$38122=$37258$37303[2]);($38125$38131=mode$37245);(bridge$38127$38136=$38125$38131);if(((bridge$38127$38136==="expr")||(bridge$38127$38136==="return"))){throw "Invalid in expr ctx";}else{(other$38148=$38125$38131);(a$38153=it$0$37249.translate(binding$38121,"expr"));(b$38154=it$0$37249.translate(value$38122,"expr"));return (((("var "+a$38153)+"=")+b$38154)+";");}}else{if(($37299$37318&&(($37300$37319=($37258$37303[0]==="assign"))&&(((t1$37309=$37258$37303[1])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===3)&&(t1$37309[0]==="send")))))))){(obj$38163=t1$37309[1]);(msg$38164=t1$37309[2]);(rhs$38165=$37258$37303[2]);(a$38182=it$0$37249.translate(obj$38163,"expr"));(b$38183=it$0$37249.translate(msg$38164,"expr"));(c$38184=it$0$37249.translate(rhs$38165,"expr"));return it$0$37249.expr((((((("("+a$38182)+"[")+b$38183)+"]=")+c$38184)+")"),mode$37245);}else{if($37300$37319){(lhs$38196=$37258$37303[1]);(rhs$38197=$37258$37303[2]);(a$38203=it$0$37249.translate(lhs$38196,"expr"));(b$38204=it$0$37249.translate(rhs$38197,"expr"));return it$0$37249.expr((((("("+a$38203)+"=")+b$38204)+")"),mode$37245);}else{if(($37297$37316&&((t0$37308===1)&&($37258$37303[0]==="multi")))){return "";}else{if(($37297$37316&&(($37299$37318=(t0$37308>=1))&&($37258$37303[0]==="multi")))){(args$38217=Array.prototype.slice.call($37258$37303,1));(isdecl$38227=function($38231$38234){var other$38265;var variable$38254;var value$38255;var t0$38250;var $38236$38245;var ph$38239;(ph$38239=$38231$38234);($38236$38245=ph$38239);if((($38236$38245 instanceof Array)&&(((t0$38250=$38236$38245.length)),((t0$38250===3)&&($38236$38245[0]==="declare"))))){(variable$38254=$38236$38245[1]);(value$38255=$38236$38245[2]);return true;}else{(other$38265=$38236$38245);return false;}});($38222$38270=null);$38222$38270;if((args$38217.length===1)){return it$0$37249.translate(args$38217[0],mode$37245);}else{if(((mode$37245==="expr")&&(!args$38217.some(isdecl$38227)))){(xs$38288=(((acc$38296=[])),(((temp$38302=args$38217)),((($length$38308=temp$38302.length)),((($index$38314=0)),function(){$38291:for(;($index$38314<$length$38308);($index$38314++)){var x$38331;var m$38323;(m$38323=temp$38302[$index$38314]);(x$38331=m$38323);acc$38296.push(it$0$37249.translate(x$38331,"expr"));}}()))),acc$38296));(xs$38288=(((acc$38342=[])),(((temp$38348=xs$38288)),((($length$38354=temp$38348.length)),((($index$38360=0)),function(){$38337:for(;($index$38360<$length$38354);($index$38360++)){var x$38377;var m$38369;(m$38369=temp$38348[$index$38360]);(x$38377=m$38369);if((x$38377!=="")){acc$38342.push(x$38377);}else{false;}}}()))),acc$38342));return (("("+xs$38288.join(","))+")");}else{return it$0$37249.body(expr$37244,mode$37245);}}}else{if(($37299$37318&&($37258$37303[0]==="splice"))){(args$38388=Array.prototype.slice.call($37258$37303,1));return it$0$37249.translate(["multi"].concat(args$38388),mode$37245);}else{if(($37297$37316&&((t0$37308===2)&&($37258$37303[0]==="variable")))){(s$38393=$37258$37303[1]);return it$0$37249.expr(it$0$37249.mangle(s$38393),mode$37245);}else{if(($37297$37316&&((t0$37308===3)&&($37258$37303[0]==="scope")))){(vars$38398=$37258$37303[1]);(body$38399=$37258$37303[2]);(decls$38404=(((acc$38412=[])),(((temp$38418=vars$38398)),((($length$38424=temp$38418.length)),((($index$38430=0)),function(){$38407:for(;($index$38430<$length$38424);($index$38430++)){var v$38447;var m$38439;(m$38439=temp$38418[$index$38430]);(v$38447=m$38439);acc$38412.push(["declare",v$38447,["value",(void 0)]]);}}()))),acc$38412));return it$0$37249.translate(["multi"].concat(decls$38404).concat([body$38399]),mode$37245);}else{if(($37297$37316&&((t0$37308>=1)&&($37258$37303[0]==="object2")))){(args$38453=Array.prototype.slice.call($37258$37303,1));(r$38458=(((f$38463=function($38467$38470){var t0$38475;var t1$38476;var a$38492;var b$38493;var x$38472;var y$38473;(t0$38475=$38467$38470);if(((t0$38475 instanceof Array)&&(((t1$38476=t0$38475.length)),(t1$38476===2)))){(x$38472=t0$38475[0]);(y$38473=t0$38475[1]);}else{$38871($38467$38470);}(a$38492=it$0$37249.translate(x$38472,"expr"));(b$38493=it$0$37249.translate(y$38473,"expr"));return ((a$38492+":")+b$38493);})),(("({"+args$38453.map(f$38463).join(","))+"})")));return it$0$37249.expr(r$38458,mode$37245);}else{if(($37297$37316&&((t0$37308===2)&&($37258$37303[0]==="js_new")))){(value$38504=$37258$37303[1]);return it$0$37249.expr((("(new "+it$0$37249.translate(value$38504,"expr"))+")"),mode$37245);}else{if(($37297$37316&&(($37299$37318=((t0$37308>=1)&&(t0$37308<=2)))&&(($37258$37303[0]==="js_break")&&(((t1$37309=function(){if((1>=t0$37308)){return ["value",null];}else{return $37258$37303[1];}}())),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&(t1$37309[0]==="value"))))))))){(label$38509=t1$37309[1]);if((mode$37245==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$38509){return (" "+label$38509);}else{return "";}}())+";");}}else{if(($37299$37318&&(($37258$37303[0]==="js_continue")&&(((t1$37309=function(){if((1>=t0$37308)){return ["value",null];}else{return $37258$37303[1];}}())),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&(t1$37309[0]==="value")))))))){(label$38524=t1$37309[1]);if((mode$37245==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$38524){return (" "+label$38524);}else{return "";}}())+";");}}else{if(($37297$37316&&(($37299$37318=(t0$37308===2))&&($37258$37303[0]==="js_return")))){(value$38539=$37258$37303[1]);if((mode$37245==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$37249.translate(value$38539,"expr"))+";");}}else{if(($37299$37318&&($37258$37303[0]==="js_delete"))){(value$38544=$37258$37303[1]);if((mode$37245==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$37249.translate(value$38544,"expr"))+";");}}else{if(($37299$37318&&($37258$37303[0]==="js_throw"))){(value$38549=$37258$37303[1]);if((mode$37245==="expr")){return (("function(){throw "+it$0$37249.translate(value$38549,"expr"))+";}()");}else{return (("throw "+it$0$37249.translate(value$38549,"expr"))+";");}}else{if(($37297$37316&&(($37299$37318=(t0$37308===3))&&(($37258$37303[0]==="js_label")&&(((t1$37309=$37258$37303[1])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===2)&&(t1$37309[0]==="value"))))))))){(label$38554=t1$37309[1]);(body$38555=$37258$37303[2]);($38568$38573=mode$37245);if(($38568$38573==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38585=$38568$38573);return ((label$38554+":")+it$0$37249.translate(body$38555,other$38585));}}else{if(($37299$37318&&($37258$37303[0]==="js_while"))){(test$38589=$37258$37303[1]);(body$38590=$37258$37303[2]);($38593$38598=mode$37245);if(($38593$38598==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38610=$38593$38598);(a$38615=it$0$37249.translate(test$38589,"expr"));(b$38616=it$0$37249.translate(body$38590,"stmt"));return (((("while("+a$38615)+"){")+b$38616)+"}");}}else{if(($37297$37316&&((t0$37308===5)&&($37258$37303[0]==="js_for")))){(x$38625=$37258$37303[1]);(y$38626=$37258$37303[2]);(z$38627=$37258$37303[3]);(body$38628=$37258$37303[4]);($38631$38636=mode$37245);if(($38631$38636==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38648=$38631$38636);(a$38655=it$0$37249.translate(x$38625,"expr"));(b$38656=it$0$37249.translate(y$38626,"expr"));(c$38657=it$0$37249.translate(z$38627,"expr"));(d$38658=it$0$37249.translate(body$38628,"stmt"));return (((((((("for("+a$38655)+";")+b$38656)+";")+c$38657)+"){")+d$38658)+"}");}}else{if(($37297$37316&&(($37299$37318=(t0$37308===4))&&($37258$37303[0]==="js_for_in")))){(x$38673=$37258$37303[1]);(y$38674=$37258$37303[2]);(body$38675=$37258$37303[3]);($38678$38683=mode$37245);if(($38678$38683==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38695=$38678$38683);(a$38701=it$0$37249.translate(x$38673,"expr"));(b$38702=it$0$37249.translate(y$38674,"expr"));(c$38703=it$0$37249.translate(body$38675,"stmt"));return (((((("for("+a$38701)+" in ")+b$38702)+"){")+c$38703)+"}");}}else{if(($37299$37318&&(($37258$37303[0]==="js_try")&&((attempt$38715=$37258$37303[1]),(((t1$37309=$37258$37303[2])),((t1$37309 instanceof Array)&&(((t2$37310=t1$37309.length)),((t2$37310===3)&&((t1$37309[0]==="lambda")&&(((t3$37311=t1$37309[1])),((t3$37311 instanceof Array)&&(((t4$37312=t3$37311.length)),((t4$37312===1)&&(((bridge$37294$37314=t3$37311[0])),(((bridge$37294$37314 instanceof Array)&&(((t0$38747=bridge$37294$37314.length)),((t0$38747===2)&&((bridge$37294$37314[0]==="symbol")&&((v$38716=bridge$37294$37314[1]),true)))))||((bridge$37294$37314 instanceof Array)&&(((t0$38755=bridge$37294$37314.length)),((t0$38755===2)&&((bridge$37294$37314[0]==="variable")&&((v$38716=bridge$37294$37314[1]),true)))))))))))))))))))){(body$38717=t1$37309[2]);(finally$38718=$37258$37303[3]);(r$38768=((($38771$38776=mode$37245)),function(){if(($38771$38776==="expr")){return it$0$37249.body(expr$37244,"expr");}else{(other$38788=$38771$38776);(a$38793=it$0$37249.translate(attempt$38715,"stmt"));(b$38794=it$0$37249.translate(body$38717,"stmt"));return (((((("try{"+a$38793)+"}catch(")+v$38716)+"){")+b$38794)+"}");}}()));($38765$38804=finally$38718);if((($38765$38804 instanceof Array)&&(((t0$38809=$38765$38804.length)),((t0$38809===1)&&($38765$38804[0]==="void"))))){return r$38768;}else{(other$38822=$38765$38804);return (((r$38768+"finally{")+it$0$37249.translate(other$38822,"stmt"))+"}");}}else{if(($37297$37316&&((t0$37308===2)&&($37258$37303[0]==="raw")))){(x$38826=$37258$37303[1]);return x$38826;}else{(other$38831=$37258$37303);throw other$38831;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$36703(Translator$36785,$36703(((accum$38836=({})),((accum$38836["::name"]="Translator"),accum$38836)),((accum$38840=({})),((accum$38840["::egclass"]=true),accum$38840))));Translator$36785;(translate$36786=function(expr$38847,mode$38848){var tr$38853;var t$38854;(tr$38853=Translator$36785());(t$38854=tr$38853.translate(expr$38847,mode$38848));return (tr$38853.dump_store()+t$38854);});(exports["Translator"]=Translator$36785);(exports["translate"]=translate$36786);
