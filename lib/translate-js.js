var $36834=function(type$36837){var f$36841;(f$36841=type$36837["::check"]);if((f$36841===(void 0))){return function(value$36847){return (value$36847 instanceof type$36837);};}else{return function(value$36851){return f$36841.call(type$36837,value$36851);};}};
var $36853=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $36854=function(dest$36857,values$36858){var k$36863;(k$36863=null);$36861:for(k$36863 in values$36858){if(values$36858.hasOwnProperty(k$36863)){(dest$36857[k$36863]=values$36858[k$36863]);}}return dest$36857;};
var $36871=function($36873$36876){var ph$36882;(ph$36882=$36873$36876);var $36878$36888;($36878$36888=ph$36882);var bridge$36880$36893;var x$36897;(bridge$36880$36893=$36878$36888);if((((typeof(bridge$36880$36893)==="string")&&((x$36897=bridge$36880$36893),true))||((typeof(bridge$36880$36893)==="number")&&((x$36897=bridge$36880$36893),true)))){return ["value",x$36897];}else{var other$36908;(other$36908=$36878$36888);return other$36908["::serialize_ast"]();}};
var send$36608;(send$36608=function(obj$36615,$36612$36616){var ph$36622;var msg$36623;var t0$36625;(t0$36625=$36612$36616);(msg$36623=t0$36625);(ph$36622=t0$36625);var $36618$36634;($36618$36634=ph$36622);var bridge$36620$36639;(bridge$36620$36639=$36618$36634);if(((typeof(bridge$36620$36639)==="string")||(typeof(bridge$36620$36639)==="number"))){return obj$36615[msg$36623];}else{var other$36651;(other$36651=$36618$36634);return obj$36615["::send"](msg$36623);}});(Array[":::project"]=function($36657$36660){var ph$36665;var value$36666;var t0$36668;(t0$36668=$36657$36660);(value$36666=t0$36668);(ph$36665=t0$36668);var $36662$36677;($36662$36677=ph$36665);if($36834(Array)($36662$36677)){return [true,value$36666];}else{$36662$36677;return [true,[value$36666]];}});(Array.prototype["::check"]=function(value$36695){if((value$36695 instanceof Array)){var i$36701;(i$36701=0);$36698:for(;(i$36701<this.length);(i$36701++)){if(($36853(this,i$36701)!==$36853(value$36695,i$36701))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $36854(this.slice(0),this);});(Array.prototype[":::project"]=function(value$36720){if((value$36720 instanceof Array)){var i$36726;(i$36726=0);$36723:for(;(i$36726<this.length);(i$36726++)){if(($36853(this,i$36726)!==$36853(value$36720,i$36726))){return [true,[value$36720]];}}return [true,value$36720.slice(this.length)];}else{return [true,[value$36720]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($36871));});(RegExp.prototype["::check"]=function($36744$36747){var ph$36752;(ph$36752=$36744$36747);var $36749$36758;($36749$36758=ph$36752);var value$36766;if((typeof($36749$36758)==="string")){(value$36766=$36749$36758);if(value$36766.match(this)){return true;}else{return false;}}else{var other$36771;(other$36771=$36749$36758);return false;}});(RegExp.prototype[":::project"]=function($36777$36780){var ph$36785;(ph$36785=$36777$36780);var $36782$36791;($36782$36791=ph$36785);var value$36799;if((typeof($36782$36791)==="string")){(value$36799=$36782$36791);var $36802$36807;($36802$36807=value$36799.match(this));var m$36815;if(($36802$36807===null)){(m$36815=$36802$36807);return [false,null];}else{var m$36820;(m$36820=$36802$36807);return [true,m$36820];}}else{var other$36824;(other$36824=$36782$36791);return [false,null];}});(Function.prototype["::send"]=function(args$36831){return this.apply(this,args$36831);});
var $39274=function(arr$39277){var results$39283;var l$39284;(results$39283=[]);(l$39284=arr$39277.length);var i$39293;(i$39293=0);$39282:for(;(i$39293<l$39284);(i$39293++)){results$39283.push([i$39293,$36853(arr$39277,i$39293)]);}return results$39283;};
var $39041=function(){var $39042$39048;($39042$39048=function(tags$39053){var it$0$39056;(it$0$39056=function(){if((!$36834($39042$39048)(this))){return Object.create($39042$39048.prototype);}else{return this;}}());(it$0$39056["tags"]=tags$39053);return it$0$39056;});($39042$39048.prototype["create"]=function(){var it$0$39076;var self$39077;(it$0$39076=this);(self$39077=this);var $39074$39086;($39074$39086=arguments);var t0$39091;var message$39095;var args$39096;(t0$39091=$39074$39086.length);if((t0$39091>=0)){(message$39095=function(){if((0>=t0$39091)){return "";}else{return $39074$39086[0];}}());(args$39096=Array.prototype.slice.call($39074$39086,1));var e$39109;(e$39109=Error(message$39095));(e$39109["::tags"]=it$0$39076.tags);(e$39109["args"]=args$39096);var temp$39125;(temp$39125=$39274(args$39096));var $length$39131;($length$39131=temp$39125.length);var $index$39137;($index$39137=0);$39110:for(;($index$39137<$length$39131);($index$39137++)){var m$39146;(m$39146=temp$39125[$index$39137]);var t0$39151;var t1$39152;var i$39156;var arg$39157;(t0$39151=m$39146);if(((t0$39151 instanceof Array)&&(((t1$39152=t0$39151.length)),(t1$39152===2)))){(i$39156=t0$39151[0]);(arg$39157=t0$39151[1]);(e$39109[i$39156]=arg$39157);}else{$39022(m$39146);}}(e$39109["length"]=args$39096.length);(e$39109["name"]=["E"].concat(it$0$39076.tags).join("."));return e$39109;}else{$39022($39074$39086);}});($39042$39048.prototype["::check"]=function(e$39187){var it$0$39191;var self$39192;(it$0$39191=this);(self$39192=this);var tags$39202;if(((!e$39187)||(!$36834(Error)(e$39187)))){return false;}(tags$39202=(e$39187["::tags"]||[]));var temp$39213;(temp$39213=it$0$39191.tags);var $length$39219;($length$39219=temp$39213.length);var $index$39225;($index$39225=0);$39203:for(;($index$39225<$length$39219);($index$39225++)){var m$39234;(m$39234=temp$39213[$index$39225]);var tag$39242;(tag$39242=m$39234);if((tags$39202.indexOf(tag$39242)===-1)){return false;}else{false;}}return true;});($39042$39048.prototype["::deconstruct"]=function(e$39251){var it$0$39255;var self$39256;(it$0$39255=this);(self$39256=this);return e$39251.args;});$36854($39042$39048,$36854(function(){var accum$39267;(accum$39267=({}));(accum$39267["::name"]="$39042");return accum$39267;}(),function(){var accum$39271;(accum$39271=({}));(accum$39271["::egclass"]=true);return accum$39271;}()));return $39042$39048;}();
var $39022=function(value$39025,url$39026,start$39027,end$39028){var err$39032;(err$39032=$39041(["match"]).create("Could not find a match for value",({"value":value$39025})));if(url$39026){(err$39032["location"]=["location",url$39026,start$39027,end$39028]);}throw err$39032;};
var $39300=function(type$39303){return function(value$39307){var f$39311;(f$39311=type$39303[":::project"]);if((f$39311===(void 0))){(f$39311=type$39303["::project"]);if((f$39311===(void 0))){return [true,type$39303(value$39307)];}else{var rval$39324;(rval$39324=false);try{(rval$39324=[true,f$39311(value$39307)]);}catch(excv$39335){var e$39341;(e$39341=excv$39335);(rval$39324=[false,null]);}return rval$39324;}}else{return f$39311.call(type$39303,value$39307);}};};
var $39347=function($39349$39352,key$39353){var ph$39361;(ph$39361=$39349$39352);var $39355$39367;($39355$39367=ph$39361);var bridge$39357$39372;(bridge$39357$39372=$39355$39367);if(((bridge$39357$39372===null)||(bridge$39357$39372===(void 0)))){return false;}else{var x$39384;if((typeof($39355$39367)==="string")){(x$39384=$39355$39367);return (key$39353 in String.prototype);}else{var x$39389;if((typeof($39355$39367)==="number")){(x$39389=$39355$39367);return (key$39353 in Number.prototype);}else{var x$39394;(x$39394=$39355$39367);return (key$39353 in x$39394);}}}};var accum$38987;var accum$38991;var $36912$36930;var gensym$36931;var $36913$36932;var __lt____gt__$36933;var js_op_table2$36934;var js_op_table$36935;var Translator$36936;var translate$36937;($36912$36930=require("./util"));(gensym$36931=$36912$36930.gensym);($36913$36932=require("./pp"));(__lt____gt__$36933=$36913$36932["<>"]);(js_op_table2$36934=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$36935=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$36936=function(){var prelude$36980;var t0$36976;var $36967$36971;var it$0$36962;(it$0$36962=function(){if((!$36834(Translator$36936)(this))){return Object.create(Translator$36936.prototype);}else{return this;}}());($36967$36971=arguments);(t0$36976=$36967$36971.length);if(((t0$36976>=0)&&(t0$36976<=1))){(prelude$36980=function(){if((0>=t0$36976)){return null;}else{return $36967$36971[0];}}());(it$0$36962["cache"]=({}));(it$0$36962["prepend"]=[]);if(prelude$36980){it$0$36962.prepend.push(it$0$36962.translate($36871(prelude$36980),"stmt"));}}else{$39022($36967$36971);}return it$0$36962;});(Translator$36936.prototype["register_value"]=function(v$37004,id$37005){var temp$37036;var name$37045;var $37018$37023;var it$0$37009;var self$37010;(it$0$37009=this);(self$37010=this);($37018$37023=$36853(it$0$37009.cache,id$37005));if(($37018$37023===(void 0))){(temp$37036=["symbol",gensym$36931()]);(it$0$37009.cache[id$37005]=temp$37036);it$0$37009.prepend.push(it$0$37009.translate(["declare",temp$37036,$36871(v$37004)],"stmt"));return temp$37036;}else{(name$37045=$37018$37023);return name$37045;}});(Translator$36936.prototype["register_raw"]=function(raw$37051,id$37052){var temp$37083;var name$37092;var $37065$37070;var it$0$37056;var self$37057;(it$0$37056=this);(self$37057=this);($37065$37070=$36853(it$0$37056.cache,id$37052));if(($37065$37070===(void 0))){(temp$37083=["symbol",gensym$36931()]);(it$0$37056.cache[id$37052]=temp$37083);it$0$37056.prepend.push(it$0$37056.translate(["declare",temp$37083,["raw",raw$37051]],"stmt"));return temp$37083;}else{(name$37092=$37065$37070);return name$37092;}});(Translator$36936.prototype["dump_store"]=function(){var rval$37113;var it$0$37101;var self$37102;(it$0$37101=this);(self$37102=this);(rval$37113=it$0$37101.prepend.join("\n"));(it$0$37101["prepend"]=[]);return rval$37113;});(Translator$36936.prototype["mangle"]=function(name$37124){var i$37151;var tr$37141;var r$37142;var it$0$37128;var self$37129;(it$0$37128=this);(self$37129=this);(tr$37141=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$37142=[]);(i$37151=0);$37140:for(;(i$37151<name$37124.length);(++i$37151)){var c$37160;(c$37160=$36853(name$37124,i$37151));r$37142.push(($36853(tr$37141,c$37160)||c$37160));}return r$37142.join("");});(Translator$36936.prototype["body"]=function(orig$37168,mode$37169){var t0$37193;var t1$37194;var t2$37195;var x$37234;var stmts$37245;var ret$37246;var other$37259;var $37185$37222;var b$37190;var trst$37191;var it$0$37173;var self$37174;(it$0$37173=this);(self$37174=this);(t0$37193=$39300(["multi"])(orig$37168));if((t0$37193[0]&&(((t1$37194=t0$37193[1])),(((t2$37195=t1$37194.length)),(t2$37195>=0))))){(b$37190=Array.prototype.slice.call(t1$37194,0));}else{$39022(orig$37168,"/home/olivier/git/earl-grey/src/translate-js.eg",3071,3075);}(trst$37191=function(stmt$37217){return it$0$37173.translate(stmt$37217,"stmt");});($37185$37222=mode$37169);if(($37185$37222==="expr")){(x$37234=["send",["lambda",[],orig$37168],["array"]]);return it$0$37173.translate(x$37234,mode$37169);}else{if(($37185$37222==="return")){(stmts$37245=b$37190.slice(0,-1));(ret$37246=$36853(b$37190,(b$37190.length-1)));return (stmts$37245.map(trst$37191).join("")+it$0$37173.translate(ret$37246,"return"));}else{if(($37185$37222==="stmt")){return b$37190.map(trst$37191).join("");}else{(other$37259=$37185$37222);throw $39041(["syntax","mode"]).create("Unknown mode",({"mode":mode$37169}));}}}});(Translator$36936.prototype["expr"]=function(x$37265,mode$37266){var other$37306;var $37279$37286;var it$0$37270;var self$37271;(it$0$37270=this);(self$37271=this);($37279$37286=mode$37266);if(($37279$37286==="expr")){return x$37265;}else{if(($37279$37286==="stmt")){return (x$37265+";");}else{if(($37279$37286==="return")){return (("return "+x$37265)+";");}else{(other$37306=$37279$37286);throw "OopsI";}}}});(Translator$36936.prototype["op"]=function(op$37312,a$37313,b$37314){var $37336$37350;var $37337$37351;var $37338$37352;var t0$37346;var t1$37347;var t2$37348;var $37332$37341;var e$37329;var it$0$37318;var self$37319;(it$0$37318=this);(self$37319=this);(e$37329=((($37332$37341=[a$37313,b$37314])),function(){if((($37336$37350=($37332$37341 instanceof Array))&&(((t0$37346=$37332$37341.length)),(($37338$37352=(t0$37346===2))&&(((t1$37347=$37332$37341[0])),((t1$37347 instanceof Array)&&(((t2$37348=t1$37347.length)),((t2$37348===1)&&(t1$37347[0]==="void"))))))))){$37332$37341[1];return (op$37312+it$0$37318.translate(b$37314,"expr"));}else{if(($37338$37352&&($37332$37341[0],(((t1$37347=$37332$37341[1])),((t1$37347 instanceof Array)&&(((t2$37348=t1$37347.length)),((t2$37348===1)&&(t1$37347[0]==="void")))))))){return (it$0$37318.translate(a$37313,"expr")+op$37312);}else{$37332$37341;return ((it$0$37318.translate(a$37313,"expr")+op$37312)+it$0$37318.translate(b$37314,"expr"));}}}()));return (("("+e$37329)+")");});(Translator$36936.prototype["translate"]=function(expr$37395,mode$37396){var repl$37521;var it$0$37560;var it$0$37554;var it$0$37548;var it$0$37542;var bridge$37502$37579;var bridge$37501$37572;var other$37594;var id$37588;var bridge$37500$37512;var $37495$37507;var r$37492;var t0$37633;var t0$37640;var trf$37660;var trmsg$37661;var trf$37705;var trmsg$37706;var trf$37720;var trmsg$37721;var otherwise$37715;var $37687$37692;var x$37781;var x$37771;var $37754$37766;var $37755$37767;var $37756$37768;var t0$37764;var $37750$37759;var $index$37821;var $length$37815;var temp$37809;var acc$37803;var trf$37791;var trargs$37792;var op$37747;var code$37860;var code$37874;var t0$37852;var t1$37853;var trf$37881;var trmsg$37882;var codevar$37850;var f$37901;var r$37896;var f$37976;var f$38022;var v$38016;var all_strings$37918;var r$37919;var $index$38109;var $length$38103;var temp$38097;var acc$38091;var a$38076;var b$38077;var name$38069;var a$38173;var b$38174;var other$38168;var $38151$38156;var a$38211;var b$38212;var c$38213;var other$38205;var $38188$38193;var a$38266;var other$38262;var bridge$38241$38250;var $38239$38245;var a$38304;var b$38305;var other$38299;var bridge$38278$38287;var $38276$38282;var a$38333;var b$38334;var c$38335;var a$38354;var b$38355;var $index$38465;var $length$38459;var temp$38453;var acc$38447;var $index$38511;var $length$38505;var temp$38499;var acc$38493;var xs$38439;var $38377$38427;var $38373$38421;var isdecl$38378;var $index$38581;var $length$38575;var temp$38569;var acc$38563;var decls$38555;var f$38614;var r$38609;var other$38736;var $38719$38724;var a$38766;var b$38767;var other$38761;var $38744$38749;var a$38806;var b$38807;var c$38808;var d$38809;var other$38799;var $38782$38787;var a$38852;var b$38853;var c$38854;var other$38846;var $38829$38834;var t0$38898;var t0$38906;var a$38944;var b$38945;var other$38939;var $38922$38927;var other$38973;var t0$38960;var $38916$38955;var r$38919;var other$38982;var x$38977;var attempt$38866;var v$38867;var body$38868;var finally$38869;var x$38824;var y$38825;var body$38826;var x$38776;var y$38777;var z$38778;var body$38779;var test$38740;var body$38741;var label$38705;var body$38706;var value$38700;var value$38695;var value$38690;var label$38675;var label$38660;var value$38655;var args$38604;var vars$38549;var body$38550;var s$38544;var args$38539;var args$38368;var lhs$38347;var rhs$38348;var obj$38314;var msg$38315;var rhs$38316;var binding$38272;var value$38273;var binding$38225;var test$38183;var pos$38184;var neg$38185;var test$38135;var pos$38136;var bindings$38063;var body$38064;var args$37912;var args$37891;var f$37844;var msg$37845;var f$37730;var args$37731;var f$37670;var msg$37671;var s$37672;var f$37624;var msg$37625;var f$37599;var v$37487;var s$37473;var $37448$37467;var $37449$37468;var $37450$37469;var $37451$37470;var t0$37459;var t1$37460;var t2$37461;var t3$37462;var t4$37463;var bridge$37415$37464;var bridge$37445$37465;var $37409$37454;var it$0$37400;var self$37401;(it$0$37400=this);(self$37401=this);($37409$37454=expr$37395);if((($37448$37467=($37409$37454 instanceof Array))&&(((t0$37459=$37409$37454.length)),((t0$37459===2)&&($37409$37454[0]==="symbol"))))){(s$37473=$37409$37454[1]);return it$0$37400.expr(it$0$37400.mangle(s$37473),mode$37396);}else{if(($37448$37467&&((t0$37459===1)&&($37409$37454[0]==="void")))){return it$0$37400.expr("null",mode$37396);}else{if(($37448$37467&&((t0$37459===2)&&($37409$37454[0]==="value")))){(v$37487=$37409$37454[1]);(r$37492=((($37495$37507=v$37487)),function(){if((typeof($37495$37507)==="string")){(repl$37521=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$37487=v$37487.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$37529){return $36853(repl$37521,m$37529);}));return (("\""+v$37487)+"\"");}else{if(($37495$37507===(void 0))){return "(void 0)";}else{if($36834(RegExp)($37495$37507)){(it$0$37542=String(v$37487));(it$0$37548=it$0$37542.slice(1,-1));(it$0$37554=it$0$37548.replace(RegExp("/","g"),"\\/"));(it$0$37560=it$0$37554.replace(RegExp("\n","g"),"\\n"));return "/".concat(it$0$37560).concat("/");}else{(bridge$37500$37512=$37495$37507);if(((((bridge$37501$37572=bridge$37500$37512)),((((bridge$37502$37579=bridge$37501$37572)),((typeof(bridge$37502$37579)==="number")||(bridge$37502$37579===true)))||(bridge$37501$37572===false)))||(bridge$37500$37512===null))){return String(v$37487);}else{if(($39347($37495$37507,"::id")&&((id$37588=$37495$37507["::id"]),id$37588))){return it$0$37400.translate(it$0$37400.register_value(v$37487,id$37588),mode$37396);}else{(other$37594=$37495$37507);throw $39041(["cannot_serialize"]).create("Cannot serialize value",({"value":v$37487}));}}}}}}()));return it$0$37400.expr(r$37492,mode$37396);}else{if(($37448$37467&&(($37450$37469=(t0$37459===3))&&(($37451$37470=($37409$37454[0]==="send"))&&(((t1$37460=$37409$37454[1])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&((t1$37460[0]==="variable")&&((t1$37460[1]==="___node")&&(((t3$37462=$37409$37454[2])),((t3$37462 instanceof Array)&&(((t4$37463=t3$37462.length)),((t4$37463===2)&&(t3$37462[0]==="value"))))))))))))))){(f$37599=t3$37462[1]);return f$37599;}else{if(($37451$37470&&(((bridge$37415$37464=$37409$37454[1])),((((bridge$37415$37464 instanceof Array)&&(((t0$37633=bridge$37415$37464.length)),((t0$37633===2)&&((bridge$37415$37464[0]==="symbol")&&(bridge$37415$37464[1]==="___js_fetch")))))||((bridge$37415$37464 instanceof Array)&&(((t0$37640=bridge$37415$37464.length)),((t0$37640===2)&&((bridge$37415$37464[0]==="variable")&&(bridge$37415$37464[1]==="___js_fetch"))))))&&(((t1$37460=$37409$37454[2])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===3)&&(t1$37460[0]==="array"))))))))){(f$37624=t1$37460[1]);(msg$37625=t1$37460[2]);(trf$37660=it$0$37400.translate(f$37624,"expr"));(trmsg$37661=it$0$37400.translate(msg$37625,"expr"));return it$0$37400.expr((((trf$37660+"[")+trmsg$37661)+"]"),mode$37396);}else{if(($37451$37470&&((f$37670=$37409$37454[1]),(((t1$37460=$37409$37454[2])),((msg$37671=t1$37460),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&(t1$37460[0]==="value"))))))))){(s$37672=t1$37460[1]);($37687$37692=null);$37687$37692;if(((typeof(s$37672)==="string")&&s$37672.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$37705=it$0$37400.translate(f$37670,"expr"));(trmsg$37706=it$0$37400.translate(["symbol",s$37672],"expr"));return it$0$37400.expr(((trf$37705+".")+trmsg$37706),mode$37396);}else{(otherwise$37715=$37687$37692);(trf$37720=it$0$37400.translate(f$37670,"expr"));(trmsg$37721=it$0$37400.translate(msg$37671,"expr"));return it$0$37400.expr((((trf$37720+"[")+trmsg$37721)+"]"),mode$37396);}}else{if(($37451$37470&&((f$37730=$37409$37454[1]),(((t1$37460=$37409$37454[2])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461>=1)&&(t1$37460[0]==="array")))))))){(args$37731=Array.prototype.slice.call(t1$37460,1));(op$37747=((($37750$37759=f$37730)),function(){if((($37754$37766=($37750$37759 instanceof Array))&&(((t0$37764=$37750$37759.length)),(($37756$37768=(t0$37764===2))&&($37750$37759[0]==="symbol"))))){(x$37771=$37750$37759[1]);return $36853(js_op_table$36935,x$37771);}else{if(($37756$37768&&($37750$37759[0]==="variable"))){(x$37781=$37750$37759[1]);return $36853(js_op_table2$36934,x$37781);}else{$37750$37759;return null;}}}()));if(op$37747){return it$0$37400.expr(it$0$37400.op(op$37747,args$37731[0],args$37731[1]),mode$37396);}else{(trf$37791=it$0$37400.translate(f$37730,"expr"));(trargs$37792=(((acc$37803=[])),(((temp$37809=args$37731)),((($length$37815=temp$37809.length)),((($index$37821=0)),function(){$37798:for(;($index$37821<$length$37815);($index$37821++)){var x$37838;var m$37830;(m$37830=temp$37809[$index$37821]);(x$37838=m$37830);acc$37803.push(it$0$37400.translate(x$37838,"expr"));}}()))),acc$37803));return it$0$37400.expr((((trf$37791+"(")+trargs$37792.join(","))+")"),mode$37396);}}else{if($37451$37470){(f$37844=$37409$37454[1]);(msg$37845=$37409$37454[2]);(t0$37852=(((code$37860="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37400.register_raw(code$37860,"~send")));if(((t0$37852 instanceof Array)&&(((t1$37853=t0$37852.length)),((t1$37853===2)&&(t0$37852[0]==="symbol"))))){(codevar$37850=t0$37852[1]);}else{$39022((((code$37874="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37400.register_raw(code$37874,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6698,6908);}(trf$37881=it$0$37400.translate(f$37844,"expr"));(trmsg$37882=it$0$37400.translate(msg$37845,"expr"));return it$0$37400.expr((((((codevar$37850+"(")+trf$37881)+",")+trmsg$37882)+")"),mode$37396);}else{if(($37448$37467&&(($37450$37469=(t0$37459>=1))&&($37409$37454[0]==="array")))){(args$37891=Array.prototype.slice.call($37409$37454,1));(r$37896=(((f$37901=function(x$37906){return it$0$37400.translate(x$37906,"expr");})),(("["+args$37891.map(f$37901).join(","))+"]")));return it$0$37400.expr(r$37896,mode$37396);}else{if(($37450$37469&&($37409$37454[0]==="object"))){(args$37912=Array.prototype.slice.call($37409$37454,1));(all_strings$37918=args$37912.every(function($37923$37926){var t0$37934;var t1$37935;var other$37969;var v$37959;var t0$37955;var $37928$37950;var ph$37931;var y$37932;(t0$37934=$37923$37926);if(((t0$37934 instanceof Array)&&(((t1$37935=t0$37934.length)),((t1$37935===3)&&(t0$37934[0]==="array"))))){(ph$37931=t0$37934[1]);(y$37932=t0$37934[2]);}else{$39022($37923$37926);}($37928$37950=ph$37931);if((($37928$37950 instanceof Array)&&(((t0$37955=$37928$37950.length)),((t0$37955===2)&&($37928$37950[0]==="value"))))){(v$37959=$37928$37950[1]);return true;}else{(other$37969=$37928$37950);return false;}}));(r$37919=function(){if(all_strings$37918){(f$37976=function($37980$37983){var t0$37988;var t1$37989;var a$38005;var b$38006;var x$37985;var y$37986;(t0$37988=$37980$37983);if(((t0$37988 instanceof Array)&&(((t1$37989=t0$37988.length)),((t1$37989===3)&&(t0$37988[0]==="array"))))){(x$37985=t0$37988[1]);(y$37986=t0$37988[2]);}else{$39022($37980$37983);}(a$38005=it$0$37400.translate(x$37985,"expr"));(b$38006=it$0$37400.translate(y$37986,"expr"));return ((a$38005+":")+b$38006);});return (("({"+args$37912.map(f$37976).join(","))+"})");}else{(v$38016=gensym$36931());(f$38022=function($38026$38029){var t0$38034;var t1$38035;var a$38051;var b$38052;var x$38031;var y$38032;(t0$38034=$38026$38029);if(((t0$38034 instanceof Array)&&(((t1$38035=t0$38034.length)),((t1$38035===3)&&(t0$38034[0]==="array"))))){(x$38031=t0$38034[1]);(y$38032=t0$38034[2]);}else{$39022($38026$38029);}(a$38051=it$0$37400.translate(x$38031,"expr"));(b$38052=it$0$37400.translate(y$38032,"expr"));return (((((v$38016+"[")+a$38051)+"]=")+b$38052)+";");});return ((((((("(function(){"+"var ")+v$38016)+"={};")+args$37912.map(f$38022).join(""))+";return ")+v$38016)+";}())");}}());return it$0$37400.expr(r$37919,mode$37396);}else{if(($37448$37467&&((t0$37459===3)&&($37409$37454[0]==="lambda")))){(bindings$38063=$37409$37454[1]);(body$38064=$37409$37454[2]);(name$38069=function(){if($36834(RegExp("^[$_a-zA-Z]*$",""))(expr$37395.name)){return (expr$37395.name+" ");}else{return "";}}());(a$38076=(((acc$38091=[])),(((temp$38097=bindings$38063)),((($length$38103=temp$38097.length)),((($index$38109=0)),function(){$38086:for(;($index$38109<$length$38103);($index$38109++)){var x$38126;var m$38118;(m$38118=temp$38097[$index$38109]);(x$38126=m$38118);acc$38091.push(it$0$37400.translate(x$38126,"expr"));}}()))),acc$38091).join(","));(b$38077=it$0$37400.body(body$38064,"return"));return it$0$37400.expr((((((("function"+name$38069)+"(")+a$38076)+"){")+b$38077)+"}"),mode$37396);}else{if(($37448$37467&&(($37450$37469=(t0$37459===4))&&(($37451$37470=($37409$37454[0]==="if"))&&((test$38135=$37409$37454[1]),((pos$38136=$37409$37454[2]),(((t1$37460=$37409$37454[3])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&((t1$37460[0]==="value")&&(t1$37460[1]===(void 0))))))))))))){($38151$38156=mode$37396);if(($38151$38156==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38168=$38151$38156);(a$38173=it$0$37400.translate(test$38135,"expr"));(b$38174=it$0$37400.translate(pos$38136,mode$37396));return (((("if("+a$38173)+"){")+b$38174)+"}");}}else{if($37451$37470){(test$38183=$37409$37454[1]);(pos$38184=$37409$37454[2]);(neg$38185=$37409$37454[3]);($38188$38193=mode$37396);if(($38188$38193==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38205=$38188$38193);(a$38211=it$0$37400.translate(test$38183,"expr"));(b$38212=it$0$37400.translate(pos$38184,mode$37396));(c$38213=it$0$37400.translate(neg$38185,mode$37396));return (((((("if("+a$38211)+"){")+b$38212)+"}else{")+c$38213)+"}");}}else{if(($37448$37467&&(($37450$37469=(t0$37459===3))&&(($37451$37470=($37409$37454[0]==="declare"))&&((binding$38225=$37409$37454[1]),(((t1$37460=$37409$37454[2])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&((t1$37460[0]==="value")&&(t1$37460[1]===(void 0)))))))))))){($38239$38245=mode$37396);(bridge$38241$38250=$38239$38245);if(((bridge$38241$38250==="expr")||(bridge$38241$38250==="return"))){throw "Invalid in expr ctx";}else{(other$38262=$38239$38245);(a$38266=it$0$37400.translate(binding$38225,"expr"));return (("var "+a$38266)+";");}}else{if($37451$37470){(binding$38272=$37409$37454[1]);(value$38273=$37409$37454[2]);($38276$38282=mode$37396);(bridge$38278$38287=$38276$38282);if(((bridge$38278$38287==="expr")||(bridge$38278$38287==="return"))){throw "Invalid in expr ctx";}else{(other$38299=$38276$38282);(a$38304=it$0$37400.translate(binding$38272,"expr"));(b$38305=it$0$37400.translate(value$38273,"expr"));return (((("var "+a$38304)+"=")+b$38305)+";");}}else{if(($37450$37469&&(($37451$37470=($37409$37454[0]==="assign"))&&(((t1$37460=$37409$37454[1])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===3)&&(t1$37460[0]==="send")))))))){(obj$38314=t1$37460[1]);(msg$38315=t1$37460[2]);(rhs$38316=$37409$37454[2]);(a$38333=it$0$37400.translate(obj$38314,"expr"));(b$38334=it$0$37400.translate(msg$38315,"expr"));(c$38335=it$0$37400.translate(rhs$38316,"expr"));return it$0$37400.expr((((((("("+a$38333)+"[")+b$38334)+"]=")+c$38335)+")"),mode$37396);}else{if($37451$37470){(lhs$38347=$37409$37454[1]);(rhs$38348=$37409$37454[2]);(a$38354=it$0$37400.translate(lhs$38347,"expr"));(b$38355=it$0$37400.translate(rhs$38348,"expr"));return it$0$37400.expr((((("("+a$38354)+"=")+b$38355)+")"),mode$37396);}else{if(($37448$37467&&((t0$37459===1)&&($37409$37454[0]==="multi")))){return "";}else{if(($37448$37467&&(($37450$37469=(t0$37459>=1))&&($37409$37454[0]==="multi")))){(args$38368=Array.prototype.slice.call($37409$37454,1));(isdecl$38378=function($38382$38385){var other$38416;var variable$38405;var value$38406;var t0$38401;var $38387$38396;var ph$38390;(ph$38390=$38382$38385);($38387$38396=ph$38390);if((($38387$38396 instanceof Array)&&(((t0$38401=$38387$38396.length)),((t0$38401===3)&&($38387$38396[0]==="declare"))))){(variable$38405=$38387$38396[1]);(value$38406=$38387$38396[2]);return true;}else{(other$38416=$38387$38396);return false;}});($38373$38421=null);$38373$38421;if((args$38368.length===1)){return it$0$37400.translate(args$38368[0],mode$37396);}else{if(((mode$37396==="expr")&&(!args$38368.some(isdecl$38378)))){(xs$38439=(((acc$38447=[])),(((temp$38453=args$38368)),((($length$38459=temp$38453.length)),((($index$38465=0)),function(){$38442:for(;($index$38465<$length$38459);($index$38465++)){var x$38482;var m$38474;(m$38474=temp$38453[$index$38465]);(x$38482=m$38474);acc$38447.push(it$0$37400.translate(x$38482,"expr"));}}()))),acc$38447));(xs$38439=(((acc$38493=[])),(((temp$38499=xs$38439)),((($length$38505=temp$38499.length)),((($index$38511=0)),function(){$38488:for(;($index$38511<$length$38505);($index$38511++)){var x$38528;var m$38520;(m$38520=temp$38499[$index$38511]);(x$38528=m$38520);if((x$38528!=="")){acc$38493.push(x$38528);}else{false;}}}()))),acc$38493));return (("("+xs$38439.join(","))+")");}else{return it$0$37400.body(expr$37395,mode$37396);}}}else{if(($37450$37469&&($37409$37454[0]==="splice"))){(args$38539=Array.prototype.slice.call($37409$37454,1));return it$0$37400.translate(["multi"].concat(args$38539),mode$37396);}else{if(($37448$37467&&((t0$37459===2)&&($37409$37454[0]==="variable")))){(s$38544=$37409$37454[1]);return it$0$37400.expr(it$0$37400.mangle(s$38544),mode$37396);}else{if(($37448$37467&&((t0$37459===3)&&($37409$37454[0]==="scope")))){(vars$38549=$37409$37454[1]);(body$38550=$37409$37454[2]);(decls$38555=(((acc$38563=[])),(((temp$38569=vars$38549)),((($length$38575=temp$38569.length)),((($index$38581=0)),function(){$38558:for(;($index$38581<$length$38575);($index$38581++)){var v$38598;var m$38590;(m$38590=temp$38569[$index$38581]);(v$38598=m$38590);acc$38563.push(["declare",v$38598,["value",(void 0)]]);}}()))),acc$38563));return it$0$37400.translate(["multi"].concat(decls$38555).concat([body$38550]),mode$37396);}else{if(($37448$37467&&((t0$37459>=1)&&($37409$37454[0]==="object2")))){(args$38604=Array.prototype.slice.call($37409$37454,1));(r$38609=(((f$38614=function($38618$38621){var t0$38626;var t1$38627;var a$38643;var b$38644;var x$38623;var y$38624;(t0$38626=$38618$38621);if(((t0$38626 instanceof Array)&&(((t1$38627=t0$38626.length)),(t1$38627===2)))){(x$38623=t0$38626[0]);(y$38624=t0$38626[1]);}else{$39022($38618$38621);}(a$38643=it$0$37400.translate(x$38623,"expr"));(b$38644=it$0$37400.translate(y$38624,"expr"));return ((a$38643+":")+b$38644);})),(("({"+args$38604.map(f$38614).join(","))+"})")));return it$0$37400.expr(r$38609,mode$37396);}else{if(($37448$37467&&((t0$37459===2)&&($37409$37454[0]==="js_new")))){(value$38655=$37409$37454[1]);return it$0$37400.expr((("(new "+it$0$37400.translate(value$38655,"expr"))+")"),mode$37396);}else{if(($37448$37467&&(($37450$37469=((t0$37459>=1)&&(t0$37459<=2)))&&(($37409$37454[0]==="js_break")&&(((t1$37460=function(){if((1>=t0$37459)){return ["value",null];}else{return $37409$37454[1];}}())),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&(t1$37460[0]==="value"))))))))){(label$38660=t1$37460[1]);if((mode$37396==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$38660){return (" "+label$38660);}else{return "";}}())+";");}}else{if(($37450$37469&&(($37409$37454[0]==="js_continue")&&(((t1$37460=function(){if((1>=t0$37459)){return ["value",null];}else{return $37409$37454[1];}}())),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&(t1$37460[0]==="value")))))))){(label$38675=t1$37460[1]);if((mode$37396==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$38675){return (" "+label$38675);}else{return "";}}())+";");}}else{if(($37448$37467&&(($37450$37469=(t0$37459===2))&&($37409$37454[0]==="js_return")))){(value$38690=$37409$37454[1]);if((mode$37396==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$37400.translate(value$38690,"expr"))+";");}}else{if(($37450$37469&&($37409$37454[0]==="js_delete"))){(value$38695=$37409$37454[1]);if((mode$37396==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$37400.translate(value$38695,"expr"))+";");}}else{if(($37450$37469&&($37409$37454[0]==="js_throw"))){(value$38700=$37409$37454[1]);if((mode$37396==="expr")){return (("function(){throw "+it$0$37400.translate(value$38700,"expr"))+";}()");}else{return (("throw "+it$0$37400.translate(value$38700,"expr"))+";");}}else{if(($37448$37467&&(($37450$37469=(t0$37459===3))&&(($37409$37454[0]==="js_label")&&(((t1$37460=$37409$37454[1])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===2)&&(t1$37460[0]==="value"))))))))){(label$38705=t1$37460[1]);(body$38706=$37409$37454[2]);($38719$38724=mode$37396);if(($38719$38724==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38736=$38719$38724);return ((label$38705+":")+it$0$37400.translate(body$38706,other$38736));}}else{if(($37450$37469&&($37409$37454[0]==="js_while"))){(test$38740=$37409$37454[1]);(body$38741=$37409$37454[2]);($38744$38749=mode$37396);if(($38744$38749==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38761=$38744$38749);(a$38766=it$0$37400.translate(test$38740,"expr"));(b$38767=it$0$37400.translate(body$38741,"stmt"));return (((("while("+a$38766)+"){")+b$38767)+"}");}}else{if(($37448$37467&&((t0$37459===5)&&($37409$37454[0]==="js_for")))){(x$38776=$37409$37454[1]);(y$38777=$37409$37454[2]);(z$38778=$37409$37454[3]);(body$38779=$37409$37454[4]);($38782$38787=mode$37396);if(($38782$38787==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38799=$38782$38787);(a$38806=it$0$37400.translate(x$38776,"expr"));(b$38807=it$0$37400.translate(y$38777,"expr"));(c$38808=it$0$37400.translate(z$38778,"expr"));(d$38809=it$0$37400.translate(body$38779,"stmt"));return (((((((("for("+a$38806)+";")+b$38807)+";")+c$38808)+"){")+d$38809)+"}");}}else{if(($37448$37467&&(($37450$37469=(t0$37459===4))&&($37409$37454[0]==="js_for_in")))){(x$38824=$37409$37454[1]);(y$38825=$37409$37454[2]);(body$38826=$37409$37454[3]);($38829$38834=mode$37396);if(($38829$38834==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38846=$38829$38834);(a$38852=it$0$37400.translate(x$38824,"expr"));(b$38853=it$0$37400.translate(y$38825,"expr"));(c$38854=it$0$37400.translate(body$38826,"stmt"));return (((((("for("+a$38852)+" in ")+b$38853)+"){")+c$38854)+"}");}}else{if(($37450$37469&&(($37409$37454[0]==="js_try")&&((attempt$38866=$37409$37454[1]),(((t1$37460=$37409$37454[2])),((t1$37460 instanceof Array)&&(((t2$37461=t1$37460.length)),((t2$37461===3)&&((t1$37460[0]==="lambda")&&(((t3$37462=t1$37460[1])),((t3$37462 instanceof Array)&&(((t4$37463=t3$37462.length)),((t4$37463===1)&&(((bridge$37445$37465=t3$37462[0])),(((bridge$37445$37465 instanceof Array)&&(((t0$38898=bridge$37445$37465.length)),((t0$38898===2)&&((bridge$37445$37465[0]==="symbol")&&((v$38867=bridge$37445$37465[1]),true)))))||((bridge$37445$37465 instanceof Array)&&(((t0$38906=bridge$37445$37465.length)),((t0$38906===2)&&((bridge$37445$37465[0]==="variable")&&((v$38867=bridge$37445$37465[1]),true)))))))))))))))))))){(body$38868=t1$37460[2]);(finally$38869=$37409$37454[3]);(r$38919=((($38922$38927=mode$37396)),function(){if(($38922$38927==="expr")){return it$0$37400.body(expr$37395,"expr");}else{(other$38939=$38922$38927);(a$38944=it$0$37400.translate(attempt$38866,"stmt"));(b$38945=it$0$37400.translate(body$38868,"stmt"));return (((((("try{"+a$38944)+"}catch(")+v$38867)+"){")+b$38945)+"}");}}()));($38916$38955=finally$38869);if((($38916$38955 instanceof Array)&&(((t0$38960=$38916$38955.length)),((t0$38960===1)&&($38916$38955[0]==="void"))))){return r$38919;}else{(other$38973=$38916$38955);return (((r$38919+"finally{")+it$0$37400.translate(other$38973,"stmt"))+"}");}}else{if(($37448$37467&&((t0$37459===2)&&($37409$37454[0]==="raw")))){(x$38977=$37409$37454[1]);return x$38977;}else{(other$38982=$37409$37454);throw other$38982;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$36854(Translator$36936,$36854(((accum$38987=({})),((accum$38987["::name"]="Translator"),accum$38987)),((accum$38991=({})),((accum$38991["::egclass"]=true),accum$38991))));Translator$36936;(translate$36937=function(expr$38998,mode$38999){var tr$39004;var t$39005;(tr$39004=Translator$36936());(t$39005=tr$39004.translate(expr$38998,mode$38999));return (tr$39004.dump_store()+t$39005);});(exports["Translator"]=Translator$36936);(exports["translate"]=translate$36937);
