var $29972=function(type$29974){var f$29977;(f$29977=type$29974["::check"]);if((f$29977===(void 0))){return function(value$29982){return (value$29982 instanceof type$29974);};}else{return function(value$29985){return f$29977.call(type$29974,value$29985);};}};
var $29987=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $29988=function(dest$29990,values$29991){var k$29996;(k$29996=null);$29994:for(k$29996 in values$29991){if(values$29991.hasOwnProperty(k$29996)){(dest$29990[k$29996]=values$29991[k$29996]);}}return dest$29990;};
var $30003=function($30004$30006){var ph$30010;(ph$30010=$30004$30006);var $30008$30015;($30008$30015=ph$30010);var bridge$30009$30020;var x$30024;(bridge$30009$30020=$30008$30015);if((((typeof(bridge$30009$30020)==="string")&&((x$30024=bridge$30009$30020),true))||((typeof(bridge$30009$30020)==="number")&&((x$30024=bridge$30009$30020),true)))){return ["value",x$30024];}else{var other$30034;(other$30034=$30008$30015);return other$30034["::serialize_ast"]();}};
var send$29779;(send$29779=function(obj$29784,$29782$29785){var ph$29789;var msg$29790;var t0$29792;(t0$29792=$29782$29785);(msg$29790=t0$29792);(ph$29789=t0$29792);var $29787$29799;($29787$29799=ph$29789);var bridge$29788$29804;(bridge$29788$29804=$29787$29799);if(((typeof(bridge$29788$29804)==="string")||(typeof(bridge$29788$29804)==="number"))){return obj$29784[msg$29790];}else{var other$29815;(other$29815=$29787$29799);return obj$29784["::send"](msg$29790);}});(Array[":::project"]=function($29820$29822){var ph$29825;var value$29826;var t0$29828;(t0$29828=$29820$29822);(value$29826=t0$29828);(ph$29825=t0$29828);var $29824$29835;($29824$29835=ph$29825);if($29972(Array)($29824$29835)){return [true,value$29826];}else{$29824$29835;return [true,[value$29826]];}});(Array.prototype["::check"]=function(value$29852){if((value$29852 instanceof Array)){var i$29857;(i$29857=0);$29855:for(;(i$29857<this.length);(i$29857++)){if(($29987(this,i$29857)!==$29987(value$29852,i$29857))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $29988(this.slice(0),this);});(Array.prototype[":::project"]=function(value$29874){if((value$29874 instanceof Array)){var i$29879;(i$29879=0);$29877:for(;(i$29879<this.length);(i$29879++)){if(($29987(this,i$29879)!==$29987(value$29874,i$29879))){return [true,[value$29874]];}}return [true,value$29874.slice(this.length)];}else{return [true,[value$29874]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($30003));});(RegExp.prototype["::check"]=function($29895$29897){var ph$29900;(ph$29900=$29895$29897);var $29899$29905;($29899$29905=ph$29900);var value$29913;if((typeof($29899$29905)==="string")){(value$29913=$29899$29905);if(value$29913.match(this)){return true;}else{return false;}}else{var other$29918;(other$29918=$29899$29905);return false;}});(RegExp.prototype[":::project"]=function($29923$29925){var ph$29928;(ph$29928=$29923$29925);var $29927$29933;($29927$29933=ph$29928);var value$29941;if((typeof($29927$29933)==="string")){(value$29941=$29927$29933);var $29944$29946;($29944$29946=value$29941.match(this));var m$29954;if(($29944$29946===null)){(m$29954=$29944$29946);return [false,null];}else{var m$29959;(m$29959=$29944$29946);return [true,m$29959];}}else{var other$29963;(other$29963=$29927$29933);return [false,null];}});(Function.prototype["::send"]=function(args$29969){return this.apply(this,args$29969);});
var $31998=function(arr$32000){var results$32004;var l$32005;(results$32004=[]);(l$32005=arr$32000.length);var i$32013;(i$32013=0);$32003:for(;(i$32013<l$32005);(i$32013++)){results$32004.push([i$32013,$29987(arr$32000,i$32013)]);}return results$32004;};
var $31802=function(){var $31803$31805;($31803$31805=function(tags$31809){var it$0$31812;(it$0$31812=function(){if((!$29972($31803$31805)(this))){return Object.create($31803$31805.prototype);}else{return this;}}());(it$0$31812["tags"]=tags$31809);return it$0$31812;});($31803$31805.prototype["create"]=function(){var $31824$31826;($31824$31826=arguments);var t0$31831;var message$31835;var args$31836;(t0$31831=$31824$31826.length);if((t0$31831>=0)){(message$31835=function(){if((0>=t0$31831)){return "";}else{return $31824$31826[0];}}());(args$31836=Array.prototype.slice.call($31824$31826,1));var it$0$31843;(it$0$31843=this);var self$31848;(self$31848=this);var e$31853;(e$31853=Error(message$31835));(e$31853["::tags"]=it$0$31843.tags);(e$31853["args"]=args$31836);var temp$31867;(temp$31867=$31998(args$31836));var $length$31872;($length$31872=temp$31867.length);var $index$31877;($index$31877=0);$31854:for(;($index$31877<$length$31872);($index$31877++)){var m$31885;(m$31885=temp$31867[$index$31877]);var t0$31890;var t1$31891;var i$31895;var arg$31896;(t0$31890=m$31885);if(((t0$31890 instanceof Array)&&(((t1$31891=t0$31890.length)),(t1$31891===2)))){(i$31895=t0$31890[0]);(arg$31896=t0$31890[1]);(e$31853[i$31895]=arg$31896);}else{$31786(m$31885);}}(e$31853["length"]=args$31836.length);(e$31853["name"]=["E"].concat(it$0$31843.tags).join("."));return e$31853;}else{$31786($31824$31826);}});($31803$31805.prototype["::check"]=function(e$31922){var it$0$31925;(it$0$31925=this);var self$31930;(self$31930=this);var tags$31935;if(((!e$31922)||(!$29972(Error)(e$31922)))){return false;}(tags$31935=(e$31922["::tags"]||[]));var temp$31944;(temp$31944=it$0$31925.tags);var $length$31949;($length$31949=temp$31944.length);var $index$31954;($index$31954=0);$31936:for(;($index$31954<$length$31949);($index$31954++)){var m$31962;(m$31962=temp$31944[$index$31954]);var tag$31970;(tag$31970=m$31962);if((tags$31935.indexOf(tag$31970)===-1)){return false;}else{false;}}return true;});($31803$31805.prototype["::deconstruct"]=function(e$31978){var it$0$31981;(it$0$31981=this);var self$31986;(self$31986=this);return e$31978.args;});$29988($31803$31805,$29988(function(){var accum$31991;(accum$31991=({}));(accum$31991["::name"]="$31803");return accum$31991;}(),function(){var accum$31995;(accum$31995=({}));(accum$31995["::egclass"]=true);return accum$31995;}()));return $31803$31805;}();
var $31786=function(value$31788,url$31789,start$31790,end$31791){var err$31794;(err$31794=$31802(["match"]).create("Could not find a match for value",({"value":value$31788})));if(url$31789){(err$31794["location"]=["location",url$31789,start$31790,end$31791]);}throw err$31794;};
var $32020=function(type$32022){return function(value$32025){var f$32028;(f$32028=type$32022[":::project"]);if((f$32028===(void 0))){(f$32028=type$32022["::project"]);if((f$32028===(void 0))){return [true,type$32022(value$32025)];}else{var rval$32037;(rval$32037=false);try{(rval$32037=[true,f$32028(value$32025)]);}catch(excv$32046){var e$32052;(e$32052=excv$32046);(rval$32037=[false,null]);}return rval$32037;}}else{return f$32028.call(type$32022,value$32025);}};};
var $32057=function($32058$32060,key$32061){var ph$32065;(ph$32065=$32058$32060);var $32063$32070;($32063$32070=ph$32065);var bridge$32064$32075;(bridge$32064$32075=$32063$32070);if(((bridge$32064$32075===null)||(bridge$32064$32075===(void 0)))){return false;}else{var x$32086;if((typeof($32063$32070)==="string")){(x$32086=$32063$32070);return (key$32061 in String.prototype);}else{var x$32091;if((typeof($32063$32070)==="number")){(x$32091=$32063$32070);return (key$32061 in Number.prototype);}else{var x$32096;(x$32096=$32063$32070);return (key$32061 in x$32096);}}}};var accum$31756;var accum$31760;var $30038$30040;var gensym$30041;var $30039$30042;var __lt____gt__$30043;var js_op_table2$30044;var js_op_table$30045;var Translator$30046;var translate$30047;($30038$30040=require("./util"));(gensym$30041=$30038$30040.gensym);($30039$30042=require("./pp"));(__lt____gt__$30043=$30039$30042["<>"]);(js_op_table2$30044=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$30045=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$30046=function(){var it$0$30087;var prelude$30080;var t0$30076;var $30069$30071;($30069$30071=arguments);(t0$30076=$30069$30071.length);if(((t0$30076>=0)&&(t0$30076<=1))){(prelude$30080=function(){if((0>=t0$30076)){return null;}else{return $30069$30071[0];}}());(it$0$30087=function(){if((!$29972(Translator$30046)(this))){return Object.create(Translator$30046.prototype);}else{return this;}}());(it$0$30087["cache"]=({}));(it$0$30087["prepend"]=[]);if(prelude$30080){it$0$30087.prepend.push(it$0$30087.translate($30003(prelude$30080),"stmt"));}return it$0$30087;}else{$31786($30069$30071);}});(Translator$30046.prototype["register_value"]=function(v$30106,id$30107){var temp$30132;var name$30141;var $30115$30121;var self$30116;var it$0$30110;(it$0$30110=this);(self$30116=this);($30115$30121=$29987(it$0$30110.cache,id$30107));if(($30115$30121===(void 0))){(temp$30132=["symbol",gensym$30041()]);(it$0$30110.cache[id$30107]=temp$30132);it$0$30110.prepend.push(it$0$30110.translate(["declare",temp$30132,$30003(v$30106)],"stmt"));return temp$30132;}else{(name$30141=$30115$30121);return name$30141;}});(Translator$30046.prototype["register_raw"]=function(raw$30146,id$30147){var temp$30172;var name$30181;var $30155$30161;var self$30156;var it$0$30150;(it$0$30150=this);(self$30156=this);($30155$30161=$29987(it$0$30150.cache,id$30147));if(($30155$30161===(void 0))){(temp$30172=["symbol",gensym$30041()]);(it$0$30150.cache[id$30147]=temp$30172);it$0$30150.prepend.push(it$0$30150.translate(["declare",temp$30172,["raw",raw$30146]],"stmt"));return temp$30172;}else{(name$30181=$30155$30161);return name$30181;}});(Translator$30046.prototype["dump_store"]=function(){var rval$30198;var self$30193;var it$0$30188;(it$0$30188=this);(self$30193=this);(rval$30198=it$0$30188.prepend.join("\n"));(it$0$30188["prepend"]=[]);return rval$30198;});(Translator$30046.prototype["mangle"]=function(name$30208){var i$30231;var tr$30222;var r$30223;var self$30216;var it$0$30211;(it$0$30211=this);(self$30216=this);(tr$30222=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$30223=[]);(i$30231=0);$30221:for(;(i$30231<name$30208.length);(++i$30231)){var c$30239;(c$30239=$29987(name$30208,i$30231));r$30223.push(($29987(tr$30222,c$30239)||c$30239));}return r$30223.join("");});(Translator$30046.prototype["body"]=function(orig$30246,mode$30247){var t0$30264;var t1$30265;var t2$30266;var x$30299;var stmts$30308;var ret$30309;var other$30322;var $30260$30288;var b$30261;var trst$30262;var self$30255;var it$0$30250;(it$0$30250=this);(self$30255=this);(t0$30264=$32020(["multi"])(orig$30246));if((t0$30264[0]&&(((t1$30265=t0$30264[1])),(((t2$30266=t1$30265.length)),(t2$30266>=0))))){(b$30261=Array.prototype.slice.call(t1$30265,0));}else{$31786(orig$30246,"/home/olivier/git/earl-grey/src/translate-js.eg",3071,3075);}(trst$30262=function(stmt$30284){return it$0$30250.translate(stmt$30284,"stmt");});($30260$30288=mode$30247);if(($30260$30288==="expr")){(x$30299=["send",["lambda",[],orig$30246],["array"]]);return it$0$30250.translate(x$30299,mode$30247);}else{if(($30260$30288==="return")){(stmts$30308=b$30261.slice(0,-1));(ret$30309=$29987(b$30261,(b$30261.length-1)));return (stmts$30308.map(trst$30262).join("")+it$0$30250.translate(ret$30309,"return"));}else{if(($30260$30288==="stmt")){return b$30261.map(trst$30262).join("");}else{(other$30322=$30260$30288);throw $31802(["syntax","mode"]).create("Unknown mode",({"mode":mode$30247}));}}}});(Translator$30046.prototype["expr"]=function(x$30327,mode$30328){var other$30362;var $30336$30342;var self$30337;var it$0$30331;(it$0$30331=this);(self$30337=this);($30336$30342=mode$30328);if(($30336$30342==="expr")){return x$30327;}else{if(($30336$30342==="stmt")){return (x$30327+";");}else{if(($30336$30342==="return")){return (("return "+x$30327)+";");}else{(other$30362=$30336$30342);throw "OopsI";}}}});(Translator$30046.prototype["op"]=function(op$30367,a$30368,b$30369){var $30386$30399;var $30387$30400;var $30388$30401;var t0$30395;var t1$30396;var t2$30397;var $30385$30390;var e$30382;var self$30377;var it$0$30372;(it$0$30372=this);(self$30377=this);(e$30382=((($30385$30390=[a$30368,b$30369])),function(){if((($30386$30399=($30385$30390 instanceof Array))&&(((t0$30395=$30385$30390.length)),(($30388$30401=(t0$30395===2))&&(((t1$30396=$30385$30390[0])),((t1$30396 instanceof Array)&&(((t2$30397=t1$30396.length)),((t2$30397===1)&&(t1$30396[0]==="void"))))))))){$30385$30390[1];return (op$30367+it$0$30372.translate(b$30369,"expr"));}else{if(($30388$30401&&($30385$30390[0],(((t1$30396=$30385$30390[1])),((t1$30396 instanceof Array)&&(((t2$30397=t1$30396.length)),((t2$30397===1)&&(t1$30396[0]==="void")))))))){return (it$0$30372.translate(a$30368,"expr")+op$30367);}else{$30385$30390;return ((it$0$30372.translate(a$30368,"expr")+op$30367)+it$0$30372.translate(b$30369,"expr"));}}}()));return (("("+e$30382)+")");});(Translator$30046.prototype["translate"]=function(expr$30438,mode$30439){var repl$30517;var it$0$30551;var it$0$30546;var it$0$30541;var it$0$30536;var bridge$30503$30568;var bridge$30502$30562;var other$30582;var id$30576;var bridge$30501$30510;var $30500$30505;var r$30497;var t0$30616;var t0$30622;var trf$30637;var trmsg$30638;var trf$30675;var trmsg$30676;var trf$30688;var trmsg$30689;var otherwise$30685;var $30662$30664;var x$30741;var x$30732;var $30716$30727;var $30717$30728;var $30718$30729;var t0$30725;var $30715$30720;var $index$30774;var $length$30769;var temp$30764;var acc$30759;var trf$30749;var trargs$30750;var op$30712;var code$30809;var code$30821;var t0$30803;var t1$30804;var trf$30826;var trmsg$30827;var codevar$30801;var f$30844;var r$30840;var f$30907;var f$30945;var v$30940;var all_strings$30858;var r$30859;var $index$31016;var $length$31011;var temp$31006;var acc$31001;var a$30990;var b$30991;var name$30985;var a$31072;var b$31073;var other$31069;var $31055$31057;var a$31104;var b$31105;var c$31106;var other$31101;var $31087$31089;var a$31152;var other$31149;var bridge$31131$31138;var $31130$31133;var a$31184;var b$31185;var other$31181;var bridge$31163$31170;var $31162$31165;var a$31208;var b$31209;var c$31210;var a$31227;var b$31228;var $index$31320;var $length$31315;var temp$31310;var acc$31305;var $index$31360;var $length$31355;var temp$31350;var acc$31345;var xs$31299;var $31246$31289;var $31245$31283;var isdecl$31247;var $index$31423;var $length$31418;var temp$31413;var acc$31408;var decls$31402;var f$31453;var r$31449;var other$31560;var $31546$31548;var a$31585;var b$31586;var other$31582;var $31568$31570;var a$31618;var b$31619;var c$31620;var d$31621;var other$31615;var $31601$31603;var a$31658;var b$31659;var c$31660;var other$31655;var $31641$31643;var t0$31698;var t0$31705;var a$31738;var b$31739;var other$31735;var $31721$31723;var other$31753;var x$31748;var attempt$31672;var v$31673;var body$31674;var x$31636;var y$31637;var body$31638;var x$31595;var y$31596;var z$31597;var body$31598;var test$31564;var body$31565;var label$31534;var body$31535;var value$31529;var value$31524;var value$31519;var label$31506;var label$31493;var value$31488;var args$31445;var vars$31397;var body$31398;var s$31392;var args$31387;var args$31241;var lhs$31222;var rhs$31223;var obj$31194;var msg$31195;var rhs$31196;var binding$31158;var value$31159;var binding$31118;var test$31082;var pos$31083;var neg$31084;var test$31041;var pos$31042;var bindings$30980;var body$30981;var args$30854;var args$30836;var f$30796;var msg$30797;var f$30698;var args$30699;var f$30647;var msg$30648;var s$30649;var f$30608;var msg$30609;var f$30587;var v$30493;var s$30480;var $30450$30474;var $30451$30475;var $30452$30476;var $30453$30477;var t0$30464;var t1$30465;var t2$30466;var t3$30467;var t4$30468;var bridge$30448$30469;var bridge$30449$30470;var t5$30471;var t6$30472;var $30447$30459;var self$30454;var it$0$30442;(it$0$30442=this);(self$30454=this);($30447$30459=expr$30438);if((($30450$30474=($30447$30459 instanceof Array))&&(((t0$30464=$30447$30459.length)),((t0$30464===2)&&($30447$30459[0]==="symbol"))))){(s$30480=$30447$30459[1]);return it$0$30442.expr(it$0$30442.mangle(s$30480),mode$30439);}else{if(($30450$30474&&((t0$30464===1)&&($30447$30459[0]==="void")))){return it$0$30442.expr("null",mode$30439);}else{if(($30450$30474&&((t0$30464===2)&&($30447$30459[0]==="value")))){(v$30493=$30447$30459[1]);(r$30497=((($30500$30505=v$30493)),function(){if((typeof($30500$30505)==="string")){(repl$30517=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$30493=v$30493.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$30524){return $29987(repl$30517,m$30524);}));return (("\""+v$30493)+"\"");}else{if(($30500$30505===(void 0))){return "(void 0)";}else{if($29972(RegExp)($30500$30505)){(it$0$30536=String(v$30493));(it$0$30541=it$0$30536.slice(1,-1));(it$0$30546=it$0$30541.replace(RegExp("/","g"),"\\/"));(it$0$30551=it$0$30546.replace(RegExp("\n","g"),"\\n"));return "/".concat(it$0$30551).concat("/");}else{(bridge$30501$30510=$30500$30505);if(((((bridge$30502$30562=bridge$30501$30510)),((((bridge$30503$30568=bridge$30502$30562)),((typeof(bridge$30503$30568)==="number")||(bridge$30503$30568===true)))||(bridge$30502$30562===false)))||(bridge$30501$30510===null))){return String(v$30493);}else{if(($32057($30500$30505,"::id")&&((id$30576=$30500$30505["::id"]),id$30576))){return it$0$30442.translate(it$0$30442.register_value(v$30493,id$30576),mode$30439);}else{(other$30582=$30500$30505);throw $31802(["cannot_serialize"]).create("Cannot serialize value",({"value":v$30493}));}}}}}}()));return it$0$30442.expr(r$30497,mode$30439);}else{if(($30450$30474&&(($30452$30476=(t0$30464===3))&&(($30453$30477=($30447$30459[0]==="send"))&&(((t1$30465=$30447$30459[1])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&((t1$30465[0]==="variable")&&((t1$30465[1]==="___node")&&(((t3$30467=$30447$30459[2])),((t3$30467 instanceof Array)&&(((t4$30468=t3$30467.length)),((t4$30468===2)&&(t3$30467[0]==="value"))))))))))))))){(f$30587=t3$30467[1]);return f$30587;}else{if(($30453$30477&&(((bridge$30448$30469=$30447$30459[1])),((((bridge$30448$30469 instanceof Array)&&(((t0$30616=bridge$30448$30469.length)),((t0$30616===2)&&((bridge$30448$30469[0]==="symbol")&&(bridge$30448$30469[1]==="___js_fetch")))))||((bridge$30448$30469 instanceof Array)&&(((t0$30622=bridge$30448$30469.length)),((t0$30622===2)&&((bridge$30448$30469[0]==="variable")&&(bridge$30448$30469[1]==="___js_fetch"))))))&&(((t1$30465=$30447$30459[2])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===3)&&(t1$30465[0]==="array"))))))))){(f$30608=t1$30465[1]);(msg$30609=t1$30465[2]);(trf$30637=it$0$30442.translate(f$30608,"expr"));(trmsg$30638=it$0$30442.translate(msg$30609,"expr"));return it$0$30442.expr((((trf$30637+"[")+trmsg$30638)+"]"),mode$30439);}else{if(($30453$30477&&((f$30647=$30447$30459[1]),(((t1$30465=$30447$30459[2])),((msg$30648=t1$30465),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&(t1$30465[0]==="value"))))))))){(s$30649=t1$30465[1]);($30662$30664=null);$30662$30664;if(((typeof(s$30649)==="string")&&s$30649.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$30675=it$0$30442.translate(f$30647,"expr"));(trmsg$30676=it$0$30442.translate(["symbol",s$30649],"expr"));return it$0$30442.expr(((trf$30675+".")+trmsg$30676),mode$30439);}else{(otherwise$30685=$30662$30664);(trf$30688=it$0$30442.translate(f$30647,"expr"));(trmsg$30689=it$0$30442.translate(msg$30648,"expr"));return it$0$30442.expr((((trf$30688+"[")+trmsg$30689)+"]"),mode$30439);}}else{if(($30453$30477&&((f$30698=$30447$30459[1]),(((t1$30465=$30447$30459[2])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466>=1)&&(t1$30465[0]==="array")))))))){(args$30699=Array.prototype.slice.call(t1$30465,1));(op$30712=((($30715$30720=f$30698)),function(){if((($30716$30727=($30715$30720 instanceof Array))&&(((t0$30725=$30715$30720.length)),(($30718$30729=(t0$30725===2))&&($30715$30720[0]==="symbol"))))){(x$30732=$30715$30720[1]);return $29987(js_op_table$30045,x$30732);}else{if(($30718$30729&&($30715$30720[0]==="variable"))){(x$30741=$30715$30720[1]);return $29987(js_op_table2$30044,x$30741);}else{$30715$30720;return null;}}}()));if(op$30712){return it$0$30442.expr(it$0$30442.op(op$30712,args$30699[0],args$30699[1]),mode$30439);}else{(trf$30749=it$0$30442.translate(f$30698,"expr"));(trargs$30750=(((acc$30759=[])),(((temp$30764=args$30699)),((($length$30769=temp$30764.length)),((($index$30774=0)),function(){$30756:for(;($index$30774<$length$30769);($index$30774++)){var x$30790;var m$30782;(m$30782=temp$30764[$index$30774]);(x$30790=m$30782);acc$30759.push(it$0$30442.translate(x$30790,"expr"));}}()))),acc$30759));return it$0$30442.expr((((trf$30749+"(")+trargs$30750.join(","))+")"),mode$30439);}}else{if($30453$30477){(f$30796=$30447$30459[1]);(msg$30797=$30447$30459[2]);(t0$30803=(((code$30809="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$30442.register_raw(code$30809,"~send")));if(((t0$30803 instanceof Array)&&(((t1$30804=t0$30803.length)),((t1$30804===2)&&(t0$30803[0]==="symbol"))))){(codevar$30801=t0$30803[1]);}else{$31786((((code$30821="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$30442.register_raw(code$30821,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6694,6904);}(trf$30826=it$0$30442.translate(f$30796,"expr"));(trmsg$30827=it$0$30442.translate(msg$30797,"expr"));return it$0$30442.expr((((((codevar$30801+"(")+trf$30826)+",")+trmsg$30827)+")"),mode$30439);}else{if(($30450$30474&&(($30452$30476=(t0$30464>=1))&&($30447$30459[0]==="array")))){(args$30836=Array.prototype.slice.call($30447$30459,1));(r$30840=(((f$30844=function(x$30848){return it$0$30442.translate(x$30848,"expr");})),(("["+args$30836.map(f$30844).join(","))+"]")));return it$0$30442.expr(r$30840,mode$30439);}else{if(($30452$30476&&($30447$30459[0]==="object"))){(args$30854=Array.prototype.slice.call($30447$30459,1));(all_strings$30858=args$30854.every(function($30862$30864){var t0$30870;var t1$30871;var other$30901;var v$30892;var t0$30888;var $30866$30883;var ph$30867;var y$30868;(t0$30870=$30862$30864);if(((t0$30870 instanceof Array)&&(((t1$30871=t0$30870.length)),((t1$30871===3)&&(t0$30870[0]==="array"))))){(ph$30867=t0$30870[1]);(y$30868=t0$30870[2]);}else{$31786($30862$30864);}($30866$30883=ph$30867);if((($30866$30883 instanceof Array)&&(((t0$30888=$30866$30883.length)),((t0$30888===2)&&($30866$30883[0]==="value"))))){(v$30892=$30866$30883[1]);return true;}else{(other$30901=$30866$30883);return false;}}));(r$30859=function(){if(all_strings$30858){(f$30907=function($30910$30912){var t0$30917;var t1$30918;var a$30930;var b$30931;var x$30914;var y$30915;(t0$30917=$30910$30912);if(((t0$30917 instanceof Array)&&(((t1$30918=t0$30917.length)),((t1$30918===3)&&(t0$30917[0]==="array"))))){(x$30914=t0$30917[1]);(y$30915=t0$30917[2]);}else{$31786($30910$30912);}(a$30930=it$0$30442.translate(x$30914,"expr"));(b$30931=it$0$30442.translate(y$30915,"expr"));return ((a$30930+":")+b$30931);});return (("({"+args$30854.map(f$30907).join(","))+"})");}else{(v$30940=gensym$30041());(f$30945=function($30948$30950){var t0$30955;var t1$30956;var a$30968;var b$30969;var x$30952;var y$30953;(t0$30955=$30948$30950);if(((t0$30955 instanceof Array)&&(((t1$30956=t0$30955.length)),((t1$30956===3)&&(t0$30955[0]==="array"))))){(x$30952=t0$30955[1]);(y$30953=t0$30955[2]);}else{$31786($30948$30950);}(a$30968=it$0$30442.translate(x$30952,"expr"));(b$30969=it$0$30442.translate(y$30953,"expr"));return (((((v$30940+"[")+a$30968)+"]=")+b$30969)+";");});return ((((((("(function(){"+"var ")+v$30940)+"={};")+args$30854.map(f$30945).join(""))+";return ")+v$30940)+";}())");}}());return it$0$30442.expr(r$30859,mode$30439);}else{if(($30450$30474&&((t0$30464===3)&&($30447$30459[0]==="lambda")))){(bindings$30980=$30447$30459[1]);(body$30981=$30447$30459[2]);(name$30985=function(){if($29972(RegExp("^[$_a-zA-Z]*$",""))(expr$30438.name)){return (expr$30438.name+" ");}else{return "";}}());(a$30990=(((acc$31001=[])),(((temp$31006=bindings$30980)),((($length$31011=temp$31006.length)),((($index$31016=0)),function(){$30998:for(;($index$31016<$length$31011);($index$31016++)){var x$31032;var m$31024;(m$31024=temp$31006[$index$31016]);(x$31032=m$31024);acc$31001.push(it$0$30442.translate(x$31032,"expr"));}}()))),acc$31001).join(","));(b$30991=it$0$30442.body(body$30981,"return"));return it$0$30442.expr((((((("function"+name$30985)+"(")+a$30990)+"){")+b$30991)+"}"),mode$30439);}else{if(($30450$30474&&(($30452$30476=(t0$30464===4))&&(($30453$30477=($30447$30459[0]==="if"))&&((test$31041=$30447$30459[1]),((pos$31042=$30447$30459[2]),(((t1$30465=$30447$30459[3])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&((t1$30465[0]==="value")&&(t1$30465[1]===(void 0))))))))))))){($31055$31057=mode$30439);if(($31055$31057==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31069=$31055$31057);(a$31072=it$0$30442.translate(test$31041,"expr"));(b$31073=it$0$30442.translate(pos$31042,mode$30439));return (((("if("+a$31072)+"){")+b$31073)+"}");}}else{if($30453$30477){(test$31082=$30447$30459[1]);(pos$31083=$30447$30459[2]);(neg$31084=$30447$30459[3]);($31087$31089=mode$30439);if(($31087$31089==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31101=$31087$31089);(a$31104=it$0$30442.translate(test$31082,"expr"));(b$31105=it$0$30442.translate(pos$31083,mode$30439));(c$31106=it$0$30442.translate(neg$31084,mode$30439));return (((((("if("+a$31104)+"){")+b$31105)+"}else{")+c$31106)+"}");}}else{if(($30450$30474&&(($30452$30476=(t0$30464===3))&&(($30453$30477=($30447$30459[0]==="declare"))&&((binding$31118=$30447$30459[1]),(((t1$30465=$30447$30459[2])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&((t1$30465[0]==="value")&&(t1$30465[1]===(void 0)))))))))))){($31130$31133=mode$30439);(bridge$31131$31138=$31130$31133);if(((bridge$31131$31138==="expr")||(bridge$31131$31138==="return"))){throw "Invalid in expr ctx";}else{(other$31149=$31130$31133);(a$31152=it$0$30442.translate(binding$31118,"expr"));return (("var "+a$31152)+";");}}else{if($30453$30477){(binding$31158=$30447$30459[1]);(value$31159=$30447$30459[2]);($31162$31165=mode$30439);(bridge$31163$31170=$31162$31165);if(((bridge$31163$31170==="expr")||(bridge$31163$31170==="return"))){throw "Invalid in expr ctx";}else{(other$31181=$31162$31165);(a$31184=it$0$30442.translate(binding$31158,"expr"));(b$31185=it$0$30442.translate(value$31159,"expr"));return (((("var "+a$31184)+"=")+b$31185)+";");}}else{if(($30452$30476&&(($30453$30477=($30447$30459[0]==="assign"))&&(((t1$30465=$30447$30459[1])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===3)&&(t1$30465[0]==="send")))))))){(obj$31194=t1$30465[1]);(msg$31195=t1$30465[2]);(rhs$31196=$30447$30459[2]);(a$31208=it$0$30442.translate(obj$31194,"expr"));(b$31209=it$0$30442.translate(msg$31195,"expr"));(c$31210=it$0$30442.translate(rhs$31196,"expr"));return it$0$30442.expr((((((("("+a$31208)+"[")+b$31209)+"]=")+c$31210)+")"),mode$30439);}else{if($30453$30477){(lhs$31222=$30447$30459[1]);(rhs$31223=$30447$30459[2]);(a$31227=it$0$30442.translate(lhs$31222,"expr"));(b$31228=it$0$30442.translate(rhs$31223,"expr"));return it$0$30442.expr((((("("+a$31227)+"=")+b$31228)+")"),mode$30439);}else{if(($30450$30474&&((t0$30464===1)&&($30447$30459[0]==="multi")))){return "";}else{if(($30450$30474&&(($30452$30476=(t0$30464>=1))&&($30447$30459[0]==="multi")))){(args$31241=Array.prototype.slice.call($30447$30459,1));(isdecl$31247=function($31250$31252){var other$31279;var variable$31269;var value$31270;var t0$31265;var $31254$31260;var ph$31255;(ph$31255=$31250$31252);($31254$31260=ph$31255);if((($31254$31260 instanceof Array)&&(((t0$31265=$31254$31260.length)),((t0$31265===3)&&($31254$31260[0]==="declare"))))){(variable$31269=$31254$31260[1]);(value$31270=$31254$31260[2]);return true;}else{(other$31279=$31254$31260);return false;}});($31245$31283=null);$31245$31283;if((args$31241.length===1)){return it$0$30442.translate(args$31241[0],mode$30439);}else{if(((mode$30439==="expr")&&(!args$31241.some(isdecl$31247)))){(xs$31299=(((acc$31305=[])),(((temp$31310=args$31241)),((($length$31315=temp$31310.length)),((($index$31320=0)),function(){$31302:for(;($index$31320<$length$31315);($index$31320++)){var x$31336;var m$31328;(m$31328=temp$31310[$index$31320]);(x$31336=m$31328);acc$31305.push(it$0$30442.translate(x$31336,"expr"));}}()))),acc$31305));(xs$31299=(((acc$31345=[])),(((temp$31350=xs$31299)),((($length$31355=temp$31350.length)),((($index$31360=0)),function(){$31342:for(;($index$31360<$length$31355);($index$31360++)){var x$31376;var m$31368;(m$31368=temp$31350[$index$31360]);(x$31376=m$31368);if((x$31376!=="")){acc$31345.push(x$31376);}else{false;}}}()))),acc$31345));return (("("+xs$31299.join(","))+")");}else{return it$0$30442.body(expr$30438,mode$30439);}}}else{if(($30452$30476&&($30447$30459[0]==="splice"))){(args$31387=Array.prototype.slice.call($30447$30459,1));return it$0$30442.translate(["multi"].concat(args$31387),mode$30439);}else{if(($30450$30474&&((t0$30464===2)&&($30447$30459[0]==="variable")))){(s$31392=$30447$30459[1]);return it$0$30442.expr(it$0$30442.mangle(s$31392),mode$30439);}else{if(($30450$30474&&((t0$30464===3)&&($30447$30459[0]==="scope")))){(vars$31397=$30447$30459[1]);(body$31398=$30447$30459[2]);(decls$31402=(((acc$31408=[])),(((temp$31413=vars$31397)),((($length$31418=temp$31413.length)),((($index$31423=0)),function(){$31405:for(;($index$31423<$length$31418);($index$31423++)){var v$31439;var m$31431;(m$31431=temp$31413[$index$31423]);(v$31439=m$31431);acc$31408.push(["declare",v$31439,["value",(void 0)]]);}}()))),acc$31408));return it$0$30442.translate(["multi"].concat(decls$31402).concat([body$31398]),mode$30439);}else{if(($30450$30474&&((t0$30464>=1)&&($30447$30459[0]==="object2")))){(args$31445=Array.prototype.slice.call($30447$30459,1));(r$31449=(((f$31453=function($31456$31458){var t0$31463;var t1$31464;var a$31476;var b$31477;var x$31460;var y$31461;(t0$31463=$31456$31458);if(((t0$31463 instanceof Array)&&(((t1$31464=t0$31463.length)),(t1$31464===2)))){(x$31460=t0$31463[0]);(y$31461=t0$31463[1]);}else{$31786($31456$31458);}(a$31476=it$0$30442.translate(x$31460,"expr"));(b$31477=it$0$30442.translate(y$31461,"expr"));return ((a$31476+":")+b$31477);})),(("({"+args$31445.map(f$31453).join(","))+"})")));return it$0$30442.expr(r$31449,mode$30439);}else{if(($30450$30474&&((t0$30464===2)&&($30447$30459[0]==="js_new")))){(value$31488=$30447$30459[1]);return it$0$30442.expr((("(new "+it$0$30442.translate(value$31488,"expr"))+")"),mode$30439);}else{if(($30450$30474&&(($30452$30476=((t0$30464>=1)&&(t0$30464<=2)))&&(($30447$30459[0]==="js_break")&&(((t1$30465=function(){if((1>=t0$30464)){return ["value",null];}else{return $30447$30459[1];}}())),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&(t1$30465[0]==="value"))))))))){(label$31493=t1$30465[1]);if((mode$30439==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$31493){return (" "+label$31493);}else{return "";}}())+";");}}else{if(($30452$30476&&(($30447$30459[0]==="js_continue")&&(((t1$30465=function(){if((1>=t0$30464)){return ["value",null];}else{return $30447$30459[1];}}())),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&(t1$30465[0]==="value")))))))){(label$31506=t1$30465[1]);if((mode$30439==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$31506){return (" "+label$31506);}else{return "";}}())+";");}}else{if(($30450$30474&&(($30452$30476=(t0$30464===2))&&($30447$30459[0]==="js_return")))){(value$31519=$30447$30459[1]);if((mode$30439==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$30442.translate(value$31519,"expr"))+";");}}else{if(($30452$30476&&($30447$30459[0]==="js_delete"))){(value$31524=$30447$30459[1]);if((mode$30439==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$30442.translate(value$31524,"expr"))+";");}}else{if(($30452$30476&&($30447$30459[0]==="js_throw"))){(value$31529=$30447$30459[1]);if((mode$30439==="expr")){return (("function(){throw "+it$0$30442.translate(value$31529,"expr"))+";}()");}else{return (("throw "+it$0$30442.translate(value$31529,"expr"))+";");}}else{if(($30450$30474&&(($30452$30476=(t0$30464===3))&&(($30447$30459[0]==="js_label")&&(((t1$30465=$30447$30459[1])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===2)&&(t1$30465[0]==="value"))))))))){(label$31534=t1$30465[1]);(body$31535=$30447$30459[2]);($31546$31548=mode$30439);if(($31546$31548==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31560=$31546$31548);return ((label$31534+":")+it$0$30442.translate(body$31535,other$31560));}}else{if(($30452$30476&&($30447$30459[0]==="js_while"))){(test$31564=$30447$30459[1]);(body$31565=$30447$30459[2]);($31568$31570=mode$30439);if(($31568$31570==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31582=$31568$31570);(a$31585=it$0$30442.translate(test$31564,"expr"));(b$31586=it$0$30442.translate(body$31565,"stmt"));return (((("while("+a$31585)+"){")+b$31586)+"}");}}else{if(($30450$30474&&((t0$30464===5)&&($30447$30459[0]==="js_for")))){(x$31595=$30447$30459[1]);(y$31596=$30447$30459[2]);(z$31597=$30447$30459[3]);(body$31598=$30447$30459[4]);($31601$31603=mode$30439);if(($31601$31603==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31615=$31601$31603);(a$31618=it$0$30442.translate(x$31595,"expr"));(b$31619=it$0$30442.translate(y$31596,"expr"));(c$31620=it$0$30442.translate(z$31597,"expr"));(d$31621=it$0$30442.translate(body$31598,"stmt"));return (((((((("for("+a$31618)+";")+b$31619)+";")+c$31620)+"){")+d$31621)+"}");}}else{if(($30450$30474&&(($30452$30476=(t0$30464===4))&&($30447$30459[0]==="js_for_in")))){(x$31636=$30447$30459[1]);(y$31637=$30447$30459[2]);(body$31638=$30447$30459[3]);($31641$31643=mode$30439);if(($31641$31643==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31655=$31641$31643);(a$31658=it$0$30442.translate(x$31636,"expr"));(b$31659=it$0$30442.translate(y$31637,"expr"));(c$31660=it$0$30442.translate(body$31638,"stmt"));return (((((("for("+a$31658)+" in ")+b$31659)+"){")+c$31660)+"}");}}else{if(($30452$30476&&(($30447$30459[0]==="js_try")&&((attempt$31672=$30447$30459[1]),(((t1$30465=$30447$30459[2])),((t1$30465 instanceof Array)&&(((t2$30466=t1$30465.length)),((t2$30466===3)&&((t1$30465[0]==="lambda")&&(((t3$30467=t1$30465[1])),((t3$30467 instanceof Array)&&(((t4$30468=t3$30467.length)),((t4$30468===1)&&(((bridge$30449$30470=t3$30467[0])),((((bridge$30449$30470 instanceof Array)&&(((t0$31698=bridge$30449$30470.length)),((t0$31698===2)&&((bridge$30449$30470[0]==="symbol")&&((v$31673=bridge$30449$30470[1]),true)))))||((bridge$30449$30470 instanceof Array)&&(((t0$31705=bridge$30449$30470.length)),((t0$31705===2)&&((bridge$30449$30470[0]==="variable")&&((v$31673=bridge$30449$30470[1]),true))))))&&((body$31674=t1$30465[2]),(((t5$30471=$30447$30459[3])),((t5$30471 instanceof Array)&&(((t6$30472=t5$30471.length)),((t6$30472===1)&&(t5$30471[0]==="void"))))))))))))))))))))){($31721$31723=mode$30439);if(($31721$31723==="expr")){return it$0$30442.body(expr$30438,"expr");}else{(other$31735=$31721$31723);(a$31738=it$0$30442.translate(attempt$31672,"stmt"));(b$31739=it$0$30442.translate(body$31674,"stmt"));return (((((("try{"+a$31738)+"}catch(")+v$31673)+"){")+b$31739)+"}");}}else{if(($30450$30474&&((t0$30464===2)&&($30447$30459[0]==="raw")))){(x$31748=$30447$30459[1]);return x$31748;}else{(other$31753=$30447$30459);throw other$31753;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$29988(Translator$30046,$29988(((accum$31756=({})),((accum$31756["::name"]="Translator"),accum$31756)),((accum$31760=({})),((accum$31760["::egclass"]=true),accum$31760))));Translator$30046;(translate$30047=function(expr$31766,mode$31767){var tr$31770;var t$31771;(tr$31770=Translator$30046());(t$31771=tr$31770.translate(expr$31766,mode$31767));return (tr$31770.dump_store()+t$31771);});(exports["Translator"]=Translator$30046);(exports["translate"]=translate$30047);
