var $40519=(function(type$40522){var f$40526;(f$40526=type$40522["::check"]);if((f$40526===(void 0))){return (function(value$40532){return (value$40532 instanceof type$40522);});}else{return (function(value$40536){return f$40526.call(type$40522,value$40536);});}});
var $40538=(function(dest$40541,values$40542){var k$40547;(k$40547=null);$40545:for(k$40547 in values$40542){if(values$40542.hasOwnProperty(k$40547)){(dest$40541[k$40547]=values$40542[k$40547]);}}return dest$40541;});
var $40555=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $40556=(function($40558$40561){var ph$40567;(ph$40567=$40558$40561);var $40563$40573;($40563$40573=ph$40567);var bridge$40565$40578;var x$40582;(bridge$40565$40578=$40563$40573);if((((typeof(bridge$40565$40578)==="string")&&((x$40582=bridge$40565$40578),true))||((typeof(bridge$40565$40578)==="number")&&((x$40582=bridge$40565$40578),true)))){return ["value",x$40582];}else{var other$40593;(other$40593=$40563$40573);return other$40593["::serialize_ast"]();}});
var $40595=(function(obj$40598){var results$40603;(results$40603=[]);var k$40608;(k$40608=null);$40602:for(k$40608 in obj$40598){if(Object.prototype.hasOwnProperty.call(obj$40598,k$40608)){results$40603.push([k$40608,$40555(obj$40598,k$40608)]);}}return results$40603;});
var $40864=(function(arr$40867){var results$40873;var l$40874;(results$40873=[]);(l$40874=arr$40867.length);var i$40883;(i$40883=0);$40872:for(;(i$40883<l$40874);(i$40883++)){results$40873.push([i$40883,$40555(arr$40867,i$40883)]);}return results$40873;});
var $40631=(function(){var $40632$40638;($40632$40638=(function(tags$40643){var it$0$40646;(it$0$40646=(function(){if((!$40519($40632$40638)(this))){return Object.create($40632$40638.prototype);}else{return this;}})());(it$0$40646["tags"]=tags$40643);return it$0$40646;}));($40632$40638.prototype["create"]=(function(){var it$0$40666;var self$40667;(it$0$40666=this);(self$40667=this);var $40664$40676;($40664$40676=arguments);var t0$40681;var message$40685;var args$40686;(t0$40681=$40664$40676.length);if((t0$40681>=0)){(message$40685=(function(){if((0>=t0$40681)){return "";}else{return $40664$40676[0];}})());(args$40686=Array.prototype.slice.call($40664$40676,1));var e$40699;(e$40699=Error(message$40685));(e$40699["::tags"]=it$0$40666.tags);(e$40699["args"]=args$40686);var temp$40715;(temp$40715=$40864(args$40686));var $length$40721;($length$40721=temp$40715.length);var $index$40727;($index$40727=0);$40700:for(;($index$40727<$length$40721);($index$40727++)){var m$40736;(m$40736=temp$40715[$index$40727]);var t0$40741;var t1$40742;var i$40746;var arg$40747;(t0$40741=m$40736);if(((t0$40741 instanceof Array)&&(((t1$40742=t0$40741.length)),(t1$40742===2)))){(i$40746=t0$40741[0]);(arg$40747=t0$40741[1]);(e$40699[i$40746]=arg$40747);}else{$40612(m$40736);}}(e$40699["length"]=args$40686.length);(e$40699["name"]=["E"].concat(it$0$40666.tags).join("."));return e$40699;}else{$40612($40664$40676);}}));($40632$40638.prototype["::check"]=(function(e$40777){var it$0$40781;var self$40782;(it$0$40781=this);(self$40782=this);var tags$40792;if(((!e$40777)||(!$40519(Error)(e$40777)))){return false;}(tags$40792=(e$40777["::tags"]||[]));var temp$40803;(temp$40803=it$0$40781.tags);var $length$40809;($length$40809=temp$40803.length);var $index$40815;($index$40815=0);$40793:for(;($index$40815<$length$40809);($index$40815++)){var m$40824;(m$40824=temp$40803[$index$40815]);var tag$40832;(tag$40832=m$40824);if((tags$40792.indexOf(tag$40832)===-1)){return false;}else{false;}}return true;}));($40632$40638.prototype["::deconstruct"]=(function(e$40841){var it$0$40845;var self$40846;(it$0$40845=this);(self$40846=this);return e$40841.args;}));$40538($40632$40638,$40538((function(){var accum$40857;(accum$40857=({}));(accum$40857["::name"]="$40632");return accum$40857;})(),(function(){var accum$40861;(accum$40861=({}));(accum$40861["::egclass"]=true);return accum$40861;})()));return $40632$40638;})();
var $40612=(function(value$40615,url$40616,start$40617,end$40618){var err$40622;(err$40622=$40631(["match"]).create("Could not find a match for value",({"value":value$40615})));if(url$40616){(err$40622["location"]=["location",url$40616,start$40617,end$40618]);}throw err$40622;});
var send$40164;var __array_methods$40165;var __re_methods$40166;(send$40164=(function(obj$40179,$40176$40180){var ph$40186;var msg$40187;var t0$40189;(t0$40189=$40176$40180);(msg$40187=t0$40189);(ph$40186=t0$40189);var $40182$40198;($40182$40198=ph$40186);var bridge$40184$40203;(bridge$40184$40203=$40182$40198);if(((typeof(bridge$40184$40203)==="string")||(typeof(bridge$40184$40203)==="number"))){return obj$40179[msg$40187];}else{var other$40215;(other$40215=$40182$40198);return obj$40179["::send"](msg$40187);}}));(Array[":::project"]=(function($40221$40224){var ph$40229;var value$40230;var t0$40232;(t0$40232=$40221$40224);(value$40230=t0$40232);(ph$40229=t0$40232);var $40226$40241;($40226$40241=ph$40229);if($40519(Array)($40226$40241)){return [true,value$40230];}else{$40226$40241;return [true,[value$40230]];}}));(__array_methods$40165=$40538((function(){var accum$40262;(accum$40262=({}));(accum$40262["::check"]=(function(value$40267){if((value$40267 instanceof Array)){var i$40273;(i$40273=0);$40270:for(;(i$40273<this.length);(i$40273++)){if(($40555(this,i$40273)!==$40555(value$40267,i$40273))){return false;}}return true;}else{return false;}}));return accum$40262;})(),$40538((function(){var accum$40282;(accum$40282=({}));(accum$40282["::clone"]=(function(){return $40538(this.slice(0),this);}));return accum$40282;})(),$40538((function(){var accum$40289;(accum$40289=({}));(accum$40289[":::project"]=(function(value$40294){if((value$40294 instanceof Array)){var i$40300;(i$40300=0);$40297:for(;(i$40300<this.length);(i$40300++)){if(($40555(this,i$40300)!==$40555(value$40294,i$40300))){return [true,this.concat([value$40294])];}}return [true,value$40294];}else{return [true,this.concat([value$40294])];}}));return accum$40289;})(),(function(){var accum$40309;(accum$40309=({}));(accum$40309["::serialize_ast"]=(function(){return ["array"].concat(this.map($40556));}));return accum$40309;})()))));var temp$40319;(temp$40319=$40595(__array_methods$40165));var $length$40325;($length$40325=temp$40319.length);var $index$40331;($index$40331=0);$40167:for(;($index$40331<$length$40325);($index$40331++)){var m$40340;(m$40340=temp$40319[$index$40331]);var t0$40345;var t1$40346;var k$40350;var v$40351;(t0$40345=m$40340);if(((t0$40345 instanceof Array)&&(((t1$40346=t0$40345.length)),(t1$40346===2)))){(k$40350=t0$40345[0]);(v$40351=t0$40345[1]);if((!$40555(Array.prototype,k$40350))){Object.defineProperty(Array.prototype,k$40350,({"enumerable":false,"value":v$40351}));}}else{$40612(m$40340);}}(__re_methods$40166=$40538((function(){var accum$40371;(accum$40371=({}));(accum$40371["::check"]=(function($40375$40378){var ph$40383;(ph$40383=$40375$40378);var $40380$40389;($40380$40389=ph$40383);var value$40397;if((typeof($40380$40389)==="string")){(value$40397=$40380$40389);if(value$40397.match(this)){return true;}else{return false;}}else{var other$40402;(other$40402=$40380$40389);return false;}}));return accum$40371;})(),(function(){var accum$40405;(accum$40405=({}));(accum$40405[":::project"]=(function($40409$40412){var ph$40417;(ph$40417=$40409$40412);var $40414$40423;($40414$40423=ph$40417);var value$40431;if((typeof($40414$40423)==="string")){(value$40431=$40414$40423);var $40434$40439;($40434$40439=value$40431.match(this));var m$40447;if(($40434$40439===null)){(m$40447=$40434$40439);return [false,null];}else{var m$40452;(m$40452=$40434$40439);return [true,m$40452];}}else{var other$40456;(other$40456=$40414$40423);return [false,null];}}));return accum$40405;})()));var temp$40462;(temp$40462=$40595(__re_methods$40166));var $length$40468;($length$40468=temp$40462.length);var $index$40474;($index$40474=0);$40170:for(;($index$40474<$length$40468);($index$40474++)){var m$40483;(m$40483=temp$40462[$index$40474]);var t0$40488;var t1$40489;var k$40493;var v$40494;(t0$40488=m$40483);if(((t0$40488 instanceof Array)&&(((t1$40489=t0$40488.length)),(t1$40489===2)))){(k$40493=t0$40488[0]);(v$40494=t0$40488[1]);if((!$40555(RegExp.prototype,k$40493))){Object.defineProperty(RegExp.prototype,k$40493,({"enumerable":false,"value":v$40494}));}}else{$40612(m$40483);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$40538(({"enumerable":false}),(function(){var accum$40512;(accum$40512=({}));(accum$40512["value"]=(function(args$40517){return this.apply(this,args$40517);}));return accum$40512;})()));}
var $43053=(function(type$43056){return (function(value$43060){var f$43064;(f$43064=type$43056[":::project"]);if((f$43064===(void 0))){(f$43064=type$43056["::project"]);if((f$43064===(void 0))){return [true,type$43056(value$43060)];}else{var rval$43077;(rval$43077=false);try{(rval$43077=[true,f$43064(value$43060)]);}catch(excv$43088){var e$43094;(e$43094=excv$43088);(rval$43077=[false,null]);}return rval$43077;}}else{return f$43064.call(type$43056,value$43060);}});});
var $43100=(function($43102$43105,key$43106){var ph$43114;(ph$43114=$43102$43105);var $43108$43120;($43108$43120=ph$43114);var bridge$43110$43125;(bridge$43110$43125=$43108$43120);if(((bridge$43110$43125===null)||(bridge$43110$43125===(void 0)))){return false;}else{var x$43137;if((typeof($43108$43120)==="string")){(x$43137=$43108$43120);return (key$43106 in String.prototype);}else{var x$43142;if((typeof($43108$43120)==="number")){(x$43142=$43108$43120);return (key$43106 in Number.prototype);}else{var x$43147;(x$43147=$43108$43120);return (key$43106 in x$43147);}}}});var accum$43018;var accum$43022;var $40892$40911;var gensym$40912;var Body$40913;var $40893$40914;var __lt____gt__$40915;var js_op_table2$40916;var js_op_table$40917;var Translator$40918;var translate$40919;($40892$40911=require("./util"));(gensym$40912=$40892$40911.gensym);(Body$40913=$40892$40911.Body);($40893$40914=require("./pp"));(__lt____gt__$40915=$40893$40914["<>"]);(js_op_table2$40916=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$40917=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$40918=(function(){var prelude$40965;var t0$40961;var $40952$40956;var it$0$40947;(it$0$40947=(function(){if((!$40519(Translator$40918)(this))){return Object.create(Translator$40918.prototype);}else{return this;}})());($40952$40956=arguments);(t0$40961=$40952$40956.length);if(((t0$40961>=0)&&(t0$40961<=1))){(prelude$40965=(function(){if((0>=t0$40961)){return null;}else{return $40952$40956[0];}})());(it$0$40947["cache"]=({}));(it$0$40947["prepend"]=[]);if(prelude$40965){it$0$40947.prepend.push(it$0$40947.translate($40556(prelude$40965),"stmt"));}}else{$40612($40952$40956);}return it$0$40947;}));(Translator$40918.prototype["register_value"]=(function(v$40989,id$40990){var temp$41021;var name$41030;var $41003$41008;var it$0$40994;var self$40995;(it$0$40994=this);(self$40995=this);($41003$41008=$40555(it$0$40994.cache,id$40990));if(($41003$41008===(void 0))){(temp$41021=["symbol",gensym$40912()]);(it$0$40994.cache[id$40990]=temp$41021);it$0$40994.prepend.push(it$0$40994.translate(["declare",temp$41021,$40556(v$40989)],"stmt"));return temp$41021;}else{(name$41030=$41003$41008);return name$41030;}}));(Translator$40918.prototype["register_raw"]=(function(raw$41036,id$41037){var temp$41068;var name$41077;var $41050$41055;var it$0$41041;var self$41042;(it$0$41041=this);(self$41042=this);($41050$41055=$40555(it$0$41041.cache,id$41037));if(($41050$41055===(void 0))){(temp$41068=["symbol",gensym$40912()]);(it$0$41041.cache[id$41037]=temp$41068);it$0$41041.prepend.push(it$0$41041.translate(["declare",temp$41068,["raw",raw$41036]],"stmt"));return temp$41068;}else{(name$41077=$41050$41055);return name$41077;}}));(Translator$40918.prototype["dump_store"]=(function(){var rval$41098;var it$0$41086;var self$41087;(it$0$41086=this);(self$41087=this);(rval$41098=it$0$41086.prepend.join("\n"));(it$0$41086["prepend"]=[]);return rval$41098;}));(Translator$40918.prototype["mangle"]=(function(name$41109){var i$41136;var tr$41126;var r$41127;var it$0$41113;var self$41114;(it$0$41113=this);(self$41114=this);(tr$41126=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$41127=[]);(i$41136=0);$41125:for(;(i$41136<name$41109.length);(++i$41136)){var c$41145;(c$41145=$40555(name$41109,i$41136));r$41127.push(($40555(tr$41126,c$41145)||c$41145));}return r$41127.join("");}));(Translator$40918.prototype["body"]=(function(orig$41153,mode$41154){var t0$41178;var t1$41179;var t2$41180;var x$41219;var stmts$41230;var ret$41231;var other$41244;var $41170$41207;var b$41175;var trst$41176;var it$0$41158;var self$41159;(it$0$41158=this);(self$41159=this);(t0$41178=$43053(Body$40913)(orig$41153));if((t0$41178[0]&&(((t1$41179=t0$41178[1])),(((t2$41180=t1$41179.length)),(t2$41180>=0))))){(b$41175=Array.prototype.slice.call(t1$41179,0));}else{$40612(orig$41153,"/home/olivier/git/earl-grey/src/translate-js.eg",3075,3079);}(trst$41176=(function(stmt$41202){return it$0$41158.translate(stmt$41202,"stmt");}));($41170$41207=mode$41154);if(($41170$41207==="expr")){(x$41219=["send",["lambda",[],orig$41153],["array"]]);return it$0$41158.translate(x$41219,mode$41154);}else{if(($41170$41207==="return")){(stmts$41230=b$41175.slice(0,-1));(ret$41231=$40555(b$41175,(b$41175.length-1)));return (stmts$41230.map(trst$41176).join("")+it$0$41158.translate(ret$41231,"return"));}else{if(($41170$41207==="stmt")){return b$41175.map(trst$41176).join("");}else{(other$41244=$41170$41207);throw $40631(["syntax","mode"]).create("Unknown mode",({"mode":mode$41154}));}}}}));(Translator$40918.prototype["expr"]=(function(x$41250,mode$41251){var other$41291;var $41264$41271;var it$0$41255;var self$41256;(it$0$41255=this);(self$41256=this);($41264$41271=mode$41251);if(($41264$41271==="expr")){return x$41250;}else{if(($41264$41271==="stmt")){return (x$41250+";");}else{if(($41264$41271==="return")){return (("return "+x$41250)+";");}else{(other$41291=$41264$41271);throw "OopsI";}}}}));(Translator$40918.prototype["op"]=(function(op$41297,a$41298,b$41299){var $41321$41335;var $41322$41336;var $41323$41337;var t0$41331;var t1$41332;var t2$41333;var $41317$41326;var e$41314;var it$0$41303;var self$41304;(it$0$41303=this);(self$41304=this);(e$41314=((($41317$41326=[a$41298,b$41299])),(function(){if((($41321$41335=($41317$41326 instanceof Array))&&(((t0$41331=$41317$41326.length)),(($41323$41337=(t0$41331===2))&&(((t1$41332=$41317$41326[0])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===1)&&(t1$41332[0]==="void"))))))))){$41317$41326[1];return (op$41297+it$0$41303.translate(b$41299,"expr"));}else{if(($41323$41337&&($41317$41326[0],(((t1$41332=$41317$41326[1])),((t1$41332 instanceof Array)&&(((t2$41333=t1$41332.length)),((t2$41333===1)&&(t1$41332[0]==="void")))))))){return (it$0$41303.translate(a$41298,"expr")+op$41297);}else{$41317$41326;return ((it$0$41303.translate(a$41298,"expr")+op$41297)+it$0$41303.translate(b$41299,"expr"));}}})()));return (("("+e$41314)+")");}));(Translator$40918.prototype["translate"]=(function(expr$41380,mode$41381){var repl$41506;var it$0$41545;var it$0$41539;var it$0$41533;var it$0$41527;var bridge$41487$41564;var bridge$41486$41557;var other$41579;var id$41573;var bridge$41485$41497;var $41480$41492;var r$41477;var t0$41618;var t0$41625;var trf$41645;var trmsg$41646;var x$41712;var x$41707;var $41694$41699;var trf$41690;var trmsg$41691;var trf$41725;var trmsg$41726;var otherwise$41720;var $41672$41677;var x$41786;var x$41776;var $41759$41771;var $41760$41772;var $41761$41773;var t0$41769;var $41755$41764;var $index$41826;var $length$41820;var temp$41814;var acc$41808;var trf$41796;var trargs$41797;var op$41752;var code$41865;var code$41879;var t0$41857;var t1$41858;var trf$41886;var trmsg$41887;var codevar$41855;var f$41906;var r$41901;var f$41981;var f$42027;var v$42021;var all_strings$41923;var r$41924;var $index$42114;var $length$42108;var temp$42102;var acc$42096;var a$42081;var b$42082;var name$42074;var a$42178;var b$42179;var other$42173;var $42156$42161;var a$42216;var b$42217;var c$42218;var other$42210;var $42193$42198;var a$42271;var other$42267;var bridge$42246$42255;var $42244$42250;var a$42309;var b$42310;var other$42304;var bridge$42283$42292;var $42281$42287;var a$42338;var b$42339;var c$42340;var a$42359;var b$42360;var $index$42470;var $length$42464;var temp$42458;var acc$42452;var $index$42516;var $length$42510;var temp$42504;var acc$42498;var xs$42444;var $42382$42432;var $42378$42426;var isdecl$42383;var $index$42586;var $length$42580;var temp$42574;var acc$42568;var decls$42560;var f$42619;var r$42614;var x$42717;var y$42718;var t0$42713;var $42703$42708;var other$42767;var $42750$42755;var a$42797;var b$42798;var other$42792;var $42775$42780;var a$42837;var b$42838;var c$42839;var d$42840;var other$42830;var $42813$42818;var a$42883;var b$42884;var c$42885;var other$42877;var $42860$42865;var t0$42929;var t0$42937;var a$42975;var b$42976;var other$42970;var $42953$42958;var other$43004;var t0$42991;var $42947$42986;var r$42950;var other$43013;var x$43008;var attempt$42897;var v$42898;var body$42899;var finally$42900;var x$42855;var y$42856;var body$42857;var x$42807;var y$42808;var z$42809;var body$42810;var test$42771;var body$42772;var label$42736;var body$42737;var value$42731;var value$42700;var value$42695;var label$42680;var label$42665;var value$42660;var args$42609;var vars$42554;var body$42555;var s$42549;var args$42544;var args$42373;var lhs$42352;var rhs$42353;var obj$42319;var msg$42320;var rhs$42321;var binding$42277;var value$42278;var binding$42230;var test$42188;var pos$42189;var neg$42190;var test$42140;var pos$42141;var bindings$42068;var body$42069;var args$41917;var args$41896;var f$41849;var msg$41850;var f$41735;var args$41736;var f$41655;var msg$41656;var s$41657;var f$41609;var msg$41610;var f$41584;var v$41472;var s$41458;var $41433$41452;var $41434$41453;var $41435$41454;var $41436$41455;var t0$41444;var t1$41445;var t2$41446;var t3$41447;var t4$41448;var bridge$41400$41449;var bridge$41430$41450;var $41394$41439;var it$0$41385;var self$41386;(it$0$41385=this);(self$41386=this);($41394$41439=expr$41380);if((($41433$41452=($41394$41439 instanceof Array))&&(((t0$41444=$41394$41439.length)),((t0$41444===2)&&($41394$41439[0]==="symbol"))))){(s$41458=$41394$41439[1]);return it$0$41385.expr(it$0$41385.mangle(s$41458),mode$41381);}else{if(($41433$41452&&((t0$41444===1)&&($41394$41439[0]==="void")))){return it$0$41385.expr("null",mode$41381);}else{if(($41433$41452&&((t0$41444===2)&&($41394$41439[0]==="value")))){(v$41472=$41394$41439[1]);(r$41477=((($41480$41492=v$41472)),(function(){if((typeof($41480$41492)==="string")){(repl$41506=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$41472=v$41472.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),(function(m$41514){return $40555(repl$41506,m$41514);})));return (("\""+v$41472)+"\"");}else{if(($41480$41492===(void 0))){return "(void 0)";}else{if($40519(RegExp)($41480$41492)){(it$0$41527=String(v$41472));(it$0$41533=it$0$41527.slice(1,-1));(it$0$41539=it$0$41533.replace(RegExp("/","g"),"\\/"));(it$0$41545=it$0$41539.replace(RegExp("\\n","g"),"\\n"));return "/".concat(it$0$41545).concat("/");}else{(bridge$41485$41497=$41480$41492);if(((((bridge$41486$41557=bridge$41485$41497)),((((bridge$41487$41564=bridge$41486$41557)),((typeof(bridge$41487$41564)==="number")||(bridge$41487$41564===true)))||(bridge$41486$41557===false)))||(bridge$41485$41497===null))){return String(v$41472);}else{if(($43100($41480$41492,"::id")&&((id$41573=$41480$41492["::id"]),id$41573))){return it$0$41385.translate(it$0$41385.register_value(v$41472,id$41573),mode$41381);}else{(other$41579=$41480$41492);throw $40631(["cannot_serialize"]).create("Cannot serialize value",({"value":v$41472}));}}}}}})()));return it$0$41385.expr(r$41477,mode$41381);}else{if(($41433$41452&&(($41435$41454=(t0$41444===3))&&(($41436$41455=($41394$41439[0]==="send"))&&(((t1$41445=$41394$41439[1])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&((t1$41445[0]==="variable")&&((t1$41445[1]==="___node")&&(((t3$41447=$41394$41439[2])),((t3$41447 instanceof Array)&&(((t4$41448=t3$41447.length)),((t4$41448===2)&&(t3$41447[0]==="value"))))))))))))))){(f$41584=t3$41447[1]);return f$41584;}else{if(($41436$41455&&(((bridge$41400$41449=$41394$41439[1])),((((bridge$41400$41449 instanceof Array)&&(((t0$41618=bridge$41400$41449.length)),((t0$41618===2)&&((bridge$41400$41449[0]==="symbol")&&(bridge$41400$41449[1]==="___js_fetch")))))||((bridge$41400$41449 instanceof Array)&&(((t0$41625=bridge$41400$41449.length)),((t0$41625===2)&&((bridge$41400$41449[0]==="variable")&&(bridge$41400$41449[1]==="___js_fetch"))))))&&(((t1$41445=$41394$41439[2])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===3)&&(t1$41445[0]==="array"))))))))){(f$41609=t1$41445[1]);(msg$41610=t1$41445[2]);(trf$41645=it$0$41385.translate(f$41609,"expr"));(trmsg$41646=it$0$41385.translate(msg$41610,"expr"));return it$0$41385.expr((((trf$41645+"[")+trmsg$41646)+"]"),mode$41381);}else{if(($41436$41455&&((f$41655=$41394$41439[1]),(((t1$41445=$41394$41439[2])),((msg$41656=t1$41445),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&(t1$41445[0]==="value"))))))))){(s$41657=t1$41445[1]);($41672$41677=null);$41672$41677;if(((typeof(s$41657)==="string")&&s$41657.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$41690=((($41694$41699=it$0$41385.translate(f$41655,"expr"))),(function(){if($40519(RegExp("^\\d+$",""))($41694$41699)){(x$41707=$41694$41699);return (("("+x$41707)+")");}else{(x$41712=$41694$41699);return x$41712;}})()));(trmsg$41691=it$0$41385.translate(["symbol",s$41657],"expr"));return it$0$41385.expr(((trf$41690+".")+trmsg$41691),mode$41381);}else{(otherwise$41720=$41672$41677);(trf$41725=it$0$41385.translate(f$41655,"expr"));(trmsg$41726=it$0$41385.translate(msg$41656,"expr"));return it$0$41385.expr((((trf$41725+"[")+trmsg$41726)+"]"),mode$41381);}}else{if(($41436$41455&&((f$41735=$41394$41439[1]),(((t1$41445=$41394$41439[2])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446>=1)&&(t1$41445[0]==="array")))))))){(args$41736=Array.prototype.slice.call(t1$41445,1));(op$41752=((($41755$41764=f$41735)),(function(){if((($41759$41771=($41755$41764 instanceof Array))&&(((t0$41769=$41755$41764.length)),(($41761$41773=(t0$41769===2))&&($41755$41764[0]==="symbol"))))){(x$41776=$41755$41764[1]);return $40555(js_op_table$40917,x$41776);}else{if(($41761$41773&&($41755$41764[0]==="variable"))){(x$41786=$41755$41764[1]);return $40555(js_op_table2$40916,x$41786);}else{$41755$41764;return null;}}})()));if(op$41752){return it$0$41385.expr(it$0$41385.op(op$41752,args$41736[0],args$41736[1]),mode$41381);}else{(trf$41796=it$0$41385.translate(f$41735,"expr"));(trargs$41797=(((acc$41808=[])),(((temp$41814=args$41736)),((($length$41820=temp$41814.length)),((($index$41826=0)),(function(){$41803:for(;($index$41826<$length$41820);($index$41826++)){var x$41843;var m$41835;(m$41835=temp$41814[$index$41826]);(x$41843=m$41835);acc$41808.push(it$0$41385.translate(x$41843,"expr"));}})()))),acc$41808));return it$0$41385.expr((((trf$41796+"(")+trargs$41797.join(","))+")"),mode$41381);}}else{if($41436$41455){(f$41849=$41394$41439[1]);(msg$41850=$41394$41439[2]);(t0$41857=(((code$41865="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41385.register_raw(code$41865,"~send")));if(((t0$41857 instanceof Array)&&(((t1$41858=t0$41857.length)),((t1$41858===2)&&(t0$41857[0]==="symbol"))))){(codevar$41855=t0$41857[1]);}else{$40612((((code$41879="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$41385.register_raw(code$41879,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6793,7003);}(trf$41886=it$0$41385.translate(f$41849,"expr"));(trmsg$41887=it$0$41385.translate(msg$41850,"expr"));return it$0$41385.expr((((((codevar$41855+"(")+trf$41886)+",")+trmsg$41887)+")"),mode$41381);}else{if(($41433$41452&&(($41435$41454=(t0$41444>=1))&&($41394$41439[0]==="array")))){(args$41896=Array.prototype.slice.call($41394$41439,1));(r$41901=(((f$41906=(function(x$41911){return it$0$41385.translate(x$41911,"expr");}))),(("["+args$41896.map(f$41906).join(","))+"]")));return it$0$41385.expr(r$41901,mode$41381);}else{if(($41435$41454&&($41394$41439[0]==="object"))){(args$41917=Array.prototype.slice.call($41394$41439,1));(all_strings$41923=args$41917.every((function($41928$41931){var t0$41939;var t1$41940;var other$41974;var v$41964;var t0$41960;var $41933$41955;var ph$41936;var y$41937;(t0$41939=$41928$41931);if(((t0$41939 instanceof Array)&&(((t1$41940=t0$41939.length)),((t1$41940===3)&&(t0$41939[0]==="array"))))){(ph$41936=t0$41939[1]);(y$41937=t0$41939[2]);}else{$40612($41928$41931);}($41933$41955=ph$41936);if((($41933$41955 instanceof Array)&&(((t0$41960=$41933$41955.length)),((t0$41960===2)&&($41933$41955[0]==="value"))))){(v$41964=$41933$41955[1]);return true;}else{(other$41974=$41933$41955);return false;}})));(r$41924=(function(){if(all_strings$41923){(f$41981=(function($41985$41988){var t0$41993;var t1$41994;var a$42010;var b$42011;var x$41990;var y$41991;(t0$41993=$41985$41988);if(((t0$41993 instanceof Array)&&(((t1$41994=t0$41993.length)),((t1$41994===3)&&(t0$41993[0]==="array"))))){(x$41990=t0$41993[1]);(y$41991=t0$41993[2]);}else{$40612($41985$41988);}(a$42010=it$0$41385.translate(x$41990,"expr"));(b$42011=it$0$41385.translate(y$41991,"expr"));return ((a$42010+":")+b$42011);}));return (("({"+args$41917.map(f$41981).join(","))+"})");}else{(v$42021=gensym$40912());(f$42027=(function($42031$42034){var t0$42039;var t1$42040;var a$42056;var b$42057;var x$42036;var y$42037;(t0$42039=$42031$42034);if(((t0$42039 instanceof Array)&&(((t1$42040=t0$42039.length)),((t1$42040===3)&&(t0$42039[0]==="array"))))){(x$42036=t0$42039[1]);(y$42037=t0$42039[2]);}else{$40612($42031$42034);}(a$42056=it$0$41385.translate(x$42036,"expr"));(b$42057=it$0$41385.translate(y$42037,"expr"));return (((((v$42021+"[")+a$42056)+"]=")+b$42057)+";");}));return ((((((("(function(){"+"var ")+v$42021)+"={};")+args$41917.map(f$42027).join(""))+";return ")+v$42021)+";}())");}})());return it$0$41385.expr(r$41924,mode$41381);}else{if(($41433$41452&&((t0$41444===3)&&($41394$41439[0]==="lambda")))){(bindings$42068=$41394$41439[1]);(body$42069=$41394$41439[2]);(name$42074=(function(){if($40519(RegExp("^[$_a-zA-Z]*$",""))(expr$41380.name)){return (expr$41380.name+" ");}else{return "";}})());(a$42081=(((acc$42096=[])),(((temp$42102=bindings$42068)),((($length$42108=temp$42102.length)),((($index$42114=0)),(function(){$42091:for(;($index$42114<$length$42108);($index$42114++)){var x$42131;var m$42123;(m$42123=temp$42102[$index$42114]);(x$42131=m$42123);acc$42096.push(it$0$41385.translate(x$42131,"expr"));}})()))),acc$42096).join(","));(b$42082=it$0$41385.body(body$42069,"return"));return it$0$41385.expr((((((("(function"+name$42074)+"(")+a$42081)+"){")+b$42082)+"})"),mode$41381);}else{if(($41433$41452&&(($41435$41454=(t0$41444===4))&&(($41436$41455=($41394$41439[0]==="if"))&&((test$42140=$41394$41439[1]),((pos$42141=$41394$41439[2]),(((t1$41445=$41394$41439[3])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&((t1$41445[0]==="value")&&(t1$41445[1]===(void 0))))))))))))){($42156$42161=mode$41381);if(($42156$42161==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42173=$42156$42161);(a$42178=it$0$41385.translate(test$42140,"expr"));(b$42179=it$0$41385.translate(pos$42141,mode$41381));return (((("if("+a$42178)+"){")+b$42179)+"}");}}else{if($41436$41455){(test$42188=$41394$41439[1]);(pos$42189=$41394$41439[2]);(neg$42190=$41394$41439[3]);($42193$42198=mode$41381);if(($42193$42198==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42210=$42193$42198);(a$42216=it$0$41385.translate(test$42188,"expr"));(b$42217=it$0$41385.translate(pos$42189,mode$41381));(c$42218=it$0$41385.translate(neg$42190,mode$41381));return (((((("if("+a$42216)+"){")+b$42217)+"}else{")+c$42218)+"}");}}else{if(($41433$41452&&(($41435$41454=(t0$41444===3))&&(($41436$41455=($41394$41439[0]==="declare"))&&((binding$42230=$41394$41439[1]),(((t1$41445=$41394$41439[2])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&((t1$41445[0]==="value")&&(t1$41445[1]===(void 0)))))))))))){($42244$42250=mode$41381);(bridge$42246$42255=$42244$42250);if(((bridge$42246$42255==="expr")||(bridge$42246$42255==="return"))){throw "Invalid in expr ctx";}else{(other$42267=$42244$42250);(a$42271=it$0$41385.translate(binding$42230,"expr"));return (("var "+a$42271)+";");}}else{if($41436$41455){(binding$42277=$41394$41439[1]);(value$42278=$41394$41439[2]);($42281$42287=mode$41381);(bridge$42283$42292=$42281$42287);if(((bridge$42283$42292==="expr")||(bridge$42283$42292==="return"))){throw "Invalid in expr ctx";}else{(other$42304=$42281$42287);(a$42309=it$0$41385.translate(binding$42277,"expr"));(b$42310=it$0$41385.translate(value$42278,"expr"));return (((("var "+a$42309)+"=")+b$42310)+";");}}else{if(($41435$41454&&(($41436$41455=($41394$41439[0]==="assign"))&&(((t1$41445=$41394$41439[1])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===3)&&(t1$41445[0]==="send")))))))){(obj$42319=t1$41445[1]);(msg$42320=t1$41445[2]);(rhs$42321=$41394$41439[2]);(a$42338=it$0$41385.translate(obj$42319,"expr"));(b$42339=it$0$41385.translate(msg$42320,"expr"));(c$42340=it$0$41385.translate(rhs$42321,"expr"));return it$0$41385.expr((((((("("+a$42338)+"[")+b$42339)+"]=")+c$42340)+")"),mode$41381);}else{if($41436$41455){(lhs$42352=$41394$41439[1]);(rhs$42353=$41394$41439[2]);(a$42359=it$0$41385.translate(lhs$42352,"expr"));(b$42360=it$0$41385.translate(rhs$42353,"expr"));return it$0$41385.expr((((("("+a$42359)+"=")+b$42360)+")"),mode$41381);}else{if(($41433$41452&&((t0$41444===1)&&($41394$41439[0]==="multi")))){return "";}else{if(($41433$41452&&(($41435$41454=(t0$41444>=1))&&($41394$41439[0]==="multi")))){(args$42373=Array.prototype.slice.call($41394$41439,1));(isdecl$42383=(function($42387$42390){var other$42421;var variable$42410;var value$42411;var t0$42406;var $42392$42401;var ph$42395;(ph$42395=$42387$42390);($42392$42401=ph$42395);if((($42392$42401 instanceof Array)&&(((t0$42406=$42392$42401.length)),((t0$42406===3)&&($42392$42401[0]==="declare"))))){(variable$42410=$42392$42401[1]);(value$42411=$42392$42401[2]);return true;}else{(other$42421=$42392$42401);return false;}}));($42378$42426=null);$42378$42426;if((args$42373.length===1)){return it$0$41385.translate(args$42373[0],mode$41381);}else{if(((mode$41381==="expr")&&(!args$42373.some(isdecl$42383)))){(xs$42444=(((acc$42452=[])),(((temp$42458=args$42373)),((($length$42464=temp$42458.length)),((($index$42470=0)),(function(){$42447:for(;($index$42470<$length$42464);($index$42470++)){var x$42487;var m$42479;(m$42479=temp$42458[$index$42470]);(x$42487=m$42479);acc$42452.push(it$0$41385.translate(x$42487,"expr"));}})()))),acc$42452));(xs$42444=(((acc$42498=[])),(((temp$42504=xs$42444)),((($length$42510=temp$42504.length)),((($index$42516=0)),(function(){$42493:for(;($index$42516<$length$42510);($index$42516++)){var x$42533;var m$42525;(m$42525=temp$42504[$index$42516]);(x$42533=m$42525);if((x$42533!=="")){acc$42498.push(x$42533);}else{false;}}})()))),acc$42498));return (("("+xs$42444.join(","))+")");}else{return it$0$41385.body(expr$41380,mode$41381);}}}else{if(($41435$41454&&($41394$41439[0]==="splice"))){(args$42544=Array.prototype.slice.call($41394$41439,1));return it$0$41385.translate(["multi"].concat(args$42544),mode$41381);}else{if(($41433$41452&&((t0$41444===2)&&($41394$41439[0]==="variable")))){(s$42549=$41394$41439[1]);return it$0$41385.expr(it$0$41385.mangle(s$42549),mode$41381);}else{if(($41433$41452&&((t0$41444===3)&&($41394$41439[0]==="scope")))){(vars$42554=$41394$41439[1]);(body$42555=$41394$41439[2]);(decls$42560=(((acc$42568=[])),(((temp$42574=vars$42554)),((($length$42580=temp$42574.length)),((($index$42586=0)),(function(){$42563:for(;($index$42586<$length$42580);($index$42586++)){var v$42603;var m$42595;(m$42595=temp$42574[$index$42586]);(v$42603=m$42595);acc$42568.push(["declare",v$42603,["value",(void 0)]]);}})()))),acc$42568));return it$0$41385.translate(["multi"].concat(decls$42560).concat([body$42555]),mode$41381);}else{if(($41433$41452&&((t0$41444>=1)&&($41394$41439[0]==="object2")))){(args$42609=Array.prototype.slice.call($41394$41439,1));(r$42614=(((f$42619=(function($42623$42626){var t0$42631;var t1$42632;var a$42648;var b$42649;var x$42628;var y$42629;(t0$42631=$42623$42626);if(((t0$42631 instanceof Array)&&(((t1$42632=t0$42631.length)),(t1$42632===2)))){(x$42628=t0$42631[0]);(y$42629=t0$42631[1]);}else{$40612($42623$42626);}(a$42648=it$0$41385.translate(x$42628,"expr"));(b$42649=it$0$41385.translate(y$42629,"expr"));return ((a$42648+":")+b$42649);}))),(("({"+args$42609.map(f$42619).join(","))+"})")));return it$0$41385.expr(r$42614,mode$41381);}else{if(($41433$41452&&((t0$41444===2)&&($41394$41439[0]==="js_new")))){(value$42660=$41394$41439[1]);return it$0$41385.expr((("(new "+it$0$41385.translate(value$42660,"expr"))+")"),mode$41381);}else{if(($41433$41452&&(($41435$41454=((t0$41444>=1)&&(t0$41444<=2)))&&(($41394$41439[0]==="js_break")&&(((t1$41445=(function(){if((1>=t0$41444)){return ["value",null];}else{return $41394$41439[1];}})())),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&(t1$41445[0]==="value"))))))))){(label$42665=t1$41445[1]);if((mode$41381==="expr")){throw "Invalid break in ctx";}else{return (("break"+(function(){if(label$42665){return (" "+label$42665);}else{return "";}})())+";");}}else{if(($41435$41454&&(($41394$41439[0]==="js_continue")&&(((t1$41445=(function(){if((1>=t0$41444)){return ["value",null];}else{return $41394$41439[1];}})())),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&(t1$41445[0]==="value")))))))){(label$42680=t1$41445[1]);if((mode$41381==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+(function(){if(label$42680){return (" "+label$42680);}else{return "";}})())+";");}}else{if(($41433$41452&&(($41435$41454=(t0$41444===2))&&($41394$41439[0]==="js_return")))){(value$42695=$41394$41439[1]);if((mode$41381==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$41385.translate(value$42695,"expr"))+";");}}else{if(($41435$41454&&($41394$41439[0]==="js_delete"))){(value$42700=$41394$41439[1]);if((mode$41381==="expr")){throw "Invalid delete in ctx";}else{($42703$42708=value$42700);if((($42703$42708 instanceof Array)&&(((t0$42713=$42703$42708.length)),((t0$42713===3)&&($42703$42708[0]==="send"))))){(x$42717=$42703$42708[1]);(y$42718=$42703$42708[2]);return (((("delete "+it$0$41385.translate(x$42717,"expr"))+"[")+it$0$41385.translate(y$42718,"expr"))+"];");}else{$42703$42708;throw $40631(["translate","delete"]).create("Invalid argument for delete");}}}else{if(($41435$41454&&($41394$41439[0]==="js_throw"))){(value$42731=$41394$41439[1]);if((mode$41381==="expr")){return (("function(){throw "+it$0$41385.translate(value$42731,"expr"))+";}()");}else{return (("throw "+it$0$41385.translate(value$42731,"expr"))+";");}}else{if(($41433$41452&&(($41435$41454=(t0$41444===3))&&(($41394$41439[0]==="js_label")&&(((t1$41445=$41394$41439[1])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===2)&&(t1$41445[0]==="value"))))))))){(label$42736=t1$41445[1]);(body$42737=$41394$41439[2]);($42750$42755=mode$41381);if(($42750$42755==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42767=$42750$42755);return ((label$42736+":")+it$0$41385.translate(body$42737,other$42767));}}else{if(($41435$41454&&($41394$41439[0]==="js_while"))){(test$42771=$41394$41439[1]);(body$42772=$41394$41439[2]);($42775$42780=mode$41381);if(($42775$42780==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42792=$42775$42780);(a$42797=it$0$41385.translate(test$42771,"expr"));(b$42798=it$0$41385.translate(body$42772,"stmt"));return (((("while("+a$42797)+"){")+b$42798)+"}");}}else{if(($41433$41452&&((t0$41444===5)&&($41394$41439[0]==="js_for")))){(x$42807=$41394$41439[1]);(y$42808=$41394$41439[2]);(z$42809=$41394$41439[3]);(body$42810=$41394$41439[4]);($42813$42818=mode$41381);if(($42813$42818==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42830=$42813$42818);(a$42837=it$0$41385.translate(x$42807,"expr"));(b$42838=it$0$41385.translate(y$42808,"expr"));(c$42839=it$0$41385.translate(z$42809,"expr"));(d$42840=it$0$41385.translate(body$42810,"stmt"));return (((((((("for("+a$42837)+";")+b$42838)+";")+c$42839)+"){")+d$42840)+"}");}}else{if(($41433$41452&&(($41435$41454=(t0$41444===4))&&($41394$41439[0]==="js_for_in")))){(x$42855=$41394$41439[1]);(y$42856=$41394$41439[2]);(body$42857=$41394$41439[3]);($42860$42865=mode$41381);if(($42860$42865==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42877=$42860$42865);(a$42883=it$0$41385.translate(x$42855,"expr"));(b$42884=it$0$41385.translate(y$42856,"expr"));(c$42885=it$0$41385.translate(body$42857,"stmt"));return (((((("for("+a$42883)+" in ")+b$42884)+"){")+c$42885)+"}");}}else{if(($41435$41454&&(($41394$41439[0]==="js_try")&&((attempt$42897=$41394$41439[1]),(((t1$41445=$41394$41439[2])),((t1$41445 instanceof Array)&&(((t2$41446=t1$41445.length)),((t2$41446===3)&&((t1$41445[0]==="lambda")&&(((t3$41447=t1$41445[1])),((t3$41447 instanceof Array)&&(((t4$41448=t3$41447.length)),((t4$41448===1)&&(((bridge$41430$41450=t3$41447[0])),(((bridge$41430$41450 instanceof Array)&&(((t0$42929=bridge$41430$41450.length)),((t0$42929===2)&&((bridge$41430$41450[0]==="symbol")&&((v$42898=bridge$41430$41450[1]),true)))))||((bridge$41430$41450 instanceof Array)&&(((t0$42937=bridge$41430$41450.length)),((t0$42937===2)&&((bridge$41430$41450[0]==="variable")&&((v$42898=bridge$41430$41450[1]),true)))))))))))))))))))){(body$42899=t1$41445[2]);(finally$42900=$41394$41439[3]);(r$42950=((($42953$42958=mode$41381)),(function(){if(($42953$42958==="expr")){return it$0$41385.body(expr$41380,"expr");}else{(other$42970=$42953$42958);(a$42975=it$0$41385.translate(attempt$42897,"stmt"));(b$42976=it$0$41385.translate(body$42899,"stmt"));return (((((("try{"+a$42975)+"}catch(")+v$42898)+"){")+b$42976)+"}");}})()));($42947$42986=finally$42900);if((($42947$42986 instanceof Array)&&(((t0$42991=$42947$42986.length)),((t0$42991===1)&&($42947$42986[0]==="void"))))){return r$42950;}else{(other$43004=$42947$42986);return (((r$42950+"finally{")+it$0$41385.translate(other$43004,"stmt"))+"}");}}else{if(($41433$41452&&((t0$41444===2)&&($41394$41439[0]==="raw")))){(x$43008=$41394$41439[1]);return x$43008;}else{(other$43013=$41394$41439);throw other$43013;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}));$40538(Translator$40918,$40538(((accum$43018=({})),((accum$43018["::name"]="Translator"),accum$43018)),((accum$43022=({})),((accum$43022["::egclass"]=true),accum$43022))));Translator$40918;(translate$40919=(function(expr$43029,mode$43030){var tr$43035;var t$43036;(tr$43035=Translator$40918());(t$43036=tr$43035.translate(expr$43029,mode$43030));return (tr$43035.dump_store()+t$43036);}));(exports["Translator"]=Translator$40918);(exports["translate"]=translate$40919);
