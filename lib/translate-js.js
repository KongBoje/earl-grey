var $37414=function(type$37417){var f$37421;(f$37421=type$37417["::check"]);if((f$37421===(void 0))){return function(value$37427){return (value$37427 instanceof type$37417);};}else{return function(value$37431){return f$37421.call(type$37417,value$37431);};}};
var $37433=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $37434=function(dest$37437,values$37438){var k$37443;(k$37443=null);$37441:for(k$37443 in values$37438){if(values$37438.hasOwnProperty(k$37443)){(dest$37437[k$37443]=values$37438[k$37443]);}}return dest$37437;};
var $37451=function($37453$37456){var ph$37462;(ph$37462=$37453$37456);var $37458$37468;($37458$37468=ph$37462);var bridge$37460$37473;var x$37477;(bridge$37460$37473=$37458$37468);if((((typeof(bridge$37460$37473)==="string")&&((x$37477=bridge$37460$37473),true))||((typeof(bridge$37460$37473)==="number")&&((x$37477=bridge$37460$37473),true)))){return ["value",x$37477];}else{var other$37488;(other$37488=$37458$37468);return other$37488["::serialize_ast"]();}};
var send$37188;(send$37188=function(obj$37195,$37192$37196){var ph$37202;var msg$37203;var t0$37205;(t0$37205=$37192$37196);(msg$37203=t0$37205);(ph$37202=t0$37205);var $37198$37214;($37198$37214=ph$37202);var bridge$37200$37219;(bridge$37200$37219=$37198$37214);if(((typeof(bridge$37200$37219)==="string")||(typeof(bridge$37200$37219)==="number"))){return obj$37195[msg$37203];}else{var other$37231;(other$37231=$37198$37214);return obj$37195["::send"](msg$37203);}});(Array[":::project"]=function($37237$37240){var ph$37245;var value$37246;var t0$37248;(t0$37248=$37237$37240);(value$37246=t0$37248);(ph$37245=t0$37248);var $37242$37257;($37242$37257=ph$37245);if($37414(Array)($37242$37257)){return [true,value$37246];}else{$37242$37257;return [true,[value$37246]];}});(Array.prototype["::check"]=function(value$37275){if((value$37275 instanceof Array)){var i$37281;(i$37281=0);$37278:for(;(i$37281<this.length);(i$37281++)){if(($37433(this,i$37281)!==$37433(value$37275,i$37281))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $37434(this.slice(0),this);});(Array.prototype[":::project"]=function(value$37300){if((value$37300 instanceof Array)){var i$37306;(i$37306=0);$37303:for(;(i$37306<this.length);(i$37306++)){if(($37433(this,i$37306)!==$37433(value$37300,i$37306))){return [true,[value$37300]];}}return [true,value$37300.slice(this.length)];}else{return [true,[value$37300]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($37451));});(RegExp.prototype["::check"]=function($37324$37327){var ph$37332;(ph$37332=$37324$37327);var $37329$37338;($37329$37338=ph$37332);var value$37346;if((typeof($37329$37338)==="string")){(value$37346=$37329$37338);if(value$37346.match(this)){return true;}else{return false;}}else{var other$37351;(other$37351=$37329$37338);return false;}});(RegExp.prototype[":::project"]=function($37357$37360){var ph$37365;(ph$37365=$37357$37360);var $37362$37371;($37362$37371=ph$37365);var value$37379;if((typeof($37362$37371)==="string")){(value$37379=$37362$37371);var $37382$37387;($37382$37387=value$37379.match(this));var m$37395;if(($37382$37387===null)){(m$37395=$37382$37387);return [false,null];}else{var m$37400;(m$37400=$37382$37387);return [true,m$37400];}}else{var other$37404;(other$37404=$37362$37371);return [false,null];}});(Function.prototype["::send"]=function(args$37411){return this.apply(this,args$37411);});
var $39854=function(arr$39857){var results$39863;var l$39864;(results$39863=[]);(l$39864=arr$39857.length);var i$39873;(i$39873=0);$39862:for(;(i$39873<l$39864);(i$39873++)){results$39863.push([i$39873,$37433(arr$39857,i$39873)]);}return results$39863;};
var $39621=function(){var $39622$39628;($39622$39628=function(tags$39633){var it$0$39636;(it$0$39636=function(){if((!$37414($39622$39628)(this))){return Object.create($39622$39628.prototype);}else{return this;}}());(it$0$39636["tags"]=tags$39633);return it$0$39636;});($39622$39628.prototype["create"]=function(){var it$0$39656;var self$39657;(it$0$39656=this);(self$39657=this);var $39654$39666;($39654$39666=arguments);var t0$39671;var message$39675;var args$39676;(t0$39671=$39654$39666.length);if((t0$39671>=0)){(message$39675=function(){if((0>=t0$39671)){return "";}else{return $39654$39666[0];}}());(args$39676=Array.prototype.slice.call($39654$39666,1));var e$39689;(e$39689=Error(message$39675));(e$39689["::tags"]=it$0$39656.tags);(e$39689["args"]=args$39676);var temp$39705;(temp$39705=$39854(args$39676));var $length$39711;($length$39711=temp$39705.length);var $index$39717;($index$39717=0);$39690:for(;($index$39717<$length$39711);($index$39717++)){var m$39726;(m$39726=temp$39705[$index$39717]);var t0$39731;var t1$39732;var i$39736;var arg$39737;(t0$39731=m$39726);if(((t0$39731 instanceof Array)&&(((t1$39732=t0$39731.length)),(t1$39732===2)))){(i$39736=t0$39731[0]);(arg$39737=t0$39731[1]);(e$39689[i$39736]=arg$39737);}else{$39602(m$39726);}}(e$39689["length"]=args$39676.length);(e$39689["name"]=["E"].concat(it$0$39656.tags).join("."));return e$39689;}else{$39602($39654$39666);}});($39622$39628.prototype["::check"]=function(e$39767){var it$0$39771;var self$39772;(it$0$39771=this);(self$39772=this);var tags$39782;if(((!e$39767)||(!$37414(Error)(e$39767)))){return false;}(tags$39782=(e$39767["::tags"]||[]));var temp$39793;(temp$39793=it$0$39771.tags);var $length$39799;($length$39799=temp$39793.length);var $index$39805;($index$39805=0);$39783:for(;($index$39805<$length$39799);($index$39805++)){var m$39814;(m$39814=temp$39793[$index$39805]);var tag$39822;(tag$39822=m$39814);if((tags$39782.indexOf(tag$39822)===-1)){return false;}else{false;}}return true;});($39622$39628.prototype["::deconstruct"]=function(e$39831){var it$0$39835;var self$39836;(it$0$39835=this);(self$39836=this);return e$39831.args;});$37434($39622$39628,$37434(function(){var accum$39847;(accum$39847=({}));(accum$39847["::name"]="$39622");return accum$39847;}(),function(){var accum$39851;(accum$39851=({}));(accum$39851["::egclass"]=true);return accum$39851;}()));return $39622$39628;}();
var $39602=function(value$39605,url$39606,start$39607,end$39608){var err$39612;(err$39612=$39621(["match"]).create("Could not find a match for value",({"value":value$39605})));if(url$39606){(err$39612["location"]=["location",url$39606,start$39607,end$39608]);}throw err$39612;};
var $39880=function(type$39883){return function(value$39887){var f$39891;(f$39891=type$39883[":::project"]);if((f$39891===(void 0))){(f$39891=type$39883["::project"]);if((f$39891===(void 0))){return [true,type$39883(value$39887)];}else{var rval$39904;(rval$39904=false);try{(rval$39904=[true,f$39891(value$39887)]);}catch(excv$39915){var e$39921;(e$39921=excv$39915);(rval$39904=[false,null]);}return rval$39904;}}else{return f$39891.call(type$39883,value$39887);}};};
var $39927=function($39929$39932,key$39933){var ph$39941;(ph$39941=$39929$39932);var $39935$39947;($39935$39947=ph$39941);var bridge$39937$39952;(bridge$39937$39952=$39935$39947);if(((bridge$39937$39952===null)||(bridge$39937$39952===(void 0)))){return false;}else{var x$39964;if((typeof($39935$39947)==="string")){(x$39964=$39935$39947);return (key$39933 in String.prototype);}else{var x$39969;if((typeof($39935$39947)==="number")){(x$39969=$39935$39947);return (key$39933 in Number.prototype);}else{var x$39974;(x$39974=$39935$39947);return (key$39933 in x$39974);}}}};var accum$39567;var accum$39571;var $37492$37510;var gensym$37511;var $37493$37512;var __lt____gt__$37513;var js_op_table2$37514;var js_op_table$37515;var Translator$37516;var translate$37517;($37492$37510=require("./util"));(gensym$37511=$37492$37510.gensym);($37493$37512=require("./pp"));(__lt____gt__$37513=$37493$37512["<>"]);(js_op_table2$37514=({"+":"+","-":"-","*":"*","/":"/","mod":"%","&.":"&","|.":"|","^.":"^","~":"~","and":"&&","or":"||","not":"!","==":"===","!=":"!==","===":"===","!==":"!==","<":"<",">":">","<=":"<=",">=":">=","<<":"<<",">>":">>",">>>":">>>","in":" in ","instanceof":" instanceof ","++":"++","--":"--"}));(js_op_table$37515=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"===","___neq":"!==","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"}));(Translator$37516=function(){var prelude$37560;var t0$37556;var $37547$37551;var it$0$37542;(it$0$37542=function(){if((!$37414(Translator$37516)(this))){return Object.create(Translator$37516.prototype);}else{return this;}}());($37547$37551=arguments);(t0$37556=$37547$37551.length);if(((t0$37556>=0)&&(t0$37556<=1))){(prelude$37560=function(){if((0>=t0$37556)){return null;}else{return $37547$37551[0];}}());(it$0$37542["cache"]=({}));(it$0$37542["prepend"]=[]);if(prelude$37560){it$0$37542.prepend.push(it$0$37542.translate($37451(prelude$37560),"stmt"));}}else{$39602($37547$37551);}return it$0$37542;});(Translator$37516.prototype["register_value"]=function(v$37584,id$37585){var temp$37616;var name$37625;var $37598$37603;var it$0$37589;var self$37590;(it$0$37589=this);(self$37590=this);($37598$37603=$37433(it$0$37589.cache,id$37585));if(($37598$37603===(void 0))){(temp$37616=["symbol",gensym$37511()]);(it$0$37589.cache[id$37585]=temp$37616);it$0$37589.prepend.push(it$0$37589.translate(["declare",temp$37616,$37451(v$37584)],"stmt"));return temp$37616;}else{(name$37625=$37598$37603);return name$37625;}});(Translator$37516.prototype["register_raw"]=function(raw$37631,id$37632){var temp$37663;var name$37672;var $37645$37650;var it$0$37636;var self$37637;(it$0$37636=this);(self$37637=this);($37645$37650=$37433(it$0$37636.cache,id$37632));if(($37645$37650===(void 0))){(temp$37663=["symbol",gensym$37511()]);(it$0$37636.cache[id$37632]=temp$37663);it$0$37636.prepend.push(it$0$37636.translate(["declare",temp$37663,["raw",raw$37631]],"stmt"));return temp$37663;}else{(name$37672=$37645$37650);return name$37672;}});(Translator$37516.prototype["dump_store"]=function(){var rval$37693;var it$0$37681;var self$37682;(it$0$37681=this);(self$37682=this);(rval$37693=it$0$37681.prepend.join("\n"));(it$0$37681["prepend"]=[]);return rval$37693;});(Translator$37516.prototype["mangle"]=function(name$37704){var i$37731;var tr$37721;var r$37722;var it$0$37708;var self$37709;(it$0$37708=this);(self$37709=this);(tr$37721=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__",":":"__colon__"}));(r$37722=[]);(i$37731=0);$37720:for(;(i$37731<name$37704.length);(++i$37731)){var c$37740;(c$37740=$37433(name$37704,i$37731));r$37722.push(($37433(tr$37721,c$37740)||c$37740));}return r$37722.join("");});(Translator$37516.prototype["body"]=function(orig$37748,mode$37749){var t0$37773;var t1$37774;var t2$37775;var x$37814;var stmts$37825;var ret$37826;var other$37839;var $37765$37802;var b$37770;var trst$37771;var it$0$37753;var self$37754;(it$0$37753=this);(self$37754=this);(t0$37773=$39880(["multi"])(orig$37748));if((t0$37773[0]&&(((t1$37774=t0$37773[1])),(((t2$37775=t1$37774.length)),(t2$37775>=0))))){(b$37770=Array.prototype.slice.call(t1$37774,0));}else{$39602(orig$37748,"/home/olivier/git/earl-grey/src/translate-js.eg",3071,3075);}(trst$37771=function(stmt$37797){return it$0$37753.translate(stmt$37797,"stmt");});($37765$37802=mode$37749);if(($37765$37802==="expr")){(x$37814=["send",["lambda",[],orig$37748],["array"]]);return it$0$37753.translate(x$37814,mode$37749);}else{if(($37765$37802==="return")){(stmts$37825=b$37770.slice(0,-1));(ret$37826=$37433(b$37770,(b$37770.length-1)));return (stmts$37825.map(trst$37771).join("")+it$0$37753.translate(ret$37826,"return"));}else{if(($37765$37802==="stmt")){return b$37770.map(trst$37771).join("");}else{(other$37839=$37765$37802);throw $39621(["syntax","mode"]).create("Unknown mode",({"mode":mode$37749}));}}}});(Translator$37516.prototype["expr"]=function(x$37845,mode$37846){var other$37886;var $37859$37866;var it$0$37850;var self$37851;(it$0$37850=this);(self$37851=this);($37859$37866=mode$37846);if(($37859$37866==="expr")){return x$37845;}else{if(($37859$37866==="stmt")){return (x$37845+";");}else{if(($37859$37866==="return")){return (("return "+x$37845)+";");}else{(other$37886=$37859$37866);throw "OopsI";}}}});(Translator$37516.prototype["op"]=function(op$37892,a$37893,b$37894){var $37916$37930;var $37917$37931;var $37918$37932;var t0$37926;var t1$37927;var t2$37928;var $37912$37921;var e$37909;var it$0$37898;var self$37899;(it$0$37898=this);(self$37899=this);(e$37909=((($37912$37921=[a$37893,b$37894])),function(){if((($37916$37930=($37912$37921 instanceof Array))&&(((t0$37926=$37912$37921.length)),(($37918$37932=(t0$37926===2))&&(((t1$37927=$37912$37921[0])),((t1$37927 instanceof Array)&&(((t2$37928=t1$37927.length)),((t2$37928===1)&&(t1$37927[0]==="void"))))))))){$37912$37921[1];return (op$37892+it$0$37898.translate(b$37894,"expr"));}else{if(($37918$37932&&($37912$37921[0],(((t1$37927=$37912$37921[1])),((t1$37927 instanceof Array)&&(((t2$37928=t1$37927.length)),((t2$37928===1)&&(t1$37927[0]==="void")))))))){return (it$0$37898.translate(a$37893,"expr")+op$37892);}else{$37912$37921;return ((it$0$37898.translate(a$37893,"expr")+op$37892)+it$0$37898.translate(b$37894,"expr"));}}}()));return (("("+e$37909)+")");});(Translator$37516.prototype["translate"]=function(expr$37975,mode$37976){var repl$38101;var it$0$38140;var it$0$38134;var it$0$38128;var it$0$38122;var bridge$38082$38159;var bridge$38081$38152;var other$38174;var id$38168;var bridge$38080$38092;var $38075$38087;var r$38072;var t0$38213;var t0$38220;var trf$38240;var trmsg$38241;var trf$38285;var trmsg$38286;var trf$38300;var trmsg$38301;var otherwise$38295;var $38267$38272;var x$38361;var x$38351;var $38334$38346;var $38335$38347;var $38336$38348;var t0$38344;var $38330$38339;var $index$38401;var $length$38395;var temp$38389;var acc$38383;var trf$38371;var trargs$38372;var op$38327;var code$38440;var code$38454;var t0$38432;var t1$38433;var trf$38461;var trmsg$38462;var codevar$38430;var f$38481;var r$38476;var f$38556;var f$38602;var v$38596;var all_strings$38498;var r$38499;var $index$38689;var $length$38683;var temp$38677;var acc$38671;var a$38656;var b$38657;var name$38649;var a$38753;var b$38754;var other$38748;var $38731$38736;var a$38791;var b$38792;var c$38793;var other$38785;var $38768$38773;var a$38846;var other$38842;var bridge$38821$38830;var $38819$38825;var a$38884;var b$38885;var other$38879;var bridge$38858$38867;var $38856$38862;var a$38913;var b$38914;var c$38915;var a$38934;var b$38935;var $index$39045;var $length$39039;var temp$39033;var acc$39027;var $index$39091;var $length$39085;var temp$39079;var acc$39073;var xs$39019;var $38957$39007;var $38953$39001;var isdecl$38958;var $index$39161;var $length$39155;var temp$39149;var acc$39143;var decls$39135;var f$39194;var r$39189;var other$39316;var $39299$39304;var a$39346;var b$39347;var other$39341;var $39324$39329;var a$39386;var b$39387;var c$39388;var d$39389;var other$39379;var $39362$39367;var a$39432;var b$39433;var c$39434;var other$39426;var $39409$39414;var t0$39478;var t0$39486;var a$39524;var b$39525;var other$39519;var $39502$39507;var other$39553;var t0$39540;var $39496$39535;var r$39499;var other$39562;var x$39557;var attempt$39446;var v$39447;var body$39448;var finally$39449;var x$39404;var y$39405;var body$39406;var x$39356;var y$39357;var z$39358;var body$39359;var test$39320;var body$39321;var label$39285;var body$39286;var value$39280;var value$39275;var value$39270;var label$39255;var label$39240;var value$39235;var args$39184;var vars$39129;var body$39130;var s$39124;var args$39119;var args$38948;var lhs$38927;var rhs$38928;var obj$38894;var msg$38895;var rhs$38896;var binding$38852;var value$38853;var binding$38805;var test$38763;var pos$38764;var neg$38765;var test$38715;var pos$38716;var bindings$38643;var body$38644;var args$38492;var args$38471;var f$38424;var msg$38425;var f$38310;var args$38311;var f$38250;var msg$38251;var s$38252;var f$38204;var msg$38205;var f$38179;var v$38067;var s$38053;var $38028$38047;var $38029$38048;var $38030$38049;var $38031$38050;var t0$38039;var t1$38040;var t2$38041;var t3$38042;var t4$38043;var bridge$37995$38044;var bridge$38025$38045;var $37989$38034;var it$0$37980;var self$37981;(it$0$37980=this);(self$37981=this);($37989$38034=expr$37975);if((($38028$38047=($37989$38034 instanceof Array))&&(((t0$38039=$37989$38034.length)),((t0$38039===2)&&($37989$38034[0]==="symbol"))))){(s$38053=$37989$38034[1]);return it$0$37980.expr(it$0$37980.mangle(s$38053),mode$37976);}else{if(($38028$38047&&((t0$38039===1)&&($37989$38034[0]==="void")))){return it$0$37980.expr("null",mode$37976);}else{if(($38028$38047&&((t0$38039===2)&&($37989$38034[0]==="value")))){(v$38067=$37989$38034[1]);(r$38072=((($38075$38087=v$38067)),function(){if((typeof($38075$38087)==="string")){(repl$38101=({"\"":"\\\"","\n":"\\n","\\":"\\\\"}));(v$38067=v$38067.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m$38109){return $37433(repl$38101,m$38109);}));return (("\""+v$38067)+"\"");}else{if(($38075$38087===(void 0))){return "(void 0)";}else{if($37414(RegExp)($38075$38087)){(it$0$38122=String(v$38067));(it$0$38128=it$0$38122.slice(1,-1));(it$0$38134=it$0$38128.replace(RegExp("/","g"),"\\/"));(it$0$38140=it$0$38134.replace(RegExp("\n","g"),"\\n"));return "/".concat(it$0$38140).concat("/");}else{(bridge$38080$38092=$38075$38087);if(((((bridge$38081$38152=bridge$38080$38092)),((((bridge$38082$38159=bridge$38081$38152)),((typeof(bridge$38082$38159)==="number")||(bridge$38082$38159===true)))||(bridge$38081$38152===false)))||(bridge$38080$38092===null))){return String(v$38067);}else{if(($39927($38075$38087,"::id")&&((id$38168=$38075$38087["::id"]),id$38168))){return it$0$37980.translate(it$0$37980.register_value(v$38067,id$38168),mode$37976);}else{(other$38174=$38075$38087);throw $39621(["cannot_serialize"]).create("Cannot serialize value",({"value":v$38067}));}}}}}}()));return it$0$37980.expr(r$38072,mode$37976);}else{if(($38028$38047&&(($38030$38049=(t0$38039===3))&&(($38031$38050=($37989$38034[0]==="send"))&&(((t1$38040=$37989$38034[1])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&((t1$38040[0]==="variable")&&((t1$38040[1]==="___node")&&(((t3$38042=$37989$38034[2])),((t3$38042 instanceof Array)&&(((t4$38043=t3$38042.length)),((t4$38043===2)&&(t3$38042[0]==="value"))))))))))))))){(f$38179=t3$38042[1]);return f$38179;}else{if(($38031$38050&&(((bridge$37995$38044=$37989$38034[1])),((((bridge$37995$38044 instanceof Array)&&(((t0$38213=bridge$37995$38044.length)),((t0$38213===2)&&((bridge$37995$38044[0]==="symbol")&&(bridge$37995$38044[1]==="___js_fetch")))))||((bridge$37995$38044 instanceof Array)&&(((t0$38220=bridge$37995$38044.length)),((t0$38220===2)&&((bridge$37995$38044[0]==="variable")&&(bridge$37995$38044[1]==="___js_fetch"))))))&&(((t1$38040=$37989$38034[2])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===3)&&(t1$38040[0]==="array"))))))))){(f$38204=t1$38040[1]);(msg$38205=t1$38040[2]);(trf$38240=it$0$37980.translate(f$38204,"expr"));(trmsg$38241=it$0$37980.translate(msg$38205,"expr"));return it$0$37980.expr((((trf$38240+"[")+trmsg$38241)+"]"),mode$37976);}else{if(($38031$38050&&((f$38250=$37989$38034[1]),(((t1$38040=$37989$38034[2])),((msg$38251=t1$38040),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&(t1$38040[0]==="value"))))))))){(s$38252=t1$38040[1]);($38267$38272=null);$38267$38272;if(((typeof(s$38252)==="string")&&s$38252.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)","")))){(trf$38285=it$0$37980.translate(f$38250,"expr"));(trmsg$38286=it$0$37980.translate(["symbol",s$38252],"expr"));return it$0$37980.expr(((trf$38285+".")+trmsg$38286),mode$37976);}else{(otherwise$38295=$38267$38272);(trf$38300=it$0$37980.translate(f$38250,"expr"));(trmsg$38301=it$0$37980.translate(msg$38251,"expr"));return it$0$37980.expr((((trf$38300+"[")+trmsg$38301)+"]"),mode$37976);}}else{if(($38031$38050&&((f$38310=$37989$38034[1]),(((t1$38040=$37989$38034[2])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041>=1)&&(t1$38040[0]==="array")))))))){(args$38311=Array.prototype.slice.call(t1$38040,1));(op$38327=((($38330$38339=f$38310)),function(){if((($38334$38346=($38330$38339 instanceof Array))&&(((t0$38344=$38330$38339.length)),(($38336$38348=(t0$38344===2))&&($38330$38339[0]==="symbol"))))){(x$38351=$38330$38339[1]);return $37433(js_op_table$37515,x$38351);}else{if(($38336$38348&&($38330$38339[0]==="variable"))){(x$38361=$38330$38339[1]);return $37433(js_op_table2$37514,x$38361);}else{$38330$38339;return null;}}}()));if(op$38327){return it$0$37980.expr(it$0$37980.op(op$38327,args$38311[0],args$38311[1]),mode$37976);}else{(trf$38371=it$0$37980.translate(f$38310,"expr"));(trargs$38372=(((acc$38383=[])),(((temp$38389=args$38311)),((($length$38395=temp$38389.length)),((($index$38401=0)),function(){$38378:for(;($index$38401<$length$38395);($index$38401++)){var x$38418;var m$38410;(m$38410=temp$38389[$index$38401]);(x$38418=m$38410);acc$38383.push(it$0$37980.translate(x$38418,"expr"));}}()))),acc$38383));return it$0$37980.expr((((trf$38371+"(")+trargs$38372.join(","))+")"),mode$37976);}}else{if($38031$38050){(f$38424=$37989$38034[1]);(msg$38425=$37989$38034[2]);(t0$38432=(((code$38440="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37980.register_raw(code$38440,"~send")));if(((t0$38432 instanceof Array)&&(((t1$38433=t0$38432.length)),((t1$38433===2)&&(t0$38432[0]==="symbol"))))){(codevar$38430=t0$38432[1]);}else{$39602((((code$38454="(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}})")),it$0$37980.register_raw(code$38454,"~send")),"/home/olivier/git/earl-grey/src/translate-js.eg",6698,6908);}(trf$38461=it$0$37980.translate(f$38424,"expr"));(trmsg$38462=it$0$37980.translate(msg$38425,"expr"));return it$0$37980.expr((((((codevar$38430+"(")+trf$38461)+",")+trmsg$38462)+")"),mode$37976);}else{if(($38028$38047&&(($38030$38049=(t0$38039>=1))&&($37989$38034[0]==="array")))){(args$38471=Array.prototype.slice.call($37989$38034,1));(r$38476=(((f$38481=function(x$38486){return it$0$37980.translate(x$38486,"expr");})),(("["+args$38471.map(f$38481).join(","))+"]")));return it$0$37980.expr(r$38476,mode$37976);}else{if(($38030$38049&&($37989$38034[0]==="object"))){(args$38492=Array.prototype.slice.call($37989$38034,1));(all_strings$38498=args$38492.every(function($38503$38506){var t0$38514;var t1$38515;var other$38549;var v$38539;var t0$38535;var $38508$38530;var ph$38511;var y$38512;(t0$38514=$38503$38506);if(((t0$38514 instanceof Array)&&(((t1$38515=t0$38514.length)),((t1$38515===3)&&(t0$38514[0]==="array"))))){(ph$38511=t0$38514[1]);(y$38512=t0$38514[2]);}else{$39602($38503$38506);}($38508$38530=ph$38511);if((($38508$38530 instanceof Array)&&(((t0$38535=$38508$38530.length)),((t0$38535===2)&&($38508$38530[0]==="value"))))){(v$38539=$38508$38530[1]);return true;}else{(other$38549=$38508$38530);return false;}}));(r$38499=function(){if(all_strings$38498){(f$38556=function($38560$38563){var t0$38568;var t1$38569;var a$38585;var b$38586;var x$38565;var y$38566;(t0$38568=$38560$38563);if(((t0$38568 instanceof Array)&&(((t1$38569=t0$38568.length)),((t1$38569===3)&&(t0$38568[0]==="array"))))){(x$38565=t0$38568[1]);(y$38566=t0$38568[2]);}else{$39602($38560$38563);}(a$38585=it$0$37980.translate(x$38565,"expr"));(b$38586=it$0$37980.translate(y$38566,"expr"));return ((a$38585+":")+b$38586);});return (("({"+args$38492.map(f$38556).join(","))+"})");}else{(v$38596=gensym$37511());(f$38602=function($38606$38609){var t0$38614;var t1$38615;var a$38631;var b$38632;var x$38611;var y$38612;(t0$38614=$38606$38609);if(((t0$38614 instanceof Array)&&(((t1$38615=t0$38614.length)),((t1$38615===3)&&(t0$38614[0]==="array"))))){(x$38611=t0$38614[1]);(y$38612=t0$38614[2]);}else{$39602($38606$38609);}(a$38631=it$0$37980.translate(x$38611,"expr"));(b$38632=it$0$37980.translate(y$38612,"expr"));return (((((v$38596+"[")+a$38631)+"]=")+b$38632)+";");});return ((((((("(function(){"+"var ")+v$38596)+"={};")+args$38492.map(f$38602).join(""))+";return ")+v$38596)+";}())");}}());return it$0$37980.expr(r$38499,mode$37976);}else{if(($38028$38047&&((t0$38039===3)&&($37989$38034[0]==="lambda")))){(bindings$38643=$37989$38034[1]);(body$38644=$37989$38034[2]);(name$38649=function(){if($37414(RegExp("^[$_a-zA-Z]*$",""))(expr$37975.name)){return (expr$37975.name+" ");}else{return "";}}());(a$38656=(((acc$38671=[])),(((temp$38677=bindings$38643)),((($length$38683=temp$38677.length)),((($index$38689=0)),function(){$38666:for(;($index$38689<$length$38683);($index$38689++)){var x$38706;var m$38698;(m$38698=temp$38677[$index$38689]);(x$38706=m$38698);acc$38671.push(it$0$37980.translate(x$38706,"expr"));}}()))),acc$38671).join(","));(b$38657=it$0$37980.body(body$38644,"return"));return it$0$37980.expr((((((("function"+name$38649)+"(")+a$38656)+"){")+b$38657)+"}"),mode$37976);}else{if(($38028$38047&&(($38030$38049=(t0$38039===4))&&(($38031$38050=($37989$38034[0]==="if"))&&((test$38715=$37989$38034[1]),((pos$38716=$37989$38034[2]),(((t1$38040=$37989$38034[3])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&((t1$38040[0]==="value")&&(t1$38040[1]===(void 0))))))))))))){($38731$38736=mode$37976);if(($38731$38736==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$38748=$38731$38736);(a$38753=it$0$37980.translate(test$38715,"expr"));(b$38754=it$0$37980.translate(pos$38716,mode$37976));return (((("if("+a$38753)+"){")+b$38754)+"}");}}else{if($38031$38050){(test$38763=$37989$38034[1]);(pos$38764=$37989$38034[2]);(neg$38765=$37989$38034[3]);($38768$38773=mode$37976);if(($38768$38773==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$38785=$38768$38773);(a$38791=it$0$37980.translate(test$38763,"expr"));(b$38792=it$0$37980.translate(pos$38764,mode$37976));(c$38793=it$0$37980.translate(neg$38765,mode$37976));return (((((("if("+a$38791)+"){")+b$38792)+"}else{")+c$38793)+"}");}}else{if(($38028$38047&&(($38030$38049=(t0$38039===3))&&(($38031$38050=($37989$38034[0]==="declare"))&&((binding$38805=$37989$38034[1]),(((t1$38040=$37989$38034[2])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&((t1$38040[0]==="value")&&(t1$38040[1]===(void 0)))))))))))){($38819$38825=mode$37976);(bridge$38821$38830=$38819$38825);if(((bridge$38821$38830==="expr")||(bridge$38821$38830==="return"))){throw "Invalid in expr ctx";}else{(other$38842=$38819$38825);(a$38846=it$0$37980.translate(binding$38805,"expr"));return (("var "+a$38846)+";");}}else{if($38031$38050){(binding$38852=$37989$38034[1]);(value$38853=$37989$38034[2]);($38856$38862=mode$37976);(bridge$38858$38867=$38856$38862);if(((bridge$38858$38867==="expr")||(bridge$38858$38867==="return"))){throw "Invalid in expr ctx";}else{(other$38879=$38856$38862);(a$38884=it$0$37980.translate(binding$38852,"expr"));(b$38885=it$0$37980.translate(value$38853,"expr"));return (((("var "+a$38884)+"=")+b$38885)+";");}}else{if(($38030$38049&&(($38031$38050=($37989$38034[0]==="assign"))&&(((t1$38040=$37989$38034[1])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===3)&&(t1$38040[0]==="send")))))))){(obj$38894=t1$38040[1]);(msg$38895=t1$38040[2]);(rhs$38896=$37989$38034[2]);(a$38913=it$0$37980.translate(obj$38894,"expr"));(b$38914=it$0$37980.translate(msg$38895,"expr"));(c$38915=it$0$37980.translate(rhs$38896,"expr"));return it$0$37980.expr((((((("("+a$38913)+"[")+b$38914)+"]=")+c$38915)+")"),mode$37976);}else{if($38031$38050){(lhs$38927=$37989$38034[1]);(rhs$38928=$37989$38034[2]);(a$38934=it$0$37980.translate(lhs$38927,"expr"));(b$38935=it$0$37980.translate(rhs$38928,"expr"));return it$0$37980.expr((((("("+a$38934)+"=")+b$38935)+")"),mode$37976);}else{if(($38028$38047&&((t0$38039===1)&&($37989$38034[0]==="multi")))){return "";}else{if(($38028$38047&&(($38030$38049=(t0$38039>=1))&&($37989$38034[0]==="multi")))){(args$38948=Array.prototype.slice.call($37989$38034,1));(isdecl$38958=function($38962$38965){var other$38996;var variable$38985;var value$38986;var t0$38981;var $38967$38976;var ph$38970;(ph$38970=$38962$38965);($38967$38976=ph$38970);if((($38967$38976 instanceof Array)&&(((t0$38981=$38967$38976.length)),((t0$38981===3)&&($38967$38976[0]==="declare"))))){(variable$38985=$38967$38976[1]);(value$38986=$38967$38976[2]);return true;}else{(other$38996=$38967$38976);return false;}});($38953$39001=null);$38953$39001;if((args$38948.length===1)){return it$0$37980.translate(args$38948[0],mode$37976);}else{if(((mode$37976==="expr")&&(!args$38948.some(isdecl$38958)))){(xs$39019=(((acc$39027=[])),(((temp$39033=args$38948)),((($length$39039=temp$39033.length)),((($index$39045=0)),function(){$39022:for(;($index$39045<$length$39039);($index$39045++)){var x$39062;var m$39054;(m$39054=temp$39033[$index$39045]);(x$39062=m$39054);acc$39027.push(it$0$37980.translate(x$39062,"expr"));}}()))),acc$39027));(xs$39019=(((acc$39073=[])),(((temp$39079=xs$39019)),((($length$39085=temp$39079.length)),((($index$39091=0)),function(){$39068:for(;($index$39091<$length$39085);($index$39091++)){var x$39108;var m$39100;(m$39100=temp$39079[$index$39091]);(x$39108=m$39100);if((x$39108!=="")){acc$39073.push(x$39108);}else{false;}}}()))),acc$39073));return (("("+xs$39019.join(","))+")");}else{return it$0$37980.body(expr$37975,mode$37976);}}}else{if(($38030$38049&&($37989$38034[0]==="splice"))){(args$39119=Array.prototype.slice.call($37989$38034,1));return it$0$37980.translate(["multi"].concat(args$39119),mode$37976);}else{if(($38028$38047&&((t0$38039===2)&&($37989$38034[0]==="variable")))){(s$39124=$37989$38034[1]);return it$0$37980.expr(it$0$37980.mangle(s$39124),mode$37976);}else{if(($38028$38047&&((t0$38039===3)&&($37989$38034[0]==="scope")))){(vars$39129=$37989$38034[1]);(body$39130=$37989$38034[2]);(decls$39135=(((acc$39143=[])),(((temp$39149=vars$39129)),((($length$39155=temp$39149.length)),((($index$39161=0)),function(){$39138:for(;($index$39161<$length$39155);($index$39161++)){var v$39178;var m$39170;(m$39170=temp$39149[$index$39161]);(v$39178=m$39170);acc$39143.push(["declare",v$39178,["value",(void 0)]]);}}()))),acc$39143));return it$0$37980.translate(["multi"].concat(decls$39135).concat([body$39130]),mode$37976);}else{if(($38028$38047&&((t0$38039>=1)&&($37989$38034[0]==="object2")))){(args$39184=Array.prototype.slice.call($37989$38034,1));(r$39189=(((f$39194=function($39198$39201){var t0$39206;var t1$39207;var a$39223;var b$39224;var x$39203;var y$39204;(t0$39206=$39198$39201);if(((t0$39206 instanceof Array)&&(((t1$39207=t0$39206.length)),(t1$39207===2)))){(x$39203=t0$39206[0]);(y$39204=t0$39206[1]);}else{$39602($39198$39201);}(a$39223=it$0$37980.translate(x$39203,"expr"));(b$39224=it$0$37980.translate(y$39204,"expr"));return ((a$39223+":")+b$39224);})),(("({"+args$39184.map(f$39194).join(","))+"})")));return it$0$37980.expr(r$39189,mode$37976);}else{if(($38028$38047&&((t0$38039===2)&&($37989$38034[0]==="js_new")))){(value$39235=$37989$38034[1]);return it$0$37980.expr((("(new "+it$0$37980.translate(value$39235,"expr"))+")"),mode$37976);}else{if(($38028$38047&&(($38030$38049=((t0$38039>=1)&&(t0$38039<=2)))&&(($37989$38034[0]==="js_break")&&(((t1$38040=function(){if((1>=t0$38039)){return ["value",null];}else{return $37989$38034[1];}}())),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&(t1$38040[0]==="value"))))))))){(label$39240=t1$38040[1]);if((mode$37976==="expr")){throw "Invalid break in ctx";}else{return (("break"+function(){if(label$39240){return (" "+label$39240);}else{return "";}}())+";");}}else{if(($38030$38049&&(($37989$38034[0]==="js_continue")&&(((t1$38040=function(){if((1>=t0$38039)){return ["value",null];}else{return $37989$38034[1];}}())),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&(t1$38040[0]==="value")))))))){(label$39255=t1$38040[1]);if((mode$37976==="expr")){throw "Invalid continue in ctx";}else{return (("continue"+function(){if(label$39255){return (" "+label$39255);}else{return "";}}())+";");}}else{if(($38028$38047&&(($38030$38049=(t0$38039===2))&&($37989$38034[0]==="js_return")))){(value$39270=$37989$38034[1]);if((mode$37976==="expr")){throw "Invalid return in ctx";}else{return (("return "+it$0$37980.translate(value$39270,"expr"))+";");}}else{if(($38030$38049&&($37989$38034[0]==="js_delete"))){(value$39275=$37989$38034[1]);if((mode$37976==="expr")){throw "Invalid delete in ctx";}else{return (("delete "+it$0$37980.translate(value$39275,"expr"))+";");}}else{if(($38030$38049&&($37989$38034[0]==="js_throw"))){(value$39280=$37989$38034[1]);if((mode$37976==="expr")){return (("function(){throw "+it$0$37980.translate(value$39280,"expr"))+";}()");}else{return (("throw "+it$0$37980.translate(value$39280,"expr"))+";");}}else{if(($38028$38047&&(($38030$38049=(t0$38039===3))&&(($37989$38034[0]==="js_label")&&(((t1$38040=$37989$38034[1])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===2)&&(t1$38040[0]==="value"))))))))){(label$39285=t1$38040[1]);(body$39286=$37989$38034[2]);($39299$39304=mode$37976);if(($39299$39304==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$39316=$39299$39304);return ((label$39285+":")+it$0$37980.translate(body$39286,other$39316));}}else{if(($38030$38049&&($37989$38034[0]==="js_while"))){(test$39320=$37989$38034[1]);(body$39321=$37989$38034[2]);($39324$39329=mode$37976);if(($39324$39329==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$39341=$39324$39329);(a$39346=it$0$37980.translate(test$39320,"expr"));(b$39347=it$0$37980.translate(body$39321,"stmt"));return (((("while("+a$39346)+"){")+b$39347)+"}");}}else{if(($38028$38047&&((t0$38039===5)&&($37989$38034[0]==="js_for")))){(x$39356=$37989$38034[1]);(y$39357=$37989$38034[2]);(z$39358=$37989$38034[3]);(body$39359=$37989$38034[4]);($39362$39367=mode$37976);if(($39362$39367==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$39379=$39362$39367);(a$39386=it$0$37980.translate(x$39356,"expr"));(b$39387=it$0$37980.translate(y$39357,"expr"));(c$39388=it$0$37980.translate(z$39358,"expr"));(d$39389=it$0$37980.translate(body$39359,"stmt"));return (((((((("for("+a$39386)+";")+b$39387)+";")+c$39388)+"){")+d$39389)+"}");}}else{if(($38028$38047&&(($38030$38049=(t0$38039===4))&&($37989$38034[0]==="js_for_in")))){(x$39404=$37989$38034[1]);(y$39405=$37989$38034[2]);(body$39406=$37989$38034[3]);($39409$39414=mode$37976);if(($39409$39414==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$39426=$39409$39414);(a$39432=it$0$37980.translate(x$39404,"expr"));(b$39433=it$0$37980.translate(y$39405,"expr"));(c$39434=it$0$37980.translate(body$39406,"stmt"));return (((((("for("+a$39432)+" in ")+b$39433)+"){")+c$39434)+"}");}}else{if(($38030$38049&&(($37989$38034[0]==="js_try")&&((attempt$39446=$37989$38034[1]),(((t1$38040=$37989$38034[2])),((t1$38040 instanceof Array)&&(((t2$38041=t1$38040.length)),((t2$38041===3)&&((t1$38040[0]==="lambda")&&(((t3$38042=t1$38040[1])),((t3$38042 instanceof Array)&&(((t4$38043=t3$38042.length)),((t4$38043===1)&&(((bridge$38025$38045=t3$38042[0])),(((bridge$38025$38045 instanceof Array)&&(((t0$39478=bridge$38025$38045.length)),((t0$39478===2)&&((bridge$38025$38045[0]==="symbol")&&((v$39447=bridge$38025$38045[1]),true)))))||((bridge$38025$38045 instanceof Array)&&(((t0$39486=bridge$38025$38045.length)),((t0$39486===2)&&((bridge$38025$38045[0]==="variable")&&((v$39447=bridge$38025$38045[1]),true)))))))))))))))))))){(body$39448=t1$38040[2]);(finally$39449=$37989$38034[3]);(r$39499=((($39502$39507=mode$37976)),function(){if(($39502$39507==="expr")){return it$0$37980.body(expr$37975,"expr");}else{(other$39519=$39502$39507);(a$39524=it$0$37980.translate(attempt$39446,"stmt"));(b$39525=it$0$37980.translate(body$39448,"stmt"));return (((((("try{"+a$39524)+"}catch(")+v$39447)+"){")+b$39525)+"}");}}()));($39496$39535=finally$39449);if((($39496$39535 instanceof Array)&&(((t0$39540=$39496$39535.length)),((t0$39540===1)&&($39496$39535[0]==="void"))))){return r$39499;}else{(other$39553=$39496$39535);return (((r$39499+"finally{")+it$0$37980.translate(other$39553,"stmt"))+"}");}}else{if(($38028$38047&&((t0$38039===2)&&($37989$38034[0]==="raw")))){(x$39557=$37989$38034[1]);return x$39557;}else{(other$39562=$37989$38034);throw other$39562;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}});$37434(Translator$37516,$37434(((accum$39567=({})),((accum$39567["::name"]="Translator"),accum$39567)),((accum$39571=({})),((accum$39571["::egclass"]=true),accum$39571))));Translator$37516;(translate$37517=function(expr$39578,mode$39579){var tr$39584;var t$39585;(tr$39584=Translator$37516());(t$39585=tr$39584.translate(expr$39578,mode$39579));return (tr$39584.dump_store()+t$39585);});(exports["Translator"]=Translator$37516);(exports["translate"]=translate$37517);
