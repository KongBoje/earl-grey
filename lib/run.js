var $22836=function(type$22839){var f$22843;(f$22843=type$22839["::check"]);if((f$22843===(void 0))){return function(value$22849){return (value$22849 instanceof type$22839);};}else{return function(value$22853){return f$22843.call(type$22839,value$22853);};}};
var $22855=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $22856=function(dest$22859,values$22860){var k$22865;(k$22865=null);$22863:for(k$22865 in values$22860){if(values$22860.hasOwnProperty(k$22865)){(dest$22859[k$22865]=values$22860[k$22865]);}}return dest$22859;};
var $22873=function($22875$22878){var ph$22884;(ph$22884=$22875$22878);var $22880$22890;($22880$22890=ph$22884);var bridge$22882$22895;var x$22899;(bridge$22882$22895=$22880$22890);if((((typeof(bridge$22882$22895)==="string")&&((x$22899=bridge$22882$22895),true))||((typeof(bridge$22882$22895)==="number")&&((x$22899=bridge$22882$22895),true)))){return ["value",x$22899];}else{var other$22910;(other$22910=$22880$22890);return other$22910["::serialize_ast"]();}};
var send$22610;(send$22610=function(obj$22617,$22614$22618){var ph$22624;var msg$22625;var t0$22627;(t0$22627=$22614$22618);(msg$22625=t0$22627);(ph$22624=t0$22627);var $22620$22636;($22620$22636=ph$22624);var bridge$22622$22641;(bridge$22622$22641=$22620$22636);if(((typeof(bridge$22622$22641)==="string")||(typeof(bridge$22622$22641)==="number"))){return obj$22617[msg$22625];}else{var other$22653;(other$22653=$22620$22636);return obj$22617["::send"](msg$22625);}});(Array[":::project"]=function($22659$22662){var ph$22667;var value$22668;var t0$22670;(t0$22670=$22659$22662);(value$22668=t0$22670);(ph$22667=t0$22670);var $22664$22679;($22664$22679=ph$22667);if($22836(Array)($22664$22679)){return [true,value$22668];}else{$22664$22679;return [true,[value$22668]];}});(Array.prototype["::check"]=function(value$22697){if((value$22697 instanceof Array)){var i$22703;(i$22703=0);$22700:for(;(i$22703<this.length);(i$22703++)){if(($22855(this,i$22703)!==$22855(value$22697,i$22703))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $22856(this.slice(0),this);});(Array.prototype[":::project"]=function(value$22722){if((value$22722 instanceof Array)){var i$22728;(i$22728=0);$22725:for(;(i$22728<this.length);(i$22728++)){if(($22855(this,i$22728)!==$22855(value$22722,i$22728))){return [true,[value$22722]];}}return [true,value$22722.slice(this.length)];}else{return [true,[value$22722]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($22873));});(RegExp.prototype["::check"]=function($22746$22749){var ph$22754;(ph$22754=$22746$22749);var $22751$22760;($22751$22760=ph$22754);var value$22768;if((typeof($22751$22760)==="string")){(value$22768=$22751$22760);if(value$22768.match(this)){return true;}else{return false;}}else{var other$22773;(other$22773=$22751$22760);return false;}});(RegExp.prototype[":::project"]=function($22779$22782){var ph$22787;(ph$22787=$22779$22782);var $22784$22793;($22784$22793=ph$22787);var value$22801;if((typeof($22784$22793)==="string")){(value$22801=$22784$22793);var $22804$22809;($22804$22809=value$22801.match(this));var m$22817;if(($22804$22809===null)){(m$22817=$22804$22809);return [false,null];}else{var m$22822;(m$22822=$22804$22809);return [true,m$22822];}}else{var other$22826;(other$22826=$22784$22793);return [false,null];}});(Function.prototype["::send"]=function(args$22833){return this.apply(this,args$22833);});
var $24605=function(type$24608){return function(value$24612){var f$24616;(f$24616=type$24608[":::project"]);if((f$24616===(void 0))){(f$24616=type$24608["::project"]);if((f$24616===(void 0))){return [true,type$24608(value$24612)];}else{var rval$24629;(rval$24629=false);try{(rval$24629=[true,f$24616(value$24612)]);}catch(excv$24640){var e$24646;(e$24646=excv$24640);(rval$24629=[false,null]);}return rval$24629;}}else{return f$24616.call(type$24608,value$24612);}};};
var $24736=function($24738$24741,key$24742){var ph$24750;(ph$24750=$24738$24741);var $24744$24756;($24744$24756=ph$24750);var bridge$24746$24761;(bridge$24746$24761=$24744$24756);if(((bridge$24746$24761===null)||(bridge$24746$24761===(void 0)))){return false;}else{var x$24773;if((typeof($24744$24756)==="string")){(x$24773=$24744$24756);return (key$24742 in String.prototype);}else{var x$24778;if((typeof($24744$24756)==="number")){(x$24778=$24744$24756);return (key$24742 in Number.prototype);}else{var x$24783;(x$24783=$24744$24756);return (key$24742 in x$24783);}}}};
var $25018=function(arr$25021){var results$25027;var l$25028;(results$25027=[]);(l$25028=arr$25021.length);var i$25037;(i$25037=0);$25026:for(;(i$25037<l$25028);(i$25037++)){results$25027.push([i$25037,$22855(arr$25021,i$25037)]);}return results$25027;};
var $25044=function(value$25047,url$25048,start$25049,end$25050){var err$25054;(err$25054=$24785(["match"]).create("Could not find a match for value",({"value":value$25047})));if(url$25048){(err$25054["location"]=["location",url$25048,start$25049,end$25050]);}throw err$25054;};
var $24785=function(){var $24786$24792;($24786$24792=function(tags$24797){var it$0$24800;(it$0$24800=function(){if((!$22836($24786$24792)(this))){return Object.create($24786$24792.prototype);}else{return this;}}());(it$0$24800["tags"]=tags$24797);return it$0$24800;});($24786$24792.prototype["create"]=function(){var it$0$24820;var self$24821;(it$0$24820=this);(self$24821=this);var $24818$24830;($24818$24830=arguments);var t0$24835;var message$24839;var args$24840;(t0$24835=$24818$24830.length);if((t0$24835>=0)){(message$24839=function(){if((0>=t0$24835)){return "";}else{return $24818$24830[0];}}());(args$24840=Array.prototype.slice.call($24818$24830,1));var e$24853;(e$24853=Error(message$24839));(e$24853["::tags"]=it$0$24820.tags);(e$24853["args"]=args$24840);var temp$24869;(temp$24869=$25018(args$24840));var $length$24875;($length$24875=temp$24869.length);var $index$24881;($index$24881=0);$24854:for(;($index$24881<$length$24875);($index$24881++)){var m$24890;(m$24890=temp$24869[$index$24881]);var t0$24895;var t1$24896;var i$24900;var arg$24901;(t0$24895=m$24890);if(((t0$24895 instanceof Array)&&(((t1$24896=t0$24895.length)),(t1$24896===2)))){(i$24900=t0$24895[0]);(arg$24901=t0$24895[1]);(e$24853[i$24900]=arg$24901);}else{$25044(m$24890);}}(e$24853["length"]=args$24840.length);(e$24853["name"]=["E"].concat(it$0$24820.tags).join("."));return e$24853;}else{$25044($24818$24830);}});($24786$24792.prototype["::check"]=function(e$24931){var it$0$24935;var self$24936;(it$0$24935=this);(self$24936=this);var tags$24946;if(((!e$24931)||(!$22836(Error)(e$24931)))){return false;}(tags$24946=(e$24931["::tags"]||[]));var temp$24957;(temp$24957=it$0$24935.tags);var $length$24963;($length$24963=temp$24957.length);var $index$24969;($index$24969=0);$24947:for(;($index$24969<$length$24963);($index$24969++)){var m$24978;(m$24978=temp$24957[$index$24969]);var tag$24986;(tag$24986=m$24978);if((tags$24946.indexOf(tag$24986)===-1)){return false;}else{false;}}return true;});($24786$24792.prototype["::deconstruct"]=function(e$24995){var it$0$24999;var self$25000;(it$0$24999=this);(self$25000=this);return e$24995.args;});$22856($24786$24792,$22856(function(){var accum$25011;(accum$25011=({}));(accum$25011["::name"]="$24786");return accum$25011;}(),function(){var accum$25015;(accum$25015=({}));(accum$25015["::egclass"]=true);return accum$25015;}()));return $24786$24792;}();
var $24652=function($24654$24657){var ph$24667;var x$24668;var t0$24670;(t0$24670=$24654$24657);(x$24668=t0$24670);(ph$24667=t0$24670);var $24659$24679;($24659$24679=ph$24667);var bridge$24661$24684;(bridge$24661$24684=$24659$24679);if((function(){var bridge$24662$24694;(bridge$24662$24694=bridge$24661$24684);return (function(){var bridge$24663$24701;(bridge$24663$24701=bridge$24662$24694);return ((bridge$24663$24701===(void 0))||(bridge$24663$24701===null));}()||(typeof(bridge$24662$24694)==="string"));}()||(typeof(bridge$24661$24684)==="number"))){return x$24668;}else{if($24736($24659$24679,"::clone")){$24659$24679["::clone"];return x$24668["::clone"]();}else{$24659$24679;if((Object.getPrototypeOf(x$24668)===Object.prototype)){var dest$24719;(dest$24719=({}));var k$24724;(k$24724=null);$24718:for(k$24724 in x$24668){if(Object.prototype.hasOwnProperty.call(x$24668,k$24724)){(dest$24719[k$24724]=x$24668[k$24724]);}}return dest$24719;}else{var other$24734;(other$24734=$24659$24679);throw $24785(["clone"]).create("Object cannot be cloned",({"obj":x$24668}));}}}};var eg$22935;var $22915$22936;var __lt____gt__$22937;var $22916$22938;var Source$22939;var display_error$22940;var fs$22941;var path$22942;var usage$22943;var usage_error$22944;var extract_options$22945;var walk$22946;var copy$22947;var gen$22948;var interactive$22949;var compile_path$22950;var run$22951;var _run$22952;(eg$22935=require("./earl-grey"));($22915$22936=require("./pp"));(__lt____gt__$22937=$22915$22936["<>"]);($22916$22938=require("./location"));(Source$22939=$22916$22938.Source);(display_error$22940=$22916$22938.display_error);(fs$22941=require("fs"));(path$22942=require("path"));(usage$22943="Usage: earl [global options] command [options] [arguments...]\n\nearl run [options] [file] [arguments...]\n  Run the specified file as a script. The arguments are available in\n  process.argv.slice{2} of the script.\n  Options:\n    -e  --eval <code>  Run the provided code instead of reading from a file.\n    -p  --print        Print the result of the evaluation to standard out.\n    -i  --interactive  Start an interactive interpreter after execution\n                       in the global environment of the script.\n\nearl compile [options] [file... | dir]\n  Compile the specified source files into .js files. The files will be\n  placed next to the originals.\n  If a directory is given, all .eg files in the directory hierarchy\n  will be compiled. The -o option can be used to compile the files\n  into a different directory (all non-eg files will be copied over).\n  Options:\n    -o  --output <dir>  Output in given directory.\n    -p  --print         Print the compiled JavaScript to standard out.\n                        No files are created.\n    -e  --eval <code>   Compile the provided code instead of reading from a file.\n    -n  --noboil        Don't produce boilerplate code (useful with -p)\n\nearl\n  Start an interactive session.\n\nGlobal options:\n  -h  --help      Print this message.\n  -v  --version   Print the version\n");(usage_error$22944=function(message$22984){console.error(usage$22943);console.error(message$22984);return process.exit(1);});(extract_options$22945=function($22991$22994,opttable$22995,optmessage$22996){var t0$23000;var results$23012;var associate$23013;var process_option$23014;var argv$22998;(t0$23000=$24605($24652)($22991$22994));if(t0$23000[0]){(argv$22998=t0$23000[1]);}else{$25044($22991$22994);}(results$23012=({}));(associate$23013=null);(process_option$23014=function(original$23025,opt$23026,last$23027){var name$23081;var name$23071;var name$23057;var $23034$23047;var $23035$23048;var $23036$23049;var $23037$23050;var t0$23045;var $23029$23040;($23029$23040=$22855(opttable$22995,opt$23026));if(($23029$23040===(void 0))){return usage_error$22944(((("Unrecognized "+optmessage$22996)+": ")+original$23025));}else{if((($23034$23047=($23029$23040 instanceof Array))&&(((t0$23045=$23029$23040.length)),(($23036$23049=(t0$23045===2))&&($23029$23040[0]==="flag"))))){(name$23057=$23029$23040[1]);(results$23012[name$23057]=true);}else{if(($23036$23049&&(($23037$23050=($23029$23040[0]==="value"))&&((name$23071=$23029$23040[1]),last$23027)))){(associate$23013=name$23071);}else{if($23037$23050){(name$23081=$23029$23040[1]);(results$23012[name$23081]=true);}else{$25044($23029$23040);}}}}});$23091:while(argv$22998.length){var $index$23208;var $length$23202;var temp$23196;var acc$23190;var other$23250;var other$23236;var opts$23167;var opt$23148;var opt$23119;var value$23120;var t0$23113;var t1$23114;var t2$23115;var $23096$23108;var arg$23102;(arg$23102=argv$22998.shift());($23096$23108=arg$23102);(t0$23113=$24605(RegExp("^--([a-zA-Z_\\-]+)=(.*)",""))($23096$23108));if((t0$23113[0]&&(((t1$23114=t0$23113[1])),(((t2$23115=t1$23114.length)),(t2$23115===3))))){t1$23114[0];(opt$23119=t1$23114[1]);(value$23120=t1$23114[2]);process_option$23014(arg$23102,opt$23119,true);(results$23012[associate$23013]=value$23120);(associate$23013=null);}else{(t0$23113=$24605(RegExp("^--([a-zA-Z_\\-]+)",""))($23096$23108));if((t0$23113[0]&&(((t1$23114=t0$23113[1])),(((t2$23115=t1$23114.length)),(t2$23115===2))))){t1$23114[0];(opt$23148=t1$23114[1]);process_option$23014(arg$23102,opt$23148,true);}else{(t0$23113=$24605(RegExp("^-([a-zA-Z_]+)",""))($23096$23108));if((t0$23113[0]&&(((t1$23114=t0$23113[1])),(((t2$23115=t1$23114.length)),(t2$23115===2))))){t1$23114[0];(opts$23167=t1$23114[1]);(acc$23190=[]);(temp$23196=opts$23167);($length$23202=temp$23196.length);($index$23208=0);$23184:for(;($index$23208<$length$23202);($index$23208++)){var ch$23231;var ch$23225;var m$23217;(m$23217=temp$23196[$index$23208]);(ch$23225=m$23217);if(($index$23208===($length$23202-1))){acc$23190.push(process_option$23014(arg$23102,ch$23225,true));}else{(ch$23231=m$23217);acc$23190.push(process_option$23014(arg$23102,ch$23231));}}acc$23190;}else{(other$23236=$23096$23108);if(associate$23013){(results$23012[associate$23013]=other$23236);(associate$23013=null);}else{(other$23250=$23096$23108);argv$22998.unshift(other$23250);break $23091;}}}}}return [results$23012,argv$22998];});(walk$22946=function(dir$23258,partial$23259,f$23260){var $index$23292;var $length$23286;var temp$23280;var acc$23274;var stats$23264;(stats$23264=fs$22941.statSync(dir$23258));if(stats$23264.isDirectory()){f$23260("dir",partial$23259);(acc$23274=[]);(temp$23280=fs$22941.readdirSync(dir$23258));($length$23286=temp$23280.length);($index$23292=0);$23269:for(;($index$23292<$length$23286);($index$23292++)){var newdir$23315;var newpartial$23316;var file$23309;var m$23301;(m$23301=temp$23280[$index$23292]);(file$23309=m$23301);acc$23274.push((((newdir$23315=path$22942.join(dir$23258,file$23309))),((newpartial$23316=path$22942.join(partial$23259,file$23309))),walk$22946(newdir$23315,newpartial$23316,f$23260)));}return acc$23274;}else{return f$23260("file",partial$23259);}});(copy$22947=function(src$23328,dest$23329){var data$23333;(data$23333=fs$22941.readFileSync(src$23328,"binary"));return fs$22941.writeFileSync(dest$23329,data$23333,"binary");});(gen$22948=function(){var g$23366;var text$23355;var file$23356;var noboil$23357;var t0$23351;var $23342$23346;($23342$23346=arguments);(t0$23351=$23342$23346.length);if(((t0$23351>=2)&&(t0$23351<=3))){(text$23355=$23342$23346[0]);(file$23356=$23342$23346[1]);(noboil$23357=function(){if((2>=t0$23351)){return false;}else{return $23342$23346[2];}}());(g$23366=eg$22935.Generator());return g$23366.generate(Source$22939(text$23355,path$22942.resolve(file$23356)),(!noboil$23357));}else{$25044($23342$23346);}});(interactive$22949=function(g$23377,e$23378){var accum$23398;var repl$23385;var settings$23386;var runner$23387;(repl$23385=require("repl"));(g$23377["interactive"]=true);(settings$23386=$22856(({"prompt":"<> ","ignoreUndefined":true}),((accum$23398=({})),((accum$23398["eval"]=function(input$23403,context$23404,filename$23405,callback$23406){var rval$23442;var execute$23416;var handle$23417;var result$23410;(result$23410=(((execute$23416=function(){var text$23427;(text$23427=g$23377.generate(Source$22939(input$23403.slice(1,-1),"<interactive>")));return e$23378(text$23427);})),((handle$23417=function(e$23436){display_error$22940(e$23436);return (void 0);})),(((rval$23442=false)),(function(){try{(rval$23442=execute$23416());}catch(excv$23453){var e$23459;(e$23459=excv$23453);(rval$23442=handle$23417(e$23459));}}(),rval$23442))));return callback$23406(null,result$23410);}),accum$23398))));(runner$23387=repl$23385.start(settings$23386));return runner$23387.on("exit",function(){return runner$23387.outputStream.write("\n");});});(compile_path$22950=function(p$23478,opts$23479){var out$23506;var $23710$23713;var beaut$23714;var name$23768;var name$23749;var t0$23743;var t1$23744;var t2$23745;var $23733$23738;var noext$23730;var $23687$23704;var $23683$23698;var data$23688;var code$23689;var $23486$23499;var $23483$23493;var stats$23487;(stats$23487=fs$22941.statSync(p$23478));($23483$23493=null);$23483$23493;if(stats$23487.isDirectory()){if(opts$23479.print){usage_error$22944("Cannot use --print when compiling a directory");}(out$23506=(opts$23479.output||p$23478));return walk$22946(p$23478,"/",function(){var rval$23579;var to$23571;var from$23565;var t0$23631;var t1$23632;var x$23625;var name$23626;var from$23627;var to$23628;var data$23629;var from$23665;var to$23666;var f$23660;var results$23612;var t0$23608;var $23518$23604;var d$23552;var $23522$23547;var $23523$23548;var $23524$23549;var t0$23544;var t1$23545;var $23515$23536;var t0$23532;var $23513$23527;($23513$23527=arguments);(t0$23532=$23513$23527.length);if((t0$23532>=0)){($23515$23536=Array.prototype.slice.call($23513$23527,0));(t0$23544=$23515$23536);(t1$23545=t0$23544.length);if((($23524$23549=(t1$23545===2))&&(t0$23544[0]==="dir"))){(d$23552=t0$23544[1]);(from$23565=path$22942.join(p$23478,d$23552));if(opts$23479.output){(to$23571=path$22942.join(out$23506,d$23552));(rval$23579=false);try{(rval$23579=fs$22941.mkdirSync(to$23571));}catch(excv$23590){var e$23596;(e$23596=excv$23590);(rval$23579="ignore error");}return rval$23579;}}else{if(($23524$23549&&(t0$23544[0]==="file"))){($23518$23604=t0$23544[1]);(t0$23608=$24605(RegExp("(?:^((?:.*))\\.eg$)",""))($23518$23604));if((t0$23608[0]&&((results$23612=t0$23608[1]),results$23612))){(t0$23631=results$23612);if(((t0$23631 instanceof Array)&&(((t1$23632=t0$23631.length)),(t1$23632===2)))){(x$23625=t0$23631[0]);(name$23626=t0$23631[1]);}else{$25044(results$23612,"/home/olivier/git/earl-grey/src/run.eg",4519,4526);}(from$23627=path$22942.join(p$23478,x$23625));(to$23628=path$22942.join(out$23506,(name$23626+".js")));(data$23629=fs$22941.readFileSync(from$23627,"utf8"));return fs$22941.writeFileSync(to$23628,(gen$22948(data$23629,from$23627,opts$23479.noboil)+"\n"));}else{$23518$23604;if((!opts$23479.output)){return null;}else{(f$23660=$23518$23604);(from$23665=path$22942.join(p$23478,f$23660));(to$23666=path$22942.join(out$23506,f$23660));return copy$22947(from$23665,to$23666);}}}else{$25044($23515$23536,"/home/olivier/git/earl-grey/src/run.eg",4186,4191);}}}else{$25044($23513$23527);}});}else{(data$23688=fs$22941.readFileSync(p$23478,"utf8"));(code$23689=gen$22948(data$23688,p$23478,opts$23479.noboil));($23683$23698=null);$23683$23698;if(opts$23479.print){($23710$23713=require("js-beautify"));(beaut$23714=$23710$23713.js);return console.log(beaut$23714(code$23689));}else{if(opts$23479.output){return fs$22941.writeFileSync(opts$23479.output,(code$23689+"\n"));}else{(noext$23730=((($23733$23738=p$23478)),(((t0$23743=$24605(RegExp("^(.*).eg$",""))($23733$23738))),function(){if((t0$23743[0]&&(((t1$23744=t0$23743[1])),(((t2$23745=t1$23744.length)),(t2$23745===2))))){t1$23744[0];(name$23749=t1$23744[1]);return name$23749;}else{(name$23768=$23733$23738);return name$23768;}}())));return fs$22941.writeFileSync((noext$23730+".js"),(code$23689+"\n"));}}}});(run$22951=function(argv$23776){var t0$23785;var t1$23786;var rval$23801;var opts$23780;var cmd$23781;(t0$23785=extract_options$22945(argv$23776,({"h":["flag","help"],"help":["flag","help"],"v":["flag","version"],"version":["flag","version"]}),"global option"));if(((t0$23785 instanceof Array)&&(((t1$23786=t0$23785.length)),(t1$23786===2)))){(opts$23780=t0$23785[0]);(cmd$23781=t0$23785[1]);}else{$25044(extract_options$22945(argv$23776,({"h":["flag","help"],"help":["flag","help"],"v":["flag","version"],"version":["flag","version"]}),"global option"),"/home/olivier/git/earl-grey/src/run.eg",5633,5826);}(rval$23801=false);try{(rval$23801=_run$22952(cmd$23781,opts$23780));}catch(excv$23812){var e$23818;(e$23818=excv$23812);(rval$23801=(display_error$22940(e$23818),process.exit(1)));}return rval$23801;});(_run$22952=function($23829$23832,opts$23833){var t0$23884;var t0$23891;var t0$23925;var t1$23926;var data$23980;var file$23971;var $23950$23960;var t0$23958;var $23946$23953;var data$24028;var file$24019;var $23998$24008;var t0$24006;var $23994$24001;var t0$23940;var t1$23941;var o$23915;var rest$23916;var file$23917;var wd$23918;var data$23919;var args$23920;var e$23921;var g$23922;var result$23923;var t0$24066;var t1$24067;var $24100$24113;var $24097$24107;var code$24101;var $index$24172;var $length$24166;var temp$24160;var acc$24154;var paths$24141;var p$24132;var $24061$24089;var $24062$24090;var t0$24087;var $24055$24082;var o$24063;var rest$24064;var data$24400;var $24409$24413;var beaut$24414;var data$24415;var otherwise$24406;var $24212$24229;var $24208$24223;var out$24213;var stats$24214;var $index$24453;var $length$24447;var temp$24441;var acc$24435;var tokens$24591;var walkloc$24481;var stuff$24597;var s$24476;var s$24427;var file$24196;var args$24197;var rawargs$24050;var rawargs$23900;var $23847$23865;var $23848$23866;var $23849$23867;var bridge$23839$23861;var t0$23862;var bridge$23843$23863;var $23835$23856;var ph$23850;(ph$23850=$23829$23832);($23835$23856=ph$23850);$23835$23856;if(opts$23833.help){return console.log(usage$22943);}else{if(opts$23833.version){return console.log("Earl Grey version",eg$22935.version);}else{(bridge$23839$23861=$23835$23856);if((((bridge$23839$23861 instanceof Array)&&(((t0$23884=bridge$23839$23861.length)),(t0$23884===0)))||((bridge$23839$23861 instanceof Array)&&(((t0$23891=bridge$23839$23861.length)),((t0$23891===1)&&(bridge$23839$23861[0]==="run")))))){return _run$22952(["run","-i"],opts$23833);}else{if((($23847$23865=($23835$23856 instanceof Array))&&(((t0$23862=$23835$23856.length)),(($23849$23867=(t0$23862>=1))&&($23835$23856[0]==="run"))))){(rawargs$23900=Array.prototype.slice.call($23835$23856,1));(t0$23925=extract_options$22945(rawargs$23900,({"e":["value","evaluate"],"eval":["value","evaluate"],"p":["flag","print"],"print":["flag","print"],"i":["flag","interactive"],"interactive":["flag","interactive"]}),"option for run"));if(((t0$23925 instanceof Array)&&(((t1$23926=t0$23925.length)),(t1$23926===2)))){(o$23915=t0$23925[0]);(rest$23916=t0$23925[1]);}else{$25044(extract_options$22945(rawargs$23900,({"e":["value","evaluate"],"eval":["value","evaluate"],"p":["flag","print"],"print":["flag","print"],"i":["flag","interactive"],"interactive":["flag","interactive"]}),"option for run"),"/home/olivier/git/earl-grey/src/run.eg",6171,6219);}(t0$23940=function(){if(o$23915.evaluate){return ["<repl>",process.cwd(),o$23915.evaluate,rest$23916];}else{($23946$23953=rest$23916.shift());if((($23950$23960=($23946$23953===(void 0)))&&o$23915.interactive)){return ["<repl>",process.cwd(),"",rest$23916];}else{if($23950$23960){return usage_error$22944("No filename specified.");}else{(t0$23958=$24605(path$22942.resolve)($23946$23953));if(t0$23958[0]){(file$23971=t0$23958[1]);(data$23980=fs$22941.readFileSync(file$23971,"utf8"));return [file$23971,file$23971,data$23980,rest$23916];}else{$25044($23946$23953);}}}}}());if(((t0$23940 instanceof Array)&&(((t1$23941=t0$23940.length)),(t1$23941===4)))){(file$23917=t0$23940[0]);(wd$23918=t0$23940[1]);(data$23919=t0$23940[2]);(args$23920=t0$23940[3]);}else{$25044(function(){if(o$23915.evaluate){return ["<repl>",process.cwd(),o$23915.evaluate,rest$23916];}else{($23994$24001=rest$23916.shift());if((($23998$24008=($23994$24001===(void 0)))&&o$23915.interactive)){return ["<repl>",process.cwd(),"",rest$23916];}else{if($23998$24008){return usage_error$22944("No filename specified.");}else{(t0$24006=$24605(path$22942.resolve)($23994$24001));if(t0$24006[0]){(file$24019=t0$24006[1]);(data$24028=fs$22941.readFileSync(file$24019,"utf8"));return [file$24019,file$24019,data$24028,rest$23916];}else{$25044($23994$24001);}}}}}(),"/home/olivier/git/earl-grey/src/run.eg",6466,6979);}(process["argv"]=["earl-run",file$23917].concat(rest$23916));(e$23921=eg$22935.evaluator(({"filename":file$23917,"showname":file$23917,"cwd":file$23917})));(g$23922=eg$22935.Generator(o$23915.interactive));(result$23923=e$23921(g$23922.generate(Source$22939(data$23919,file$23917))));if(o$23915.print){console.log(result$23923);}if(o$23915.interactive){return interactive$22949(g$23922,e$23921);}}else{if(($23849$23867&&($23835$23856[0]==="compile"))){(rawargs$24050=Array.prototype.slice.call($23835$23856,1));(t0$24066=extract_options$22945(rawargs$24050,({"o":["value","output"],"output":["value","output"],"p":["flag","print"],"print":["flag","print"],"e":["value","evaluate"],"eval":["value","evaluate"],"n":["flag","noboil"],"noboil":["flag","noboil"]}),"option for compile"));if(((t0$24066 instanceof Array)&&(((t1$24067=t0$24066.length)),(t1$24067===2)))){(o$24063=t0$24066[0]);(rest$24064=t0$24066[1]);}else{$25044(extract_options$22945(rawargs$24050,({"o":["value","output"],"output":["value","output"],"p":["flag","print"],"print":["flag","print"],"e":["value","evaluate"],"eval":["value","evaluate"],"n":["flag","noboil"],"noboil":["flag","noboil"]}),"option for compile"),"/home/olivier/git/earl-grey/src/run.eg",7371,7423);}($24055$24082=rest$24064);$24055$24082;if(o$24063.evaluate){(code$24101=gen$22948(o$24063.evaluate,"<cli>",o$24063.noboil));($24097$24107=null);$24097$24107;if(o$24063.output){return fs$22941.writeFileSync(o$24063.output,(code$24101+"\n"));}else{return console.log(code$24101);}}else{if((($24061$24089=($24055$24082 instanceof Array))&&(((t0$24087=$24055$24082.length)),(t0$24087===0)))){return usage_error$22944("Must provide at least one file or directory to compile.");}else{if(($24061$24089&&(t0$24087===1))){(p$24132=$24055$24082[0]);return compile_path$22950(p$24132,o$24063);}else{$24055$24082;if(o$24063.output){return usage_error$22944("The -o option cannot be used if more than one file or directory is compiled.");}else{if((($24055$24082 instanceof Array)&&(((t0$24087=$24055$24082.length)),(t0$24087>=0)))){(paths$24141=Array.prototype.slice.call($24055$24082,0));(acc$24154=[]);(temp$24160=paths$24141);($length$24166=temp$24160.length);($index$24172=0);$24149:for(;($index$24172<$length$24166);($index$24172++)){var p$24189;var m$24181;(m$24181=temp$24160[$index$24172]);(p$24189=m$24181);acc$24154.push(compile_path$22950(p$24189,o$24063));}return acc$24154;}else{$25044($24055$24082);}}}}}}else{if(($23847$23865&&((t0$23862>=2)&&(((bridge$23843$23863=$23835$23856[0])),((bridge$23843$23863==="tr")||(bridge$23843$23863==="translate")))))){(file$24196=$23835$23856[1]);(args$24197=Array.prototype.slice.call($23835$23856,2));(out$24213=args$24197[0]);(stats$24214=fs$22941.statSync(file$24196));($24208$24223=null);$24208$24223;if(stats$24214.isDirectory()){return walk$22946(file$24196,"/",function(){var rval$24300;var from$24288;var to$24289;var t0$24352;var t1$24353;var x$24346;var name$24347;var from$24348;var to$24349;var data$24350;var from$24382;var to$24383;var f$24377;var results$24333;var t0$24329;var $24241$24325;var d$24274;var $24244$24269;var $24245$24270;var $24246$24271;var t0$24266;var t1$24267;var $24238$24258;var t0$24254;var $24236$24249;($24236$24249=arguments);(t0$24254=$24236$24249.length);if((t0$24254>=0)){($24238$24258=Array.prototype.slice.call($24236$24249,0));(t0$24266=$24238$24258);(t1$24267=t0$24266.length);if((($24246$24271=(t1$24267===2))&&(t0$24266[0]==="dir"))){(d$24274=t0$24266[1]);(from$24288=path$22942.join(file$24196,d$24274));(to$24289=path$22942.join(out$24213,d$24274));(rval$24300=false);try{(rval$24300=fs$22941.mkdirSync(to$24289));}catch(excv$24311){var e$24317;(e$24317=excv$24311);(rval$24300="ignore error");}return rval$24300;}else{if(($24246$24271&&(t0$24266[0]==="file"))){($24241$24325=t0$24266[1]);(t0$24329=$24605(RegExp("(?:^((?:.*))\\.eg$)",""))($24241$24325));if((t0$24329[0]&&((results$24333=t0$24329[1]),results$24333))){(t0$24352=results$24333);if(((t0$24352 instanceof Array)&&(((t1$24353=t0$24352.length)),(t1$24353===2)))){(x$24346=t0$24352[0]);(name$24347=t0$24352[1]);}else{$25044(results$24333,"/home/olivier/git/earl-grey/src/run.eg",8864,8871);}(from$24348=path$22942.join(file$24196,x$24346));(to$24349=path$22942.join(out$24213,(name$24347+".js")));(data$24350=fs$22941.readFileSync(from$24348,"utf8"));return fs$22941.writeFileSync(to$24349,(gen$22948(data$24350,from$24348)+"\n"));}else{(f$24377=$24241$24325);(from$24382=path$22942.join(file$24196,f$24377));(to$24383=path$22942.join(out$24213,f$24377));return copy$22947(from$24382,to$24383);}}else{$25044($24238$24258,"/home/olivier/git/earl-grey/src/run.eg",8544,8549);}}}else{$25044($24236$24249);}});}else{if(out$24213){(data$24400=fs$22941.readFileSync(file$24196,"utf8"));return fs$22941.writeFileSync(out$24213,(gen$22948(data$24400,file$24196)+"\n"));}else{(otherwise$24406=$24208$24223);($24409$24413=require("js-beautify"));(beaut$24414=$24409$24413.js);(data$24415=fs$22941.readFileSync(file$24196,"utf8"));return console.log(beaut$24414(gen$22948(data$24415,file$24196)));}}}else{if(($23847$23865&&(($23849$23867=(t0$23862===2))&&($23835$23856[0]==="tok")))){(s$24427=$23835$23856[1]);(acc$24435=[]);(temp$24441=eg$22935.tokenize(Source$22939(s$24427,null)));($length$24447=temp$24441.length);($index$24453=0);$24430:for(;($index$24453<$length$24447);($index$24453++)){var token$24470;var m$24462;(m$24462=temp$24441[$index$24453]);(token$24470=m$24462);acc$24435.push((__lt____gt__$22937(null,token$24470),__lt____gt__$22937(null,token$24470.location.ref()),__lt____gt__$22937(null,token$24470.location.highlight())));}return acc$24435;}else{if(($23849$23867&&($23835$23856[0]==="pa"))){(s$24476=$23835$23856[1]);(walkloc$24481=function($24485$24488){var t0$24500;var $index$24566;var $length$24560;var temp$24554;var acc$24548;var type$24538;var args$24539;var x$24532;var x$24521;var $24494$24516;var $24495$24517;var $24496$24518;var t0$24514;var $24490$24509;var ph$24497;var node$24498;(t0$24500=$24485$24488);(node$24498=t0$24500);(ph$24497=t0$24500);($24490$24509=ph$24497);if((($24494$24516=($24490$24509 instanceof Array))&&(((t0$24514=$24490$24509.length)),(($24496$24518=(t0$24514===2))&&($24490$24509[0]==="symbol"))))){(x$24521=$24490$24509[1]);__lt____gt__$22937(null,node$24498);return __lt____gt__$22937(null,(node$24498.location&&node$24498.location.highlight()));}else{if(($24496$24518&&($24490$24509[0]==="value"))){(x$24532=$24490$24509[1]);__lt____gt__$22937(null,node$24498);return __lt____gt__$22937(null,(node$24498.location&&node$24498.location.highlight()));}else{if(($24494$24516&&(t0$24514>=1))){(type$24538=$24490$24509[0]);(args$24539=Array.prototype.slice.call($24490$24509,1));__lt____gt__$22937(null,node$24498);__lt____gt__$22937(null,(node$24498.location&&node$24498.location.highlight()));(acc$24548=[]);(temp$24554=args$24539);($length$24560=temp$24554.length);($index$24566=0);$24543:for(;($index$24566<$length$24560);($index$24566++)){var arg$24583;var m$24575;(m$24575=temp$24554[$index$24566]);(arg$24583=m$24575);acc$24548.push(walkloc$24481(arg$24583));}return acc$24548;}else{$25044($24490$24509);}}}});return walkloc$24481((((tokens$24591=eg$22935.tokenize(Source$22939(s$24476,null)))),eg$22935.parse(tokens$24591)));}else{(stuff$24597=$23835$23856);return usage_error$22944(("Invalid use. Did you mean: earl run "+stuff$24597.join(" ")));}}}}}}}}});(exports["run"]=run$22951);
