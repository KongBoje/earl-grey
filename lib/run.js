var items=function(obj){var results=[];for(k in obj){results.push([k,send(obj,k)]);}return results;};var enumerate=function(arr){var results=[];var l=arr.length;for(var i=0;(i<l);(i++)){results.push([i,send(arr,i)]);}return results;};var send=function(obj,msg){var __t855=msg;var other;if(((typeof(__t855)==="string")||(typeof(__t855)==="number"))){return obj[msg];}else{if(((other=__t855),true)){return obj["::send"](msg);}else{throw ["Could not find a match",__t855];}}};(Function.prototype["::send"]=function(args){return this.apply(this,args);});var augment=function(dest,values){for(k in values){(dest[k]=send(values,k));}return dest;};var patch_array=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};var range=function(from,to){var rval=[];for(var i=from;(i<=to);(i++)){rval.push(i);}return rval;};var StructFactory=function(name){var make=function(){var r=Array.prototype.slice.call(arguments,0);(r["#"]=name);return r;};(make[":::project"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return [true,value];}else{if(true){return [true,make(value)];}else{return false;}}});(make["::check"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return true;}else{if(true){return false;}else{return false;}}});(make[":::deconstruct"]=function(value){if(((value instanceof Array)&&(value["#"]===name))){return [true,value.slice(0)];}else{if(true){return [false,false];}else{return false;}}});return make;};var Struct=function(name){var r=Array.prototype.slice.call(arguments,1);(r["#"]=name);return r;};(Struct["::check"]=function(value){if((value instanceof Array)){return (value["#"]!==undefined);}else{if(true){return false;}else{return false;}}});(Struct[":::deconstruct"]=function(value){if(((value instanceof Array)&&(value["#"]!==undefined))){return [true,[value["#"]].concat(value.slice(0))];}else{if(true){return [false,null];}else{return false;}}});var pr_terminus=function(node){var r=HTML(node,"span");var pre=(String.fromCharCode(27)+"[?0;7y+h <div class=\"ug\">");var post=("</div>"+String.fromCharCode(7));return console.log(((pre+r)+post));};var pr=function(__t856,r){var __t857=__t856;var n;var x;if((___checker(Node)(__t857)&&((n=__t857),true))){return pr_terminus(n);}else{if(((x=__t857),true)){return pr_terminus((r||repr)(x));}else{throw ["Could not find a match",__t857];}}};var repr=function(__t859,__t860){var x;var __t858;(x=__t859);true;(__t858=__t859);var recur;var recur;if(((___checker(Function)(__t860)&&((recur=__t860),true))||((recur=repr),true))){(void 0);}else{throw "a condition failed";}var __t861=__t858;var __tp0;var __tp1;var __tp2;var tag;var entries;var entries;var other;if((__t861===true)){return Node(["special","true"],"true");}else{if((__t861===false)){return Node(["special","false"],"false");}else{if((__t861===null)){return Node(["special","nil"],"null");}else{if((__t861===(void 0))){return Node(["special","nil"],"undefined");}else{if((typeof(__t861)==="number")){return Node(["num"],String(x));}else{if((typeof(__t861)==="string")){return Node(["str"],x);}else{if((___checker(Struct)(__t861)&&(((__tp0=___deconstructor(Struct)(__t861)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2>=1)&&((tag=__tp1[0]),true,(entries=__tp1.slice(1)),true)))))){return Node(["struct"],[Node(["sym"],tag),Node(["sequence"],function(){var __t862=[];var __t863=entries;var __t864=__t863.length;for(var __t865=0;(__t865<__t864);(__t865++)){var __t866=__t863[__t865];var x;var other;if(((x=__t866),true)){__t862.push(recur(x,repr));}else{if(((other=__t866),true)){false;}else{throw ["Could not find a match",__t866];}}}return __t862;}())]);}else{if((___checker(Array)(__t861)&&((entries=__t861),true))){return Node(["sequence"],function(){var __t867=[];var __t868=entries;var __t869=__t868.length;for(var __t870=0;(__t870<__t869);(__t870++)){var __t871=__t868[__t870];var x;var other;if(((x=__t871),true)){__t867.push(recur(x,repr));}else{if(((other=__t871),true)){false;}else{throw ["Could not find a match",__t871];}}}return __t867;}());}else{if(x["::repr"]){return x["::repr"](recur);}else{if((Object.getPrototypeOf(x)===Object.prototype)){return Node(["table"],function(){var __t872=[];var __t873=items(x);var __t874=__t873.length;for(var __t875=0;(__t875<__t874);(__t875++)){var __t876=__t873[__t875];var __tp0;var k;var v;var other;if(((__t876 instanceof Array)&&((__t876["#"]===undefined)&&(((__tp0=__t876.length),true)&&((__tp0===2)&&((k=__t876[0]),true,(v=__t876[1]),true)))))){__t872.push(Node(["pairing"],[recur(k,repr),recur(v,repr)]));}else{if(((other=__t876),true)){false;}else{throw ["Could not find a match",__t876];}}}return __t872;}());}else{if(((other=__t861),true)){return Node(["unknown"],other.toString());}else{throw ["Could not find a match",__t861];}}}}}}}}}}}};var ___checker=function(type){var __t877=type["::check"];var f;if((__t877===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=__t877),true)){return function(value){return f.call(type,value);};}else{throw ["Could not find a match",__t877];}}};var checker=___checker;var ___projector=function(type){return function(value){var __t878=type[":::project"];var f;if((__t878===(void 0))){var __t879=type["::project"];var f;if((__t879===(void 0))){return [true,type(value)];}else{if(((f=__t879),true)){var __t881;try{(__t881=[true,f(value)]);}catch(__t880){(__t881=[false,null]);}return __t881;}else{throw ["Could not find a match",__t879];}}}else{if(((f=__t878),true)){return f.call(type,value);}else{throw ["Could not find a match",__t878];}}};};var projector=___projector;var ___deconstructor=function(type){return function(value){var __t882=type[":::deconstruct"];var f;if((__t882===(void 0))){var __t883=type["::deconstruct"];var f;if((__t883===(void 0))){if((value instanceof Array)){return [true,value];}else{if(true){return [false,null];}else{return false;}}}else{if(((f=__t883),true)){var __t885;try{(__t885=[true,f.call(type,value)]);}catch(__t884){(__t885=[false,null]);}return __t885;}else{throw ["Could not find a match",__t883];}}}else{if(((f=__t882),true)){return f.call(type,value);}else{throw ["Could not find a match",__t882];}}};};var deconstructor=___deconstructor;(Array[":::project"]=function(value){var __t886=value;var _;if(___checker(Array)(__t886)){return [true,value];}else{if(((_=__t886),true)){return [true,[value]];}else{throw ["Could not find a match",__t886];}}});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var __t887=value.match(this);var m;var m;if(((__t887===null)&&((m=__t887),true))){return [false,null];}else{if(((m=__t887),true)){return [true,m];}else{throw ["Could not find a match",__t887];}}});(RegExp.prototype[":::deconstruct"]=function(value){var __t888=value.match(this);var m;var m;if(((__t888===null)&&((m=__t888),true))){return [false,null];}else{if(((m=__t888),true)){return [true,m];}else{throw ["Could not find a match",__t888];}}});var Node=function(__t843,__t844){var __tp0;var classes;if((((__tp0=___projector(Array)(__t843)),__tp0[0])&&((classes=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var __tp0;var children;if((((__tp0=___projector(Array)(__t844)),__tp0[0])&&((children=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var __t842=function(){if((!___checker(Node)(this))){return Object.create(Node.prototype);}else{return this;}}();(__t842["classes"]=classes.sort());(__t842["children"]=children);return __t842;};augment(Node,({"::check":function(x){return ((x&&x.classes)&&x.children);},"::deconstruct":function(x){return [x.classes,x.children];}}));(Node.prototype["::check"]=function(n){var __t842=this;var __t845=__t842.classes;var __t846=__t845.length;for(var __t847=0;(__t847<__t846);(__t847++)){var __t848=__t845[__t847];var c;var other;if(((c=__t848),true,(n.classes.indexOf(c)===(-1)))){return false;}else{if(((other=__t848),true)){false;}else{throw ["Could not find a match",__t848];}}}false;return true;});Node;var escape_html=function(__t889){var __tp0;var s;if((((__tp0=[true,String(__t889)]),__tp0[0])&&((s=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}var repl=({"&":"&amp;","<":"&lt;",">":"&gt;"});return s.replace(RegExp("[&<>]","g"),function(x){return send(repl,x);});};var quotify=function(__t890){var __tp0;var s;if((((__tp0=[true,String(__t890)]),__tp0[0])&&((s=__tp0[1]),true))){(void 0);}else{throw "a condition failed";}return s.replace(RegExp("[\"\\\\]","g"),function(x){return ("\\"+x);});};var HTML=function(__t891,default_tag){var __t892=__t891;var s;var children;var __tp0;var __tp1;var __tp2;var tags;var children;var other;if(((typeof(__t892)==="string")&&((s=__t892),true))){return escape_html(s);}else{if((___checker(Array)(__t892)&&((children=__t892),true))){return function(){var __t893=[];var __t894=children;var __t895=__t894.length;for(var __t896=0;(__t896<__t895);(__t896++)){var __t897=__t894[__t896];var child;var other;if(((child=__t897),true)){__t893.push(HTML(child,default_tag));}else{if(((other=__t897),true)){false;}else{throw ["Could not find a match",__t897];}}}return __t893;}().join("");}else{if((___checker(Node)(__t892)&&(((__tp0=___deconstructor(Node)(__t892)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((tags=__tp1[0]),true,(children=__tp1[1]),true)))))){var tag=(default_tag||"span");var classes=[];var id=null;var kv=[];var sub=[];var __t898=tags;var __t899=__t898.length;for(var __t900=0;(__t900<__t899);(__t900++)){var __t902=__t898[__t900];var __tp0;var __tp1;var __tp2;var k;var v;var __tp0;var __tp1;var __tp2;var k;var __tp0;var __tp1;var __tp2;var _;var m;var __tp0;var __tp1;var __tp2;var _;var m;var s;var other;var __t903=false;var __t904=false;var __t905=false;if(((__t903=(__t902["#"]==="assoc"))&&((__t904=((__tp0=[true,__t902]),__tp0[0]))&&((__t905=((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true))&&((__tp2===2)&&((k=__tp1[0]),true,(v=__tp1[1]),true)))))){kv.push([k,v]);}else{if((__t905&&((__tp2===1)&&((k=__tp1[0]),true)))){kv.push([k,undefined]);}else{if((___checker(RegExp("(?:^\\+((?:.*)))",""))(__t902)&&(((__tp0=___deconstructor(RegExp("(?:^\\+((?:.*)))",""))(__t902)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((_=__tp1[0]),true,(m=__tp1[1]),true)))))){(tag=m);}else{if((___checker(RegExp("(?:^#((?:.*)))",""))(__t902)&&(((__tp0=___deconstructor(RegExp("(?:^#((?:.*)))",""))(__t902)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===2)&&((_=__tp1[0]),true,(m=__tp1[1]),true)))))){(id=m);}else{if(((typeof(__t902)==="string")&&((s=__t902),true))){classes.push(s);}else{if(((other=__t902),true)){false;}else{throw ["Could not find a match",__t902];}}}}}}}false;var accum=function(){if((tag==="raw")){return [];}else{return ["<",tag];}}();if(id){(accum=accum.concat(" id=\"",id,"\""));}else{false;}if(classes.length){(accum=accum.concat(" class=\"",quotify(classes.join(" ")),"\""));}else{false;}if(kv){var __t906=[];var __t907=kv;var __t908=__t907.length;for(var __t909=0;(__t909<__t908);(__t909++)){var __t910=__t907[__t909];var __tp0;var k;var v;var other;if(((__t910 instanceof Array)&&((__t910["#"]===undefined)&&(((__tp0=__t910.length),true)&&((__tp0===2)&&((k=__t910[0]),true,(v=__t910[1]),true)))))){__t906.push((accum=accum.concat(function(){if((v!==null)){return [" ",k,"=\"",quotify(v),"\""];}else{return [" ",k];}}())));}else{if(((other=__t910),true)){false;}else{throw ["Could not find a match",__t910];}}}__t906;}else{false;}(children=function(){var __t911=tag;var other;if((__t911==="raw")){var __t912=[];var __t913=children;var __t914=__t913.length;for(var __t915=0;(__t915<__t914);(__t915++)){var __t916=__t913[__t915];var s;var c;var other;if(((typeof(__t916)==="string")&&((s=__t916),true))){__t912.push(s);}else{if(((c=__t916),true)){__t912.push(HTML(c,default_tag));}else{if(((other=__t916),true)){false;}else{throw ["Could not find a match",__t916];}}}}return __t912;}else{if(((other=__t911),true)){var __t917=[];var __t918=children;var __t919=__t918.length;for(var __t920=0;(__t920<__t919);(__t920++)){var __t921=__t918[__t920];var c;var other;if(((c=__t921),true)){__t917.push(HTML(c,default_tag));}else{if(((other=__t921),true)){false;}else{throw ["Could not find a match",__t921];}}}return __t917;}else{throw ["Could not find a match",__t911];}}}());var __t901=tag;var other;if((__t901==="raw")){return accum.concat(children).join("");}else{if(((other=__t901),true)){var x=patch_array([">"],children,["</",tag,">"]);return accum.concat(x).join("");}else{throw ["Could not find a match",__t901];}}}else{if(((other=__t892),true)){return HTML([true,String(other)][1],default_tag);}else{throw ["Could not find a match",__t892];}}}}};var ErrorFactory=function(tags){var __t849=function(){if((!___checker(ErrorFactory)(this))){return Object.create(ErrorFactory.prototype);}else{return this;}}();(__t849["tags"]=tags);return __t849;};augment(ErrorFactory,[]);(ErrorFactory.prototype["create"]=function(){var __t850=Array.prototype.slice.call(arguments,0);var __tp0;var message;var args;if(((__t850 instanceof Array)&&((__t850["#"]===undefined)&&(((__tp0=__t850.length),true)&&((__tp0>=0)&&((message=function(){if((0>=__tp0)){return "";}else{return __t850[0];}}()),true,(args=__t850.slice(1)),true)))))){var __t849=this;var e=Error(message);(e["::tags"]=__t849.tags);(e["args"]=args);(e["name"]=["E"].concat(__t849.tags).join("."));return e;}else{throw ["Could not find a match",__t850];}});(ErrorFactory.prototype["::check"]=function(e){var __t849=this;if(((!e)||(!___checker(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var __t851=__t849.tags;var __t852=__t851.length;for(var __t853=0;(__t853<__t852);(__t853++)){var __t854=__t851[__t853];var tag;var other;if(((tag=__t854),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=__t854),true)){false;}else{throw ["Could not find a match",__t854];}}}false;return true;});(ErrorFactory.prototype["::deconstruct"]=function(e){var __t849=this;return e.args;});ErrorFactory;
var eg=require("./earl-grey");var fs=require("fs");var path=require("path");var vm=require("vm");var usage="\nusage:\n\nearl translate <file> [outfile]\n  Translate a source file, output to outfile. Without outfile\n  specified, print to standard out.\n\nearl translate <directory> <outdir>\n  Translate all the .eg files in the specified directory.\n\nearl run [file] [arguments...]\n  Run the specified file as a script.\n";var walk=function(dir,partial,f){var stats=fs.statSync(dir);if(stats.isDirectory()){f("dir",partial);var __t922=[];var __t923=fs.readdirSync(dir);var __t924=__t923.length;for(var __t925=0;(__t925<__t924);(__t925++)){var __t926=__t923[__t925];var file;var other;if(((file=__t926),true)){__t922.push(function(){var newdir=path.join(dir,file);var newpartial=path.join(partial,file);return walk(newdir,newpartial,f);}());}else{if(((other=__t926),true)){false;}else{throw ["Could not find a match",__t926];}}}return __t922;}else{return f("file",partial);}};var copy=function(src,dest){var data=fs.readFileSync(src,"binary");return fs.writeFileSync(dest,data,"binary");};var libdata=fs.readFileSync(path.join(__dirname,"lib.raw.js"));var run=function(__t927){var __t928=__t927;var __tp0;var __tp1;var src;var dest;var __t930;var __t931;var __t929;var __tp0;var __tp1;var file;var __tp0;var __tp1;var file;var args;var __tp0;var __tp1;var s;var __tp0;var __tp1;var s;var __tp0;var __tp1;var data;var other;var __t932=false;var __t933=false;var __t934=false;var __t935=false;if(((__t928 instanceof Array)&&((__t928["#"]===undefined)&&(((__tp0=__t928.length),true)&&((__tp0===3)&&(((__tp1=__t928[0]),(__tp1==="quack"))&&((src=__t928[1]),true,(dest=__t928[2]),true))))))){return walk(src,"/",function(){var __t937=Array.prototype.slice.call(arguments,0);var __tp0;var __t938;if(((__t937 instanceof Array)&&((__t937["#"]===undefined)&&(((__tp0=__t937.length),true)&&((__tp0>=0)&&((__t938=__t937.slice(0)),true)))))){var __t939=__t938;var __tp0;var __tp1;var d;var __tp0;var __tp1;var f;var __t940=false;var __t941=false;var __t942=false;var __t943=false;if(((__t940=(__t939 instanceof Array))&&((__t941=(__t939["#"]===undefined))&&((__t942=((__tp0=__t939.length),true))&&((__t943=(__tp0===2))&&(((__tp1=__t939[0]),(__tp1==="dir"))&&((d=__t939[1]),true))))))){var from=path.join(src,d);var to=path.join(dest,d);var __t945;try{(__t945=fs.mkdirSync(to));}catch(__t944){(__t945="ignore error");}return __t945;}else{if((__t943&&(((__tp1=__t939[0]),(__tp1==="file"))&&((f=__t939[1]),true)))){var from=path.join(src,f);var to=path.join(dest,f);return copy(from,to);}else{throw ["Could not find a match",__t939];}}}else{throw ["Could not find a match",__t937];}});}else{if((((__t928 instanceof Array)&&((__t928["#"]===undefined)&&(((__t929=__t928.length),true)&&(__t929===0))))||((__t928 instanceof Array)&&((__t928["#"]===undefined)&&(((__t930=__t928.length),true)&&((__t930===1)&&((__t931=__t928[0]),(((__t931==="i")||(__t931==="in"))||(__t931==="interactive"))))))))){var repl=require("repl");vm.runInThisContext(libdata,"stdin");var settings=({"prompt":"<> ","ignoreUndefined":true,"eval":function(input,context,filename,callback){var text=eg.generate(input.slice(1,(-1)));var result=function(){var __t947;try{(__t947=vm.runInThisContext(text,"stdin"));}catch(__t946){(__t947=function(){var __t948=__t946;var e;var ___exc;if(((e=__t948),true)){return console.log(e.stack);}else{if(((___exc=__t948),true)){throw ___exc;}else{throw ["Could not find a match",__t948];}}}());}return __t947;}();return callback(null,result);}});var run=repl.start(settings);return run.on("exit",function(){return run.outputStream.write("\n");});}else{if(((__t932=(__t928 instanceof Array))&&((__t933=(__t928["#"]===undefined))&&((__t934=((__tp0=__t928.length),true))&&((__tp0===2)&&(((__tp1=__t928[0]),(__tp1==="run"))&&((file=__t928[1]),true))))))){var data=fs.readFileSync(file,"utf8");var code=eg.generate(data,libdata);return eval(code);}else{if((__t934&&((__tp0>=2)&&(((__tp1=__t928[0]),((__tp1==="tr")||(__tp1==="translate")))&&((file=__t928[1]),true,(args=__t928.slice(2)),true))))){var out=args[0];var stats=fs.statSync(file);if(stats.isDirectory()){return walk(file,"/",function(){var __t950=Array.prototype.slice.call(arguments,0);var __tp0;var __t951;if(((__t950 instanceof Array)&&((__t950["#"]===undefined)&&(((__tp0=__t950.length),true)&&((__tp0>=0)&&((__t951=__t950.slice(0)),true)))))){var __t952=__t951;var __tp0;var __tp1;var d;var __tp0;var __tp1;var __t953;var __t954=false;var __t955=false;var __t956=false;var __t957=false;if(((__t954=(__t952 instanceof Array))&&((__t955=(__t952["#"]===undefined))&&((__t956=((__tp0=__t952.length),true))&&((__t957=(__tp0===2))&&(((__tp1=__t952[0]),(__tp1==="dir"))&&((d=__t952[1]),true))))))){var from=path.join(file,d);var to=path.join(out,d);var __t959;try{(__t959=fs.mkdirSync(to));}catch(__t958){(__t959="ignore error");}return __t959;}else{if((__t957&&(((__tp1=__t952[0]),(__tp1==="file"))&&((__t953=__t952[1]),true)))){var __t960=__t953;var __tp0;var __tp1;var __tp2;var x;var name;var f;if((((__tp0=___projector(RegExp("(?:^((?:.*))\\.eg$)",""))(__t960)),__tp0[0])&&(((__tp1=__tp0[1]),(__tp1 instanceof Array))&&((__tp1["#"]===undefined)&&(((__tp2=__tp1.length),true)&&((__tp2===2)&&((x=__tp1[0]),true,(name=__tp1[1]),true))))))){var from=path.join(file,x);var to=path.join(out,(name+".js"));var data=fs.readFileSync(from,"utf8");return fs.writeFileSync(to,(eg.generate(data,function(){if(___checker(RegExp("(?:\\.raw\\.eg$)",""))(x)){return "";}else{return libdata;}}())+"\n"));}else{if(((f=__t960),true)){var from=path.join(file,f);var to=path.join(out,f);return copy(from,to);}else{throw ["Could not find a match",__t960];}}}else{throw ["Could not find a match",__t952];}}}else{throw ["Could not find a match",__t950];}});}else{if(out){var data=fs.readFileSync(file,"utf8");return fs.writeFileSync(out,(eg.generate(data,libdata)+"\n"));}else{if(true){var data=fs.readFileSync(file,"utf8");return console.log(eg.generate(data,""));}else{return false;}}}}else{if((__t934&&((__t935=(__tp0===2))&&(((__tp1=__t928[0]),(__tp1==="tok"))&&((s=__t928[1]),true))))){var __t961=[];var __t962=eg.tokenize(eg.Source(s,null));var __t963=__t962.length;for(var __t964=0;(__t964<__t963);(__t964++)){var __t965=__t962[__t964];var token;var other;if(((token=__t965),true)){__t961.push((pr(token),pr(token.location.ref()),pr(token.location.highlight())));}else{if(((other=__t965),true)){false;}else{throw ["Could not find a match",__t965];}}}return __t961;}else{if((__t935&&(((__tp1=__t928[0]),(__tp1==="pa"))&&((s=__t928[1]),true)))){var walkloc=function(__t967){var node;var __t966;(node=__t967);true;(__t966=__t967);var __t968=__t966;var __tp0;var __tp1;var x;var __tp0;var __tp1;var x;var __tp0;var type;var args;var __t969=false;var __t970=false;var __t971=false;var __t972=false;if(((__t969=(__t968 instanceof Array))&&((__t970=(__t968["#"]===undefined))&&((__t971=((__tp0=__t968.length),true))&&((__t972=(__tp0===2))&&(((__tp1=__t968[0]),(__tp1==="symbol"))&&((x=__t968[1]),true))))))){pr(node);return pr((node.location&&node.location.highlight()));}else{if((__t972&&(((__tp1=__t968[0]),(__tp1==="value"))&&((x=__t968[1]),true)))){pr(node);return pr((node.location&&node.location.highlight()));}else{if((__t971&&((__tp0>=1)&&((type=__t968[0]),true,(args=__t968.slice(1)),true)))){pr(node);pr((node.location&&node.location.highlight()));var __t973=[];var __t974=args;var __t975=__t974.length;for(var __t976=0;(__t976<__t975);(__t976++)){var __t977=__t974[__t976];var arg;var other;if(((arg=__t977),true)){__t973.push(walkloc(arg));}else{if(((other=__t977),true)){false;}else{throw ["Could not find a match",__t977];}}}return __t973;}else{throw ["Could not find a match",__t968];}}}};return walkloc(eg.parse(eg.Source(s,null)));}else{if((__t935&&(((__tp1=__t928[0]),(__tp1==="runs"))&&((data=__t928[1]),true)))){var code=function(){var __t979;try{(__t979=eg.generate(data,libdata));}catch(__t978){(__t979=function(){var __t980=__t978;var e;var __tp0;var __tp1;var __tp2;var args;var ___exc;if((((e=__t980),true,___checker(ErrorFactory(["syntax"]))(__t980))&&(((__tp0=___deconstructor(ErrorFactory(["syntax"]))(__t980)),__tp0[0])&&(((__tp1=__tp0[1]),true,(__tp2=__tp1.length),true)&&((__tp2===1)&&((args=__tp1[0]),true)))))){pr(Node(["+div"],[Node(["error_type"],e.name),Node(["error_message"],e.message)]));var hls=["hl1","hl2","hl3","hl4"];var locs=function(){var __t981=[];var __t982=enumerate(items(args));var __t983=__t982.length;for(var __t984=0;(__t984<__t983);(__t984++)){var __t985=__t982[__t984];var __tp0;var i;var __tp1;var __tp2;var key;var arg;var other;if(((__t985 instanceof Array)&&((__t985["#"]===undefined)&&(((__tp0=__t985.length),true)&&((__tp0===2)&&(((i=__t985[0]),true,(__tp1=__t985[1]),(__tp1 instanceof Array))&&((__tp1["#"]===undefined)&&(((__tp2=__tp1.length),true)&&((__tp2===2)&&((key=__tp1[0]),true,(arg=__tp1[1]),true,arg.location)))))))))){__t981.push([arg.location,send(hls,(i%4))]);}else{if(((other=__t985),true)){false;}else{throw ["Could not find a match",__t985];}}}return __t981;}();pr(args);pr(eg.highlight_locations(locs));return null;}else{if(((___exc=__t980),true)){throw ___exc;}else{throw ["Could not find a match",__t980];}}}());}return __t979;}();return (code&&pr(eval(code)));}else{if(((other=__t928),true)){return console.log(usage);}else{throw ["Could not find a match",__t928];}}}}}}}}};(exports["run"]=run);
