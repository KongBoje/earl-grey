var $12678=function(type$12680){var f$12683;(f$12683=type$12680["::check"]);if((f$12683===(void 0))){return function(value$12688){return (value$12688 instanceof type$12680);};}else{return function(value$12691){return f$12683.call(type$12680,value$12691);};}};
var $12693=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $12694=function(dest$12696,values$12697){var k$12702;(k$12702=null);$12700:for(k$12702 in values$12697){if(values$12697.hasOwnProperty(k$12702)){(dest$12696[k$12702]=values$12697[k$12702]);}}return dest$12696;};
var $12709=function($12710$12712){var ph$12716;(ph$12716=$12710$12712);var $12714$12721;($12714$12721=ph$12716);var bridge$12715$12726;var x$12730;(bridge$12715$12726=$12714$12721);if((((typeof(bridge$12715$12726)==="string")&&((x$12730=bridge$12715$12726),true))||((typeof(bridge$12715$12726)==="number")&&((x$12730=bridge$12715$12726),true)))){return ["value",x$12730];}else{var other$12740;(other$12740=$12714$12721);return other$12740["::serialize_ast"]();}};
var send$12485;(send$12485=function(obj$12490,$12488$12491){var ph$12495;var msg$12496;var t0$12498;(t0$12498=$12488$12491);(msg$12496=t0$12498);(ph$12495=t0$12498);var $12493$12505;($12493$12505=ph$12495);var bridge$12494$12510;(bridge$12494$12510=$12493$12505);if(((typeof(bridge$12494$12510)==="string")||(typeof(bridge$12494$12510)==="number"))){return obj$12490[msg$12496];}else{var other$12521;(other$12521=$12493$12505);return obj$12490["::send"](msg$12496);}});(Array[":::project"]=function($12526$12528){var ph$12531;var value$12532;var t0$12534;(t0$12534=$12526$12528);(value$12532=t0$12534);(ph$12531=t0$12534);var $12530$12541;($12530$12541=ph$12531);if($12678(Array)($12530$12541)){return [true,value$12532];}else{$12530$12541;return [true,[value$12532]];}});(Array.prototype["::check"]=function(value$12558){if((value$12558 instanceof Array)){var i$12563;(i$12563=0);$12561:for(;(i$12563<this.length);(i$12563++)){if(($12693(this,i$12563)!==$12693(value$12558,i$12563))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $12694(this.slice(0),this);});(Array.prototype[":::project"]=function(value$12580){if((value$12580 instanceof Array)){var i$12585;(i$12585=0);$12583:for(;(i$12585<this.length);(i$12585++)){if(($12693(this,i$12585)!==$12693(value$12580,i$12585))){return [true,[value$12580]];}}return [true,value$12580.slice(this.length)];}else{return [true,[value$12580]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($12709));});(RegExp.prototype["::check"]=function($12601$12603){var ph$12606;(ph$12606=$12601$12603);var $12605$12611;($12605$12611=ph$12606);var value$12619;if((typeof($12605$12611)==="string")){(value$12619=$12605$12611);if(value$12619.match(this)){return true;}else{return false;}}else{var other$12624;(other$12624=$12605$12611);return false;}});(RegExp.prototype[":::project"]=function($12629$12631){var ph$12634;(ph$12634=$12629$12631);var $12633$12639;($12633$12639=ph$12634);var value$12647;if((typeof($12633$12639)==="string")){(value$12647=$12633$12639);var $12650$12652;($12650$12652=value$12647.match(this));var m$12660;if(($12650$12652===null)){(m$12660=$12650$12652);return [false,null];}else{var m$12665;(m$12665=$12650$12652);return [true,m$12665];}}else{var other$12669;(other$12669=$12633$12639);return [false,null];}});(Function.prototype["::send"]=function(args$12675){return this.apply(this,args$12675);});
var $16158=function(arr$16160){var results$16164;var l$16165;(results$16164=[]);(l$16165=arr$16160.length);var i$16173;(i$16173=0);$16163:for(;(i$16173<l$16165);(i$16173++)){results$16164.push([i$16173,$12693(arr$16160,i$16173)]);}return results$16164;};
var $16180=function(value$16182,url$16183,start$16184,end$16185){var err$16188;(err$16188=$15962(["match"]).create("Could not find a match for value",({"value":value$16182})));if(url$16183){(err$16188["location"]=["location",url$16183,start$16184,end$16185]);}throw err$16188;};
var $15962=function(){var $15963$15965;($15963$15965=function(tags$15969){var it$0$15972;(it$0$15972=function(){if((!$12678($15963$15965)(this))){return Object.create($15963$15965.prototype);}else{return this;}}());(it$0$15972["tags"]=tags$15969);return it$0$15972;});($15963$15965.prototype["create"]=function(){var $15984$15986;($15984$15986=arguments);var t0$15991;var message$15995;var args$15996;(t0$15991=$15984$15986.length);if((t0$15991>=0)){(message$15995=function(){if((0>=t0$15991)){return "";}else{return $15984$15986[0];}}());(args$15996=Array.prototype.slice.call($15984$15986,1));var it$0$16003;(it$0$16003=this);var self$16008;(self$16008=this);var e$16013;(e$16013=Error(message$15995));(e$16013["::tags"]=it$0$16003.tags);(e$16013["args"]=args$15996);var temp$16027;(temp$16027=$16158(args$15996));var $length$16032;($length$16032=temp$16027.length);var $index$16037;($index$16037=0);$16014:for(;($index$16037<$length$16032);($index$16037++)){var m$16045;(m$16045=temp$16027[$index$16037]);var t0$16050;var t1$16051;var i$16055;var arg$16056;(t0$16050=m$16045);if(((t0$16050 instanceof Array)&&(((t1$16051=t0$16050.length)),(t1$16051===2)))){(i$16055=t0$16050[0]);(arg$16056=t0$16050[1]);(e$16013[i$16055]=arg$16056);}else{$16180(m$16045);}}(e$16013["length"]=args$15996.length);(e$16013["name"]=["E"].concat(it$0$16003.tags).join("."));return e$16013;}else{$16180($15984$15986);}});($15963$15965.prototype["::check"]=function(e$16082){var it$0$16085;(it$0$16085=this);var self$16090;(self$16090=this);var tags$16095;if(((!e$16082)||(!$12678(Error)(e$16082)))){return false;}(tags$16095=(e$16082["::tags"]||[]));var temp$16104;(temp$16104=it$0$16085.tags);var $length$16109;($length$16109=temp$16104.length);var $index$16114;($index$16114=0);$16096:for(;($index$16114<$length$16109);($index$16114++)){var m$16122;(m$16122=temp$16104[$index$16114]);var tag$16130;(tag$16130=m$16122);if((tags$16095.indexOf(tag$16130)===-1)){return false;}else{false;}}return true;});($15963$15965.prototype["::deconstruct"]=function(e$16138){var it$0$16141;(it$0$16141=this);var self$16146;(self$16146=this);return e$16138.args;});$12694($15963$15965,$12694(function(){var accum$16151;(accum$16151=({}));(accum$16151["::name"]="$15963");return accum$16151;}(),function(){var accum$16155;(accum$16155=({}));(accum$16155["::egclass"]=true);return accum$16155;}()));return $15963$15965;}();
var $16286=function($16287$16289,key$16290){var ph$16294;(ph$16294=$16287$16289);var $16292$16299;($16292$16299=ph$16294);var bridge$16293$16304;(bridge$16293$16304=$16292$16299);if(((bridge$16293$16304===null)||(bridge$16293$16304===(void 0)))){return false;}else{var x$16315;if((typeof($16292$16299)==="string")){(x$16315=$16292$16299);return (key$16290 in String.prototype);}else{var x$16320;if((typeof($16292$16299)==="number")){(x$16320=$16292$16299);return (key$16290 in Number.prototype);}else{var x$16325;(x$16325=$16292$16299);return (key$16290 in x$16325);}}}};
var $16215=function($16216$16218){var ph$16224;var x$16225;var t0$16227;(t0$16227=$16216$16218);(x$16225=t0$16227);(ph$16224=t0$16227);var $16220$16234;($16220$16234=ph$16224);var bridge$16221$16239;(bridge$16221$16239=$16220$16234);if((function(){var bridge$16222$16248;(bridge$16222$16248=bridge$16221$16239);return (function(){var bridge$16223$16254;(bridge$16223$16254=bridge$16222$16248);return ((bridge$16223$16254===(void 0))||(bridge$16223$16254===null));}()||(typeof(bridge$16222$16248)==="string"));}()||(typeof(bridge$16221$16239)==="number"))){return x$16225;}else{if($16286($16220$16234,"::clone")){$16220$16234["::clone"];return x$16225["::clone"]();}else{$16220$16234;if((Object.getPrototypeOf(x$16225)===Object.prototype)){var dest$16270;(dest$16270=({}));var k$16275;(k$16275=null);$16269:for(k$16275 in x$16225){if(Object.prototype.hasOwnProperty.call(x$16225,k$16275)){(dest$16270[k$16275]=x$16225[k$16275]);}}return dest$16270;}else{var other$16284;(other$16284=$16220$16234);throw $15962(["clone"]).create("Object cannot be cloned",({"obj":x$16225}));}}}};
var $16196=function(a$16198,b$16199){var dest$16203;(dest$16203=$16215(a$16198));var k$16208;(k$16208=null);$16202:for(k$16208 in b$16199){if(Object.prototype.hasOwnProperty.call(b$16199,k$16208)){(dest$16203[k$16208]=b$16199[k$16208]);}}return dest$16203;};
var $16327=Object.keys;
var $16328=function(type$16330){return function(value$16333){var f$16336;(f$16336=type$16330[":::project"]);if((f$16336===(void 0))){(f$16336=type$16330["::project"]);if((f$16336===(void 0))){return [true,type$16330(value$16333)];}else{var rval$16345;(rval$16345=false);try{(rval$16345=[true,f$16336(value$16333)]);}catch(excv$16354){var e$16360;(e$16360=excv$16354);(rval$16345=[false,null]);}return rval$16345;}}else{return f$16336.call(type$16330,value$16333);}};};
var $16365=function(xs$16367,ys$16368){var acc$16373;(acc$16373=[]);var temp$16378;(temp$16378=$16158(xs$16367));var $length$16383;($length$16383=temp$16378.length);var $index$16388;($index$16388=0);$16370:for(;($index$16388<$length$16383);($index$16388++)){var m$16396;(m$16396=temp$16378[$index$16388]);var t0$16401;var t1$16402;var i$16406;var x$16407;(t0$16401=m$16396);if(((t0$16401 instanceof Array)&&(((t1$16402=t0$16401.length)),(t1$16402===2)))){(i$16406=t0$16401[0]);(x$16407=t0$16401[1]);acc$16373.push([x$16407,$12693(ys$16368,i$16406)]);}else{$16180(m$16396);}}return acc$16373;};
var $16420=function(from$16422,to$16423){var rval$16427;(rval$16427=[]);var i$16432;(i$16432=from$16422);$16426:for(;(i$16432<=to$16423);(i$16432++)){rval$16427.push(i$16432);}return rval$16427;};var accum$13563;var accum$13567;var accum$14235;var accum$14239;var $12744$12748;var __lt____gt__$12749;var $12745$12750;var __lt____lt____colon__$12751;var util$12752;var GenSym$12753;var gensym$12754;var neighbours$12755;var classify$12756;var classify_contiguous$12757;var identity$12758;var $12747$12759;var checker_db$12760;var PatternParser$12761;var PatternProcessor$12762;var assemble_conditions$12763;var assemble_pattern$12764;var inject_below_uses$12765;var parse_pattern$12766;var checkall$12767;var same_block$12768;var parse_clauses$12769;var opt_clauses$12770;var weave_clauses$12771;($12744$12748=require("./pp"));(__lt____gt__$12749=$12744$12748["<>"]);($12745$12750=require("./location"));(__lt____lt____colon__$12751=$12745$12750["<<:"]);(util$12752=require("./util"));(GenSym$12753=util$12752.GenSym);(gensym$12754=util$12752.gensym);(neighbours$12755=util$12752.neighbours);(classify$12756=util$12752.classify);(classify_contiguous$12757=util$12752.classify_contiguous);(identity$12758=util$12752.identity);($12747$12759=require("./expand"));(checker_db$12760=$12747$12759.checker_db);(PatternParser$12761=function(scope$12814,pattern$12815,opt$12816){var it$0$12819;(it$0$12819=function(){if((!$12678(PatternParser$12761)(this))){return Object.create(PatternParser$12761.prototype);}else{return this;}}());(it$0$12819["opt"]=opt$12816);(it$0$12819["arguments"]=[]);(it$0$12819["vars"]=[]);(it$0$12819["specials"]=({}));(it$0$12819["pattern"]=it$0$12819.expand(scope$12814,pattern$12815,(opt$12816.tags||({})),true,it$0$12819.opt.indexable));return it$0$12819;});(PatternParser$12761.prototype["parse_specs"]=function(scope$12844,specs$12845,tags$12846){var $index$12892;var $length$12887;var temp$12882;var acc$12877;var rest$12859;var has_defaults$12860;var rval$12861;var self$12854;var it$0$12849;(it$0$12849=this);(self$12854=this);(rest$12859=(void 0));(has_defaults$12860=false);(rval$12861=classify$12756("fw","bw","keys","defaults",(((acc$12877=[])),(((temp$12882=scope$12844.step_all(["pattern"],specs$12845))),((($length$12887=temp$12882.length)),((($index$12892=0)),function(){$12870:for(;($index$12892<$length$12887);($index$12892++)){var v$12961;var v$12955;var variable$12944;var value$12945;var key$12937;var subp$12938;var key$12931;var variable$12914;var $12872$12908;var $12873$12909;var $12874$12910;var $12875$12911;var t0$12905;var t1$12906;var m$12900;(m$12900=temp$12882[$index$12892]);(t0$12905=m$12900);if((($12873$12909=(t0$12905 instanceof Array))&&(((t1$12906=t0$12905.length)),(($12875$12911=(t1$12906===2))&&(t0$12905[0]==="dynsplice"))))){(variable$12914=t0$12905[1]);acc$12877.push((((rest$12859=it$0$12849.expand(scope$12844,variable$12914,tags$12846))),["ignore"]));}else{if(($12875$12911&&(t0$12905[0]==="assoc"))){(key$12931=t0$12905[1]);acc$12877.push(["keys",[key$12931,it$0$12849.expand(scope$12844,key$12931,tags$12846)]]);}else{if(($12873$12909&&(($12875$12911=(t1$12906===3))&&(t0$12905[0]==="assoc")))){(key$12937=t0$12905[1]);(subp$12938=t0$12905[2]);acc$12877.push(["keys",[key$12937,it$0$12849.expand(scope$12844,subp$12938,tags$12846)]]);}else{if(($12875$12911&&(t0$12905[0]==="default"))){(variable$12944=t0$12905[1]);(value$12945=t0$12905[2]);acc$12877.push((((has_defaults$12860=true)),function(){if(rest$12859){throw $15962(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$12849.expand(scope$12844,variable$12944,tags$12846),value$12945]];}}()));}else{(v$12955=m$12900);if(((rest$12859===(void 0))&&(!has_defaults$12860))){acc$12877.push(["fw",it$0$12849.expand(scope$12844,v$12955,tags$12846)]);}else{(v$12961=m$12900);acc$12877.push(["bw",it$0$12849.expand(scope$12844,v$12961,tags$12846)]);}}}}}}}()))),acc$12877)));(rval$12861["rest"]=rest$12859);return rval$12861;});(PatternParser$12761.prototype["expand"]=function(){var x$13034;var x$13043;var x$13068;var x$13073;var variable$13079;var variable$13094;var x$13132;var msg$13139;var msg$13154;var $index$13190;var $length$13185;var temp$13180;var acc$13175;var $index$13302;var $length$13297;var temp$13292;var acc$13287;var $index$13334;var $length$13329;var temp$13324;var t0$13401;var t1$13402;var t2$13403;var $index$13440;var $length$13435;var temp$13430;var acc$13425;var patts$13419;var canon$13215;var normalize$13216;var pps$13217;var vars$13218;var patt$13506;var msg$13545;var other$13542;var keys$13512;var fw$13488;var bw$13489;var defaults$13490;var rest$13491;var $13467$13485;var t0$13478;var t1$13479;var t2$13480;var t3$13481;var t4$13482;var t5$13483;var $13466$13473;var specs$13468;var other$13557;var mode$13551;var subp$13552;var args$13462;var xs$13211;var xs$13169;var x$13160;var f$13145;var arg$13146;var f$13123;var arguments$13124;var checker$13117;var subp$13118;var projector$13111;var subp$13112;var condition$13105;var subp$13106;var v$13100;var v$13085;var type$13050;var $13012$13026;var $13013$13027;var $13014$13028;var $13015$13029;var t0$13022;var bridge$13011$13023;var t1$13024;var $13010$13017;var expr$13003;var rval$13004;var self$12998;var it$0$12993;var scope$12982;var pattern$12983;var tags$12984;var toplevel$12985;var checked$12986;var t0$12978;var $12971$12973;($12971$12973=arguments);(t0$12978=$12971$12973.length);if(((t0$12978>=3)&&(t0$12978<=5))){(scope$12982=$12971$12973[0]);(pattern$12983=$12971$12973[1]);(tags$12984=$12971$12973[2]);(toplevel$12985=function(){if((3>=t0$12978)){return false;}else{return $12971$12973[3];}}());(checked$12986=function(){if((4>=t0$12978)){return false;}else{return $12971$12973[4];}}());(it$0$12993=this);(self$12998=this);(expr$13003=scope$12982.step(["pattern"],pattern$12983));(rval$13004=((($13010$13017=expr$13003)),function(){if((((x$13034=$13010$13017)),((x$13034 instanceof Array)&&(x$13034[0]==="void")))){return ["check",checker_db$12760.null,["ignore"]];}else{if((((x$13043=$13010$13017)),((x$13043 instanceof Array)&&(x$13043[0]==="ignore")))){return expr$13003;}else{if((($13010$13017 instanceof Array)&&(((t0$13022=$13010$13017.length)),((t0$13022===2)&&($13010$13017[0]==="special"))))){(type$13050=$13010$13017[1]);(it$0$12993.specials[type$13050]=true);return expr$13003;}else{(bridge$13011$13023=$13010$13017);if(((((x$13068=bridge$13011$13023)),((x$13068 instanceof Array)&&(x$13068[0]==="symbol")))||(((x$13073=bridge$13011$13023)),((x$13073 instanceof Array)&&(x$13073[0]==="variable"))))){(variable$13079=$16196(expr$13003,tags$12984));it$0$12993.vars.push(variable$13079);return ["assign",variable$13079];}else{if((($13012$13026=($13010$13017 instanceof Array))&&(((t0$13022=$13010$13017.length)),(($13014$13028=(t0$13022===2))&&(($13015$13029=($13010$13017[0]==="value"))&&((v$13085=$13010$13017[1]),it$0$12993.opt.strings_as_variables)))))){(variable$13094=__lt____lt____colon__$12751($16196(["symbol",v$13085],tags$12984),expr$13003));it$0$12993.vars.push(variable$13094);return ["assign",variable$13094];}else{if($13015$13029){(v$13100=$13010$13017[1]);return ["check",checker_db$12760(v$13100),["ignore"]];}else{if(($13012$13026&&(($13014$13028=(t0$13022===3))&&($13010$13017[0]==="test")))){(condition$13105=$13010$13017[1]);(subp$13106=$13010$13017[2]);return ["test",condition$13105,it$0$12993.expand(scope$12982,subp$13106,tags$12984,toplevel$12985,false)];}else{if(($13014$13028&&($13010$13017[0]==="project"))){(projector$13111=$13010$13017[1]);(subp$13112=$13010$13017[2]);return ["project",projector$13111,it$0$12993.expand(scope$12982,subp$13112,tags$12984,toplevel$12985,true)];}else{if(($13014$13028&&($13010$13017[0]==="check"))){(checker$13117=$13010$13017[1]);(subp$13118=$13010$13017[2]);return ["check",checker$13117,it$0$12993.expand(scope$12982,subp$13118,tags$12984,toplevel$12985,true)];}else{if(($13014$13028&&(($13015$13029=($13010$13017[0]==="send"))&&((f$13123=$13010$13017[1]),(((t1$13024=$13010$13017[2])),(((x$13132=t1$13024)),((x$13132 instanceof Array)&&(x$13132[0]==="data")))))))){(arguments$13124=t1$13024);if(toplevel$12985){it$0$12993.arguments.unshift(arguments$13124);return it$0$12993.expand(scope$12982,f$13123,tags$12984,true,false);}else{(msg$13139="Function arguments can only be declared as a top level pattern.");throw $15962(["syntax","pattern"]).create(msg$13139,({"node":expr$13003,"arg":arguments$13124}));}}else{if($13015$13029){(f$13145=$13010$13017[1]);(arg$13146=$13010$13017[2]);return ["assign",expr$13003];}else{$13010$13017;if((!it$0$12993.opt.allow_nested)){(msg$13154="Nested patterns are not allowed here.");throw $15962(["syntax","pattern"]).create(msg$13154,({"node":expr$13003}));}else{if((($13012$13026=($13010$13017 instanceof Array))&&(((t0$13022=$13010$13017.length)),((t0$13022===2)&&($13010$13017[0]==="neg"))))){(x$13160=$13010$13017[1]);return ["neg",it$0$12993.expand(scope$12982,x$13160,tags$12984)];}else{if(($13012$13026&&(($13014$13028=(t0$13022>=1))&&($13010$13017[0]==="all")))){(xs$13169=Array.prototype.slice.call($13010$13017,1));return ["all"].concat((((acc$13175=[])),(((temp$13180=xs$13169)),((($length$13185=temp$13180.length)),((($index$13190=0)),function(){$13172:for(;($index$13190<$length$13185);($index$13190++)){var x$13206;var m$13198;(m$13198=temp$13180[$index$13190]);(x$13206=m$13198);acc$13175.push(it$0$12993.expand(scope$12982,x$13206,tags$12984));}}()))),acc$13175));}else{if(($13014$13028&&($13010$13017[0]==="any"))){(xs$13211=Array.prototype.slice.call($13010$13017,1));(canon$13215=function(all$13224){return all$13224.sort().join(",");});(normalize$13216=function(vars$13230){var $index$13250;var $length$13245;var temp$13240;var acc$13235;return canon$13215((((acc$13235=[])),(((temp$13240=vars$13230)),((($length$13245=temp$13240.length)),((($index$13250=0)),function(){$13232:for(;($index$13250<$length$13245);($index$13250++)){var v$13268;var t0$13263;var t1$13264;var m$13258;(m$13258=temp$13240[$index$13250]);(t0$13263=m$13258);if(((t0$13263 instanceof Array)&&(((t1$13264=t0$13263.length)),((t1$13264===2)&&(t0$13263[0]==="symbol"))))){(v$13268=t0$13263[1]);acc$13235.push(v$13268);}else{$16180(m$13258,"/home/olivier/git/earl-grey/src/pattern.eg",3781,3838);}}}()))),acc$13235));});(pps$13217=(((acc$13287=[])),(((temp$13292=xs$13211)),((($length$13297=temp$13292.length)),((($index$13302=0)),function(){$13284:for(;($index$13302<$length$13297);($index$13302++)){var x$13318;var m$13310;(m$13310=temp$13292[$index$13302]);(x$13318=m$13310);acc$13287.push(PatternParser$12761(scope$12982,x$13318,$16196(it$0$12993.opt,({"tags":tags$12984}))));}}()))),acc$13287));(temp$13324=neighbours$12755(pps$13217));($length$13329=temp$13324.length);($index$13334=0);$13219:for(;($index$13334<$length$13329);($index$13334++)){var $index$13378;var $length$13373;var temp$13368;var pp1$13352;var pp2$13353;var t0$13347;var t1$13348;var m$13342;(m$13342=temp$13324[$index$13334]);(t0$13347=m$13342);if(((t0$13347 instanceof Array)&&(((t1$13348=t0$13347.length)),(t1$13348===2)))){(pp1$13352=t0$13347[0]);(pp2$13353=t0$13347[1]);(temp$13368=pps$13217);($length$13373=temp$13368.length);($index$13378=0);$13364:for(;($index$13378<$length$13373);($index$13378++)){var pp$13394;var m$13386;(m$13386=temp$13368[$index$13378]);(pp$13394=m$13386);normalize$13216(pp$13394.vars);}if((normalize$13216(pp1$13352.vars)!==normalize$13216(pp2$13353.vars))){throw $15962(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$12751(pp1$13352.vars.sort(),pp1$13352.pattern),"vars2":__lt____lt____colon__$12751(pp2$13353.vars.sort(),pp2$13353.pattern)}));}if((canon$13215($16327(pp1$13352.specials))!==canon$13215($16327(pp2$13353.specials)))){throw $15962(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$12751($16327(pp1$13352.specials).sort(),pp1$13352.pattern),"special2":__lt____lt____colon__$12751($16327(pp2$13353.specials).sort(),pp2$13353.pattern)}));}}else{$16180(m$13342,"/home/olivier/git/earl-grey/src/pattern.eg",3930,4727);}}(t0$13401=pps$13217);if(((t0$13401 instanceof Array)&&(((t1$13402=t0$13401.length)),((t1$13402>=1)&&(((t2$13403=t0$13401[0])),$16286(t2$13403,"vars")))))){(vars$13218=t2$13403.vars);Array.prototype.slice.call(t0$13401,1);}else{$16180(pps$13217,"/home/olivier/git/earl-grey/src/pattern.eg",4744,4747);}(it$0$12993["vars"]=it$0$12993.vars.concat(vars$13218));(patts$13419=(((acc$13425=[])),(((temp$13430=pps$13217)),((($length$13435=temp$13430.length)),((($index$13440=0)),function(){$13422:for(;($index$13440<$length$13435);($index$13440++)){var pp$13456;var m$13448;(m$13448=temp$13430[$index$13440]);(pp$13456=m$13448);acc$13425.push(pp$13456.pattern);}}()))),acc$13425));return ["any"].concat(patts$13419);}else{if(($13014$13028&&($13010$13017[0]==="data"))){(args$13462=Array.prototype.slice.call($13010$13017,1));(specs$13468=it$0$12993.parse_specs(scope$12982,args$13462,tags$12984));($13466$13473=specs$13468);if((($13467$13485=$16286($13466$13473,"keys"))&&(((t0$13478=$13466$13473.keys)),((t0$13478 instanceof Array)&&(((t1$13479=t0$13478.length)),((t1$13479===0)&&($16286($13466$13473,"fw")&&((fw$13488=$13466$13473.fw),($16286($13466$13473,"bw")&&((bw$13489=$13466$13473.bw),($16286($13466$13473,"defaults")&&((defaults$13490=$13466$13473.defaults),$16286($13466$13473,"rest"))))))))))))){(rest$13491=$13466$13473.rest);(patt$13506=__lt____lt____colon__$12751(["array_pattern",fw$13488,bw$13489,defaults$13490,rest$13491],pattern$12983));if(checked$12986){return patt$13506;}else{return ["check",checker_db$12760.Array,patt$13506];}}else{if(($13467$13485&&((keys$13512=$13466$13473.keys),($16286($13466$13473,"fw")&&(((t0$13478=$13466$13473.fw)),((t0$13478 instanceof Array)&&(((t1$13479=t0$13478.length)),((t1$13479===0)&&($16286($13466$13473,"bw")&&(((t2$13480=$13466$13473.bw)),((t2$13480 instanceof Array)&&(((t3$13481=t2$13480.length)),((t3$13481===0)&&($16286($13466$13473,"defaults")&&(((t4$13482=$13466$13473.defaults)),((t4$13482 instanceof Array)&&(((t5$13483=t4$13482.length)),((t5$13483===0)&&($16286($13466$13473,"rest")&&($13466$13473.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$13512);}else{(other$13542=$13466$13473);(msg$13545="Pattern must be an array or an object.");throw $15962(["syntax","pattern"]).create(msg$13545,({"node":expr$13003,"specs":specs$13468}));}}}else{if(($13012$13026&&((t0$13022===3)&&($13010$13017[0]==="mode")))){(mode$13551=$13010$13017[1]);(subp$13552=$13010$13017[2]);return it$0$12993.expand(scope$12982,subp$13552,$16196(tags$12984,({"declare_mode":mode$13551})),toplevel$12985,checked$12986);}else{(other$13557=$13010$13017);throw $15962(["syntax","pattern"]).create("Illegal pattern",({"node":other$13557}));}}}}}}}}}}}}}}}}}}()));return (it$0$12993.opt.wrap_pattern||identity$12758)(__lt____lt____colon__$12751(rval$13004,pattern$12983),toplevel$12985);}else{$16180($12971$12973);}});$12694(PatternParser$12761,$12694(((accum$13563=({})),((accum$13563["::name"]="PatternParser"),accum$13563)),((accum$13567=({})),((accum$13567["::egclass"]=true),accum$13567))));PatternParser$12761;(PatternProcessor$12762=function(){var it$0$13575;(it$0$13575=function(){if((!$12678(PatternProcessor$12762)(this))){return Object.create(PatternProcessor$12762.prototype);}else{return this;}}());(it$0$13575["temps"]=[]);(it$0$13575["parts"]=[]);(it$0$13575["gen"]=GenSym$12753("t"));return it$0$13575;});(PatternProcessor$12762.prototype["do"]=function(part$13594){var self$13602;var it$0$13597;(it$0$13597=this);(self$13602=this);return it$0$13597.parts.push(["do",part$13594]);});(PatternProcessor$12762.prototype["check"]=function(){var self$13633;var it$0$13628;var part$13620;var tags$13621;var t0$13616;var $13609$13611;($13609$13611=arguments);(t0$13616=$13609$13611.length);if(((t0$13616>=1)&&(t0$13616<=2))){(part$13620=$13609$13611[0]);(tags$13621=function(){if((1>=t0$13616)){return ({});}else{return $13609$13611[1];}}());(it$0$13628=this);(self$13633=this);return it$0$13628.parts.push($16196(["check",part$13620],tags$13621));}else{$16180($13609$13611);}});(PatternProcessor$12762.prototype["temp"]=function(){var x$13687;var x$13692;var init$13699;var bridge$13667$13678;var $13666$13673;var self$13668;var it$0$13661;var x$13653;var v$13654;var t0$13649;var $13642$13644;($13642$13644=arguments);(t0$13649=$13642$13644.length);if(((t0$13649>=1)&&(t0$13649<=2))){(x$13653=$13642$13644[0]);(v$13654=function(){if((1>=t0$13649)){return null;}else{return $13642$13644[1];}}());(it$0$13661=this);(self$13668=this);($13666$13673=x$13653);(bridge$13667$13678=$13666$13673);if((((((x$13687=bridge$13667$13678)),((x$13687 instanceof Array)&&(x$13687[0]==="variable")))||(((x$13692=bridge$13667$13678)),((x$13692 instanceof Array)&&(x$13692[0]==="symbol"))))&&($16286($13666$13673,"single_assignment")&&($13666$13673.single_assignment&&(!v$13654))))){return x$13653;}else{(init$13699=$13666$13673);(v$13654=(v$13654||["symbol",it$0$13661.gen()]));(v$13654["single_assignment"]=true);it$0$13661.temps.push(v$13654);it$0$13661.do(["send",["symbol","="],["data",["send",["symbol","set"],v$13654],init$13699]]);return v$13654;}}else{$16180($13642$13644);}});(PatternProcessor$12762.prototype["process"]=function(pattern$13713,rhs$13714,fns$13715){var x$13752;var x$13784;var t$13796;var t$13807;var pp$13817;var $index$13845;var $length$13840;var temp$13835;var t$13827;var $index$13903;var $length$13898;var temp$13893;var acc$13888;var fn$13874;var parts$13875;var t$13869;var $index$13956;var $length$13951;var temp$13946;var acc$13941;var t$13934;var otherwise$14068;var $14050$14052;var $index$14082;var $length$14077;var temp$14072;var $index$14125;var $length$14120;var temp$14115;var end$14179;var pos$14174;var $index$14199;var $length$14194;var temp$14189;var acc$14184;var nfw$14008;var nbw$14009;var ndflt$14010;var extract_length$14011;var check_length$14012;var lo$14013;var hi$14014;var t$14015;var len$14016;var fw$14001;var bw$14002;var dflt$14003;var rest$14004;var subp$13930;var xs$13865;var xs$13823;var patt$13813;var projector$13802;var subp$13803;var checker$13791;var subp$13792;var checker$13780;var condition$13773;var subp$13774;var kind$13768;var sym$13759;var $13732$13744;var $13733$13745;var $13734$13746;var $13735$13747;var t0$13742;var $13731$13737;var rval$13728;var self$13723;var it$0$13718;(it$0$13718=this);(self$13723=this);(rval$13728=((($13731$13737=pattern$13713)),function(){if((((x$13752=$13731$13737)),((x$13752 instanceof Array)&&(x$13752[0]==="ignore")))){return it$0$13718.do(rhs$13714);}else{if((($13732$13744=($13731$13737 instanceof Array))&&(((t0$13742=$13731$13737.length)),(($13734$13746=(t0$13742===2))&&($13731$13737[0]==="assign"))))){(sym$13759=$13731$13737[1]);return it$0$13718.parts.push(fns$13715.assign(sym$13759,rhs$13714));}else{if(($13734$13746&&($13731$13737[0]==="special"))){(kind$13768=$13731$13737[1]);return it$0$13718.process(fns$13715.special(pattern$13713,rhs$13714),rhs$13714,fns$13715);}else{if(($13732$13744&&(($13734$13746=(t0$13742===3))&&($13731$13737[0]==="test")))){(condition$13773=$13731$13737[1]);(subp$13774=$13731$13737[2]);it$0$13718.process(subp$13774,rhs$13714,fns$13715);return it$0$13718.check(condition$13773,({"test":true}));}else{if(($13734$13746&&(($13735$13747=($13731$13737[0]==="check"))&&((checker$13780=$13731$13737[1]),(((x$13784=$13731$13737[2])),((x$13784 instanceof Array)&&(x$13784[0]==="ignore"))))))){return it$0$13718.check(["send",checker$13780,["data",rhs$13714]]);}else{if($13735$13747){(checker$13791=$13731$13737[1]);(subp$13792=$13731$13737[2]);(t$13796=it$0$13718.temp(rhs$13714));it$0$13718.check(["send",checker$13791,["data",t$13796]]);return it$0$13718.process(subp$13792,t$13796,fns$13715);}else{if(($13734$13746&&($13731$13737[0]==="project"))){(projector$13802=$13731$13737[1]);(subp$13803=$13731$13737[2]);(t$13807=it$0$13718.temp(["send",projector$13802,["data",rhs$13714]]));it$0$13718.check(["send",t$13807,["value",0]]);return it$0$13718.process(subp$13803,["send",t$13807,["value",1]],fns$13715);}else{if(($13732$13744&&((t0$13742===2)&&($13731$13737[0]==="neg")))){(patt$13813=$13731$13737[1]);return it$0$13718.check(["send",["symbol","not"],["data",["void"],(((pp$13817=PatternProcessor$12762())),pp$13817.process(patt$13813,rhs$13714,fns$13715),assemble_conditions$12763(pp$13817))]]);}else{if(($13732$13744&&(($13734$13746=(t0$13742>=1))&&($13731$13737[0]==="all")))){(xs$13823=Array.prototype.slice.call($13731$13737,1));(t$13827=it$0$13718.temp(rhs$13714));(temp$13835=xs$13823);($length$13840=temp$13835.length);($index$13845=0);$13828:for(;($index$13845<$length$13840);($index$13845++)){var x$13861;var m$13853;(m$13853=temp$13835[$index$13845]);(x$13861=m$13853);it$0$13718.process(x$13861,t$13827,fns$13715);}return null;}else{if(($13734$13746&&($13731$13737[0]==="any"))){(xs$13865=Array.prototype.slice.call($13731$13737,1));(t$13869=it$0$13718.temp(rhs$13714,["symbol",gensym$12754("bridge")]));return it$0$13718.check((((fn$13874=function(x$13879,rest$13880){return ["send",["symbol","or"],["data",x$13879,rest$13880]];})),((parts$13875=(((acc$13888=[])),(((temp$13893=xs$13865)),((($length$13898=temp$13893.length)),((($index$13903=0)),function(){$13885:for(;($index$13903<$length$13898);($index$13903++)){var pp$13923;var x$13919;var m$13911;(m$13911=temp$13893[$index$13903]);(x$13919=m$13911);acc$13888.push((((pp$13923=PatternProcessor$12762())),pp$13923.process(x$13919,t$13869,fns$13715),assemble_conditions$12763(pp$13923)));}}()))),acc$13888))),util$12752.construct(parts$13875,fn$13874,["symbol","false"])));}else{if(($13734$13746&&($13731$13737[0]==="object_pattern"))){(subp$13930=Array.prototype.slice.call($13731$13737,1));(t$13934=it$0$13718.temp(rhs$13714));(acc$13941=[]);(temp$13946=subp$13930);($length$13951=temp$13946.length);($index$13956=0);$13935:for(;($index$13956<$length$13951);($index$13956++)){var k$13976;var v$13977;var t0$13969;var t1$13970;var t2$13971;var t3$13972;var m$13964;(m$13964=temp$13946[$index$13956]);(t0$13969=m$13964);if(((t0$13969 instanceof Array)&&(((t1$13970=t0$13969.length)),((t1$13970===2)&&(((t2$13971=t0$13969[0])),((t2$13971 instanceof Array)&&(((t3$13972=t2$13971.length)),((t3$13972===2)&&(t2$13971[0]==="value"))))))))){(k$13976=t2$13971[1]);(v$13977=t0$13969[1]);acc$13941.push((it$0$13718.check(["send",["symbol","___hasprop"],["data",t$13934,["value",k$13976]]]),it$0$13718.process(v$13977,["send",t$13934,["value",k$13976]],fns$13715)));}else{$16180(m$13964,"/home/olivier/git/earl-grey/src/pattern.eg",8076,8208);}}return acc$13941;}else{if(($13732$13744&&((t0$13742===5)&&($13731$13737[0]==="array_pattern")))){(fw$14001=$13731$13737[1]);(bw$14002=$13731$13737[2]);(dflt$14003=$13731$13737[3]);(rest$14004=$13731$13737[4]);(nfw$14008=fw$14001.length);(nbw$14009=bw$14002.length);(ndflt$14010=dflt$14003.length);(extract_length$14011=true);(check_length$14012=true);(lo$14013=(nfw$14008+nbw$14009));(hi$14014=(lo$14013+ndflt$14010));(t$14015=it$0$13718.temp(rhs$13714));(len$14016=it$0$13718.temp(["send",t$14015,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));it$0$13718.check(((($14050$14052=rest$14004)),function(){if($14050$14052){return ["send",["symbol",">="],["data",len$14016,["value",lo$14013]]];}else{$14050$14052;if((lo$14013===hi$14014)){return ["send",["symbol","==="],["data",len$14016,["value",lo$14013]]];}else{(otherwise$14068=$14050$14052);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$14016,["value",lo$14013]]],["send",["symbol","<="],["data",len$14016,["value",hi$14014]]]]];}}}()));(temp$14072=$16158(fw$14001));($length$14077=temp$14072.length);($index$14082=0);$14017:for(;($index$14082<$length$14077);($index$14082++)){var i$14100;var m$14101;var t0$14095;var t1$14096;var m$14090;(m$14090=temp$14072[$index$14082]);(t0$14095=m$14090);if(((t0$14095 instanceof Array)&&(((t1$14096=t0$14095.length)),(t1$14096===2)))){(i$14100=t0$14095[0]);(m$14101=t0$14095[1]);it$0$13718.process(m$14101,["send",t$14015,["value",i$14100]],fns$13715);}else{$16180(m$14090,"/home/olivier/git/earl-grey/src/pattern.eg",8940,9026);}}(temp$14115=$16158(dflt$14003));($length$14120=temp$14115.length);($index$14125=0);$14019:for(;($index$14125<$length$14120);($index$14125++)){var idx$14167;var i$14145;var patt$14146;var value$14147;var t0$14138;var t1$14139;var t2$14140;var t3$14141;var m$14133;(m$14133=temp$14115[$index$14125]);(t0$14138=m$14133);if(((t0$14138 instanceof Array)&&(((t1$14139=t0$14138.length)),((t1$14139===2)&&((i$14145=t0$14138[0]),(((t2$14140=t0$14138[1])),((t2$14140 instanceof Array)&&(((t3$14141=t2$14140.length)),(t3$14141===2))))))))){(patt$14146=t2$14140[0]);(value$14147=t2$14140[1]);(idx$14167=(i$14145+nfw$14008));it$0$13718.process(patt$14146,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$14167+nbw$14009)],len$14016]],value$14147,["send",t$14015,["value",idx$14167]]]],fns$13715);}else{$16180(m$14133,"/home/olivier/git/earl-grey/src/pattern.eg",9026,9195);}}if((rest$14004!==(void 0))){(pos$14174=(nfw$14008+ndflt$14010));(end$14179=function(){if((nbw$14009>0)){return [["value",(-nbw$14009)]];}else{return [];}}());it$0$13718.process(rest$14004,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$14015,["value",pos$14174]].concat(end$14179)],fns$13715);}else{[];}(acc$14184=[]);(temp$14189=$16158(bw$14002));($length$14194=temp$14189.length);($index$14199=0);$14021:for(;($index$14199<$length$14194);($index$14199++)){var i$14217;var m$14218;var t0$14212;var t1$14213;var m$14207;(m$14207=temp$14189[$index$14199]);(t0$14212=m$14207);if(((t0$14212 instanceof Array)&&(((t1$14213=t0$14212.length)),(t1$14213===2)))){(i$14217=t0$14212[0]);(m$14218=t0$14212[1]);acc$14184.push(it$0$13718.process(m$14218,["send",["symbol","___js_fetch"],["data",t$14015,["send",["symbol","-"],["data",len$14016,["value",(nbw$14009-i$14217)]]]]],fns$13715));}else{$16180(m$14207,"/home/olivier/git/earl-grey/src/pattern.eg",9646,9797);}}return acc$14184;}else{$16180($13731$13737);}}}}}}}}}}}}}()));return rval$13728;});$12694(PatternProcessor$12762,$12694(((accum$14235=({})),((accum$14235["::name"]="PatternProcessor"),accum$14235)),((accum$14239=({})),((accum$14239["::egclass"]=true),accum$14239))));PatternProcessor$12762;(assemble_conditions$12763=function(pp$14245){var $index$14348;var $length$14343;var temp$14338;var acc$14333;var decls$14327;var construct$14248;(construct$14248=function($14251$14253){var x$14311;var rest$14312;var x$14298;var x$14284;var rest$14285;var $14256$14272;var $14257$14273;var t0$14268;var t1$14269;var t2$14270;var $14255$14263;var ph$14258;(ph$14258=$14251$14253);($14255$14263=ph$14258);if((($14256$14272=($14255$14263 instanceof Array))&&(((t0$14268=$14255$14263.length)),(t0$14268===0)))){return ["value",true];}else{if(($14256$14272&&((t0$14268>=1)&&(((t1$14269=$14255$14263[0])),((t1$14269 instanceof Array)&&(((t2$14270=t1$14269.length)),((t2$14270===2)&&(t1$14269[0]==="do")))))))){(x$14284=t1$14269[1]);(rest$14285=Array.prototype.slice.call($14255$14263,1));return ["multi",x$14284,construct$14248(rest$14285)];}else{if(($14256$14272&&((t0$14268===1)&&(((t1$14269=$14255$14263[0])),((t1$14269 instanceof Array)&&(((t2$14270=t1$14269.length)),((t2$14270===2)&&(t1$14269[0]==="check")))))))){(x$14298=t1$14269[1]);return x$14298;}else{if(($14256$14272&&((t0$14268>=1)&&(((t1$14269=$14255$14263[0])),((t1$14269 instanceof Array)&&(((t2$14270=t1$14269.length)),((t2$14270===2)&&(t1$14269[0]==="check")))))))){(x$14311=t1$14269[1]);(rest$14312=Array.prototype.slice.call($14255$14263,1));return ["send",["symbol","and"],["data",x$14311,construct$14248(rest$14312)]];}else{$16180($14255$14263);}}}}});if(pp$14245.temps.length){(decls$14327=(((acc$14333=[])),(((temp$14338=pp$14245.temps)),((($length$14343=temp$14338.length)),((($index$14348=0)),function(){$14330:for(;($index$14348<$length$14343);($index$14348++)){var t$14364;var m$14356;(m$14356=temp$14338[$index$14348]);(t$14364=m$14356);acc$14333.push(["declare",t$14364]);}}()))),acc$14333));return ["multi"].concat(decls$14327).concat([construct$14248(pp$14245.parts)]);}else{return construct$14248(pp$14245.parts);}});(assemble_pattern$12764=function(){var $index$14422;var $length$14417;var temp$14412;var $index$14477;var $length$14472;var temp$14467;var test$14597;var lead$14392;var trail$14393;var construct$14394;var parts$14383;var t$14384;var f$14385;var t0$14379;var $14372$14374;($14372$14374=arguments);(t0$14379=$14372$14374.length);if(((t0$14379>=2)&&(t0$14379<=3))){(parts$14383=$14372$14374[0]);(t$14384=$14372$14374[1]);(f$14385=function(){if((2>=t0$14379)){return null;}else{return $14372$14374[2];}}());(lead$14392=[]);(temp$14412=parts$14383.slice(0));($length$14417=temp$14412.length);($index$14422=0);$14395:for(;($index$14422<$length$14417);($index$14422++)){var x$14457;var x$14444;var $14397$14438;var $14398$14439;var $14399$14440;var $14400$14441;var t0$14435;var t1$14436;var m$14430;(m$14430=temp$14412[$index$14422]);(t0$14435=m$14430);if((($14398$14439=(t0$14435 instanceof Array))&&(((t1$14436=t0$14435.length)),(($14400$14441=(t1$14436===2))&&(t0$14435[0]==="do"))))){(x$14444=t0$14435[1]);lead$14392.push(x$14444);parts$14383.shift();}else{if(($14400$14441&&(t0$14435[0]==="check"))){(x$14457=t0$14435[1]);break $14395;}else{$16180(m$14430,"/home/olivier/git/earl-grey/src/pattern.eg",10258,10368);}}}(trail$14393=[]);(temp$14467=parts$14383.slice(0).reverse());($length$14472=temp$14467.length);($index$14477=0);$14401:for(;($index$14477<$length$14472);($index$14477++)){var x$14512;var x$14499;var $14403$14493;var $14404$14494;var $14405$14495;var $14406$14496;var t0$14490;var t1$14491;var m$14485;(m$14485=temp$14467[$index$14477]);(t0$14490=m$14485);if((($14404$14494=(t0$14490 instanceof Array))&&(((t1$14491=t0$14490.length)),(($14406$14496=(t1$14491===2))&&(t0$14490[0]==="do"))))){(x$14499=t0$14490[1]);trail$14393.unshift(x$14499);parts$14383.pop();}else{if(($14406$14496&&(t0$14490[0]==="check"))){(x$14512=t0$14490[1]);break $14401;}else{$16180(m$14485,"/home/olivier/git/earl-grey/src/pattern.eg",10382,10504);}}}(construct$14394=function($14519$14521){var other$14593;var x$14579;var rest$14580;var x$14566;var x$14552;var rest$14553;var $14524$14540;var $14525$14541;var t0$14536;var t1$14537;var t2$14538;var $14523$14531;var ph$14526;(ph$14526=$14519$14521);($14523$14531=ph$14526);if((($14524$14540=($14523$14531 instanceof Array))&&(((t0$14536=$14523$14531.length)),(t0$14536===0)))){return ["value",true];}else{if(($14524$14540&&((t0$14536>=1)&&(((t1$14537=$14523$14531[0])),((t1$14537 instanceof Array)&&(((t2$14538=t1$14537.length)),((t2$14538===2)&&(t1$14537[0]==="do")))))))){(x$14552=t1$14537[1]);(rest$14553=Array.prototype.slice.call($14523$14531,1));return ["multi",x$14552,construct$14394(rest$14553)];}else{if(($14524$14540&&((t0$14536===1)&&(((t1$14537=$14523$14531[0])),((t1$14537 instanceof Array)&&(((t2$14538=t1$14537.length)),((t2$14538===2)&&(t1$14537[0]==="check")))))))){(x$14566=t1$14537[1]);return x$14566;}else{if(($14524$14540&&((t0$14536>=1)&&(((t1$14537=$14523$14531[0])),((t1$14537 instanceof Array)&&(((t2$14538=t1$14537.length)),((t2$14538===2)&&(t1$14537[0]==="check")))))))){(x$14579=t1$14537[1]);(rest$14580=Array.prototype.slice.call($14523$14531,1));return ["send",["symbol","and"],["data",x$14579,construct$14394(rest$14580)]];}else{(other$14593=$14523$14531);throw $15962(["oops"]).create("?!?",other$14593);}}}}});if(parts$14383.length){(test$14597=construct$14394(parts$14383));return ["multi"].concat(lead$14392).concat([function(){if(f$14385){return ["send",["symbol","if"],["data",test$14597,["multi"].concat(trail$14393).concat([t$14384]),f$14385]];}else{return ["send",["symbol","if"],["data",test$14597,["multi"].concat(trail$14393).concat([t$14384])]];}}()]);}else{return ["multi"].concat(lead$14392).concat(trail$14393).concat([t$14384]);}}else{$16180($14372$14374);}});(inject_below_uses$12765=function($14606$14608,fn$14609){var other$14636;var scope$14626;var x$14627;var t0$14622;var $14611$14617;var ph$14612;(ph$14612=$14606$14608);($14611$14617=ph$14612);if((($14611$14617 instanceof Array)&&(((t0$14622=$14611$14617.length)),((t0$14622===3)&&($14611$14617[0]==="use"))))){(scope$14626=$14611$14617[1]);(x$14627=$14611$14617[2]);return ["use",scope$14626,inject_below_uses$12765(x$14627,fn$14609)];}else{(other$14636=$14611$14617);return fn$14609(other$14636);}});(parse_pattern$12766=function(scope$14642,pattern$14643,rhs$14644,opt$14645){var t0$14656;var $index$14698;var $length$14693;var temp$14688;var acc$14683;var parse$14648;var target$14649;var proc$14650;(parse$14648=PatternParser$12761(scope$14642,pattern$14643,opt$14645));if(((!opt$14645.allow_arguments)&&parse$14648.arguments.length)){throw $15962(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$14648.arguments[0]}));}(t0$14656=$16328((opt$14645.wrap_target||identity$12758))(function(){if(parse$14648.arguments.length){return inject_below_uses$12765(rhs$14644,function(x$14661){return util$12752.construct(parse$14648.arguments.concat([x$14661]),function(args$14664,rest$14665){return ["send",["symbol","->"],["data",args$14664,rest$14665]];});});}else{return rhs$14644;}}()));if(t0$14656[0]){(target$14649=t0$14656[1]);}else{$16180(function(){if(parse$14648.arguments.length){return inject_below_uses$12765(rhs$14644,function(x$14671){return util$12752.construct(parse$14648.arguments.concat([x$14671]),function(args$14674,rest$14675){return ["send",["symbol","->"],["data",args$14674,rest$14675]];});});}else{return rhs$14644;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11897,12330);}(proc$14650=PatternProcessor$12762());proc$14650.process(parse$14648.pattern,target$14649,opt$14645);if(opt$14645.finalize){return ["splice"].concat(opt$14645.declare(scope$14642,parse$14648.vars)).concat([["multi"].concat((((acc$14683=[])),(((temp$14688=proc$14650.temps)),((($length$14693=temp$14688.length)),((($index$14698=0)),function(){$14680:for(;($index$14698<$length$14693);($index$14698++)){var t$14714;var m$14706;(m$14706=temp$14688[$index$14698]);(t$14714=m$14706);acc$14683.push(["declare",t$14714]);}}()))),acc$14683)).concat([assemble_pattern$12764(proc$14650.parts,opt$14645.success(target$14649),opt$14645.failure(target$14649))])]);}else{return [parse$14648.vars,proc$14650.temps,proc$14650.parts];}});(checkall$12767=["send","data","multi","assign","void","check","do"]);(same_block$12768=function($14723$14725,ban1$14726,ban2$14727){var $index$14867;var $length$14862;var temp$14857;var other$14888;var type1$14834;var args1$14835;var type2$14836;var args2$14837;var m1$14819;var m2$14820;var v1$14804;var v2$14805;var s1$14789;var s2$14790;var v1$14762;var v2$14763;var $14730$14753;var $14731$14754;var $14732$14755;var $14733$14756;var $14734$14757;var $14735$14758;var $14736$14759;var t0$14747;var t1$14748;var t2$14749;var t3$14750;var t4$14751;var $14729$14742;var ph$14737;(ph$14737=$14723$14725);($14729$14742=ph$14737);if((($14730$14753=($14729$14742 instanceof Array))&&(((t0$14747=$14729$14742.length)),(($14732$14755=(t0$14747===2))&&(((t1$14748=$14729$14742[0])),(($14734$14757=(t1$14748 instanceof Array))&&(((t2$14749=t1$14748.length)),(($14736$14759=(t2$14749===2))&&((t1$14748[0]==="variable")&&((v1$14762=t1$14748[1]),(((t3$14750=$14729$14742[1])),((t3$14750 instanceof Array)&&(((t4$14751=t3$14750.length)),((t4$14751===2)&&(t3$14750[0]==="variable"))))))))))))))){(v2$14763=t3$14750[1]);return (v1$14762===v2$14763);}else{if(($14736$14759&&((t1$14748[0]==="symbol")&&((s1$14789=t1$14748[1]),(((t3$14750=$14729$14742[1])),((t3$14750 instanceof Array)&&(((t4$14751=t3$14750.length)),((t4$14751===2)&&(t3$14750[0]==="symbol"))))))))){(s2$14790=t3$14750[1]);return (((!$12693(ban1$14726,s1$14789))&&(!$12693(ban2$14727,s2$14790)))&&(s1$14789===s2$14790));}else{if(($14736$14759&&((t1$14748[0]==="value")&&((v1$14804=t1$14748[1]),(((t3$14750=$14729$14742[1])),((t3$14750 instanceof Array)&&(((t4$14751=t3$14750.length)),((t4$14751===2)&&(t3$14750[0]==="value"))))))))){(v2$14805=t3$14750[1]);return (v1$14804===v2$14805);}else{if(($14736$14759&&((t1$14748[0]==="macro")&&((m1$14819=t1$14748[1]),(((t3$14750=$14729$14742[1])),((t3$14750 instanceof Array)&&(((t4$14751=t3$14750.length)),((t4$14751===2)&&(t3$14750[0]==="macro"))))))))){(m2$14820=t3$14750[1]);return (m1$14819===m2$14820);}else{if(($14734$14757&&((t2$14749>=1)&&((type1$14834=t1$14748[0]),((args1$14835=Array.prototype.slice.call(t1$14748,1)),(((t3$14750=$14729$14742[1])),((t3$14750 instanceof Array)&&(((t4$14751=t3$14750.length)),((t4$14751>=1)&&((type2$14836=t3$14750[0]),((args2$14837=Array.prototype.slice.call(t3$14750,1)),(checkall$12767.indexOf(type1$14834)!==-1)))))))))))){if(((type1$14834===type2$14836)&&(args1$14835.length===args2$14837.length))){(temp$14857=$16365(args1$14835,args2$14837));($length$14862=temp$14857.length);($index$14867=0);$14853:for(;($index$14867<$length$14862);($index$14867++)){var pair$14883;var m$14875;(m$14875=temp$14857[$index$14867]);(pair$14883=m$14875);if((!same_block$12768(pair$14883,ban1$14726,ban2$14727))){return false;}}return true;}else{return false;}}else{(other$14888=$14729$14742);return false;}}}}}});(parse_clauses$12769=function(scope$14894,target$14895,stmts$14896,opt$14897){var $index$14927;var $length$14922;var temp$14917;var acc$14912;var $index$15136;var $length$15131;var temp$15126;var acc$15121;var $index$15190;var $length$15185;var temp$15180;var acc$15175;var decls$15169;var all_temps$14900;var the_parts$14901;var unique_temps$14902;(all_temps$14900=[]);(the_parts$14901=(((acc$14912=[])),(((temp$14917=scope$14894.step_all(["clause"],stmts$14896))),((($length$14922=temp$14917.length)),((($index$14927=0)),function(){$14908:for(;($index$14927<$length$14922);($index$14927++)){var accum$15020;var accum$15035;var t0$15014;var t1$15015;var $index$15058;var $length$15053;var temp$15048;var bod$15094;var placeholder$14959;var special_fn$14960;var vars$14961;var temps$14962;var blocks$14963;var vars2$14964;var x$15103;var other$15111;var b$15100;var pattern$14946;var body$14947;var $14910$14943;var t0$14940;var t1$14941;var m$14935;(m$14935=temp$14917[$index$14927]);(t0$14940=m$14935);if(((t0$14940 instanceof Array)&&(((t1$14941=t0$14940.length)),((t1$14941===3)&&(t0$14940[0]==="clause"))))){(pattern$14946=t0$14940[1]);(body$14947=t0$14940[2]);acc$14912.push((((placeholder$14959=(void 0))),((special_fn$14960=function($14972$14974,value$14975){var t0$14981;var t1$14982;var other$15010;var $14977$14994;var ph$14978;var expr$14979;(t0$14981=$14972$14974);if(((t0$14981 instanceof Array)&&(((t1$14982=t0$14981.length)),((t1$14982===2)&&(t0$14981[0]==="special"))))){(ph$14978=t0$14981[1]);(expr$14979=t0$14981);}else{$16180($14972$14974);}($14977$14994=ph$14978);if(($14977$14994==="match")){(placeholder$14959=__lt____lt____colon__$12751(["symbol",scope$14894.gensym("ph")],expr$14979));return ["assign",placeholder$14959];}else{(other$15010=$14977$14994);throw $15962(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$14979}));}})),(((t0$15014=parse_pattern$12766(scope$14894,pattern$14946,target$14895,$16196(opt$14897,$12694(({"allow_arguments":false,"allow_nested":true,"special":special_fn$14960}),$12694(((accum$15020=({})),((accum$15020["assign"]=function(v$15024,value$15025){return ["do",__lt____lt____colon__$12751(["assign",v$15024,value$15025],v$15024)];}),accum$15020)),({"finalize":false}))))))),function(){if(((t0$15014 instanceof Array)&&(((t1$15015=t0$15014.length)),(t1$15015===3)))){(vars$14961=t0$15014[0]);(temps$14962=t0$15014[1]);(blocks$14963=t0$15014[2]);}else{return $16180(parse_pattern$12766(scope$14894,pattern$14946,target$14895,$16196(opt$14897,$12694(({"allow_arguments":false,"allow_nested":true,"special":special_fn$14960}),$12694(((accum$15035=({})),((accum$15035["assign"]=function(v$15039,value$15040){return ["do",__lt____lt____colon__$12751(["assign",v$15039,value$15040],v$15039)];}),accum$15035)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",13964,14311);}}()),(all_temps$14900=all_temps$14900.concat(temps$14962)),function(){if(placeholder$14959){return vars$14961.push(placeholder$14959);}}(),((vars2$14964=({}))),(((temp$15048=vars$14961)),((($length$15053=temp$15048.length)),((($index$15058=0)),function(){$14965:for(;($index$15058<$length$15053);($index$15058++)){var other$15091;var xxx$15076;var t0$15071;var t1$15072;var m$15066;(m$15066=temp$15048[$index$15058]);(t0$15071=m$15066);if(((t0$15071 instanceof Array)&&(((t1$15072=t0$15071.length)),((t1$15072===2)&&(t0$15071[0]==="symbol"))))){(xxx$15076=t0$15071[1]);(vars2$14964[xxx$15076]=true);}else{(other$15091=m$15066);throw $15962(["syntax","unexpected"]).create();}}}()))),(((bod$15094=function(){if(placeholder$14959){return parse_clauses$12769(scope$14894,placeholder$14959,$16328(["multi"])(body$14947)[1],opt$14897);}else{if(opt$14897.wrap){return opt$14897.wrap(body$14947);}else{return body$14947;}}}())),["clause",vars$14961,vars2$14964,blocks$14963,bod$15094])));}else{if((((x$15103=t0$14940)),((x$15103 instanceof Array)&&(x$15103[0]==="block")))){(b$15100=t0$14940);acc$14912.push(b$15100);}else{(other$15111=m$14935);acc$14912.push(function(){throw $15962(["syntax","clause"]).create("Illegal clause",({"clause":other$15111}));}());}}}}()))),acc$14912));if(opt$14897.fallback){the_parts$14901.push(["block",opt$14897.fallback(target$14895)]);}(unique_temps$14902=$16327(util$12752.mkset((((acc$15121=[])),(((temp$15126=all_temps$14900)),((($length$15131=temp$15126.length)),((($index$15136=0)),function(){$15118:for(;($index$15136<$length$15131);($index$15136++)){var t$15154;var t0$15149;var t1$15150;var m$15144;(m$15144=temp$15126[$index$15136]);(t0$15149=m$15144);if(((t0$15149 instanceof Array)&&(((t1$15150=t0$15149.length)),((t1$15150===2)&&(t0$15149[0]==="symbol"))))){(t$15154=t0$15149[1]);acc$15121.push(t$15154);}else{$16180(m$15144,"/home/olivier/git/earl-grey/src/pattern.eg",15120,15150);}}}()))),acc$15121))));(decls$15169=(((acc$15175=[])),(((temp$15180=unique_temps$14902)),((($length$15185=temp$15180.length)),((($index$15190=0)),function(){$15172:for(;($index$15190<$length$15185);($index$15190++)){var t$15206;var m$15198;(m$15198=temp$15180[$index$15190]);(t$15206=m$15198);acc$15175.push(["declare",["symbol",t$15206]]);}}()))),acc$15175));return ["multi"].concat(decls$15169).concat([weave_clauses$12771(the_parts$14901)]);});(opt_clauses$12770=function(clauses$15214){var $index$15243;var $length$15238;var temp$15233;var acc$15228;var $index$15400;var $length$15395;var temp$15390;var acc$15385;var $index$15452;var $length$15447;var temp$15442;var acc$15437;var $index$15497;var $length$15492;var temp$15487;var acc$15482;var shares$15217;var max$15218;var temps$15219;var shared_last$15220;var idx_last$15221;var new_clauses$15222;(shares$15217=(((acc$15228=[])),(((temp$15233=$16158(clauses$15214.slice(1)))),((($length$15238=temp$15233.length)),((($index$15243=0)),function(){$15225:for(;($index$15243<$length$15238);($index$15243++)){var t0$15295;var t1$15296;var $index$15325;var $length$15320;var temp$15315;var varsd0$15288;var blocks0$15289;var share$15290;var idx$15291;var i$15263;var vars$15264;var varsd$15265;var blocks$15266;var body$15267;var t0$15256;var t1$15257;var t2$15258;var t3$15259;var m$15251;(m$15251=temp$15233[$index$15243]);(t0$15256=m$15251);if(((t0$15256 instanceof Array)&&(((t1$15257=t0$15256.length)),((t1$15257===2)&&((i$15263=t0$15256[0]),(((t2$15258=t0$15256[1])),((t2$15258 instanceof Array)&&(((t3$15259=t2$15258.length)),((t3$15259===5)&&(t2$15258[0]==="clause")))))))))){(vars$15264=t2$15258[1]);(varsd$15265=t2$15258[2]);(blocks$15266=t2$15258[3]);(body$15267=t2$15258[4]);acc$15228.push(((((t0$15295=$12693(clauses$15214,i$15263))),function(){if(((t0$15295 instanceof Array)&&(((t1$15296=t0$15295.length)),((t1$15296===5)&&(t0$15295[0]==="clause"))))){t0$15295[1];(varsd0$15288=t0$15295[2]);(blocks0$15289=t0$15295[3]);t0$15295[4];}else{return $16180($12693(clauses$15214,i$15263),"/home/olivier/git/earl-grey/src/pattern.eg",15423,15443);}}()),((share$15290=0)),((idx$15291=0)),(((temp$15315=blocks$15266)),((($length$15320=temp$15315.length)),((($index$15325=0)),function(){$15292:for(;($index$15325<$length$15320);($index$15325++)){var x$15356;var x$15365;var other$15375;var $15344$15346;var b$15341;var m$15333;(m$15333=temp$15315[$index$15325]);(b$15341=m$15333);if(same_block$12768([$12693(blocks0$15289,share$15290),b$15341],varsd0$15288,varsd$15265)){(share$15290++);($15344$15346=b$15341);if((((x$15356=$15344$15346)),((x$15356 instanceof Array)&&(x$15356[0]==="do")))){null;}else{if((((x$15365=$15344$15346)),((x$15365 instanceof Array)&&(x$15365[0]==="check")))){(idx$15291=share$15290);}else{(other$15375=$15344$15346);__lt____gt__$12749(null,other$15375);}}}else{break $15292;}}}()))),[share$15290,idx$15291]));}else{$16180(m$15251,"/home/olivier/git/earl-grey/src/pattern.eg",15299,15827);}}}()))),acc$15228));(max$15218=$12693(Math.max,(((acc$15385=[])),(((temp$15390=shares$15217)),((($length$15395=temp$15390.length)),((($index$15400=0)),function(){$15382:for(;($index$15400<$length$15395);($index$15400++)){var x$15418;var t0$15413;var t1$15414;var m$15408;(m$15408=temp$15390[$index$15400]);(t0$15413=m$15408);if(((t0$15413 instanceof Array)&&(((t1$15414=t0$15413.length)),(t1$15414===2)))){(x$15418=t0$15413[0]);t0$15413[1];acc$15385.push(x$15418);}else{$16180(m$15408,"/home/olivier/git/earl-grey/src/pattern.eg",15841,15870);}}}()))),acc$15385)));shares$15217.push([0,0]);(temps$15219=(((acc$15437=[])),(((temp$15442=$16420(1,max$15218))),((($length$15447=temp$15442.length)),((($index$15452=0)),function(){$15434:for(;($index$15452<$length$15447);($index$15452++)){var m$15460;(m$15460=temp$15442[$index$15452]);m$15460;acc$15437.push(["symbol",gensym$12754()]);}}()))),acc$15437));(shared_last$15220=0);(idx_last$15221=0);(new_clauses$15222=(((acc$15482=[])),(((temp$15487=$16158(clauses$15214))),((($length$15492=temp$15487.length)),((($index$15497=0)),function(){$15479:for(;($index$15497<$length$15492);($index$15497++)){var t0$15548;var t1$15549;var $index$15590;var $length$15585;var temp$15580;var acc$15575;var rest$15665;var newblocks$15661;var share$15542;var idx$15543;var shared$15544;var n_to_share$15545;var to_share$15546;var other$15672;var i$15517;var vars$15518;var varsd$15519;var blocks$15520;var body$15521;var t0$15510;var t1$15511;var t2$15512;var t3$15513;var m$15505;(m$15505=temp$15487[$index$15497]);(t0$15510=m$15505);if(((t0$15510 instanceof Array)&&(((t1$15511=t0$15510.length)),((t1$15511===2)&&((i$15517=t0$15510[0]),(((t2$15512=t0$15510[1])),((t2$15512 instanceof Array)&&(((t3$15513=t2$15512.length)),((t3$15513===5)&&(t2$15512[0]==="clause")))))))))){(vars$15518=t2$15512[1]);(varsd$15519=t2$15512[2]);(blocks$15520=t2$15512[3]);(body$15521=t2$15512[4]);acc$15482.push(((((t0$15548=$12693(shares$15217,i$15517))),function(){if(((t0$15548 instanceof Array)&&(((t1$15549=t0$15548.length)),(t1$15549===2)))){(share$15542=t0$15548[0]);(idx$15543=t0$15548[1]);}else{return $16180($12693(shares$15217,i$15517),"/home/olivier/git/earl-grey/src/pattern.eg",16099,16118);}}()),((shared$15544=function(){if(idx_last$15221){return [["check",$12693(temps$15219,(idx_last$15221-1))]];}else{return [];}}())),((n_to_share$15545=Math.max(shared_last$15220,share$15542))),((to_share$15546=(((acc$15575=[])),(((temp$15580=$16158(blocks$15520.slice(shared_last$15220,n_to_share$15545)))),((($length$15585=temp$15580.length)),((($index$15590=0)),function(){$15568:for(;($index$15590<$length$15585);($index$15590++)){var j$15637;var x$15638;var j$15614;var x$15615;var $15570$15608;var $15571$15609;var $15572$15610;var $15573$15611;var t0$15603;var t1$15604;var t2$15605;var t3$15606;var m$15598;(m$15598=temp$15580[$index$15590]);(t0$15603=m$15598);if((($15571$15609=(t0$15603 instanceof Array))&&(((t1$15604=t0$15603.length)),(($15573$15611=(t1$15604===2))&&((j$15614=t0$15603[0]),(((t2$15605=t0$15603[1])),((t2$15605 instanceof Array)&&(((t3$15606=t2$15605.length)),((t3$15606===2)&&(t2$15605[0]==="check")))))))))){(x$15615=t2$15605[1]);acc$15575.push(["check",["assign",$12693(temps$15219,(shared_last$15220+j$15614)),x$15615]]);}else{if(($15573$15611&&((j$15637=t0$15603[0]),(((t2$15605=t0$15603[1])),((t2$15605 instanceof Array)&&(((t3$15606=t2$15605.length)),((t3$15606===2)&&(t2$15605[0]==="do")))))))){(x$15638=t2$15605[1]);acc$15575.push(["do",x$15638]);}else{$16180(m$15598,"/home/olivier/git/earl-grey/src/pattern.eg",16247,16418);}}}}()))),acc$15575))),((shared_last$15220=share$15542)),((idx_last$15221=idx$15543)),(((newblocks$15661=(((rest$15665=blocks$15520.slice(n_to_share$15545))),shared$15544.concat(to_share$15546).concat(rest$15665)))),["clause",vars$15518,varsd$15519,newblocks$15661,body$15521])));}else{(other$15672=m$15505);acc$15482.push(function(){throw $15962(["oops"]).create("what",({"value":other$15672}));}());}}}()))),acc$15482));return [temps$15219,new_clauses$15222];});(weave_clauses$12771=function(parts$15680){var $index$15732;var $length$15727;var temp$15722;var $index$15929;var $length$15924;var temp$15919;var acc$15914;var groups$15683;var reassemble$15684;var new_temps$15685;var helper$15686;(groups$15683=classify_contiguous$12757(parts$15680,function($15695$15697){var t0$15701;var t1$15702;var cls$15699;(t0$15701=$15695$15697);if(((t0$15701 instanceof Array)&&(((t1$15702=t0$15701.length)),(t1$15702>=1)))){(cls$15699=t0$15701[0]);Array.prototype.slice.call(t0$15701,1);}else{$16180($15695$15697);}return cls$15699;}));(reassemble$15684=[]);(new_temps$15685=[]);(temp$15722=groups$15683);($length$15727=temp$15722.length);($index$15732=0);$15687:for(;($index$15732<$length$15727);($index$15732++)){var t0$15768;var t1$15769;var ts$15765;var new_clauses$15766;var elems$15782;var elems$15754;var $15689$15748;var $15690$15749;var $15691$15750;var $15692$15751;var t0$15745;var t1$15746;var m$15740;(m$15740=temp$15722[$index$15732]);(t0$15745=m$15740);if((($15690$15749=(t0$15745 instanceof Array))&&(((t1$15746=t0$15745.length)),(($15692$15751=(t1$15746>=1))&&(t0$15745[0]==="clause"))))){(elems$15754=Array.prototype.slice.call(t0$15745,1));(t0$15768=opt_clauses$12770(elems$15754));if(((t0$15768 instanceof Array)&&(((t1$15769=t0$15768.length)),(t1$15769===2)))){(ts$15765=t0$15768[0]);(new_clauses$15766=t0$15768[1]);}else{$16180(opt_clauses$12770(elems$15754),"/home/olivier/git/earl-grey/src/pattern.eg",16919,16947);}(new_temps$15685=new_temps$15685.concat(ts$15765));(reassemble$15684=reassemble$15684.concat(new_clauses$15766));}else{if(($15692$15751&&(t0$15745[0]==="block"))){(elems$15782=Array.prototype.slice.call(t0$15745,1));(reassemble$15684=reassemble$15684.concat(elems$15782));}else{$16180(m$15740,"/home/olivier/git/earl-grey/src/pattern.eg",16853,17058);}}}(helper$15686=function($15789$15791){var $index$15888;var $length$15883;var temp$15878;var acc$15873;var decls$15867;var vars$15859;var varsd$15860;var blocks$15861;var body$15862;var rest$15863;var body$15833;var rest$15834;var $15794$15817;var $15795$15818;var $15796$15819;var $15797$15820;var $15798$15821;var $15799$15822;var t0$15810;var t1$15811;var t2$15812;var t3$15813;var t4$15814;var t5$15815;var $15793$15805;var ph$15800;(ph$15800=$15789$15791);($15793$15805=ph$15800);if((($15794$15817=($15793$15805 instanceof Array))&&(((t0$15810=$15793$15805.length)),(t0$15810===0)))){return ["multi"];}else{if(($15794$15817&&(($15796$15819=(t0$15810>=1))&&(((t1$15811=$15793$15805[0])),(($15798$15821=(t1$15811 instanceof Array))&&(((t2$15812=t1$15811.length)),((t2$15812===2)&&((t1$15811[0]==="block")&&(((t3$15813=$16328(["multi"])(t1$15811[1]))),(t3$15813[0]&&(((t4$15814=t3$15813[1])),(((t5$15815=t4$15814.length)),(t5$15815>=0))))))))))))){(body$15833=Array.prototype.slice.call(t4$15814,0));(rest$15834=Array.prototype.slice.call($15793$15805,1));return ["multi"].concat(body$15833).concat([helper$15686(rest$15834)]);}else{if(($15798$15821&&((t2$15812===5)&&(t1$15811[0]==="clause")))){(vars$15859=t1$15811[1]);(varsd$15860=t1$15811[2]);(blocks$15861=t1$15811[3]);(body$15862=t1$15811[4]);(rest$15863=Array.prototype.slice.call($15793$15805,1));(decls$15867=(((acc$15873=[])),(((temp$15878=vars$15859)),((($length$15883=temp$15878.length)),((($index$15888=0)),function(){$15870:for(;($index$15888<$length$15883);($index$15888++)){var v$15904;var m$15896;(m$15896=temp$15878[$index$15888]);(v$15904=m$15896);acc$15873.push(["declare",v$15904]);}}()))),acc$15873));return ["tagscope","back",["multi"].concat(decls$15867).concat([assemble_pattern$12764(blocks$15861,body$15862,["use","back",helper$15686(rest$15863)])])];}else{$16180($15793$15805);}}}});return ["multi"].concat((((acc$15914=[])),(((temp$15919=new_temps$15685)),((($length$15924=temp$15919.length)),((($index$15929=0)),function(){$15911:for(;($index$15929<$length$15924);($index$15929++)){var t$15945;var m$15937;(m$15937=temp$15919[$index$15929]);(t$15945=m$15937);acc$15914.push(["declare",t$15945]);}}()))),acc$15914)).concat([helper$15686(reassemble$15684)]);});(exports["PatternParser"]=PatternParser$12761);(exports["PatternProcessor"]=PatternProcessor$12762);(exports["parse_clauses"]=parse_clauses$12769);(exports["parse_pattern"]=parse_pattern$12766);
