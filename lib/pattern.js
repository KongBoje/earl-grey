var $10347=function(type$10349){var f$10352;(f$10352=type$10349["::check"]);;if((f$10352===(void 0))){return function(value$10357){return (value$10357 instanceof type$10349);};}else{return function(value$10360){return f$10352.call(type$10349,value$10360);};}};
var $10362=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $10363=function($10364$10366){var ph$10370;(ph$10370=$10364$10366);;var $10368$10375;($10368$10375=ph$10370);;var bridge$10369$10380;var x$10384;(bridge$10369$10380=$10368$10375);if((((typeof(bridge$10369$10380)==="string")&&((x$10384=bridge$10369$10380),true))||((typeof(bridge$10369$10380)==="number")&&((x$10384=bridge$10369$10380),true)))){return ["value",x$10384];}else{var other$10391;(other$10391=$10368$10375);return other$10391["::serialize_ast"]();}};
var send$10187;(send$10187=function(obj$10192,$10190$10193){var ph$10197;var msg$10198;var t0$10200;(t0$10200=$10190$10193);(msg$10198=t0$10200);(ph$10197=t0$10200);;var $10195$10204;($10195$10204=ph$10197);;var bridge$10196$10209;(bridge$10196$10209=$10195$10204);if(((typeof(bridge$10196$10209)==="string")||(typeof(bridge$10196$10209)==="number"))){return obj$10192[msg$10198];}else{var other$10217;(other$10217=$10195$10204);return obj$10192["::send"](msg$10198);}});;(Array[":::project"]=function($10220$10222){var ph$10225;var value$10226;var t0$10228;(t0$10228=$10220$10222);(value$10226=t0$10228);(ph$10225=t0$10228);;var $10224$10232;($10224$10232=ph$10225);;if($10347(Array)($10224$10232)){return [true,value$10226];}else{$10224$10232;return [true,[value$10226]];}});(Array.prototype["::check"]=function(value$10246){if((value$10246 instanceof Array)){var i$10251;(i$10251=0);;$10249:for(;(i$10251<this.length);(i$10251++)){if(($10362(this,i$10251)!==$10362(value$10246,i$10251))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$10262){if((value$10262 instanceof Array)){var i$10267;(i$10267=0);;$10265:for(;(i$10267<this.length);(i$10267++)){if(($10362(this,i$10267)!==$10362(value$10262,i$10267))){return [true,[value$10262]];}}return [true,value$10262.slice(this.length)];}else{return [true,[value$10262]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($10363));});(RegExp.prototype["::check"]=function($10277$10279){var ph$10282;(ph$10282=$10277$10279);;var $10281$10287;($10281$10287=ph$10282);;var value$10295;if((typeof($10281$10287)==="string")){(value$10295=$10281$10287);if(value$10295.match(this)){return true;}else{return false;}}else{var other$10300;(other$10300=$10281$10287);return false;}});(RegExp.prototype[":::project"]=function($10302$10304){var ph$10307;(ph$10307=$10302$10304);;var $10306$10312;($10306$10312=ph$10307);;var value$10320;if((typeof($10306$10312)==="string")){(value$10320=$10306$10312);var $10323$10325;($10323$10325=value$10320.match(this));;var m$10333;if(($10323$10325===null)){(m$10333=$10323$10325);return [false,null];}else{var m$10338;(m$10338=$10323$10325);return [true,m$10338];}}else{var other$10342;(other$10342=$10306$10312);return [false,null];}});(Function.prototype["::send"]=function(args$10345){return this.apply(this,args$10345);});
var $13347=function(arr$13349){var results$13353;var l$13354;(results$13353=[]);;(l$13354=arr$13349.length);;var i$13362;(i$13362=0);;$13352:for(;(i$13362<l$13354);(i$13362++)){results$13353.push([i$13362,$10362(arr$13349,i$13362)]);}return results$13353;};
var $13369=function(value$13371,url$13372,start$13373,end$13374){var err$13377;(err$13377=$13178(["match"]).create("Could not find a match for value",({"value":value$13371})));;if(url$13372){(err$13377["location"]=["location",url$13372,start$13373,end$13374]);}throw err$13377;};
var $13382=function(dest$13384,values$13385){var k$13390;(k$13390=null);$13388:for(k$13390 in values$13385){if(values$13385.hasOwnProperty(k$13390)){(dest$13384[k$13390]=values$13385[k$13390]);}}return dest$13384;};
var $13178=function(){var $13179$13181;($13179$13181=function(tags$13185){var it$0$13188;(it$0$13188=function(){if((!$10347($13179$13181)(this))){return Object.create($13179$13181.prototype);}else{return this;}}());;(it$0$13188["tags"]=tags$13185);return it$0$13188;});;($13179$13181.prototype["create"]=function(){var $13197$13199;($13197$13199=arguments);;var t0$13204;var message$13208;var args$13209;(t0$13204=$13197$13199.length);if((t0$13204>=0)){(message$13208=function(){if((0>=t0$13204)){return "";}else{return $13197$13199[0];}}());(args$13209=Array.prototype.slice.call($13197$13199,1));var it$0$13213;(it$0$13213=this);;var self$13218;(self$13218=this);;var e$13223;(e$13223=Error(message$13208));;(e$13223["::tags"]=it$0$13213.tags);(e$13223["args"]=args$13209);var temp$13231;(temp$13231=$13347(args$13209));;var $length$13236;($length$13236=temp$13231.length);;var $index$13241;($index$13241=0);;$13224:for(;($index$13241<$length$13236);($index$13241++)){var m$13249;(m$13249=temp$13231[$index$13241]);;var t0$13254;var t1$13255;var i$13259;var arg$13260;(t0$13254=m$13249);if(((t0$13254 instanceof Array)&&((t1$13255=t0$13254.length),(t1$13255===2)))){(i$13259=t0$13254[0]);(arg$13260=t0$13254[1]);(e$13223[i$13259]=arg$13260);}else{$13369(m$13249);;}}(e$13223["length"]=args$13209.length);(e$13223["name"]=["E"].concat(it$0$13213.tags).join("."));return e$13223;}else{$13369($13197$13199);}});($13179$13181.prototype["::check"]=function(e$13271){var it$0$13274;(it$0$13274=this);;var self$13279;(self$13279=this);;var tags$13284;if(((!e$13271)||(!$10347(Error)(e$13271)))){return false;}(tags$13284=(e$13271["::tags"]||[]));;var temp$13293;(temp$13293=it$0$13274.tags);;var $length$13298;($length$13298=temp$13293.length);;var $index$13303;($index$13303=0);;$13285:for(;($index$13303<$length$13298);($index$13303++)){var m$13311;(m$13311=temp$13293[$index$13303]);;var tag$13319;(tag$13319=m$13311);if((tags$13284.indexOf(tag$13319)===-1)){return false;}else{false;;}}return true;});($13179$13181.prototype["::deconstruct"]=function(e$13327){var it$0$13330;(it$0$13330=this);;var self$13335;(self$13335=this);;return e$13327.args;});$13382($13179$13181,$13382(function(){var accum$13340;(accum$13340=({}));(accum$13340["::name"]="$13179");return accum$13340;}(),function(){var accum$13344;(accum$13344=({}));(accum$13344["::egclass"]=true);return accum$13344;}()));return $13179$13181;}();
var $13394=function($13395$13397,key$13398){var ph$13402;(ph$13402=$13395$13397);;var $13400$13407;($13400$13407=ph$13402);;var bridge$13401$13412;(bridge$13401$13412=$13400$13407);if(((bridge$13401$13412===null)||(bridge$13401$13412===(void 0)))){return false;}else{var x$13420;if((typeof($13400$13407)==="string")){(x$13420=$13400$13407);return (key$13398 in String.prototype);}else{var x$13425;if((typeof($13400$13407)==="number")){(x$13425=$13400$13407);return (key$13398 in Number.prototype);}else{var x$13430;(x$13430=$13400$13407);return (key$13398 in x$13430);}}}};
var $13448=function($13449$13451){var ph$13457;var x$13458;var t0$13460;(t0$13460=$13449$13451);(x$13458=t0$13460);(ph$13457=t0$13460);;var $13453$13464;($13453$13464=ph$13457);;var bridge$13454$13469;(bridge$13454$13469=$13453$13464);if((function(){var bridge$13455$13475;(bridge$13455$13475=bridge$13454$13469);return (function(){var bridge$13456$13478;(bridge$13456$13478=bridge$13455$13475);return ((bridge$13456$13478===(void 0))||(bridge$13456$13478===null));}()||(typeof(bridge$13455$13475)==="string"));}()||(typeof(bridge$13454$13469)==="number"))){return x$13458;}else{if($13394($13453$13464,"::clone")){$13453$13464["::clone"];return x$13458["::clone"]();}else{$13453$13464;if((Object.getPrototypeOf(x$13458)===Object.prototype)){var dest$13491;(dest$13491=({}));;var k$13496;(k$13496=null);$13490:for(k$13496 in x$13458){if(Object.prototype.hasOwnProperty.call(x$13458,k$13496)){(dest$13491[k$13496]=x$13458[k$13496]);}}return dest$13491;}else{var other$13502;(other$13502=$13453$13464);throw $13178(["clone"]).create("Object cannot be cloned",({"obj":x$13458}));}}}};
var $13432=function(a$13434,b$13435){var dest$13439;(dest$13439=$13448(a$13434));;var k$13444;(k$13444=null);$13438:for(k$13444 in b$13435){if(Object.prototype.hasOwnProperty.call(b$13435,k$13444)){(dest$13439[k$13444]=b$13435[k$13444]);}}return dest$13439;};
var $13504=function(type$13506){return function(value$13509){var f$13512;(f$13512=type$13506[":::project"]);;if((f$13512===(void 0))){var f$13517;(f$13517=type$13506["::project"]);;if((f$13517===(void 0))){return [true,type$13506(value$13509)];}else{var rval$13522;(rval$13522=false);;try{(rval$13522=[true,f$13517(value$13509)]);}catch(excv$13528){var e$13534;(e$13534=excv$13528);(rval$13522=[false,null]);}return rval$13522;}}else{return f$13512.call(type$13506,value$13509);}};};
var $13536=function(from$13538,to$13539){var rval$13543;(rval$13543=[]);;var i$13548;(i$13548=from$13538);;$13542:for(;(i$13548<=to$13539);(i$13548++)){rval$13543.push(i$13548);}return rval$13543;};var accum$11116;var accum$11120;var accum$11722;var accum$11726;var $10394$10398;var __lt____gt__$10399;var $10395$10400;var __lt____lt____colon__$10401;var util$10402;var GenSym$10403;var gensym$10404;var zip$10405;var enumerate$10406;var iterkeys$10407;var neighbours$10408;var classify$10409;var classify_contiguous$10410;var identity$10411;var $10397$10412;var checker_db$10413;var PatternParser$10414;var PatternProcessor$10415;var assemble_conditions$10416;var assemble_pattern$10417;var inject_below_uses$10418;var parse_pattern$10419;var checkall$10420;var same_block$10421;var parse_clauses$10422;var opt_clauses$10423;var weave_clauses$10424;($10394$10398=require("./pp"));;(__lt____gt__$10399=$10394$10398["<>"]);;($10395$10400=require("./location"));;(__lt____lt____colon__$10401=$10395$10400["<<:"]);;(util$10402=require("./util"));;(GenSym$10403=util$10402.GenSym);;(gensym$10404=util$10402.gensym);;(zip$10405=util$10402.zip);;(enumerate$10406=util$10402.enumerate);;(iterkeys$10407=util$10402.keys);;(neighbours$10408=util$10402.neighbours);;(classify$10409=util$10402.classify);;(classify_contiguous$10410=util$10402.classify_contiguous);;(identity$10411=util$10402.identity);;($10397$10412=require("./expand"));;(checker_db$10413=$10397$10412.checker_db);;(PatternParser$10414=function(scope$10476,pattern$10477,opt$10478){var it$0$10481;(it$0$10481=function(){if((!$10347(PatternParser$10414)(this))){return Object.create(PatternParser$10414.prototype);}else{return this;}}());;(it$0$10481["opt"]=opt$10478);(it$0$10481["arguments"]=[]);(it$0$10481["vars"]=[]);(it$0$10481["specials"]=({}));(it$0$10481["pattern"]=it$0$10481.expand(scope$10476,pattern$10477,true,it$0$10481.opt.indexable));return it$0$10481;});;(PatternParser$10414.prototype["parse_specs"]=function(scope$10491,specs$10492){var $index$10538;var $length$10533;var temp$10528;var acc$10523;var rest$10505;var has_defaults$10506;var rval$10507;var self$10500;var it$0$10495;(it$0$10495=this);;(self$10500=this);;(rest$10505=(void 0));;(has_defaults$10506=false);;(rval$10507=classify$10409("fw","bw","keys","defaults",(((acc$10523=[])),(((temp$10528=scope$10491.step_all(["pattern"],specs$10492))),((($length$10533=temp$10528.length)),((($index$10538=0)),function(){$10516:for(;($index$10538<$length$10533);($index$10538++)){var v$10590;var v$10585;var variable$10578;var value$10579;var key$10572;var subp$10573;var key$10567;var variable$10560;var $10518$10554;var $10519$10555;var $10520$10556;var $10521$10557;var t0$10551;var t1$10552;var m$10546;(m$10546=temp$10528[$index$10538]);;(t0$10551=m$10546);if((($10519$10555=(t0$10551 instanceof Array))&&((t1$10552=t0$10551.length),(($10521$10557=(t1$10552===2))&&(t0$10551[0]==="dynsplice"))))){(variable$10560=t0$10551[1]);acc$10523.push(((rest$10505=it$0$10495.expand(scope$10491,variable$10560)),["ignore"]));}else{if(($10521$10557&&(t0$10551[0]==="assoc"))){(key$10567=t0$10551[1]);acc$10523.push(["keys",[key$10567,it$0$10495.expand(scope$10491,key$10567)]]);}else{if(($10519$10555&&(($10521$10557=(t1$10552===3))&&(t0$10551[0]==="assoc")))){(key$10572=t0$10551[1]);(subp$10573=t0$10551[2]);acc$10523.push(["keys",[key$10572,it$0$10495.expand(scope$10491,subp$10573)]]);}else{if(($10521$10557&&(t0$10551[0]==="default"))){(variable$10578=t0$10551[1]);(value$10579=t0$10551[2]);acc$10523.push(((has_defaults$10506=true),function(){if(rest$10505){throw $13178(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$10495.expand(scope$10491,variable$10578),value$10579]];}}()));}else{(v$10585=m$10546);if(((rest$10505===(void 0))&&(!has_defaults$10506))){acc$10523.push(["fw",it$0$10495.expand(scope$10491,v$10585)]);}else{(v$10590=m$10546);acc$10523.push(["bw",it$0$10495.expand(scope$10491,v$10590)]);}}}}}}}()))),acc$10523)));;(rval$10507["rest"]=rest$10505);return rval$10507;});(PatternParser$10414.prototype["expand"]=function(){var x$10655;var x$10664;var x$10680;var x$10685;var msg$10731;var x$10743;var msg$10756;var msg$10765;var $index$10798;var $length$10793;var temp$10788;var acc$10783;var $index$10902;var $length$10897;var temp$10892;var acc$10887;var $index$10933;var $length$10928;var temp$10923;var t0$10994;var t1$10995;var t2$10996;var $index$11024;var $length$11019;var temp$11014;var acc$11009;var patts$11003;var canon$10822;var normalize$10823;var pps$10824;var vars$10825;var patt$11083;var msg$11104;var other$11101;var keys$11089;var fw$11071;var bw$11072;var defaults$11073;var rest$11074;var $11050$11068;var t0$11061;var t1$11062;var t2$11063;var t3$11064;var t4$11065;var t5$11066;var $11049$11056;var specs$11051;var other$11110;var args$11045;var xs$10818;var xs$10777;var x$10771;var f$10751;var arg$10752;var f$10737;var arguments$10738;var f$10724;var arg$10725;var checker$10718;var subp$10719;var projector$10712;var subp$10713;var condition$10706;var subp$10707;var v$10701;var v$10693;var type$10671;var $10633$10647;var $10634$10648;var $10635$10649;var $10636$10650;var t0$10643;var bridge$10632$10644;var t1$10645;var $10631$10638;var expr$10624;var rval$10625;var self$10619;var it$0$10614;var scope$10607;var pattern$10608;var toplevel$10609;var checked$10610;var t0$10603;var $10596$10598;($10596$10598=arguments);;(t0$10603=$10596$10598.length);if(((t0$10603>=2)&&(t0$10603<=4))){(scope$10607=$10596$10598[0]);(pattern$10608=$10596$10598[1]);(toplevel$10609=function(){if((2>=t0$10603)){return false;}else{return $10596$10598[2];}}());(checked$10610=function(){if((3>=t0$10603)){return false;}else{return $10596$10598[3];}}());(it$0$10614=this);;(self$10619=this);;(expr$10624=scope$10607.step(["pattern"],pattern$10608));;(rval$10625=((($10631$10638=expr$10624)),function(){if((((x$10655=$10631$10638)),((x$10655 instanceof Array)&&(x$10655[0]==="void")))){return ["check",checker_db$10413.null,["ignore"]];}else{if((((x$10664=$10631$10638)),((x$10664 instanceof Array)&&(x$10664[0]==="ignore")))){return expr$10624;}else{if((($10631$10638 instanceof Array)&&((t0$10643=$10631$10638.length),((t0$10643===2)&&($10631$10638[0]==="special"))))){(type$10671=$10631$10638[1]);(it$0$10614.specials[type$10671]=true);return expr$10624;}else{(bridge$10632$10644=$10631$10638);if(((((x$10680=bridge$10632$10644)),((x$10680 instanceof Array)&&(x$10680[0]==="symbol")))||(((x$10685=bridge$10632$10644)),((x$10685 instanceof Array)&&(x$10685[0]==="variable"))))){it$0$10614.vars.push(expr$10624);return ["assign",expr$10624];}else{if((($10633$10647=($10631$10638 instanceof Array))&&((t0$10643=$10631$10638.length),(($10635$10649=(t0$10643===2))&&(($10636$10650=($10631$10638[0]==="value"))&&((v$10693=$10631$10638[1]),it$0$10614.opt.strings_as_variables)))))){it$0$10614.vars.push(expr$10624);return ["assign",expr$10624];}else{if($10636$10650){(v$10701=$10631$10638[1]);return ["check",checker_db$10413(v$10701),["ignore"]];}else{if(($10633$10647&&(($10635$10649=(t0$10643===3))&&($10631$10638[0]==="test")))){(condition$10706=$10631$10638[1]);(subp$10707=$10631$10638[2]);return ["test",condition$10706,it$0$10614.expand(scope$10607,subp$10707,toplevel$10609,false)];}else{if(($10635$10649&&($10631$10638[0]==="project"))){(projector$10712=$10631$10638[1]);(subp$10713=$10631$10638[2]);return ["project",projector$10712,it$0$10614.expand(scope$10607,subp$10713,toplevel$10609,true)];}else{if(($10635$10649&&($10631$10638[0]==="check"))){(checker$10718=$10631$10638[1]);(subp$10719=$10631$10638[2]);return ["check",checker$10718,it$0$10614.expand(scope$10607,subp$10719,toplevel$10609,true)];}else{if(($10635$10649&&(($10636$10650=($10631$10638[0]==="send"))&&((f$10724=$10631$10638[1]),((arg$10725=$10631$10638[2]),(!toplevel$10609)))))){(msg$10731="Function arguments can only be declared as a top level pattern.");;throw $13178(["syntax","pattern"]).create(msg$10731,({"node":expr$10624,"arg":arg$10725}));}else{if(($10636$10650&&((f$10737=$10631$10638[1]),((t1$10645=$10631$10638[2]),(((x$10743=t1$10645)),((x$10743 instanceof Array)&&(x$10743[0]==="data"))))))){(arguments$10738=t1$10645);it$0$10614.arguments.unshift(arguments$10738);return it$0$10614.expand(scope$10607,f$10737,true,false);}else{if($10636$10650){(f$10751=$10631$10638[1]);(arg$10752=$10631$10638[2]);(msg$10756=["Function must be declared with an array of arguments","(did you mean to use ':='?)"].join(" "));;throw $13178(["syntax","pattern"]).create(msg$10756,({"node":expr$10624,"arg":arg$10752}));}else{$10631$10638;if((!it$0$10614.opt.allow_nested)){(msg$10765="Nested patterns are not allowed here.");;throw $13178(["syntax","pattern"]).create(msg$10765,({"node":expr$10624}));}else{if((($10633$10647=($10631$10638 instanceof Array))&&((t0$10643=$10631$10638.length),((t0$10643===2)&&($10631$10638[0]==="neg"))))){(x$10771=$10631$10638[1]);return ["neg",it$0$10614.expand(scope$10607,x$10771)];}else{if(($10633$10647&&(($10635$10649=(t0$10643>=1))&&($10631$10638[0]==="all")))){(xs$10777=Array.prototype.slice.call($10631$10638,1));return ["all"].concat((((acc$10783=[])),(((temp$10788=xs$10777)),((($length$10793=temp$10788.length)),((($index$10798=0)),function(){$10780:for(;($index$10798<$length$10793);($index$10798++)){var x$10814;var m$10806;(m$10806=temp$10788[$index$10798]);;(x$10814=m$10806);acc$10783.push(it$0$10614.expand(scope$10607,x$10814));}}()))),acc$10783));}else{if(($10635$10649&&($10631$10638[0]==="any"))){(xs$10818=Array.prototype.slice.call($10631$10638,1));(canon$10822=function(all$10831){return all$10831.sort().join(",");});;(normalize$10823=function(vars$10837){var $index$10857;var $length$10852;var temp$10847;var acc$10842;return canon$10822((((acc$10842=[])),(((temp$10847=vars$10837)),((($length$10852=temp$10847.length)),((($index$10857=0)),function(){$10839:for(;($index$10857<$length$10852);($index$10857++)){var v$10875;var t0$10870;var t1$10871;var m$10865;(m$10865=temp$10847[$index$10857]);;(t0$10870=m$10865);if(((t0$10870 instanceof Array)&&((t1$10871=t0$10870.length),((t1$10871===2)&&(t0$10870[0]==="symbol"))))){(v$10875=t0$10870[1]);acc$10842.push(v$10875);}else{$13369(m$10865,"/home/olivier/git/earl-grey/src/pattern.eg",3447,3504);;}}}()))),acc$10842));});;(pps$10824=(((acc$10887=[])),(((temp$10892=xs$10818)),((($length$10897=temp$10892.length)),((($index$10902=0)),function(){$10884:for(;($index$10902<$length$10897);($index$10902++)){var x$10918;var m$10910;(m$10910=temp$10892[$index$10902]);;(x$10918=m$10910);acc$10887.push(PatternParser$10414(scope$10607,x$10918,it$0$10614.opt));}}()))),acc$10887));;(temp$10923=neighbours$10408(pps$10824));;($length$10928=temp$10923.length);;($index$10933=0);;$10826:for(;($index$10933<$length$10928);($index$10933++)){var $index$10971;var $length$10966;var temp$10961;var pp1$10951;var pp2$10952;var t0$10946;var t1$10947;var m$10941;(m$10941=temp$10923[$index$10933]);;(t0$10946=m$10941);if(((t0$10946 instanceof Array)&&((t1$10947=t0$10946.length),(t1$10947===2)))){(pp1$10951=t0$10946[0]);(pp2$10952=t0$10946[1]);(temp$10961=pps$10824);;($length$10966=temp$10961.length);;($index$10971=0);;$10957:for(;($index$10971<$length$10966);($index$10971++)){var pp$10987;var m$10979;(m$10979=temp$10961[$index$10971]);;(pp$10987=m$10979);normalize$10823(pp$10987.vars);}if((normalize$10823(pp1$10951.vars)!==normalize$10823(pp2$10952.vars))){throw $13178(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$10401(pp1$10951.vars.sort(),pp1$10951.pattern),"vars2":__lt____lt____colon__$10401(pp2$10952.vars.sort(),pp2$10952.pattern)}));}if((canon$10822(iterkeys$10407(pp1$10951.specials))!==canon$10822(iterkeys$10407(pp2$10952.specials)))){throw $13178(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$10401(iterkeys$10407(pp1$10951.specials).sort(),pp1$10951.pattern),"special2":__lt____lt____colon__$10401(iterkeys$10407(pp2$10952.specials).sort(),pp2$10952.pattern)}));}}else{$13369(m$10941,"/home/olivier/git/earl-grey/src/pattern.eg",3580,4393);;}}(t0$10994=pps$10824);if(((t0$10994 instanceof Array)&&((t1$10995=t0$10994.length),((t1$10995>=1)&&((t2$10996=t0$10994[0]),$13394(t2$10996,"vars")))))){(vars$10825=t2$10996.vars);Array.prototype.slice.call(t0$10994,1);;}else{$13369(pps$10824,"/home/olivier/git/earl-grey/src/pattern.eg",4410,4413);}(it$0$10614["vars"]=it$0$10614.vars.concat(vars$10825));(patts$11003=(((acc$11009=[])),(((temp$11014=pps$10824)),((($length$11019=temp$11014.length)),((($index$11024=0)),function(){$11006:for(;($index$11024<$length$11019);($index$11024++)){var pp$11040;var m$11032;(m$11032=temp$11014[$index$11024]);;(pp$11040=m$11032);acc$11009.push(pp$11040.pattern);}}()))),acc$11009));;return ["any"].concat(patts$11003);}else{if(($10635$10649&&($10631$10638[0]==="data"))){(args$11045=Array.prototype.slice.call($10631$10638,1));(specs$11051=it$0$10614.parse_specs(scope$10607,args$11045));;($11049$11056=specs$11051);;if((($11050$11068=$13394($11049$11056,"keys"))&&((t0$11061=$11049$11056.keys),((t0$11061 instanceof Array)&&((t1$11062=t0$11061.length),((t1$11062===0)&&($13394($11049$11056,"fw")&&((fw$11071=$11049$11056.fw),($13394($11049$11056,"bw")&&((bw$11072=$11049$11056.bw),($13394($11049$11056,"defaults")&&((defaults$11073=$11049$11056.defaults),$13394($11049$11056,"rest"))))))))))))){(rest$11074=$11049$11056.rest);(patt$11083=__lt____lt____colon__$10401(["array_pattern",fw$11071,bw$11072,defaults$11073,rest$11074],pattern$10608));;if(checked$10610){return patt$11083;}else{return ["check",checker_db$10413.Array,patt$11083];}}else{if(($11050$11068&&((keys$11089=$11049$11056.keys),($13394($11049$11056,"fw")&&((t0$11061=$11049$11056.fw),((t0$11061 instanceof Array)&&((t1$11062=t0$11061.length),((t1$11062===0)&&($13394($11049$11056,"bw")&&((t2$11063=$11049$11056.bw),((t2$11063 instanceof Array)&&((t3$11064=t2$11063.length),((t3$11064===0)&&($13394($11049$11056,"defaults")&&((t4$11065=$11049$11056.defaults),((t4$11065 instanceof Array)&&((t5$11066=t4$11065.length),((t5$11066===0)&&($13394($11049$11056,"rest")&&($11049$11056.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$11089);}else{(other$11101=$11049$11056);(msg$11104="Pattern must be an array or an object.");;throw $13178(["syntax","pattern"]).create(msg$11104,({"node":expr$10624,"specs":specs$11051}));}}}else{(other$11110=$10631$10638);throw $13178(["syntax","pattern"]).create("Illegal pattern",({"node":other$11110}));}}}}}}}}}}}}}}}}}}()));;return (it$0$10614.opt.wrap_pattern||identity$10411)(__lt____lt____colon__$10401(rval$10625,pattern$10608),toplevel$10609);}else{$13369($10596$10598);}});$13382(PatternParser$10414,$13382(((accum$11116=({})),((accum$11116["::name"]="PatternParser"),accum$11116)),((accum$11120=({})),((accum$11120["::egclass"]=true),accum$11120))));PatternParser$10414;(PatternProcessor$10415=function(){var it$0$11128;(it$0$11128=function(){if((!$10347(PatternProcessor$10415)(this))){return Object.create(PatternProcessor$10415.prototype);}else{return this;}}());;(it$0$11128["temps"]=[]);(it$0$11128["parts"]=[]);(it$0$11128["gen"]=GenSym$10403("t"));return it$0$11128;});;(PatternProcessor$10415.prototype["do"]=function(part$11138){var self$11146;var it$0$11141;(it$0$11141=this);;(self$11146=this);;return it$0$11141.parts.push(["do",part$11138]);});(PatternProcessor$10415.prototype["check"]=function(){var self$11174;var it$0$11169;var part$11164;var tags$11165;var t0$11160;var $11153$11155;($11153$11155=arguments);;(t0$11160=$11153$11155.length);if(((t0$11160>=1)&&(t0$11160<=2))){(part$11164=$11153$11155[0]);(tags$11165=function(){if((1>=t0$11160)){return ({});}else{return $11153$11155[1];}}());(it$0$11169=this);;(self$11174=this);;return it$0$11169.parts.push($13432(["check",part$11164],tags$11165));}else{$13369($11153$11155);}});(PatternProcessor$10415.prototype["temp"]=function(){var x$11222;var x$11227;var init$11234;var bridge$11205$11216;var $11204$11211;var self$11206;var it$0$11199;var x$11194;var v$11195;var t0$11190;var $11183$11185;($11183$11185=arguments);;(t0$11190=$11183$11185.length);if(((t0$11190>=1)&&(t0$11190<=2))){(x$11194=$11183$11185[0]);(v$11195=function(){if((1>=t0$11190)){return null;}else{return $11183$11185[1];}}());(it$0$11199=this);;(self$11206=this);;($11204$11211=x$11194);;(bridge$11205$11216=$11204$11211);if((((((x$11222=bridge$11205$11216)),((x$11222 instanceof Array)&&(x$11222[0]==="variable")))||(((x$11227=bridge$11205$11216)),((x$11227 instanceof Array)&&(x$11227[0]==="symbol"))))&&($13394($11204$11211,"single_assignment")&&($11204$11211.single_assignment&&(!v$11195))))){return x$11194;}else{(init$11234=$11204$11211);(v$11195=(v$11195||["symbol",it$0$11199.gen()]));(v$11195["single_assignment"]=true);it$0$11199.temps.push(v$11195);it$0$11199.do(["send",["symbol",":="],["data",v$11195,init$11234]]);return v$11195;}}else{$13369($11183$11185);}});(PatternProcessor$10415.prototype["process"]=function(pattern$11242,rhs$11243,fns$11244){var x$11281;var x$11310;var t$11322;var t$11333;var pp$11343;var $index$11371;var $length$11366;var temp$11361;var t$11353;var $index$11429;var $length$11424;var temp$11419;var acc$11414;var fn$11400;var parts$11401;var t$11395;var $index$11481;var $length$11476;var temp$11471;var acc$11466;var t$11459;var otherwise$11580;var $11562$11564;var $index$11594;var $length$11589;var temp$11584;var $index$11631;var $length$11626;var temp$11621;var end$11673;var pos$11668;var $index$11693;var $length$11688;var temp$11683;var acc$11678;var nfw$11520;var nbw$11521;var ndflt$11522;var extract_length$11523;var check_length$11524;var lo$11525;var hi$11526;var t$11527;var len$11528;var fw$11513;var bw$11514;var dflt$11515;var rest$11516;var subp$11455;var xs$11391;var xs$11349;var patt$11339;var projector$11328;var subp$11329;var checker$11317;var subp$11318;var checker$11306;var condition$11299;var subp$11300;var kind$11294;var sym$11288;var $11261$11273;var $11262$11274;var $11263$11275;var $11264$11276;var t0$11271;var $11260$11266;var rval$11257;var self$11252;var it$0$11247;(it$0$11247=this);;(self$11252=this);;(rval$11257=((($11260$11266=pattern$11242)),function(){if((((x$11281=$11260$11266)),((x$11281 instanceof Array)&&(x$11281[0]==="ignore")))){return it$0$11247.do(rhs$11243);}else{if((($11261$11273=($11260$11266 instanceof Array))&&((t0$11271=$11260$11266.length),(($11263$11275=(t0$11271===2))&&($11260$11266[0]==="assign"))))){(sym$11288=$11260$11266[1]);return it$0$11247.parts.push(fns$11244.assign(sym$11288,rhs$11243));}else{if(($11263$11275&&($11260$11266[0]==="special"))){(kind$11294=$11260$11266[1]);return it$0$11247.process(fns$11244.special(pattern$11242,rhs$11243),rhs$11243,fns$11244);}else{if(($11261$11273&&(($11263$11275=(t0$11271===3))&&($11260$11266[0]==="test")))){(condition$11299=$11260$11266[1]);(subp$11300=$11260$11266[2]);it$0$11247.process(subp$11300,rhs$11243,fns$11244);return it$0$11247.check(condition$11299,({"test":true}));}else{if(($11263$11275&&(($11264$11276=($11260$11266[0]==="check"))&&((checker$11306=$11260$11266[1]),(((x$11310=$11260$11266[2])),((x$11310 instanceof Array)&&(x$11310[0]==="ignore"))))))){return it$0$11247.check(["send",checker$11306,["data",rhs$11243]]);}else{if($11264$11276){(checker$11317=$11260$11266[1]);(subp$11318=$11260$11266[2]);(t$11322=it$0$11247.temp(rhs$11243));;it$0$11247.check(["send",checker$11317,["data",t$11322]]);return it$0$11247.process(subp$11318,t$11322,fns$11244);}else{if(($11263$11275&&($11260$11266[0]==="project"))){(projector$11328=$11260$11266[1]);(subp$11329=$11260$11266[2]);(t$11333=it$0$11247.temp(["send",projector$11328,["data",rhs$11243]]));;it$0$11247.check(["send",t$11333,["value",0]]);return it$0$11247.process(subp$11329,["send",t$11333,["value",1]],fns$11244);}else{if(($11261$11273&&((t0$11271===2)&&($11260$11266[0]==="neg")))){(patt$11339=$11260$11266[1]);return it$0$11247.check(["send",["symbol","not"],["data",["void"],(((pp$11343=PatternProcessor$10415())),pp$11343.process(patt$11339,rhs$11243,fns$11244),assemble_conditions$10416(pp$11343))]]);}else{if(($11261$11273&&(($11263$11275=(t0$11271>=1))&&($11260$11266[0]==="all")))){(xs$11349=Array.prototype.slice.call($11260$11266,1));(t$11353=it$0$11247.temp(rhs$11243));;(temp$11361=xs$11349);;($length$11366=temp$11361.length);;($index$11371=0);;$11354:for(;($index$11371<$length$11366);($index$11371++)){var x$11387;var m$11379;(m$11379=temp$11361[$index$11371]);;(x$11387=m$11379);it$0$11247.process(x$11387,t$11353,fns$11244);}return null;}else{if(($11263$11275&&($11260$11266[0]==="any"))){(xs$11391=Array.prototype.slice.call($11260$11266,1));(t$11395=it$0$11247.temp(rhs$11243,["symbol",gensym$10404("bridge")]));;return it$0$11247.check((((fn$11400=function(x$11405,rest$11406){return ["send",["symbol","or"],["data",x$11405,rest$11406]];})),((parts$11401=(((acc$11414=[])),(((temp$11419=xs$11391)),((($length$11424=temp$11419.length)),((($index$11429=0)),function(){$11411:for(;($index$11429<$length$11424);($index$11429++)){var pp$11448;var x$11445;var m$11437;(m$11437=temp$11419[$index$11429]);;(x$11445=m$11437);acc$11414.push((((pp$11448=PatternProcessor$10415())),pp$11448.process(x$11445,t$11395,fns$11244),assemble_conditions$10416(pp$11448)));}}()))),acc$11414))),util$10402.construct(parts$11401,fn$11400,["symbol","false"])));}else{if(($11263$11275&&($11260$11266[0]==="object_pattern"))){(subp$11455=Array.prototype.slice.call($11260$11266,1));(t$11459=it$0$11247.temp(rhs$11243));;(acc$11466=[]);;(temp$11471=subp$11455);;($length$11476=temp$11471.length);;($index$11481=0);;$11460:for(;($index$11481<$length$11476);($index$11481++)){var k$11501;var v$11502;var t0$11494;var t1$11495;var t2$11496;var t3$11497;var m$11489;(m$11489=temp$11471[$index$11481]);;(t0$11494=m$11489);if(((t0$11494 instanceof Array)&&((t1$11495=t0$11494.length),((t1$11495===2)&&((t2$11496=t0$11494[0]),((t2$11496 instanceof Array)&&((t3$11497=t2$11496.length),((t3$11497===2)&&(t2$11496[0]==="value"))))))))){(k$11501=t2$11496[1]);(v$11502=t0$11494[1]);acc$11466.push((it$0$11247.check(["send",["symbol","___hasprop"],["data",t$11459,["value",k$11501]]]),it$0$11247.process(v$11502,["send",t$11459,["value",k$11501]],fns$11244)));}else{$13369(m$11489,"/home/olivier/git/earl-grey/src/pattern.eg",7617,7749);;}}return acc$11466;}else{if(($11261$11273&&((t0$11271===5)&&($11260$11266[0]==="array_pattern")))){(fw$11513=$11260$11266[1]);(bw$11514=$11260$11266[2]);(dflt$11515=$11260$11266[3]);(rest$11516=$11260$11266[4]);(nfw$11520=fw$11513.length);;(nbw$11521=bw$11514.length);;(ndflt$11522=dflt$11515.length);;(extract_length$11523=true);;(check_length$11524=true);;(lo$11525=(nfw$11520+nbw$11521));;(hi$11526=(lo$11525+ndflt$11522));;(t$11527=it$0$11247.temp(rhs$11243));;(len$11528=it$0$11247.temp(["send",t$11527,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$11247.check(((($11562$11564=rest$11516)),function(){if($11562$11564){return ["send",["symbol",">="],["data",len$11528,["value",lo$11525]]];}else{$11562$11564;if((lo$11525===hi$11526)){return ["send",["symbol","==="],["data",len$11528,["value",lo$11525]]];}else{(otherwise$11580=$11562$11564);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$11528,["value",lo$11525]]],["send",["symbol","<="],["data",len$11528,["value",hi$11526]]]]];}}}()));(temp$11584=enumerate$10406(fw$11513));;($length$11589=temp$11584.length);;($index$11594=0);;$11529:for(;($index$11594<$length$11589);($index$11594++)){var i$11612;var m$11613;var t0$11607;var t1$11608;var m$11602;(m$11602=temp$11584[$index$11594]);;(t0$11607=m$11602);if(((t0$11607 instanceof Array)&&((t1$11608=t0$11607.length),(t1$11608===2)))){(i$11612=t0$11607[0]);(m$11613=t0$11607[1]);it$0$11247.process(m$11613,["send",t$11527,["value",i$11612]],fns$11244);}else{$13369(m$11602,"/home/olivier/git/earl-grey/src/pattern.eg",8481,8567);;}}(temp$11621=enumerate$10406(dflt$11515));;($length$11626=temp$11621.length);;($index$11631=0);;$11531:for(;($index$11631<$length$11626);($index$11631++)){var idx$11661;var i$11651;var patt$11652;var value$11653;var t0$11644;var t1$11645;var t2$11646;var t3$11647;var m$11639;(m$11639=temp$11621[$index$11631]);;(t0$11644=m$11639);if(((t0$11644 instanceof Array)&&((t1$11645=t0$11644.length),((t1$11645===2)&&((i$11651=t0$11644[0]),((t2$11646=t0$11644[1]),((t2$11646 instanceof Array)&&((t3$11647=t2$11646.length),(t3$11647===2))))))))){(patt$11652=t2$11646[0]);(value$11653=t2$11646[1]);(idx$11661=(i$11651+nfw$11520));;it$0$11247.process(patt$11652,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$11661+nbw$11521)],len$11528]],value$11653,["send",t$11527,["value",idx$11661]]]],fns$11244);}else{$13369(m$11639,"/home/olivier/git/earl-grey/src/pattern.eg",8567,8736);;}}if((rest$11516!==(void 0))){(pos$11668=(nfw$11520+ndflt$11522));;(end$11673=function(){if((nbw$11521>0)){return [["value",(-nbw$11521)]];}else{return [];}}());;it$0$11247.process(rest$11516,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$11527,["value",pos$11668]].concat(end$11673)],fns$11244);}else{[];}(acc$11678=[]);;(temp$11683=enumerate$10406(bw$11514));;($length$11688=temp$11683.length);;($index$11693=0);;$11533:for(;($index$11693<$length$11688);($index$11693++)){var i$11711;var m$11712;var t0$11706;var t1$11707;var m$11701;(m$11701=temp$11683[$index$11693]);;(t0$11706=m$11701);if(((t0$11706 instanceof Array)&&((t1$11707=t0$11706.length),(t1$11707===2)))){(i$11711=t0$11706[0]);(m$11712=t0$11706[1]);acc$11678.push(it$0$11247.process(m$11712,["send",["symbol","___js_fetch"],["data",t$11527,["send",["symbol","-"],["data",len$11528,["value",(nbw$11521-i$11711)]]]]],fns$11244));}else{$13369(m$11701,"/home/olivier/git/earl-grey/src/pattern.eg",9187,9338);;}}return acc$11678;}else{$13369($11260$11266);}}}}}}}}}}}}}()));;return rval$11257;});$13382(PatternProcessor$10415,$13382(((accum$11722=({})),((accum$11722["::name"]="PatternProcessor"),accum$11722)),((accum$11726=({})),((accum$11726["::egclass"]=true),accum$11726))));PatternProcessor$10415;(assemble_conditions$10416=function(pp$11732){var $index$11814;var $length$11809;var temp$11804;var acc$11799;var decls$11793;var construct$11735;(construct$11735=function($11738$11740){var x$11783;var rest$11784;var x$11776;var x$11768;var rest$11769;var $11743$11759;var $11744$11760;var t0$11755;var t1$11756;var t2$11757;var $11742$11750;var ph$11745;(ph$11745=$11738$11740);;($11742$11750=ph$11745);;if((($11743$11759=($11742$11750 instanceof Array))&&((t0$11755=$11742$11750.length),(t0$11755===0)))){return ["value",true];}else{if(($11743$11759&&((t0$11755>=1)&&((t1$11756=$11742$11750[0]),((t1$11756 instanceof Array)&&((t2$11757=t1$11756.length),((t2$11757===2)&&(t1$11756[0]==="do")))))))){(x$11768=t1$11756[1]);(rest$11769=Array.prototype.slice.call($11742$11750,1));return ["multi",x$11768,construct$11735(rest$11769)];}else{if(($11743$11759&&((t0$11755===1)&&((t1$11756=$11742$11750[0]),((t1$11756 instanceof Array)&&((t2$11757=t1$11756.length),((t2$11757===2)&&(t1$11756[0]==="check")))))))){(x$11776=t1$11756[1]);return x$11776;}else{if(($11743$11759&&((t0$11755>=1)&&((t1$11756=$11742$11750[0]),((t1$11756 instanceof Array)&&((t2$11757=t1$11756.length),((t2$11757===2)&&(t1$11756[0]==="check")))))))){(x$11783=t1$11756[1]);(rest$11784=Array.prototype.slice.call($11742$11750,1));return ["send",["symbol","and"],["data",x$11783,construct$11735(rest$11784)]];}else{$13369($11742$11750);}}}}});;if(pp$11732.temps.length){(decls$11793=(((acc$11799=[])),(((temp$11804=pp$11732.temps)),((($length$11809=temp$11804.length)),((($index$11814=0)),function(){$11796:for(;($index$11814<$length$11809);($index$11814++)){var t$11830;var m$11822;(m$11822=temp$11804[$index$11814]);;(t$11830=m$11822);acc$11799.push(["declare",t$11830]);}}()))),acc$11799));;return ["multi"].concat(decls$11793).concat([construct$11735(pp$11732.parts)]);}else{return construct$11735(pp$11732.parts);}});;(assemble_pattern$10417=function(){var $index$11884;var $length$11879;var temp$11874;var $index$11933;var $length$11928;var temp$11923;var test$12026;var lead$11854;var trail$11855;var construct$11856;var parts$11848;var t$11849;var f$11850;var t0$11844;var $11837$11839;($11837$11839=arguments);;(t0$11844=$11837$11839.length);if(((t0$11844>=2)&&(t0$11844<=3))){(parts$11848=$11837$11839[0]);(t$11849=$11837$11839[1]);(f$11850=function(){if((2>=t0$11844)){return null;}else{return $11837$11839[2];}}());(lead$11854=[]);;(temp$11874=parts$11848.slice(0));;($length$11879=temp$11874.length);;($index$11884=0);;$11857:for(;($index$11884<$length$11879);($index$11884++)){var x$11913;var x$11906;var $11859$11900;var $11860$11901;var $11861$11902;var $11862$11903;var t0$11897;var t1$11898;var m$11892;(m$11892=temp$11874[$index$11884]);;(t0$11897=m$11892);if((($11860$11901=(t0$11897 instanceof Array))&&((t1$11898=t0$11897.length),(($11862$11903=(t1$11898===2))&&(t0$11897[0]==="do"))))){(x$11906=t0$11897[1]);lead$11854.push(x$11906);parts$11848.shift();}else{if(($11862$11903&&(t0$11897[0]==="check"))){(x$11913=t0$11897[1]);break $11857;}else{$13369(m$11892,"/home/olivier/git/earl-grey/src/pattern.eg",9799,9909);;}}}(trail$11855=[]);;(temp$11923=parts$11848.slice(0).reverse());;($length$11928=temp$11923.length);;($index$11933=0);;$11863:for(;($index$11933<$length$11928);($index$11933++)){var x$11962;var x$11955;var $11865$11949;var $11866$11950;var $11867$11951;var $11868$11952;var t0$11946;var t1$11947;var m$11941;(m$11941=temp$11923[$index$11933]);;(t0$11946=m$11941);if((($11866$11950=(t0$11946 instanceof Array))&&((t1$11947=t0$11946.length),(($11868$11952=(t1$11947===2))&&(t0$11946[0]==="do"))))){(x$11955=t0$11946[1]);trail$11855.unshift(x$11955);parts$11848.pop();}else{if(($11868$11952&&(t0$11946[0]==="check"))){(x$11962=t0$11946[1]);break $11863;}else{$13369(m$11941,"/home/olivier/git/earl-grey/src/pattern.eg",9923,10045);;}}}(construct$11856=function($11969$11971){var other$12022;var x$12014;var rest$12015;var x$12007;var x$11999;var rest$12000;var $11974$11990;var $11975$11991;var t0$11986;var t1$11987;var t2$11988;var $11973$11981;var ph$11976;(ph$11976=$11969$11971);;($11973$11981=ph$11976);;if((($11974$11990=($11973$11981 instanceof Array))&&((t0$11986=$11973$11981.length),(t0$11986===0)))){return ["value",true];}else{if(($11974$11990&&((t0$11986>=1)&&((t1$11987=$11973$11981[0]),((t1$11987 instanceof Array)&&((t2$11988=t1$11987.length),((t2$11988===2)&&(t1$11987[0]==="do")))))))){(x$11999=t1$11987[1]);(rest$12000=Array.prototype.slice.call($11973$11981,1));return ["multi",x$11999,construct$11856(rest$12000)];}else{if(($11974$11990&&((t0$11986===1)&&((t1$11987=$11973$11981[0]),((t1$11987 instanceof Array)&&((t2$11988=t1$11987.length),((t2$11988===2)&&(t1$11987[0]==="check")))))))){(x$12007=t1$11987[1]);return x$12007;}else{if(($11974$11990&&((t0$11986>=1)&&((t1$11987=$11973$11981[0]),((t1$11987 instanceof Array)&&((t2$11988=t1$11987.length),((t2$11988===2)&&(t1$11987[0]==="check")))))))){(x$12014=t1$11987[1]);(rest$12015=Array.prototype.slice.call($11973$11981,1));return ["send",["symbol","and"],["data",x$12014,construct$11856(rest$12015)]];}else{(other$12022=$11973$11981);throw $13178(["oops"]).create("?!?",other$12022);}}}}});;if(parts$11848.length){(test$12026=construct$11856(parts$11848));;return ["multi"].concat(lead$11854).concat([function(){if(f$11850){return ["send",["symbol","if"],["data",test$12026,["multi"].concat(trail$11855).concat([t$11849]),f$11850]];}else{return ["send",["symbol","if"],["data",test$12026,["multi"].concat(trail$11855).concat([t$11849])]];}}()]);}else{return ["multi"].concat(lead$11854).concat(trail$11855).concat([t$11849]);}}else{$13369($11837$11839);}});;(inject_below_uses$10418=function($12035$12037,fn$12038){var other$12062;var scope$12055;var x$12056;var t0$12051;var $12040$12046;var ph$12041;(ph$12041=$12035$12037);;($12040$12046=ph$12041);;if((($12040$12046 instanceof Array)&&((t0$12051=$12040$12046.length),((t0$12051===3)&&($12040$12046[0]==="use"))))){(scope$12055=$12040$12046[1]);(x$12056=$12040$12046[2]);return ["use",scope$12055,inject_below_uses$10418(x$12056,fn$12038)];}else{(other$12062=$12040$12046);return fn$12038(other$12062);}});;(parse_pattern$10419=function(scope$12068,pattern$12069,rhs$12070,opt$12071){var t0$12082;var $index$12121;var $length$12116;var temp$12111;var acc$12106;var parse$12074;var target$12075;var proc$12076;(parse$12074=PatternParser$10414(scope$12068,pattern$12069,opt$12071));;if(((!opt$12071.allow_arguments)&&parse$12074.arguments.length)){throw $13178(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$12074.arguments[0]}));}(t0$12082=$13504((opt$12071.wrap_target||identity$10411))(function(){if(parse$12074.arguments.length){return inject_below_uses$10418(rhs$12070,function(x$12085){return util$10402.construct(parse$12074.arguments.concat([x$12085]),function(args$12088,rest$12089){return ["send",["symbol","->"],["data",args$12088,rest$12089]];});});}else{return rhs$12070;}}()));if(t0$12082[0]){(target$12075=t0$12082[1]);;}else{$13369(function(){if(parse$12074.arguments.length){return inject_below_uses$10418(rhs$12070,function(x$12094){return util$10402.construct(parse$12074.arguments.concat([x$12094]),function(args$12097,rest$12098){return ["send",["symbol","->"],["data",args$12097,rest$12098]];});});}else{return rhs$12070;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11438,11871);}(proc$12076=PatternProcessor$10415());;proc$12076.process(parse$12074.pattern,target$12075,opt$12071);if(opt$12071.finalize){return ["splice"].concat(opt$12071.declare(parse$12074.vars)).concat([["multi"].concat((((acc$12106=[])),(((temp$12111=proc$12076.temps)),((($length$12116=temp$12111.length)),((($index$12121=0)),function(){$12103:for(;($index$12121<$length$12116);($index$12121++)){var t$12137;var m$12129;(m$12129=temp$12111[$index$12121]);;(t$12137=m$12129);acc$12106.push(["declare",t$12137]);}}()))),acc$12106)).concat([assemble_pattern$10417(proc$12076.parts,opt$12071.success(target$12075),opt$12071.failure(target$12075))])]);}else{return [parse$12074.vars,proc$12076.temps,proc$12076.parts];}});;(checkall$10420=["send","data","multi","assign","void","check","do"]);;(same_block$10421=function($12145$12147,ban1$12148,ban2$12149){var $index$12250;var $length$12245;var temp$12240;var other$12271;var type1$12223;var args1$12224;var type2$12225;var args2$12226;var m1$12214;var m2$12215;var v1$12205;var v2$12206;var s1$12196;var s2$12197;var v1$12184;var v2$12185;var $12152$12175;var $12153$12176;var $12154$12177;var $12155$12178;var $12156$12179;var $12157$12180;var $12158$12181;var t0$12169;var t1$12170;var t2$12171;var t3$12172;var t4$12173;var $12151$12164;var ph$12159;(ph$12159=$12145$12147);;($12151$12164=ph$12159);;if((($12152$12175=($12151$12164 instanceof Array))&&((t0$12169=$12151$12164.length),(($12154$12177=(t0$12169===2))&&((t1$12170=$12151$12164[0]),(($12156$12179=(t1$12170 instanceof Array))&&((t2$12171=t1$12170.length),(($12158$12181=(t2$12171===2))&&((t1$12170[0]==="variable")&&((v1$12184=t1$12170[1]),((t3$12172=$12151$12164[1]),((t3$12172 instanceof Array)&&((t4$12173=t3$12172.length),((t4$12173===2)&&(t3$12172[0]==="variable"))))))))))))))){(v2$12185=t3$12172[1]);return (v1$12184===v2$12185);}else{if(($12158$12181&&((t1$12170[0]==="symbol")&&((s1$12196=t1$12170[1]),((t3$12172=$12151$12164[1]),((t3$12172 instanceof Array)&&((t4$12173=t3$12172.length),((t4$12173===2)&&(t3$12172[0]==="symbol"))))))))){(s2$12197=t3$12172[1]);return (((!$10362(ban1$12148,s1$12196))&&(!$10362(ban2$12149,s2$12197)))&&(s1$12196===s2$12197));}else{if(($12158$12181&&((t1$12170[0]==="value")&&((v1$12205=t1$12170[1]),((t3$12172=$12151$12164[1]),((t3$12172 instanceof Array)&&((t4$12173=t3$12172.length),((t4$12173===2)&&(t3$12172[0]==="value"))))))))){(v2$12206=t3$12172[1]);return (v1$12205===v2$12206);}else{if(($12158$12181&&((t1$12170[0]==="macro")&&((m1$12214=t1$12170[1]),((t3$12172=$12151$12164[1]),((t3$12172 instanceof Array)&&((t4$12173=t3$12172.length),((t4$12173===2)&&(t3$12172[0]==="macro"))))))))){(m2$12215=t3$12172[1]);return (m1$12214===m2$12215);}else{if(($12156$12179&&((t2$12171>=1)&&((type1$12223=t1$12170[0]),((args1$12224=Array.prototype.slice.call(t1$12170,1)),((t3$12172=$12151$12164[1]),((t3$12172 instanceof Array)&&((t4$12173=t3$12172.length),((t4$12173>=1)&&((type2$12225=t3$12172[0]),((args2$12226=Array.prototype.slice.call(t3$12172,1)),(checkall$10420.indexOf(type1$12223)!==-1)))))))))))){if(((type1$12223===type2$12225)&&(args1$12224.length===args2$12226.length))){(temp$12240=zip$10405(args1$12224,args2$12226));;($length$12245=temp$12240.length);;($index$12250=0);;$12236:for(;($index$12250<$length$12245);($index$12250++)){var pair$12266;var m$12258;(m$12258=temp$12240[$index$12250]);;(pair$12266=m$12258);if((!same_block$10421(pair$12266,ban1$12148,ban2$12149))){return false;}}return true;}else{return false;}}else{(other$12271=$12151$12164);return false;}}}}}});;(parse_clauses$10422=function(scope$12277,target$12278,stmts$12279,opt$12280){var $index$12310;var $length$12305;var temp$12300;var acc$12295;var $index$12486;var $length$12481;var temp$12476;var acc$12471;var $index$12533;var $length$12528;var temp$12523;var acc$12518;var decls$12512;var all_temps$12283;var the_parts$12284;var unique_temps$12285;(all_temps$12283=[]);;(the_parts$12284=(((acc$12295=[])),(((temp$12300=scope$12277.step_all(["clause"],stmts$12279))),((($length$12305=temp$12300.length)),((($index$12310=0)),function(){$12291:for(;($index$12310<$length$12305);($index$12310++)){var accum$12385;var accum$12396;var t0$12381;var t1$12382;var $index$12419;var $length$12414;var temp$12409;var bod$12446;var placeholder$12335;var special_fn$12336;var vars$12337;var temps$12338;var blocks$12339;var vars2$12340;var x$12455;var other$12462;var b$12452;var pattern$12329;var body$12330;var $12293$12326;var t0$12323;var t1$12324;var m$12318;(m$12318=temp$12300[$index$12310]);;(t0$12323=m$12318);if(((t0$12323 instanceof Array)&&((t1$12324=t0$12323.length),((t1$12324===3)&&(t0$12323[0]==="clause"))))){(pattern$12329=t0$12323[1]);(body$12330=t0$12323[2]);acc$12295.push((((placeholder$12335=(void 0))),((special_fn$12336=function($12348$12350,value$12351){var t0$12357;var t1$12358;var other$12377;var $12353$12364;var ph$12354;var expr$12355;(t0$12357=$12348$12350);if(((t0$12357 instanceof Array)&&((t1$12358=t0$12357.length),((t1$12358===2)&&(t0$12357[0]==="special"))))){(ph$12354=t0$12357[1]);(expr$12355=t0$12357);;}else{$13369($12348$12350);}($12353$12364=ph$12354);;if(($12353$12364==="match")){(placeholder$12335=__lt____lt____colon__$10401(["symbol",scope$12277.gensym("ph")],expr$12355));return ["assign",placeholder$12335];}else{(other$12377=$12353$12364);throw $13178(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$12355}));}})),((t0$12381=parse_pattern$10419(scope$12277,pattern$12329,target$12278,$13432(opt$12280,$13382(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12336}),$13382(((accum$12385=({})),((accum$12385["assign"]=function(v$12389,value$12390){return ["do",__lt____lt____colon__$10401(["assign",v$12389,value$12390],v$12389)];}),accum$12385)),({"finalize":false})))))),function(){if(((t0$12381 instanceof Array)&&((t1$12382=t0$12381.length),(t1$12382===3)))){(vars$12337=t0$12381[0]);(temps$12338=t0$12381[1]);(blocks$12339=t0$12381[2]);}else{return $13369(parse_pattern$10419(scope$12277,pattern$12329,target$12278,$13432(opt$12280,$13382(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12336}),$13382(((accum$12396=({})),((accum$12396["assign"]=function(v$12400,value$12401){return ["do",__lt____lt____colon__$10401(["assign",v$12400,value$12401],v$12400)];}),accum$12396)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",13491,13838);}}()),(all_temps$12283=all_temps$12283.concat(temps$12338)),function(){if(placeholder$12335){return vars$12337.push(placeholder$12335);}}(),((vars2$12340=({}))),(((temp$12409=vars$12337)),((($length$12414=temp$12409.length)),((($index$12419=0)),function(){$12341:for(;($index$12419<$length$12414);($index$12419++)){var other$12443;var xxx$12437;var t0$12432;var t1$12433;var m$12427;(m$12427=temp$12409[$index$12419]);;(t0$12432=m$12427);if(((t0$12432 instanceof Array)&&((t1$12433=t0$12432.length),((t1$12433===2)&&(t0$12432[0]==="symbol"))))){(xxx$12437=t0$12432[1]);(vars2$12340[xxx$12437]=true);}else{(other$12443=m$12427);throw $13178(["syntax","unexpected"]).create();}}}()))),(((bod$12446=function(){if(placeholder$12335){return parse_clauses$10422(scope$12277,placeholder$12335,$13504(["multi"])(body$12330)[1],opt$12280);}else{if(opt$12280.wrap){return opt$12280.wrap(body$12330);}else{return body$12330;}}}())),["clause",vars$12337,vars2$12340,blocks$12339,bod$12446])));}else{if((((x$12455=t0$12323)),((x$12455 instanceof Array)&&(x$12455[0]==="block")))){(b$12452=t0$12323);acc$12295.push(b$12452);}else{(other$12462=m$12318);acc$12295.push(function(){throw $13178(["syntax","clause"]).create("Illegal clause",({"clause":other$12462}));}());}}}}()))),acc$12295));;if(opt$12280.fallback){the_parts$12284.push(["block",opt$12280.fallback(target$12278)]);}(unique_temps$12285=iterkeys$10407(util$10402.set((((acc$12471=[])),(((temp$12476=all_temps$12283)),((($length$12481=temp$12476.length)),((($index$12486=0)),function(){$12468:for(;($index$12486<$length$12481);($index$12486++)){var t$12504;var t0$12499;var t1$12500;var m$12494;(m$12494=temp$12476[$index$12486]);;(t0$12499=m$12494);if(((t0$12499 instanceof Array)&&((t1$12500=t0$12499.length),((t1$12500===2)&&(t0$12499[0]==="symbol"))))){(t$12504=t0$12499[1]);acc$12471.push(t$12504);}else{$13369(m$12494,"/home/olivier/git/earl-grey/src/pattern.eg",14650,14680);;}}}()))),acc$12471))));;(decls$12512=(((acc$12518=[])),(((temp$12523=unique_temps$12285)),((($length$12528=temp$12523.length)),((($index$12533=0)),function(){$12515:for(;($index$12533<$length$12528);($index$12533++)){var t$12549;var m$12541;(m$12541=temp$12523[$index$12533]);;(t$12549=m$12541);acc$12518.push(["declare",["symbol",t$12549]]);}}()))),acc$12518));;return ["multi"].concat(decls$12512).concat([weave_clauses$10424(the_parts$12284)]);});;(opt_clauses$10423=function(clauses$12556){var $index$12585;var $length$12580;var temp$12575;var acc$12570;var $index$12720;var $length$12715;var temp$12710;var acc$12705;var $index$12765;var $length$12760;var temp$12755;var acc$12750;var $index$12809;var $length$12804;var temp$12799;var acc$12794;var shares$12559;var max$12560;var temps$12561;var shared_last$12562;var idx_last$12563;var new_clauses$12564;(shares$12559=(((acc$12570=[])),(((temp$12575=enumerate$10406(clauses$12556.slice(1)))),((($length$12580=temp$12575.length)),((($index$12585=0)),function(){$12567:for(;($index$12585<$length$12580);($index$12585++)){var t0$12624;var t1$12625;var $index$12648;var $length$12643;var temp$12638;var varsd0$12617;var blocks0$12618;var share$12619;var idx$12620;var i$12605;var vars$12606;var varsd$12607;var blocks$12608;var body$12609;var t0$12598;var t1$12599;var t2$12600;var t3$12601;var m$12593;(m$12593=temp$12575[$index$12585]);;(t0$12598=m$12593);if(((t0$12598 instanceof Array)&&((t1$12599=t0$12598.length),((t1$12599===2)&&((i$12605=t0$12598[0]),((t2$12600=t0$12598[1]),((t2$12600 instanceof Array)&&((t3$12601=t2$12600.length),((t3$12601===5)&&(t2$12600[0]==="clause")))))))))){(vars$12606=t2$12600[1]);(varsd$12607=t2$12600[2]);(blocks$12608=t2$12600[3]);(body$12609=t2$12600[4]);acc$12570.push((((t0$12624=$10362(clauses$12556,i$12605)),function(){if(((t0$12624 instanceof Array)&&((t1$12625=t0$12624.length),((t1$12625===5)&&(t0$12624[0]==="clause"))))){t0$12624[1];(varsd0$12617=t0$12624[2]);(blocks0$12618=t0$12624[3]);t0$12624[4];}else{return $13369($10362(clauses$12556,i$12605),"/home/olivier/git/earl-grey/src/pattern.eg",14953,14973);}}()),((share$12619=0)),((idx$12620=0)),(((temp$12638=blocks$12608)),((($length$12643=temp$12638.length)),((($index$12648=0)),function(){$12621:for(;($index$12648<$length$12643);($index$12648++)){var x$12679;var x$12688;var other$12695;var $12667$12669;var b$12664;var m$12656;(m$12656=temp$12638[$index$12648]);;(b$12664=m$12656);if(same_block$10421([$10362(blocks0$12618,share$12619),b$12664],varsd0$12617,varsd$12607)){(share$12619++);($12667$12669=b$12664);;if((((x$12679=$12667$12669)),((x$12679 instanceof Array)&&(x$12679[0]==="do")))){null;}else{if((((x$12688=$12667$12669)),((x$12688 instanceof Array)&&(x$12688[0]==="check")))){(idx$12620=share$12619);}else{(other$12695=$12667$12669);__lt____gt__$10399(null,other$12695);}}}else{break $12621;}}}()))),[share$12619,idx$12620]));}else{$13369(m$12593,"/home/olivier/git/earl-grey/src/pattern.eg",14829,15350);;}}}()))),acc$12570));;(max$12560=$10362(Math.max,(((acc$12705=[])),(((temp$12710=shares$12559)),((($length$12715=temp$12710.length)),((($index$12720=0)),function(){$12702:for(;($index$12720<$length$12715);($index$12720++)){var x$12738;var t0$12733;var t1$12734;var m$12728;(m$12728=temp$12710[$index$12720]);;(t0$12733=m$12728);if(((t0$12733 instanceof Array)&&((t1$12734=t0$12733.length),(t1$12734===2)))){(x$12738=t0$12733[0]);t0$12733[1];acc$12705.push(x$12738);}else{$13369(m$12728,"/home/olivier/git/earl-grey/src/pattern.eg",15364,15393);;}}}()))),acc$12705)));;shares$12559.push([0,0]);(temps$12561=(((acc$12750=[])),(((temp$12755=$13536(1,max$12560))),((($length$12760=temp$12755.length)),((($index$12765=0)),function(){$12747:for(;($index$12765<$length$12760);($index$12765++)){var m$12773;(m$12773=temp$12755[$index$12765]);;m$12773;acc$12750.push(["symbol",gensym$10404()]);}}()))),acc$12750));;(shared_last$12562=0);;(idx_last$12563=0);;(new_clauses$12564=(((acc$12794=[])),(((temp$12799=enumerate$10406(clauses$12556))),((($length$12804=temp$12799.length)),((($index$12809=0)),function(){$12791:for(;($index$12809<$length$12804);($index$12809++)){var t0$12847;var t1$12848;var $index$12883;var $length$12878;var temp$12873;var acc$12868;var rest$12932;var newblocks$12928;var share$12841;var idx$12842;var shared$12843;var n_to_share$12844;var to_share$12845;var other$12939;var i$12829;var vars$12830;var varsd$12831;var blocks$12832;var body$12833;var t0$12822;var t1$12823;var t2$12824;var t3$12825;var m$12817;(m$12817=temp$12799[$index$12809]);;(t0$12822=m$12817);if(((t0$12822 instanceof Array)&&((t1$12823=t0$12822.length),((t1$12823===2)&&((i$12829=t0$12822[0]),((t2$12824=t0$12822[1]),((t2$12824 instanceof Array)&&((t3$12825=t2$12824.length),((t3$12825===5)&&(t2$12824[0]==="clause")))))))))){(vars$12830=t2$12824[1]);(varsd$12831=t2$12824[2]);(blocks$12832=t2$12824[3]);(body$12833=t2$12824[4]);acc$12794.push((((t0$12847=$10362(shares$12559,i$12829)),function(){if(((t0$12847 instanceof Array)&&((t1$12848=t0$12847.length),(t1$12848===2)))){(share$12841=t0$12847[0]);(idx$12842=t0$12847[1]);}else{return $13369($10362(shares$12559,i$12829),"/home/olivier/git/earl-grey/src/pattern.eg",15614,15633);}}()),((shared$12843=function(){if(idx_last$12563){return [["check",$10362(temps$12561,(idx_last$12563-1))]];}else{return [];}}())),((n_to_share$12844=Math.max(shared_last$12562,share$12841))),((to_share$12845=(((acc$12868=[])),(((temp$12873=enumerate$10406(blocks$12832.slice(shared_last$12562,n_to_share$12844)))),((($length$12878=temp$12873.length)),((($index$12883=0)),function(){$12861:for(;($index$12883<$length$12878);($index$12883++)){var j$12917;var x$12918;var j$12907;var x$12908;var $12863$12901;var $12864$12902;var $12865$12903;var $12866$12904;var t0$12896;var t1$12897;var t2$12898;var t3$12899;var m$12891;(m$12891=temp$12873[$index$12883]);;(t0$12896=m$12891);if((($12864$12902=(t0$12896 instanceof Array))&&((t1$12897=t0$12896.length),(($12866$12904=(t1$12897===2))&&((j$12907=t0$12896[0]),((t2$12898=t0$12896[1]),((t2$12898 instanceof Array)&&((t3$12899=t2$12898.length),((t3$12899===2)&&(t2$12898[0]==="check")))))))))){(x$12908=t2$12898[1]);acc$12868.push(["check",["assign",$10362(temps$12561,(shared_last$12562+j$12907)),x$12908]]);}else{if(($12866$12904&&((j$12917=t0$12896[0]),((t2$12898=t0$12896[1]),((t2$12898 instanceof Array)&&((t3$12899=t2$12898.length),((t3$12899===2)&&(t2$12898[0]==="do")))))))){(x$12918=t2$12898[1]);acc$12868.push(["do",x$12918]);}else{$13369(m$12891,"/home/olivier/git/earl-grey/src/pattern.eg",15762,15933);;}}}}()))),acc$12868))),(shared_last$12562=share$12841),(idx_last$12563=idx$12842),(((newblocks$12928=(((rest$12932=blocks$12832.slice(n_to_share$12844))),shared$12843.concat(to_share$12845).concat(rest$12932)))),["clause",vars$12830,varsd$12831,newblocks$12928,body$12833])));}else{(other$12939=m$12817);acc$12794.push(function(){throw $13178(["oops"]).create("what",({"value":other$12939}));}());}}}()))),acc$12794));;return [temps$12561,new_clauses$12564];});;(weave_clauses$10424=function(parts$12946){var $index$12992;var $length$12987;var temp$12982;var $index$13158;var $length$13153;var temp$13148;var acc$13143;var groups$12949;var reassemble$12950;var new_temps$12951;var helper$12952;(groups$12949=classify_contiguous$10410(parts$12946,function($12961$12963){var t0$12967;var t1$12968;var cls$12965;(t0$12967=$12961$12963);if(((t0$12967 instanceof Array)&&((t1$12968=t0$12967.length),(t1$12968>=1)))){(cls$12965=t0$12967[0]);Array.prototype.slice.call(t0$12967,1);;}else{$13369($12961$12963);}return cls$12965;}));;(reassemble$12950=[]);;(new_temps$12951=[]);;(temp$12982=groups$12949);;($length$12987=temp$12982.length);;($index$12992=0);;$12953:for(;($index$12992<$length$12987);($index$12992++)){var t0$13022;var t1$13023;var ts$13019;var new_clauses$13020;var elems$13030;var elems$13014;var $12955$13008;var $12956$13009;var $12957$13010;var $12958$13011;var t0$13005;var t1$13006;var m$13000;(m$13000=temp$12982[$index$12992]);;(t0$13005=m$13000);if((($12956$13009=(t0$13005 instanceof Array))&&((t1$13006=t0$13005.length),(($12958$13011=(t1$13006>=1))&&(t0$13005[0]==="clause"))))){(elems$13014=Array.prototype.slice.call(t0$13005,1));(t0$13022=opt_clauses$10423(elems$13014));if(((t0$13022 instanceof Array)&&((t1$13023=t0$13022.length),(t1$13023===2)))){(ts$13019=t0$13022[0]);(new_clauses$13020=t0$13022[1]);;}else{$13369(opt_clauses$10423(elems$13014),"/home/olivier/git/earl-grey/src/pattern.eg",16428,16456);}(new_temps$12951=new_temps$12951.concat(ts$13019));(reassemble$12950=reassemble$12950.concat(new_clauses$13020));}else{if(($12958$13011&&(t0$13005[0]==="block"))){(elems$13030=Array.prototype.slice.call(t0$13005,1));(reassemble$12950=reassemble$12950.concat(elems$13030));}else{$13369(m$13000,"/home/olivier/git/earl-grey/src/pattern.eg",16362,16567);;}}}(helper$12952=function($13037$13039){var $index$13118;var $length$13113;var temp$13108;var acc$13103;var decls$13097;var vars$13089;var varsd$13090;var blocks$13091;var body$13092;var rest$13093;var body$13078;var rest$13079;var $13042$13065;var $13043$13066;var $13044$13067;var $13045$13068;var $13046$13069;var $13047$13070;var t0$13058;var t1$13059;var t2$13060;var t3$13061;var t4$13062;var t5$13063;var $13041$13053;var ph$13048;(ph$13048=$13037$13039);;($13041$13053=ph$13048);;if((($13042$13065=($13041$13053 instanceof Array))&&((t0$13058=$13041$13053.length),(t0$13058===0)))){return ["multi"];}else{if(($13042$13065&&(($13044$13067=(t0$13058>=1))&&((t1$13059=$13041$13053[0]),(($13046$13069=(t1$13059 instanceof Array))&&((t2$13060=t1$13059.length),((t2$13060===2)&&((t1$13059[0]==="block")&&((t3$13061=$13504(["multi"])(t1$13059[1])),(t3$13061[0]&&((t4$13062=t3$13061[1]),((t5$13063=t4$13062.length),(t5$13063>=0))))))))))))){(body$13078=Array.prototype.slice.call(t4$13062,0));(rest$13079=Array.prototype.slice.call($13041$13053,1));return ["multi"].concat(body$13078).concat([helper$12952(rest$13079)]);}else{if(($13046$13069&&((t2$13060===5)&&(t1$13059[0]==="clause")))){(vars$13089=t1$13059[1]);(varsd$13090=t1$13059[2]);(blocks$13091=t1$13059[3]);(body$13092=t1$13059[4]);(rest$13093=Array.prototype.slice.call($13041$13053,1));(decls$13097=(((acc$13103=[])),(((temp$13108=vars$13089)),((($length$13113=temp$13108.length)),((($index$13118=0)),function(){$13100:for(;($index$13118<$length$13113);($index$13118++)){var v$13134;var m$13126;(m$13126=temp$13108[$index$13118]);;(v$13134=m$13126);acc$13103.push(["declare",v$13134]);}}()))),acc$13103));;return ["tagscope","back",["multi"].concat(decls$13097).concat([assemble_pattern$10417(blocks$13091,body$13092,["use","back",helper$12952(rest$13093)])])];}else{$13369($13041$13053);}}}});;return ["multi"].concat((((acc$13143=[])),(((temp$13148=new_temps$12951)),((($length$13153=temp$13148.length)),((($index$13158=0)),function(){$13140:for(;($index$13158<$length$13153);($index$13158++)){var t$13174;var m$13166;(m$13166=temp$13148[$index$13158]);;(t$13174=m$13166);acc$13143.push(["declare",t$13174]);}}()))),acc$13143)).concat([helper$12952(reassemble$12950)]);});;(exports["PatternParser"]=PatternParser$10414);(exports["PatternProcessor"]=PatternProcessor$10415);(exports["parse_clauses"]=parse_clauses$10422);(exports["parse_pattern"]=parse_pattern$10419);
