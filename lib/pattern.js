var $12856=function(type$12858){var f$12861;(f$12861=type$12858["::check"]);if((f$12861===(void 0))){return function(value$12866){return (value$12866 instanceof type$12858);};}else{return function(value$12869){return f$12861.call(type$12858,value$12869);};}};
var $12871=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $12872=function(dest$12874,values$12875){var k$12880;(k$12880=null);$12878:for(k$12880 in values$12875){if(values$12875.hasOwnProperty(k$12880)){(dest$12874[k$12880]=values$12875[k$12880]);}}return dest$12874;};
var $12887=function($12888$12890){var ph$12894;(ph$12894=$12888$12890);var $12892$12899;($12892$12899=ph$12894);var bridge$12893$12904;var x$12908;(bridge$12893$12904=$12892$12899);if((((typeof(bridge$12893$12904)==="string")&&((x$12908=bridge$12893$12904),true))||((typeof(bridge$12893$12904)==="number")&&((x$12908=bridge$12893$12904),true)))){return ["value",x$12908];}else{var other$12918;(other$12918=$12892$12899);return other$12918["::serialize_ast"]();}};
var send$12663;(send$12663=function(obj$12668,$12666$12669){var ph$12673;var msg$12674;var t0$12676;(t0$12676=$12666$12669);(msg$12674=t0$12676);(ph$12673=t0$12676);var $12671$12683;($12671$12683=ph$12673);var bridge$12672$12688;(bridge$12672$12688=$12671$12683);if(((typeof(bridge$12672$12688)==="string")||(typeof(bridge$12672$12688)==="number"))){return obj$12668[msg$12674];}else{var other$12699;(other$12699=$12671$12683);return obj$12668["::send"](msg$12674);}});(Array[":::project"]=function($12704$12706){var ph$12709;var value$12710;var t0$12712;(t0$12712=$12704$12706);(value$12710=t0$12712);(ph$12709=t0$12712);var $12708$12719;($12708$12719=ph$12709);if($12856(Array)($12708$12719)){return [true,value$12710];}else{$12708$12719;return [true,[value$12710]];}});(Array.prototype["::check"]=function(value$12736){if((value$12736 instanceof Array)){var i$12741;(i$12741=0);$12739:for(;(i$12741<this.length);(i$12741++)){if(($12871(this,i$12741)!==$12871(value$12736,i$12741))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $12872(this.slice(0),this);});(Array.prototype[":::project"]=function(value$12758){if((value$12758 instanceof Array)){var i$12763;(i$12763=0);$12761:for(;(i$12763<this.length);(i$12763++)){if(($12871(this,i$12763)!==$12871(value$12758,i$12763))){return [true,[value$12758]];}}return [true,value$12758.slice(this.length)];}else{return [true,[value$12758]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($12887));});(RegExp.prototype["::check"]=function($12779$12781){var ph$12784;(ph$12784=$12779$12781);var $12783$12789;($12783$12789=ph$12784);var value$12797;if((typeof($12783$12789)==="string")){(value$12797=$12783$12789);if(value$12797.match(this)){return true;}else{return false;}}else{var other$12802;(other$12802=$12783$12789);return false;}});(RegExp.prototype[":::project"]=function($12807$12809){var ph$12812;(ph$12812=$12807$12809);var $12811$12817;($12811$12817=ph$12812);var value$12825;if((typeof($12811$12817)==="string")){(value$12825=$12811$12817);var $12828$12830;($12828$12830=value$12825.match(this));var m$12838;if(($12828$12830===null)){(m$12838=$12828$12830);return [false,null];}else{var m$12843;(m$12843=$12828$12830);return [true,m$12843];}}else{var other$12847;(other$12847=$12811$12817);return [false,null];}});(Function.prototype["::send"]=function(args$12853){return this.apply(this,args$12853);});
var $16336=function(arr$16338){var results$16342;var l$16343;(results$16342=[]);(l$16343=arr$16338.length);var i$16351;(i$16351=0);$16341:for(;(i$16351<l$16343);(i$16351++)){results$16342.push([i$16351,$12871(arr$16338,i$16351)]);}return results$16342;};
var $16358=function(value$16360,url$16361,start$16362,end$16363){var err$16366;(err$16366=$16140(["match"]).create("Could not find a match for value",({"value":value$16360})));if(url$16361){(err$16366["location"]=["location",url$16361,start$16362,end$16363]);}throw err$16366;};
var $16140=function(){var $16141$16143;($16141$16143=function(tags$16147){var it$0$16150;(it$0$16150=function(){if((!$12856($16141$16143)(this))){return Object.create($16141$16143.prototype);}else{return this;}}());(it$0$16150["tags"]=tags$16147);return it$0$16150;});($16141$16143.prototype["create"]=function(){var $16162$16164;($16162$16164=arguments);var t0$16169;var message$16173;var args$16174;(t0$16169=$16162$16164.length);if((t0$16169>=0)){(message$16173=function(){if((0>=t0$16169)){return "";}else{return $16162$16164[0];}}());(args$16174=Array.prototype.slice.call($16162$16164,1));var it$0$16181;(it$0$16181=this);var self$16186;(self$16186=this);var e$16191;(e$16191=Error(message$16173));(e$16191["::tags"]=it$0$16181.tags);(e$16191["args"]=args$16174);var temp$16205;(temp$16205=$16336(args$16174));var $length$16210;($length$16210=temp$16205.length);var $index$16215;($index$16215=0);$16192:for(;($index$16215<$length$16210);($index$16215++)){var m$16223;(m$16223=temp$16205[$index$16215]);var t0$16228;var t1$16229;var i$16233;var arg$16234;(t0$16228=m$16223);if(((t0$16228 instanceof Array)&&(((t1$16229=t0$16228.length)),(t1$16229===2)))){(i$16233=t0$16228[0]);(arg$16234=t0$16228[1]);(e$16191[i$16233]=arg$16234);}else{$16358(m$16223);}}(e$16191["length"]=args$16174.length);(e$16191["name"]=["E"].concat(it$0$16181.tags).join("."));return e$16191;}else{$16358($16162$16164);}});($16141$16143.prototype["::check"]=function(e$16260){var it$0$16263;(it$0$16263=this);var self$16268;(self$16268=this);var tags$16273;if(((!e$16260)||(!$12856(Error)(e$16260)))){return false;}(tags$16273=(e$16260["::tags"]||[]));var temp$16282;(temp$16282=it$0$16263.tags);var $length$16287;($length$16287=temp$16282.length);var $index$16292;($index$16292=0);$16274:for(;($index$16292<$length$16287);($index$16292++)){var m$16300;(m$16300=temp$16282[$index$16292]);var tag$16308;(tag$16308=m$16300);if((tags$16273.indexOf(tag$16308)===-1)){return false;}else{false;}}return true;});($16141$16143.prototype["::deconstruct"]=function(e$16316){var it$0$16319;(it$0$16319=this);var self$16324;(self$16324=this);return e$16316.args;});$12872($16141$16143,$12872(function(){var accum$16329;(accum$16329=({}));(accum$16329["::name"]="$16141");return accum$16329;}(),function(){var accum$16333;(accum$16333=({}));(accum$16333["::egclass"]=true);return accum$16333;}()));return $16141$16143;}();
var $16464=function($16465$16467,key$16468){var ph$16472;(ph$16472=$16465$16467);var $16470$16477;($16470$16477=ph$16472);var bridge$16471$16482;(bridge$16471$16482=$16470$16477);if(((bridge$16471$16482===null)||(bridge$16471$16482===(void 0)))){return false;}else{var x$16493;if((typeof($16470$16477)==="string")){(x$16493=$16470$16477);return (key$16468 in String.prototype);}else{var x$16498;if((typeof($16470$16477)==="number")){(x$16498=$16470$16477);return (key$16468 in Number.prototype);}else{var x$16503;(x$16503=$16470$16477);return (key$16468 in x$16503);}}}};
var $16393=function($16394$16396){var ph$16402;var x$16403;var t0$16405;(t0$16405=$16394$16396);(x$16403=t0$16405);(ph$16402=t0$16405);var $16398$16412;($16398$16412=ph$16402);var bridge$16399$16417;(bridge$16399$16417=$16398$16412);if((function(){var bridge$16400$16426;(bridge$16400$16426=bridge$16399$16417);return (function(){var bridge$16401$16432;(bridge$16401$16432=bridge$16400$16426);return ((bridge$16401$16432===(void 0))||(bridge$16401$16432===null));}()||(typeof(bridge$16400$16426)==="string"));}()||(typeof(bridge$16399$16417)==="number"))){return x$16403;}else{if($16464($16398$16412,"::clone")){$16398$16412["::clone"];return x$16403["::clone"]();}else{$16398$16412;if((Object.getPrototypeOf(x$16403)===Object.prototype)){var dest$16448;(dest$16448=({}));var k$16453;(k$16453=null);$16447:for(k$16453 in x$16403){if(Object.prototype.hasOwnProperty.call(x$16403,k$16453)){(dest$16448[k$16453]=x$16403[k$16453]);}}return dest$16448;}else{var other$16462;(other$16462=$16398$16412);throw $16140(["clone"]).create("Object cannot be cloned",({"obj":x$16403}));}}}};
var $16374=function(a$16376,b$16377){var dest$16381;(dest$16381=$16393(a$16376));var k$16386;(k$16386=null);$16380:for(k$16386 in b$16377){if(Object.prototype.hasOwnProperty.call(b$16377,k$16386)){(dest$16381[k$16386]=b$16377[k$16386]);}}return dest$16381;};
var $16505=Object.keys;
var $16506=function(type$16508){return function(value$16511){var f$16514;(f$16514=type$16508[":::project"]);if((f$16514===(void 0))){(f$16514=type$16508["::project"]);if((f$16514===(void 0))){return [true,type$16508(value$16511)];}else{var rval$16523;(rval$16523=false);try{(rval$16523=[true,f$16514(value$16511)]);}catch(excv$16532){var e$16538;(e$16538=excv$16532);(rval$16523=[false,null]);}return rval$16523;}}else{return f$16514.call(type$16508,value$16511);}};};
var $16543=function(xs$16545,ys$16546){var acc$16551;(acc$16551=[]);var temp$16556;(temp$16556=$16336(xs$16545));var $length$16561;($length$16561=temp$16556.length);var $index$16566;($index$16566=0);$16548:for(;($index$16566<$length$16561);($index$16566++)){var m$16574;(m$16574=temp$16556[$index$16566]);var t0$16579;var t1$16580;var i$16584;var x$16585;(t0$16579=m$16574);if(((t0$16579 instanceof Array)&&(((t1$16580=t0$16579.length)),(t1$16580===2)))){(i$16584=t0$16579[0]);(x$16585=t0$16579[1]);acc$16551.push([x$16585,$12871(ys$16546,i$16584)]);}else{$16358(m$16574);}}return acc$16551;};
var $16598=function(from$16600,to$16601){var rval$16605;(rval$16605=[]);var i$16610;(i$16610=from$16600);$16604:for(;(i$16610<=to$16601);(i$16610++)){rval$16605.push(i$16610);}return rval$16605;};var accum$13741;var accum$13745;var accum$14413;var accum$14417;var $12922$12926;var __lt____gt__$12927;var $12923$12928;var __lt____lt____colon__$12929;var util$12930;var GenSym$12931;var gensym$12932;var neighbours$12933;var classify$12934;var classify_contiguous$12935;var identity$12936;var $12925$12937;var checker_db$12938;var PatternParser$12939;var PatternProcessor$12940;var assemble_conditions$12941;var assemble_pattern$12942;var inject_below_uses$12943;var parse_pattern$12944;var checkall$12945;var same_block$12946;var parse_clauses$12947;var opt_clauses$12948;var weave_clauses$12949;($12922$12926=require("./pp"));(__lt____gt__$12927=$12922$12926["<>"]);($12923$12928=require("./location"));(__lt____lt____colon__$12929=$12923$12928["<<:"]);(util$12930=require("./util"));(GenSym$12931=util$12930.GenSym);(gensym$12932=util$12930.gensym);(neighbours$12933=util$12930.neighbours);(classify$12934=util$12930.classify);(classify_contiguous$12935=util$12930.classify_contiguous);(identity$12936=util$12930.identity);($12925$12937=require("./expand"));(checker_db$12938=$12925$12937.checker_db);(PatternParser$12939=function(scope$12992,pattern$12993,opt$12994){var it$0$12997;(it$0$12997=function(){if((!$12856(PatternParser$12939)(this))){return Object.create(PatternParser$12939.prototype);}else{return this;}}());(it$0$12997["opt"]=opt$12994);(it$0$12997["arguments"]=[]);(it$0$12997["vars"]=[]);(it$0$12997["specials"]=({}));(it$0$12997["pattern"]=it$0$12997.expand(scope$12992,pattern$12993,(opt$12994.tags||({})),true,it$0$12997.opt.indexable));return it$0$12997;});(PatternParser$12939.prototype["parse_specs"]=function(scope$13022,specs$13023,tags$13024){var $index$13070;var $length$13065;var temp$13060;var acc$13055;var rest$13037;var has_defaults$13038;var rval$13039;var self$13032;var it$0$13027;(it$0$13027=this);(self$13032=this);(rest$13037=(void 0));(has_defaults$13038=false);(rval$13039=classify$12934("fw","bw","keys","defaults",(((acc$13055=[])),(((temp$13060=scope$13022.step_all(["pattern"],specs$13023))),((($length$13065=temp$13060.length)),((($index$13070=0)),function(){$13048:for(;($index$13070<$length$13065);($index$13070++)){var v$13139;var v$13133;var variable$13122;var value$13123;var key$13115;var subp$13116;var key$13109;var variable$13092;var $13050$13086;var $13051$13087;var $13052$13088;var $13053$13089;var t0$13083;var t1$13084;var m$13078;(m$13078=temp$13060[$index$13070]);(t0$13083=m$13078);if((($13051$13087=(t0$13083 instanceof Array))&&(((t1$13084=t0$13083.length)),(($13053$13089=(t1$13084===2))&&(t0$13083[0]==="dynsplice"))))){(variable$13092=t0$13083[1]);acc$13055.push((((rest$13037=it$0$13027.expand(scope$13022,variable$13092,tags$13024))),["ignore"]));}else{if(($13053$13089&&(t0$13083[0]==="assoc"))){(key$13109=t0$13083[1]);acc$13055.push(["keys",[key$13109,it$0$13027.expand(scope$13022,key$13109,tags$13024)]]);}else{if(($13051$13087&&(($13053$13089=(t1$13084===3))&&(t0$13083[0]==="assoc")))){(key$13115=t0$13083[1]);(subp$13116=t0$13083[2]);acc$13055.push(["keys",[key$13115,it$0$13027.expand(scope$13022,subp$13116,tags$13024)]]);}else{if(($13053$13089&&(t0$13083[0]==="default"))){(variable$13122=t0$13083[1]);(value$13123=t0$13083[2]);acc$13055.push((((has_defaults$13038=true)),function(){if(rest$13037){throw $16140(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$13027.expand(scope$13022,variable$13122,tags$13024),value$13123]];}}()));}else{(v$13133=m$13078);if(((rest$13037===(void 0))&&(!has_defaults$13038))){acc$13055.push(["fw",it$0$13027.expand(scope$13022,v$13133,tags$13024)]);}else{(v$13139=m$13078);acc$13055.push(["bw",it$0$13027.expand(scope$13022,v$13139,tags$13024)]);}}}}}}}()))),acc$13055)));(rval$13039["rest"]=rest$13037);return rval$13039;});(PatternParser$12939.prototype["expand"]=function(){var x$13212;var x$13221;var x$13246;var x$13251;var variable$13257;var variable$13272;var x$13310;var msg$13317;var msg$13332;var $index$13368;var $length$13363;var temp$13358;var acc$13353;var $index$13480;var $length$13475;var temp$13470;var acc$13465;var $index$13512;var $length$13507;var temp$13502;var t0$13579;var t1$13580;var t2$13581;var $index$13618;var $length$13613;var temp$13608;var acc$13603;var patts$13597;var canon$13393;var normalize$13394;var pps$13395;var vars$13396;var patt$13684;var msg$13723;var other$13720;var keys$13690;var fw$13666;var bw$13667;var defaults$13668;var rest$13669;var $13645$13663;var t0$13656;var t1$13657;var t2$13658;var t3$13659;var t4$13660;var t5$13661;var $13644$13651;var specs$13646;var other$13735;var mode$13729;var subp$13730;var args$13640;var xs$13389;var xs$13347;var x$13338;var f$13323;var arg$13324;var f$13301;var arguments$13302;var checker$13295;var subp$13296;var projector$13289;var subp$13290;var condition$13283;var subp$13284;var v$13278;var v$13263;var type$13228;var $13190$13204;var $13191$13205;var $13192$13206;var $13193$13207;var t0$13200;var bridge$13189$13201;var t1$13202;var $13188$13195;var expr$13181;var rval$13182;var self$13176;var it$0$13171;var scope$13160;var pattern$13161;var tags$13162;var toplevel$13163;var checked$13164;var t0$13156;var $13149$13151;($13149$13151=arguments);(t0$13156=$13149$13151.length);if(((t0$13156>=3)&&(t0$13156<=5))){(scope$13160=$13149$13151[0]);(pattern$13161=$13149$13151[1]);(tags$13162=$13149$13151[2]);(toplevel$13163=function(){if((3>=t0$13156)){return false;}else{return $13149$13151[3];}}());(checked$13164=function(){if((4>=t0$13156)){return false;}else{return $13149$13151[4];}}());(it$0$13171=this);(self$13176=this);(expr$13181=scope$13160.step(["pattern"],pattern$13161));(rval$13182=((($13188$13195=expr$13181)),function(){if((((x$13212=$13188$13195)),((x$13212 instanceof Array)&&(x$13212[0]==="void")))){return ["check",checker_db$12938.null,["ignore"]];}else{if((((x$13221=$13188$13195)),((x$13221 instanceof Array)&&(x$13221[0]==="ignore")))){return expr$13181;}else{if((($13188$13195 instanceof Array)&&(((t0$13200=$13188$13195.length)),((t0$13200===2)&&($13188$13195[0]==="special"))))){(type$13228=$13188$13195[1]);(it$0$13171.specials[type$13228]=true);return expr$13181;}else{(bridge$13189$13201=$13188$13195);if(((((x$13246=bridge$13189$13201)),((x$13246 instanceof Array)&&(x$13246[0]==="symbol")))||(((x$13251=bridge$13189$13201)),((x$13251 instanceof Array)&&(x$13251[0]==="variable"))))){(variable$13257=$16374(expr$13181,tags$13162));it$0$13171.vars.push(variable$13257);return ["assign",variable$13257];}else{if((($13190$13204=($13188$13195 instanceof Array))&&(((t0$13200=$13188$13195.length)),(($13192$13206=(t0$13200===2))&&(($13193$13207=($13188$13195[0]==="value"))&&((v$13263=$13188$13195[1]),it$0$13171.opt.strings_as_variables)))))){(variable$13272=__lt____lt____colon__$12929($16374(["symbol",v$13263],tags$13162),expr$13181));it$0$13171.vars.push(variable$13272);return ["assign",variable$13272];}else{if($13193$13207){(v$13278=$13188$13195[1]);return ["check",checker_db$12938(v$13278),["ignore"]];}else{if(($13190$13204&&(($13192$13206=(t0$13200===3))&&($13188$13195[0]==="test")))){(condition$13283=$13188$13195[1]);(subp$13284=$13188$13195[2]);return ["test",condition$13283,it$0$13171.expand(scope$13160,subp$13284,tags$13162,toplevel$13163,false)];}else{if(($13192$13206&&($13188$13195[0]==="project"))){(projector$13289=$13188$13195[1]);(subp$13290=$13188$13195[2]);return ["project",projector$13289,it$0$13171.expand(scope$13160,subp$13290,tags$13162,toplevel$13163,true)];}else{if(($13192$13206&&($13188$13195[0]==="check"))){(checker$13295=$13188$13195[1]);(subp$13296=$13188$13195[2]);return ["check",checker$13295,it$0$13171.expand(scope$13160,subp$13296,tags$13162,toplevel$13163,true)];}else{if(($13192$13206&&(($13193$13207=($13188$13195[0]==="send"))&&((f$13301=$13188$13195[1]),(((t1$13202=$13188$13195[2])),(((x$13310=t1$13202)),((x$13310 instanceof Array)&&(x$13310[0]==="data")))))))){(arguments$13302=t1$13202);if(toplevel$13163){it$0$13171.arguments.unshift(arguments$13302);return it$0$13171.expand(scope$13160,f$13301,tags$13162,true,false);}else{(msg$13317="Function arguments can only be declared as a top level pattern.");throw $16140(["syntax","pattern"]).create(msg$13317,({"node":expr$13181,"arg":arguments$13302}));}}else{if($13193$13207){(f$13323=$13188$13195[1]);(arg$13324=$13188$13195[2]);return ["assign",expr$13181];}else{$13188$13195;if((!it$0$13171.opt.allow_nested)){(msg$13332="Nested patterns are not allowed here.");throw $16140(["syntax","pattern"]).create(msg$13332,({"node":expr$13181}));}else{if((($13190$13204=($13188$13195 instanceof Array))&&(((t0$13200=$13188$13195.length)),((t0$13200===2)&&($13188$13195[0]==="neg"))))){(x$13338=$13188$13195[1]);return ["neg",it$0$13171.expand(scope$13160,x$13338,tags$13162)];}else{if(($13190$13204&&(($13192$13206=(t0$13200>=1))&&($13188$13195[0]==="all")))){(xs$13347=Array.prototype.slice.call($13188$13195,1));return ["all"].concat((((acc$13353=[])),(((temp$13358=xs$13347)),((($length$13363=temp$13358.length)),((($index$13368=0)),function(){$13350:for(;($index$13368<$length$13363);($index$13368++)){var x$13384;var m$13376;(m$13376=temp$13358[$index$13368]);(x$13384=m$13376);acc$13353.push(it$0$13171.expand(scope$13160,x$13384,tags$13162));}}()))),acc$13353));}else{if(($13192$13206&&($13188$13195[0]==="any"))){(xs$13389=Array.prototype.slice.call($13188$13195,1));(canon$13393=function(all$13402){return all$13402.sort().join(",");});(normalize$13394=function(vars$13408){var $index$13428;var $length$13423;var temp$13418;var acc$13413;return canon$13393((((acc$13413=[])),(((temp$13418=vars$13408)),((($length$13423=temp$13418.length)),((($index$13428=0)),function(){$13410:for(;($index$13428<$length$13423);($index$13428++)){var v$13446;var t0$13441;var t1$13442;var m$13436;(m$13436=temp$13418[$index$13428]);(t0$13441=m$13436);if(((t0$13441 instanceof Array)&&(((t1$13442=t0$13441.length)),((t1$13442===2)&&(t0$13441[0]==="symbol"))))){(v$13446=t0$13441[1]);acc$13413.push(v$13446);}else{$16358(m$13436,"/home/olivier/git/earl-grey/src/pattern.eg",3781,3838);}}}()))),acc$13413));});(pps$13395=(((acc$13465=[])),(((temp$13470=xs$13389)),((($length$13475=temp$13470.length)),((($index$13480=0)),function(){$13462:for(;($index$13480<$length$13475);($index$13480++)){var x$13496;var m$13488;(m$13488=temp$13470[$index$13480]);(x$13496=m$13488);acc$13465.push(PatternParser$12939(scope$13160,x$13496,$16374(it$0$13171.opt,({"tags":tags$13162}))));}}()))),acc$13465));(temp$13502=neighbours$12933(pps$13395));($length$13507=temp$13502.length);($index$13512=0);$13397:for(;($index$13512<$length$13507);($index$13512++)){var $index$13556;var $length$13551;var temp$13546;var pp1$13530;var pp2$13531;var t0$13525;var t1$13526;var m$13520;(m$13520=temp$13502[$index$13512]);(t0$13525=m$13520);if(((t0$13525 instanceof Array)&&(((t1$13526=t0$13525.length)),(t1$13526===2)))){(pp1$13530=t0$13525[0]);(pp2$13531=t0$13525[1]);(temp$13546=pps$13395);($length$13551=temp$13546.length);($index$13556=0);$13542:for(;($index$13556<$length$13551);($index$13556++)){var pp$13572;var m$13564;(m$13564=temp$13546[$index$13556]);(pp$13572=m$13564);normalize$13394(pp$13572.vars);}if((normalize$13394(pp1$13530.vars)!==normalize$13394(pp2$13531.vars))){throw $16140(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$12929(pp1$13530.vars.sort(),pp1$13530.pattern),"vars2":__lt____lt____colon__$12929(pp2$13531.vars.sort(),pp2$13531.pattern)}));}if((canon$13393($16505(pp1$13530.specials))!==canon$13393($16505(pp2$13531.specials)))){throw $16140(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$12929($16505(pp1$13530.specials).sort(),pp1$13530.pattern),"special2":__lt____lt____colon__$12929($16505(pp2$13531.specials).sort(),pp2$13531.pattern)}));}}else{$16358(m$13520,"/home/olivier/git/earl-grey/src/pattern.eg",3930,4727);}}(t0$13579=pps$13395);if(((t0$13579 instanceof Array)&&(((t1$13580=t0$13579.length)),((t1$13580>=1)&&(((t2$13581=t0$13579[0])),$16464(t2$13581,"vars")))))){(vars$13396=t2$13581.vars);Array.prototype.slice.call(t0$13579,1);}else{$16358(pps$13395,"/home/olivier/git/earl-grey/src/pattern.eg",4744,4747);}(it$0$13171["vars"]=it$0$13171.vars.concat(vars$13396));(patts$13597=(((acc$13603=[])),(((temp$13608=pps$13395)),((($length$13613=temp$13608.length)),((($index$13618=0)),function(){$13600:for(;($index$13618<$length$13613);($index$13618++)){var pp$13634;var m$13626;(m$13626=temp$13608[$index$13618]);(pp$13634=m$13626);acc$13603.push(pp$13634.pattern);}}()))),acc$13603));return ["any"].concat(patts$13597);}else{if(($13192$13206&&($13188$13195[0]==="data"))){(args$13640=Array.prototype.slice.call($13188$13195,1));(specs$13646=it$0$13171.parse_specs(scope$13160,args$13640,tags$13162));($13644$13651=specs$13646);if((($13645$13663=$16464($13644$13651,"keys"))&&(((t0$13656=$13644$13651.keys)),((t0$13656 instanceof Array)&&(((t1$13657=t0$13656.length)),((t1$13657===0)&&($16464($13644$13651,"fw")&&((fw$13666=$13644$13651.fw),($16464($13644$13651,"bw")&&((bw$13667=$13644$13651.bw),($16464($13644$13651,"defaults")&&((defaults$13668=$13644$13651.defaults),$16464($13644$13651,"rest"))))))))))))){(rest$13669=$13644$13651.rest);(patt$13684=__lt____lt____colon__$12929(["array_pattern",fw$13666,bw$13667,defaults$13668,rest$13669],pattern$13161));if(checked$13164){return patt$13684;}else{return ["check",checker_db$12938.Array,patt$13684];}}else{if(($13645$13663&&((keys$13690=$13644$13651.keys),($16464($13644$13651,"fw")&&(((t0$13656=$13644$13651.fw)),((t0$13656 instanceof Array)&&(((t1$13657=t0$13656.length)),((t1$13657===0)&&($16464($13644$13651,"bw")&&(((t2$13658=$13644$13651.bw)),((t2$13658 instanceof Array)&&(((t3$13659=t2$13658.length)),((t3$13659===0)&&($16464($13644$13651,"defaults")&&(((t4$13660=$13644$13651.defaults)),((t4$13660 instanceof Array)&&(((t5$13661=t4$13660.length)),((t5$13661===0)&&($16464($13644$13651,"rest")&&($13644$13651.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$13690);}else{(other$13720=$13644$13651);(msg$13723="Pattern must be an array or an object.");throw $16140(["syntax","pattern"]).create(msg$13723,({"node":expr$13181,"specs":specs$13646}));}}}else{if(($13190$13204&&((t0$13200===3)&&($13188$13195[0]==="mode")))){(mode$13729=$13188$13195[1]);(subp$13730=$13188$13195[2]);return it$0$13171.expand(scope$13160,subp$13730,$16374(tags$13162,({"declare_mode":mode$13729})),toplevel$13163,checked$13164);}else{(other$13735=$13188$13195);throw $16140(["syntax","pattern"]).create("Illegal pattern",({"node":other$13735}));}}}}}}}}}}}}}}}}}}()));return (it$0$13171.opt.wrap_pattern||identity$12936)(__lt____lt____colon__$12929(rval$13182,pattern$13161),toplevel$13163);}else{$16358($13149$13151);}});$12872(PatternParser$12939,$12872(((accum$13741=({})),((accum$13741["::name"]="PatternParser"),accum$13741)),((accum$13745=({})),((accum$13745["::egclass"]=true),accum$13745))));PatternParser$12939;(PatternProcessor$12940=function(){var it$0$13753;(it$0$13753=function(){if((!$12856(PatternProcessor$12940)(this))){return Object.create(PatternProcessor$12940.prototype);}else{return this;}}());(it$0$13753["temps"]=[]);(it$0$13753["parts"]=[]);(it$0$13753["gen"]=GenSym$12931("t"));return it$0$13753;});(PatternProcessor$12940.prototype["do"]=function(part$13772){var self$13780;var it$0$13775;(it$0$13775=this);(self$13780=this);return it$0$13775.parts.push(["do",part$13772]);});(PatternProcessor$12940.prototype["check"]=function(){var self$13811;var it$0$13806;var part$13798;var tags$13799;var t0$13794;var $13787$13789;($13787$13789=arguments);(t0$13794=$13787$13789.length);if(((t0$13794>=1)&&(t0$13794<=2))){(part$13798=$13787$13789[0]);(tags$13799=function(){if((1>=t0$13794)){return ({});}else{return $13787$13789[1];}}());(it$0$13806=this);(self$13811=this);return it$0$13806.parts.push($16374(["check",part$13798],tags$13799));}else{$16358($13787$13789);}});(PatternProcessor$12940.prototype["temp"]=function(){var x$13865;var x$13870;var init$13877;var bridge$13845$13856;var $13844$13851;var self$13846;var it$0$13839;var x$13831;var v$13832;var t0$13827;var $13820$13822;($13820$13822=arguments);(t0$13827=$13820$13822.length);if(((t0$13827>=1)&&(t0$13827<=2))){(x$13831=$13820$13822[0]);(v$13832=function(){if((1>=t0$13827)){return null;}else{return $13820$13822[1];}}());(it$0$13839=this);(self$13846=this);($13844$13851=x$13831);(bridge$13845$13856=$13844$13851);if((((((x$13865=bridge$13845$13856)),((x$13865 instanceof Array)&&(x$13865[0]==="variable")))||(((x$13870=bridge$13845$13856)),((x$13870 instanceof Array)&&(x$13870[0]==="symbol"))))&&($16464($13844$13851,"single_assignment")&&($13844$13851.single_assignment&&(!v$13832))))){return x$13831;}else{(init$13877=$13844$13851);(v$13832=(v$13832||["symbol",it$0$13839.gen()]));(v$13832["single_assignment"]=true);it$0$13839.temps.push(v$13832);it$0$13839.do(["send",["symbol","="],["data",["send",["symbol","set"],v$13832],init$13877]]);return v$13832;}}else{$16358($13820$13822);}});(PatternProcessor$12940.prototype["process"]=function(pattern$13891,rhs$13892,fns$13893){var x$13930;var x$13962;var t$13974;var t$13985;var pp$13995;var $index$14023;var $length$14018;var temp$14013;var t$14005;var $index$14081;var $length$14076;var temp$14071;var acc$14066;var fn$14052;var parts$14053;var t$14047;var $index$14134;var $length$14129;var temp$14124;var acc$14119;var t$14112;var otherwise$14246;var $14228$14230;var $index$14260;var $length$14255;var temp$14250;var $index$14303;var $length$14298;var temp$14293;var end$14357;var pos$14352;var $index$14377;var $length$14372;var temp$14367;var acc$14362;var nfw$14186;var nbw$14187;var ndflt$14188;var extract_length$14189;var check_length$14190;var lo$14191;var hi$14192;var t$14193;var len$14194;var fw$14179;var bw$14180;var dflt$14181;var rest$14182;var subp$14108;var xs$14043;var xs$14001;var patt$13991;var projector$13980;var subp$13981;var checker$13969;var subp$13970;var checker$13958;var condition$13951;var subp$13952;var kind$13946;var sym$13937;var $13910$13922;var $13911$13923;var $13912$13924;var $13913$13925;var t0$13920;var $13909$13915;var rval$13906;var self$13901;var it$0$13896;(it$0$13896=this);(self$13901=this);(rval$13906=((($13909$13915=pattern$13891)),function(){if((((x$13930=$13909$13915)),((x$13930 instanceof Array)&&(x$13930[0]==="ignore")))){return it$0$13896.do(rhs$13892);}else{if((($13910$13922=($13909$13915 instanceof Array))&&(((t0$13920=$13909$13915.length)),(($13912$13924=(t0$13920===2))&&($13909$13915[0]==="assign"))))){(sym$13937=$13909$13915[1]);return it$0$13896.parts.push(fns$13893.assign(sym$13937,rhs$13892));}else{if(($13912$13924&&($13909$13915[0]==="special"))){(kind$13946=$13909$13915[1]);return it$0$13896.process(fns$13893.special(pattern$13891,rhs$13892),rhs$13892,fns$13893);}else{if(($13910$13922&&(($13912$13924=(t0$13920===3))&&($13909$13915[0]==="test")))){(condition$13951=$13909$13915[1]);(subp$13952=$13909$13915[2]);it$0$13896.process(subp$13952,rhs$13892,fns$13893);return it$0$13896.check(condition$13951,({"test":true}));}else{if(($13912$13924&&(($13913$13925=($13909$13915[0]==="check"))&&((checker$13958=$13909$13915[1]),(((x$13962=$13909$13915[2])),((x$13962 instanceof Array)&&(x$13962[0]==="ignore"))))))){return it$0$13896.check(["send",checker$13958,["data",rhs$13892]]);}else{if($13913$13925){(checker$13969=$13909$13915[1]);(subp$13970=$13909$13915[2]);(t$13974=it$0$13896.temp(rhs$13892));it$0$13896.check(["send",checker$13969,["data",t$13974]]);return it$0$13896.process(subp$13970,t$13974,fns$13893);}else{if(($13912$13924&&($13909$13915[0]==="project"))){(projector$13980=$13909$13915[1]);(subp$13981=$13909$13915[2]);(t$13985=it$0$13896.temp(["send",projector$13980,["data",rhs$13892]]));it$0$13896.check(["send",t$13985,["value",0]]);return it$0$13896.process(subp$13981,["send",t$13985,["value",1]],fns$13893);}else{if(($13910$13922&&((t0$13920===2)&&($13909$13915[0]==="neg")))){(patt$13991=$13909$13915[1]);return it$0$13896.check(["send",["symbol","not"],["data",["void"],(((pp$13995=PatternProcessor$12940())),pp$13995.process(patt$13991,rhs$13892,fns$13893),assemble_conditions$12941(pp$13995))]]);}else{if(($13910$13922&&(($13912$13924=(t0$13920>=1))&&($13909$13915[0]==="all")))){(xs$14001=Array.prototype.slice.call($13909$13915,1));(t$14005=it$0$13896.temp(rhs$13892));(temp$14013=xs$14001);($length$14018=temp$14013.length);($index$14023=0);$14006:for(;($index$14023<$length$14018);($index$14023++)){var x$14039;var m$14031;(m$14031=temp$14013[$index$14023]);(x$14039=m$14031);it$0$13896.process(x$14039,t$14005,fns$13893);}return null;}else{if(($13912$13924&&($13909$13915[0]==="any"))){(xs$14043=Array.prototype.slice.call($13909$13915,1));(t$14047=it$0$13896.temp(rhs$13892,["symbol",gensym$12932("bridge")]));return it$0$13896.check((((fn$14052=function(x$14057,rest$14058){return ["send",["symbol","or"],["data",x$14057,rest$14058]];})),((parts$14053=(((acc$14066=[])),(((temp$14071=xs$14043)),((($length$14076=temp$14071.length)),((($index$14081=0)),function(){$14063:for(;($index$14081<$length$14076);($index$14081++)){var pp$14101;var x$14097;var m$14089;(m$14089=temp$14071[$index$14081]);(x$14097=m$14089);acc$14066.push((((pp$14101=PatternProcessor$12940())),pp$14101.process(x$14097,t$14047,fns$13893),assemble_conditions$12941(pp$14101)));}}()))),acc$14066))),util$12930.construct(parts$14053,fn$14052,["symbol","false"])));}else{if(($13912$13924&&($13909$13915[0]==="object_pattern"))){(subp$14108=Array.prototype.slice.call($13909$13915,1));(t$14112=it$0$13896.temp(rhs$13892));(acc$14119=[]);(temp$14124=subp$14108);($length$14129=temp$14124.length);($index$14134=0);$14113:for(;($index$14134<$length$14129);($index$14134++)){var k$14154;var v$14155;var t0$14147;var t1$14148;var t2$14149;var t3$14150;var m$14142;(m$14142=temp$14124[$index$14134]);(t0$14147=m$14142);if(((t0$14147 instanceof Array)&&(((t1$14148=t0$14147.length)),((t1$14148===2)&&(((t2$14149=t0$14147[0])),((t2$14149 instanceof Array)&&(((t3$14150=t2$14149.length)),((t3$14150===2)&&(t2$14149[0]==="value"))))))))){(k$14154=t2$14149[1]);(v$14155=t0$14147[1]);acc$14119.push((it$0$13896.check(["send",["symbol","___hasprop"],["data",t$14112,["value",k$14154]]]),it$0$13896.process(v$14155,["send",t$14112,["value",k$14154]],fns$13893)));}else{$16358(m$14142,"/home/olivier/git/earl-grey/src/pattern.eg",8076,8208);}}return acc$14119;}else{if(($13910$13922&&((t0$13920===5)&&($13909$13915[0]==="array_pattern")))){(fw$14179=$13909$13915[1]);(bw$14180=$13909$13915[2]);(dflt$14181=$13909$13915[3]);(rest$14182=$13909$13915[4]);(nfw$14186=fw$14179.length);(nbw$14187=bw$14180.length);(ndflt$14188=dflt$14181.length);(extract_length$14189=true);(check_length$14190=true);(lo$14191=(nfw$14186+nbw$14187));(hi$14192=(lo$14191+ndflt$14188));(t$14193=it$0$13896.temp(rhs$13892));(len$14194=it$0$13896.temp(["send",t$14193,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));it$0$13896.check(((($14228$14230=rest$14182)),function(){if($14228$14230){return ["send",["symbol",">="],["data",len$14194,["value",lo$14191]]];}else{$14228$14230;if((lo$14191===hi$14192)){return ["send",["symbol","==="],["data",len$14194,["value",lo$14191]]];}else{(otherwise$14246=$14228$14230);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$14194,["value",lo$14191]]],["send",["symbol","<="],["data",len$14194,["value",hi$14192]]]]];}}}()));(temp$14250=$16336(fw$14179));($length$14255=temp$14250.length);($index$14260=0);$14195:for(;($index$14260<$length$14255);($index$14260++)){var i$14278;var m$14279;var t0$14273;var t1$14274;var m$14268;(m$14268=temp$14250[$index$14260]);(t0$14273=m$14268);if(((t0$14273 instanceof Array)&&(((t1$14274=t0$14273.length)),(t1$14274===2)))){(i$14278=t0$14273[0]);(m$14279=t0$14273[1]);it$0$13896.process(m$14279,["send",t$14193,["value",i$14278]],fns$13893);}else{$16358(m$14268,"/home/olivier/git/earl-grey/src/pattern.eg",8940,9026);}}(temp$14293=$16336(dflt$14181));($length$14298=temp$14293.length);($index$14303=0);$14197:for(;($index$14303<$length$14298);($index$14303++)){var idx$14345;var i$14323;var patt$14324;var value$14325;var t0$14316;var t1$14317;var t2$14318;var t3$14319;var m$14311;(m$14311=temp$14293[$index$14303]);(t0$14316=m$14311);if(((t0$14316 instanceof Array)&&(((t1$14317=t0$14316.length)),((t1$14317===2)&&((i$14323=t0$14316[0]),(((t2$14318=t0$14316[1])),((t2$14318 instanceof Array)&&(((t3$14319=t2$14318.length)),(t3$14319===2))))))))){(patt$14324=t2$14318[0]);(value$14325=t2$14318[1]);(idx$14345=(i$14323+nfw$14186));it$0$13896.process(patt$14324,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$14345+nbw$14187)],len$14194]],value$14325,["send",t$14193,["value",idx$14345]]]],fns$13893);}else{$16358(m$14311,"/home/olivier/git/earl-grey/src/pattern.eg",9026,9195);}}if((rest$14182!==(void 0))){(pos$14352=(nfw$14186+ndflt$14188));(end$14357=function(){if((nbw$14187>0)){return [["value",(-nbw$14187)]];}else{return [];}}());it$0$13896.process(rest$14182,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$14193,["value",pos$14352]].concat(end$14357)],fns$13893);}else{[];}(acc$14362=[]);(temp$14367=$16336(bw$14180));($length$14372=temp$14367.length);($index$14377=0);$14199:for(;($index$14377<$length$14372);($index$14377++)){var i$14395;var m$14396;var t0$14390;var t1$14391;var m$14385;(m$14385=temp$14367[$index$14377]);(t0$14390=m$14385);if(((t0$14390 instanceof Array)&&(((t1$14391=t0$14390.length)),(t1$14391===2)))){(i$14395=t0$14390[0]);(m$14396=t0$14390[1]);acc$14362.push(it$0$13896.process(m$14396,["send",["symbol","___js_fetch"],["data",t$14193,["send",["symbol","-"],["data",len$14194,["value",(nbw$14187-i$14395)]]]]],fns$13893));}else{$16358(m$14385,"/home/olivier/git/earl-grey/src/pattern.eg",9646,9797);}}return acc$14362;}else{$16358($13909$13915);}}}}}}}}}}}}}()));return rval$13906;});$12872(PatternProcessor$12940,$12872(((accum$14413=({})),((accum$14413["::name"]="PatternProcessor"),accum$14413)),((accum$14417=({})),((accum$14417["::egclass"]=true),accum$14417))));PatternProcessor$12940;(assemble_conditions$12941=function(pp$14423){var $index$14526;var $length$14521;var temp$14516;var acc$14511;var decls$14505;var construct$14426;(construct$14426=function($14429$14431){var x$14489;var rest$14490;var x$14476;var x$14462;var rest$14463;var $14434$14450;var $14435$14451;var t0$14446;var t1$14447;var t2$14448;var $14433$14441;var ph$14436;(ph$14436=$14429$14431);($14433$14441=ph$14436);if((($14434$14450=($14433$14441 instanceof Array))&&(((t0$14446=$14433$14441.length)),(t0$14446===0)))){return ["value",true];}else{if(($14434$14450&&((t0$14446>=1)&&(((t1$14447=$14433$14441[0])),((t1$14447 instanceof Array)&&(((t2$14448=t1$14447.length)),((t2$14448===2)&&(t1$14447[0]==="do")))))))){(x$14462=t1$14447[1]);(rest$14463=Array.prototype.slice.call($14433$14441,1));return ["multi",x$14462,construct$14426(rest$14463)];}else{if(($14434$14450&&((t0$14446===1)&&(((t1$14447=$14433$14441[0])),((t1$14447 instanceof Array)&&(((t2$14448=t1$14447.length)),((t2$14448===2)&&(t1$14447[0]==="check")))))))){(x$14476=t1$14447[1]);return x$14476;}else{if(($14434$14450&&((t0$14446>=1)&&(((t1$14447=$14433$14441[0])),((t1$14447 instanceof Array)&&(((t2$14448=t1$14447.length)),((t2$14448===2)&&(t1$14447[0]==="check")))))))){(x$14489=t1$14447[1]);(rest$14490=Array.prototype.slice.call($14433$14441,1));return ["send",["symbol","and"],["data",x$14489,construct$14426(rest$14490)]];}else{$16358($14433$14441);}}}}});if(pp$14423.temps.length){(decls$14505=(((acc$14511=[])),(((temp$14516=pp$14423.temps)),((($length$14521=temp$14516.length)),((($index$14526=0)),function(){$14508:for(;($index$14526<$length$14521);($index$14526++)){var t$14542;var m$14534;(m$14534=temp$14516[$index$14526]);(t$14542=m$14534);acc$14511.push(["declare",t$14542]);}}()))),acc$14511));return ["multi"].concat(decls$14505).concat([construct$14426(pp$14423.parts)]);}else{return construct$14426(pp$14423.parts);}});(assemble_pattern$12942=function(){var $index$14600;var $length$14595;var temp$14590;var $index$14655;var $length$14650;var temp$14645;var test$14775;var lead$14570;var trail$14571;var construct$14572;var parts$14561;var t$14562;var f$14563;var t0$14557;var $14550$14552;($14550$14552=arguments);(t0$14557=$14550$14552.length);if(((t0$14557>=2)&&(t0$14557<=3))){(parts$14561=$14550$14552[0]);(t$14562=$14550$14552[1]);(f$14563=function(){if((2>=t0$14557)){return null;}else{return $14550$14552[2];}}());(lead$14570=[]);(temp$14590=parts$14561.slice(0));($length$14595=temp$14590.length);($index$14600=0);$14573:for(;($index$14600<$length$14595);($index$14600++)){var x$14635;var x$14622;var $14575$14616;var $14576$14617;var $14577$14618;var $14578$14619;var t0$14613;var t1$14614;var m$14608;(m$14608=temp$14590[$index$14600]);(t0$14613=m$14608);if((($14576$14617=(t0$14613 instanceof Array))&&(((t1$14614=t0$14613.length)),(($14578$14619=(t1$14614===2))&&(t0$14613[0]==="do"))))){(x$14622=t0$14613[1]);lead$14570.push(x$14622);parts$14561.shift();}else{if(($14578$14619&&(t0$14613[0]==="check"))){(x$14635=t0$14613[1]);break $14573;}else{$16358(m$14608,"/home/olivier/git/earl-grey/src/pattern.eg",10258,10368);}}}(trail$14571=[]);(temp$14645=parts$14561.slice(0).reverse());($length$14650=temp$14645.length);($index$14655=0);$14579:for(;($index$14655<$length$14650);($index$14655++)){var x$14690;var x$14677;var $14581$14671;var $14582$14672;var $14583$14673;var $14584$14674;var t0$14668;var t1$14669;var m$14663;(m$14663=temp$14645[$index$14655]);(t0$14668=m$14663);if((($14582$14672=(t0$14668 instanceof Array))&&(((t1$14669=t0$14668.length)),(($14584$14674=(t1$14669===2))&&(t0$14668[0]==="do"))))){(x$14677=t0$14668[1]);trail$14571.unshift(x$14677);parts$14561.pop();}else{if(($14584$14674&&(t0$14668[0]==="check"))){(x$14690=t0$14668[1]);break $14579;}else{$16358(m$14663,"/home/olivier/git/earl-grey/src/pattern.eg",10382,10504);}}}(construct$14572=function($14697$14699){var other$14771;var x$14757;var rest$14758;var x$14744;var x$14730;var rest$14731;var $14702$14718;var $14703$14719;var t0$14714;var t1$14715;var t2$14716;var $14701$14709;var ph$14704;(ph$14704=$14697$14699);($14701$14709=ph$14704);if((($14702$14718=($14701$14709 instanceof Array))&&(((t0$14714=$14701$14709.length)),(t0$14714===0)))){return ["value",true];}else{if(($14702$14718&&((t0$14714>=1)&&(((t1$14715=$14701$14709[0])),((t1$14715 instanceof Array)&&(((t2$14716=t1$14715.length)),((t2$14716===2)&&(t1$14715[0]==="do")))))))){(x$14730=t1$14715[1]);(rest$14731=Array.prototype.slice.call($14701$14709,1));return ["multi",x$14730,construct$14572(rest$14731)];}else{if(($14702$14718&&((t0$14714===1)&&(((t1$14715=$14701$14709[0])),((t1$14715 instanceof Array)&&(((t2$14716=t1$14715.length)),((t2$14716===2)&&(t1$14715[0]==="check")))))))){(x$14744=t1$14715[1]);return x$14744;}else{if(($14702$14718&&((t0$14714>=1)&&(((t1$14715=$14701$14709[0])),((t1$14715 instanceof Array)&&(((t2$14716=t1$14715.length)),((t2$14716===2)&&(t1$14715[0]==="check")))))))){(x$14757=t1$14715[1]);(rest$14758=Array.prototype.slice.call($14701$14709,1));return ["send",["symbol","and"],["data",x$14757,construct$14572(rest$14758)]];}else{(other$14771=$14701$14709);throw $16140(["oops"]).create("?!?",other$14771);}}}}});if(parts$14561.length){(test$14775=construct$14572(parts$14561));return ["multi"].concat(lead$14570).concat([function(){if(f$14563){return ["send",["symbol","if"],["data",test$14775,["multi"].concat(trail$14571).concat([t$14562]),f$14563]];}else{return ["send",["symbol","if"],["data",test$14775,["multi"].concat(trail$14571).concat([t$14562])]];}}()]);}else{return ["multi"].concat(lead$14570).concat(trail$14571).concat([t$14562]);}}else{$16358($14550$14552);}});(inject_below_uses$12943=function($14784$14786,fn$14787){var other$14814;var scope$14804;var x$14805;var t0$14800;var $14789$14795;var ph$14790;(ph$14790=$14784$14786);($14789$14795=ph$14790);if((($14789$14795 instanceof Array)&&(((t0$14800=$14789$14795.length)),((t0$14800===3)&&($14789$14795[0]==="use"))))){(scope$14804=$14789$14795[1]);(x$14805=$14789$14795[2]);return ["use",scope$14804,inject_below_uses$12943(x$14805,fn$14787)];}else{(other$14814=$14789$14795);return fn$14787(other$14814);}});(parse_pattern$12944=function(scope$14820,pattern$14821,rhs$14822,opt$14823){var t0$14834;var $index$14876;var $length$14871;var temp$14866;var acc$14861;var parse$14826;var target$14827;var proc$14828;(parse$14826=PatternParser$12939(scope$14820,pattern$14821,opt$14823));if(((!opt$14823.allow_arguments)&&parse$14826.arguments.length)){throw $16140(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$14826.arguments[0]}));}(t0$14834=$16506((opt$14823.wrap_target||identity$12936))(function(){if(parse$14826.arguments.length){return inject_below_uses$12943(rhs$14822,function(x$14839){return util$12930.construct(parse$14826.arguments.concat([x$14839]),function(args$14842,rest$14843){return ["send",["symbol","->"],["data",args$14842,rest$14843]];});});}else{return rhs$14822;}}()));if(t0$14834[0]){(target$14827=t0$14834[1]);}else{$16358(function(){if(parse$14826.arguments.length){return inject_below_uses$12943(rhs$14822,function(x$14849){return util$12930.construct(parse$14826.arguments.concat([x$14849]),function(args$14852,rest$14853){return ["send",["symbol","->"],["data",args$14852,rest$14853]];});});}else{return rhs$14822;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11897,12330);}(proc$14828=PatternProcessor$12940());proc$14828.process(parse$14826.pattern,target$14827,opt$14823);if(opt$14823.finalize){return ["splice"].concat(opt$14823.declare(scope$14820,parse$14826.vars)).concat([["multi"].concat((((acc$14861=[])),(((temp$14866=proc$14828.temps)),((($length$14871=temp$14866.length)),((($index$14876=0)),function(){$14858:for(;($index$14876<$length$14871);($index$14876++)){var t$14892;var m$14884;(m$14884=temp$14866[$index$14876]);(t$14892=m$14884);acc$14861.push(["declare",t$14892]);}}()))),acc$14861)).concat([assemble_pattern$12942(proc$14828.parts,opt$14823.success(target$14827),opt$14823.failure(target$14827))])]);}else{return [parse$14826.vars,proc$14828.temps,proc$14828.parts];}});(checkall$12945=["send","data","multi","assign","void","check","do"]);(same_block$12946=function($14901$14903,ban1$14904,ban2$14905){var $index$15045;var $length$15040;var temp$15035;var other$15066;var type1$15012;var args1$15013;var type2$15014;var args2$15015;var m1$14997;var m2$14998;var v1$14982;var v2$14983;var s1$14967;var s2$14968;var v1$14940;var v2$14941;var $14908$14931;var $14909$14932;var $14910$14933;var $14911$14934;var $14912$14935;var $14913$14936;var $14914$14937;var t0$14925;var t1$14926;var t2$14927;var t3$14928;var t4$14929;var $14907$14920;var ph$14915;(ph$14915=$14901$14903);($14907$14920=ph$14915);if((($14908$14931=($14907$14920 instanceof Array))&&(((t0$14925=$14907$14920.length)),(($14910$14933=(t0$14925===2))&&(((t1$14926=$14907$14920[0])),(($14912$14935=(t1$14926 instanceof Array))&&(((t2$14927=t1$14926.length)),(($14914$14937=(t2$14927===2))&&((t1$14926[0]==="variable")&&((v1$14940=t1$14926[1]),(((t3$14928=$14907$14920[1])),((t3$14928 instanceof Array)&&(((t4$14929=t3$14928.length)),((t4$14929===2)&&(t3$14928[0]==="variable"))))))))))))))){(v2$14941=t3$14928[1]);return (v1$14940===v2$14941);}else{if(($14914$14937&&((t1$14926[0]==="symbol")&&((s1$14967=t1$14926[1]),(((t3$14928=$14907$14920[1])),((t3$14928 instanceof Array)&&(((t4$14929=t3$14928.length)),((t4$14929===2)&&(t3$14928[0]==="symbol"))))))))){(s2$14968=t3$14928[1]);return (((!$12871(ban1$14904,s1$14967))&&(!$12871(ban2$14905,s2$14968)))&&(s1$14967===s2$14968));}else{if(($14914$14937&&((t1$14926[0]==="value")&&((v1$14982=t1$14926[1]),(((t3$14928=$14907$14920[1])),((t3$14928 instanceof Array)&&(((t4$14929=t3$14928.length)),((t4$14929===2)&&(t3$14928[0]==="value"))))))))){(v2$14983=t3$14928[1]);return (v1$14982===v2$14983);}else{if(($14914$14937&&((t1$14926[0]==="macro")&&((m1$14997=t1$14926[1]),(((t3$14928=$14907$14920[1])),((t3$14928 instanceof Array)&&(((t4$14929=t3$14928.length)),((t4$14929===2)&&(t3$14928[0]==="macro"))))))))){(m2$14998=t3$14928[1]);return (m1$14997===m2$14998);}else{if(($14912$14935&&((t2$14927>=1)&&((type1$15012=t1$14926[0]),((args1$15013=Array.prototype.slice.call(t1$14926,1)),(((t3$14928=$14907$14920[1])),((t3$14928 instanceof Array)&&(((t4$14929=t3$14928.length)),((t4$14929>=1)&&((type2$15014=t3$14928[0]),((args2$15015=Array.prototype.slice.call(t3$14928,1)),(checkall$12945.indexOf(type1$15012)!==-1)))))))))))){if(((type1$15012===type2$15014)&&(args1$15013.length===args2$15015.length))){(temp$15035=$16543(args1$15013,args2$15015));($length$15040=temp$15035.length);($index$15045=0);$15031:for(;($index$15045<$length$15040);($index$15045++)){var pair$15061;var m$15053;(m$15053=temp$15035[$index$15045]);(pair$15061=m$15053);if((!same_block$12946(pair$15061,ban1$14904,ban2$14905))){return false;}}return true;}else{return false;}}else{(other$15066=$14907$14920);return false;}}}}}});(parse_clauses$12947=function(scope$15072,target$15073,stmts$15074,opt$15075){var $index$15105;var $length$15100;var temp$15095;var acc$15090;var $index$15314;var $length$15309;var temp$15304;var acc$15299;var $index$15368;var $length$15363;var temp$15358;var acc$15353;var decls$15347;var all_temps$15078;var the_parts$15079;var unique_temps$15080;(all_temps$15078=[]);(the_parts$15079=(((acc$15090=[])),(((temp$15095=scope$15072.step_all(["clause"],stmts$15074))),((($length$15100=temp$15095.length)),((($index$15105=0)),function(){$15086:for(;($index$15105<$length$15100);($index$15105++)){var accum$15198;var accum$15213;var t0$15192;var t1$15193;var $index$15236;var $length$15231;var temp$15226;var bod$15272;var placeholder$15137;var special_fn$15138;var vars$15139;var temps$15140;var blocks$15141;var vars2$15142;var x$15281;var other$15289;var b$15278;var pattern$15124;var body$15125;var $15088$15121;var t0$15118;var t1$15119;var m$15113;(m$15113=temp$15095[$index$15105]);(t0$15118=m$15113);if(((t0$15118 instanceof Array)&&(((t1$15119=t0$15118.length)),((t1$15119===3)&&(t0$15118[0]==="clause"))))){(pattern$15124=t0$15118[1]);(body$15125=t0$15118[2]);acc$15090.push((((placeholder$15137=(void 0))),((special_fn$15138=function($15150$15152,value$15153){var t0$15159;var t1$15160;var other$15188;var $15155$15172;var ph$15156;var expr$15157;(t0$15159=$15150$15152);if(((t0$15159 instanceof Array)&&(((t1$15160=t0$15159.length)),((t1$15160===2)&&(t0$15159[0]==="special"))))){(ph$15156=t0$15159[1]);(expr$15157=t0$15159);}else{$16358($15150$15152);}($15155$15172=ph$15156);if(($15155$15172==="match")){(placeholder$15137=__lt____lt____colon__$12929(["symbol",scope$15072.gensym("ph")],expr$15157));return ["assign",placeholder$15137];}else{(other$15188=$15155$15172);throw $16140(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$15157}));}})),(((t0$15192=parse_pattern$12944(scope$15072,pattern$15124,target$15073,$16374(opt$15075,$12872(({"allow_arguments":false,"allow_nested":true,"special":special_fn$15138}),$12872(((accum$15198=({})),((accum$15198["assign"]=function(v$15202,value$15203){return ["do",__lt____lt____colon__$12929(["assign",v$15202,value$15203],v$15202)];}),accum$15198)),({"finalize":false}))))))),function(){if(((t0$15192 instanceof Array)&&(((t1$15193=t0$15192.length)),(t1$15193===3)))){(vars$15139=t0$15192[0]);(temps$15140=t0$15192[1]);(blocks$15141=t0$15192[2]);}else{return $16358(parse_pattern$12944(scope$15072,pattern$15124,target$15073,$16374(opt$15075,$12872(({"allow_arguments":false,"allow_nested":true,"special":special_fn$15138}),$12872(((accum$15213=({})),((accum$15213["assign"]=function(v$15217,value$15218){return ["do",__lt____lt____colon__$12929(["assign",v$15217,value$15218],v$15217)];}),accum$15213)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",13964,14311);}}()),(all_temps$15078=all_temps$15078.concat(temps$15140)),function(){if(placeholder$15137){return vars$15139.push(placeholder$15137);}}(),((vars2$15142=({}))),(((temp$15226=vars$15139)),((($length$15231=temp$15226.length)),((($index$15236=0)),function(){$15143:for(;($index$15236<$length$15231);($index$15236++)){var other$15269;var xxx$15254;var t0$15249;var t1$15250;var m$15244;(m$15244=temp$15226[$index$15236]);(t0$15249=m$15244);if(((t0$15249 instanceof Array)&&(((t1$15250=t0$15249.length)),((t1$15250===2)&&(t0$15249[0]==="symbol"))))){(xxx$15254=t0$15249[1]);(vars2$15142[xxx$15254]=true);}else{(other$15269=m$15244);throw $16140(["syntax","unexpected"]).create();}}}()))),(((bod$15272=function(){if(placeholder$15137){return parse_clauses$12947(scope$15072,placeholder$15137,$16506(["multi"])(body$15125)[1],opt$15075);}else{if(opt$15075.wrap){return opt$15075.wrap(body$15125);}else{return body$15125;}}}())),["clause",vars$15139,vars2$15142,blocks$15141,bod$15272])));}else{if((((x$15281=t0$15118)),((x$15281 instanceof Array)&&(x$15281[0]==="block")))){(b$15278=t0$15118);acc$15090.push(b$15278);}else{(other$15289=m$15113);acc$15090.push(function(){throw $16140(["syntax","clause"]).create("Illegal clause",({"clause":other$15289}));}());}}}}()))),acc$15090));if(opt$15075.fallback){the_parts$15079.push(["block",opt$15075.fallback(target$15073)]);}(unique_temps$15080=$16505(util$12930.mkset((((acc$15299=[])),(((temp$15304=all_temps$15078)),((($length$15309=temp$15304.length)),((($index$15314=0)),function(){$15296:for(;($index$15314<$length$15309);($index$15314++)){var t$15332;var t0$15327;var t1$15328;var m$15322;(m$15322=temp$15304[$index$15314]);(t0$15327=m$15322);if(((t0$15327 instanceof Array)&&(((t1$15328=t0$15327.length)),((t1$15328===2)&&(t0$15327[0]==="symbol"))))){(t$15332=t0$15327[1]);acc$15299.push(t$15332);}else{$16358(m$15322,"/home/olivier/git/earl-grey/src/pattern.eg",15120,15150);}}}()))),acc$15299))));(decls$15347=(((acc$15353=[])),(((temp$15358=unique_temps$15080)),((($length$15363=temp$15358.length)),((($index$15368=0)),function(){$15350:for(;($index$15368<$length$15363);($index$15368++)){var t$15384;var m$15376;(m$15376=temp$15358[$index$15368]);(t$15384=m$15376);acc$15353.push(["declare",["symbol",t$15384]]);}}()))),acc$15353));return ["multi"].concat(decls$15347).concat([weave_clauses$12949(the_parts$15079)]);});(opt_clauses$12948=function(clauses$15392){var $index$15421;var $length$15416;var temp$15411;var acc$15406;var $index$15578;var $length$15573;var temp$15568;var acc$15563;var $index$15630;var $length$15625;var temp$15620;var acc$15615;var $index$15675;var $length$15670;var temp$15665;var acc$15660;var shares$15395;var max$15396;var temps$15397;var shared_last$15398;var idx_last$15399;var new_clauses$15400;(shares$15395=(((acc$15406=[])),(((temp$15411=$16336(clauses$15392.slice(1)))),((($length$15416=temp$15411.length)),((($index$15421=0)),function(){$15403:for(;($index$15421<$length$15416);($index$15421++)){var t0$15473;var t1$15474;var $index$15503;var $length$15498;var temp$15493;var varsd0$15466;var blocks0$15467;var share$15468;var idx$15469;var i$15441;var vars$15442;var varsd$15443;var blocks$15444;var body$15445;var t0$15434;var t1$15435;var t2$15436;var t3$15437;var m$15429;(m$15429=temp$15411[$index$15421]);(t0$15434=m$15429);if(((t0$15434 instanceof Array)&&(((t1$15435=t0$15434.length)),((t1$15435===2)&&((i$15441=t0$15434[0]),(((t2$15436=t0$15434[1])),((t2$15436 instanceof Array)&&(((t3$15437=t2$15436.length)),((t3$15437===5)&&(t2$15436[0]==="clause")))))))))){(vars$15442=t2$15436[1]);(varsd$15443=t2$15436[2]);(blocks$15444=t2$15436[3]);(body$15445=t2$15436[4]);acc$15406.push(((((t0$15473=$12871(clauses$15392,i$15441))),function(){if(((t0$15473 instanceof Array)&&(((t1$15474=t0$15473.length)),((t1$15474===5)&&(t0$15473[0]==="clause"))))){t0$15473[1];(varsd0$15466=t0$15473[2]);(blocks0$15467=t0$15473[3]);t0$15473[4];}else{return $16358($12871(clauses$15392,i$15441),"/home/olivier/git/earl-grey/src/pattern.eg",15423,15443);}}()),((share$15468=0)),((idx$15469=0)),(((temp$15493=blocks$15444)),((($length$15498=temp$15493.length)),((($index$15503=0)),function(){$15470:for(;($index$15503<$length$15498);($index$15503++)){var x$15534;var x$15543;var other$15553;var $15522$15524;var b$15519;var m$15511;(m$15511=temp$15493[$index$15503]);(b$15519=m$15511);if(same_block$12946([$12871(blocks0$15467,share$15468),b$15519],varsd0$15466,varsd$15443)){(share$15468++);($15522$15524=b$15519);if((((x$15534=$15522$15524)),((x$15534 instanceof Array)&&(x$15534[0]==="do")))){null;}else{if((((x$15543=$15522$15524)),((x$15543 instanceof Array)&&(x$15543[0]==="check")))){(idx$15469=share$15468);}else{(other$15553=$15522$15524);__lt____gt__$12927(null,other$15553);}}}else{break $15470;}}}()))),[share$15468,idx$15469]));}else{$16358(m$15429,"/home/olivier/git/earl-grey/src/pattern.eg",15299,15827);}}}()))),acc$15406));(max$15396=$12871(Math.max,(((acc$15563=[])),(((temp$15568=shares$15395)),((($length$15573=temp$15568.length)),((($index$15578=0)),function(){$15560:for(;($index$15578<$length$15573);($index$15578++)){var x$15596;var t0$15591;var t1$15592;var m$15586;(m$15586=temp$15568[$index$15578]);(t0$15591=m$15586);if(((t0$15591 instanceof Array)&&(((t1$15592=t0$15591.length)),(t1$15592===2)))){(x$15596=t0$15591[0]);t0$15591[1];acc$15563.push(x$15596);}else{$16358(m$15586,"/home/olivier/git/earl-grey/src/pattern.eg",15841,15870);}}}()))),acc$15563)));shares$15395.push([0,0]);(temps$15397=(((acc$15615=[])),(((temp$15620=$16598(1,max$15396))),((($length$15625=temp$15620.length)),((($index$15630=0)),function(){$15612:for(;($index$15630<$length$15625);($index$15630++)){var m$15638;(m$15638=temp$15620[$index$15630]);m$15638;acc$15615.push(["symbol",gensym$12932()]);}}()))),acc$15615));(shared_last$15398=0);(idx_last$15399=0);(new_clauses$15400=(((acc$15660=[])),(((temp$15665=$16336(clauses$15392))),((($length$15670=temp$15665.length)),((($index$15675=0)),function(){$15657:for(;($index$15675<$length$15670);($index$15675++)){var t0$15726;var t1$15727;var $index$15768;var $length$15763;var temp$15758;var acc$15753;var rest$15843;var newblocks$15839;var share$15720;var idx$15721;var shared$15722;var n_to_share$15723;var to_share$15724;var other$15850;var i$15695;var vars$15696;var varsd$15697;var blocks$15698;var body$15699;var t0$15688;var t1$15689;var t2$15690;var t3$15691;var m$15683;(m$15683=temp$15665[$index$15675]);(t0$15688=m$15683);if(((t0$15688 instanceof Array)&&(((t1$15689=t0$15688.length)),((t1$15689===2)&&((i$15695=t0$15688[0]),(((t2$15690=t0$15688[1])),((t2$15690 instanceof Array)&&(((t3$15691=t2$15690.length)),((t3$15691===5)&&(t2$15690[0]==="clause")))))))))){(vars$15696=t2$15690[1]);(varsd$15697=t2$15690[2]);(blocks$15698=t2$15690[3]);(body$15699=t2$15690[4]);acc$15660.push(((((t0$15726=$12871(shares$15395,i$15695))),function(){if(((t0$15726 instanceof Array)&&(((t1$15727=t0$15726.length)),(t1$15727===2)))){(share$15720=t0$15726[0]);(idx$15721=t0$15726[1]);}else{return $16358($12871(shares$15395,i$15695),"/home/olivier/git/earl-grey/src/pattern.eg",16099,16118);}}()),((shared$15722=function(){if(idx_last$15399){return [["check",$12871(temps$15397,(idx_last$15399-1))]];}else{return [];}}())),((n_to_share$15723=Math.max(shared_last$15398,share$15720))),((to_share$15724=(((acc$15753=[])),(((temp$15758=$16336(blocks$15698.slice(shared_last$15398,n_to_share$15723)))),((($length$15763=temp$15758.length)),((($index$15768=0)),function(){$15746:for(;($index$15768<$length$15763);($index$15768++)){var j$15815;var x$15816;var j$15792;var x$15793;var $15748$15786;var $15749$15787;var $15750$15788;var $15751$15789;var t0$15781;var t1$15782;var t2$15783;var t3$15784;var m$15776;(m$15776=temp$15758[$index$15768]);(t0$15781=m$15776);if((($15749$15787=(t0$15781 instanceof Array))&&(((t1$15782=t0$15781.length)),(($15751$15789=(t1$15782===2))&&((j$15792=t0$15781[0]),(((t2$15783=t0$15781[1])),((t2$15783 instanceof Array)&&(((t3$15784=t2$15783.length)),((t3$15784===2)&&(t2$15783[0]==="check")))))))))){(x$15793=t2$15783[1]);acc$15753.push(["check",["assign",$12871(temps$15397,(shared_last$15398+j$15792)),x$15793]]);}else{if(($15751$15789&&((j$15815=t0$15781[0]),(((t2$15783=t0$15781[1])),((t2$15783 instanceof Array)&&(((t3$15784=t2$15783.length)),((t3$15784===2)&&(t2$15783[0]==="do")))))))){(x$15816=t2$15783[1]);acc$15753.push(["do",x$15816]);}else{$16358(m$15776,"/home/olivier/git/earl-grey/src/pattern.eg",16247,16418);}}}}()))),acc$15753))),((shared_last$15398=share$15720)),((idx_last$15399=idx$15721)),(((newblocks$15839=(((rest$15843=blocks$15698.slice(n_to_share$15723))),shared$15722.concat(to_share$15724).concat(rest$15843)))),["clause",vars$15696,varsd$15697,newblocks$15839,body$15699])));}else{(other$15850=m$15683);acc$15660.push(function(){throw $16140(["oops"]).create("what",({"value":other$15850}));}());}}}()))),acc$15660));return [temps$15397,new_clauses$15400];});(weave_clauses$12949=function(parts$15858){var $index$15910;var $length$15905;var temp$15900;var $index$16107;var $length$16102;var temp$16097;var acc$16092;var groups$15861;var reassemble$15862;var new_temps$15863;var helper$15864;(groups$15861=classify_contiguous$12935(parts$15858,function($15873$15875){var t0$15879;var t1$15880;var cls$15877;(t0$15879=$15873$15875);if(((t0$15879 instanceof Array)&&(((t1$15880=t0$15879.length)),(t1$15880>=1)))){(cls$15877=t0$15879[0]);Array.prototype.slice.call(t0$15879,1);}else{$16358($15873$15875);}return cls$15877;}));(reassemble$15862=[]);(new_temps$15863=[]);(temp$15900=groups$15861);($length$15905=temp$15900.length);($index$15910=0);$15865:for(;($index$15910<$length$15905);($index$15910++)){var t0$15946;var t1$15947;var ts$15943;var new_clauses$15944;var elems$15960;var elems$15932;var $15867$15926;var $15868$15927;var $15869$15928;var $15870$15929;var t0$15923;var t1$15924;var m$15918;(m$15918=temp$15900[$index$15910]);(t0$15923=m$15918);if((($15868$15927=(t0$15923 instanceof Array))&&(((t1$15924=t0$15923.length)),(($15870$15929=(t1$15924>=1))&&(t0$15923[0]==="clause"))))){(elems$15932=Array.prototype.slice.call(t0$15923,1));(t0$15946=opt_clauses$12948(elems$15932));if(((t0$15946 instanceof Array)&&(((t1$15947=t0$15946.length)),(t1$15947===2)))){(ts$15943=t0$15946[0]);(new_clauses$15944=t0$15946[1]);}else{$16358(opt_clauses$12948(elems$15932),"/home/olivier/git/earl-grey/src/pattern.eg",16919,16947);}(new_temps$15863=new_temps$15863.concat(ts$15943));(reassemble$15862=reassemble$15862.concat(new_clauses$15944));}else{if(($15870$15929&&(t0$15923[0]==="block"))){(elems$15960=Array.prototype.slice.call(t0$15923,1));(reassemble$15862=reassemble$15862.concat(elems$15960));}else{$16358(m$15918,"/home/olivier/git/earl-grey/src/pattern.eg",16853,17058);}}}(helper$15864=function($15967$15969){var $index$16066;var $length$16061;var temp$16056;var acc$16051;var decls$16045;var vars$16037;var varsd$16038;var blocks$16039;var body$16040;var rest$16041;var body$16011;var rest$16012;var $15972$15995;var $15973$15996;var $15974$15997;var $15975$15998;var $15976$15999;var $15977$16000;var t0$15988;var t1$15989;var t2$15990;var t3$15991;var t4$15992;var t5$15993;var $15971$15983;var ph$15978;(ph$15978=$15967$15969);($15971$15983=ph$15978);if((($15972$15995=($15971$15983 instanceof Array))&&(((t0$15988=$15971$15983.length)),(t0$15988===0)))){return ["multi"];}else{if(($15972$15995&&(($15974$15997=(t0$15988>=1))&&(((t1$15989=$15971$15983[0])),(($15976$15999=(t1$15989 instanceof Array))&&(((t2$15990=t1$15989.length)),((t2$15990===2)&&((t1$15989[0]==="block")&&(((t3$15991=$16506(["multi"])(t1$15989[1]))),(t3$15991[0]&&(((t4$15992=t3$15991[1])),(((t5$15993=t4$15992.length)),(t5$15993>=0))))))))))))){(body$16011=Array.prototype.slice.call(t4$15992,0));(rest$16012=Array.prototype.slice.call($15971$15983,1));return ["multi"].concat(body$16011).concat([helper$15864(rest$16012)]);}else{if(($15976$15999&&((t2$15990===5)&&(t1$15989[0]==="clause")))){(vars$16037=t1$15989[1]);(varsd$16038=t1$15989[2]);(blocks$16039=t1$15989[3]);(body$16040=t1$15989[4]);(rest$16041=Array.prototype.slice.call($15971$15983,1));(decls$16045=(((acc$16051=[])),(((temp$16056=vars$16037)),((($length$16061=temp$16056.length)),((($index$16066=0)),function(){$16048:for(;($index$16066<$length$16061);($index$16066++)){var v$16082;var m$16074;(m$16074=temp$16056[$index$16066]);(v$16082=m$16074);acc$16051.push(["declare",v$16082]);}}()))),acc$16051));return ["tagscope","back",["multi"].concat(decls$16045).concat([assemble_pattern$12942(blocks$16039,body$16040,["use","back",helper$15864(rest$16041)])])];}else{$16358($15971$15983);}}}});return ["multi"].concat((((acc$16092=[])),(((temp$16097=new_temps$15863)),((($length$16102=temp$16097.length)),((($index$16107=0)),function(){$16089:for(;($index$16107<$length$16102);($index$16107++)){var t$16123;var m$16115;(m$16115=temp$16097[$index$16107]);(t$16123=m$16115);acc$16092.push(["declare",t$16123]);}}()))),acc$16092)).concat([helper$15864(reassemble$15862)]);});(exports["PatternParser"]=PatternParser$12939);(exports["PatternProcessor"]=PatternProcessor$12940);(exports["parse_clauses"]=parse_clauses$12947);(exports["parse_pattern"]=parse_pattern$12944);
