var $10422=function(type$10424){var f$10427;(f$10427=type$10424["::check"]);;if((f$10427===(void 0))){return function(value$10432){return (value$10432 instanceof type$10424);};}else{return function(value$10435){return f$10427.call(type$10424,value$10435);};}};
var $10437=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $10438=function(dest$10440,values$10441){var k$10446;(k$10446=null);$10444:for(k$10446 in values$10441){if(values$10441.hasOwnProperty(k$10446)){(dest$10440[k$10446]=values$10441[k$10446]);}}return dest$10440;};
var $10450=function($10451$10453){var ph$10457;(ph$10457=$10451$10453);;var $10455$10462;($10455$10462=ph$10457);;var bridge$10456$10467;var x$10471;(bridge$10456$10467=$10455$10462);if((((typeof(bridge$10456$10467)==="string")&&((x$10471=bridge$10456$10467),true))||((typeof(bridge$10456$10467)==="number")&&((x$10471=bridge$10456$10467),true)))){return ["value",x$10471];}else{var other$10478;(other$10478=$10455$10462);return other$10478["::serialize_ast"]();}};
var send$10262;(send$10262=function(obj$10267,$10265$10268){var ph$10272;var msg$10273;var t0$10275;(t0$10275=$10265$10268);(msg$10273=t0$10275);(ph$10272=t0$10275);;var $10270$10279;($10270$10279=ph$10272);;var bridge$10271$10284;(bridge$10271$10284=$10270$10279);if(((typeof(bridge$10271$10284)==="string")||(typeof(bridge$10271$10284)==="number"))){return obj$10267[msg$10273];}else{var other$10292;(other$10292=$10270$10279);return obj$10267["::send"](msg$10273);}});;(Array[":::project"]=function($10295$10297){var ph$10300;var value$10301;var t0$10303;(t0$10303=$10295$10297);(value$10301=t0$10303);(ph$10300=t0$10303);;var $10299$10307;($10299$10307=ph$10300);;if($10422(Array)($10299$10307)){return [true,value$10301];}else{$10299$10307;return [true,[value$10301]];}});(Array.prototype["::check"]=function(value$10321){if((value$10321 instanceof Array)){var i$10326;(i$10326=0);;$10324:for(;(i$10326<this.length);(i$10326++)){if(($10437(this,i$10326)!==$10437(value$10321,i$10326))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $10438(this.slice(0),this);});(Array.prototype[":::project"]=function(value$10337){if((value$10337 instanceof Array)){var i$10342;(i$10342=0);;$10340:for(;(i$10342<this.length);(i$10342++)){if(($10437(this,i$10342)!==$10437(value$10337,i$10342))){return [true,[value$10337]];}}return [true,value$10337.slice(this.length)];}else{return [true,[value$10337]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($10450));});(RegExp.prototype["::check"]=function($10352$10354){var ph$10357;(ph$10357=$10352$10354);;var $10356$10362;($10356$10362=ph$10357);;var value$10370;if((typeof($10356$10362)==="string")){(value$10370=$10356$10362);if(value$10370.match(this)){return true;}else{return false;}}else{var other$10375;(other$10375=$10356$10362);return false;}});(RegExp.prototype[":::project"]=function($10377$10379){var ph$10382;(ph$10382=$10377$10379);;var $10381$10387;($10381$10387=ph$10382);;var value$10395;if((typeof($10381$10387)==="string")){(value$10395=$10381$10387);var $10398$10400;($10398$10400=value$10395.match(this));;var m$10408;if(($10398$10400===null)){(m$10408=$10398$10400);return [false,null];}else{var m$10413;(m$10413=$10398$10400);return [true,m$10413];}}else{var other$10417;(other$10417=$10381$10387);return [false,null];}});(Function.prototype["::send"]=function(args$10420){return this.apply(this,args$10420);});
var $13426=function(arr$13428){var results$13432;var l$13433;(results$13432=[]);;(l$13433=arr$13428.length);;var i$13441;(i$13441=0);;$13431:for(;(i$13441<l$13433);(i$13441++)){results$13432.push([i$13441,$10437(arr$13428,i$13441)]);}return results$13432;};
var $13448=function(value$13450,url$13451,start$13452,end$13453){var err$13456;(err$13456=$13257(["match"]).create("Could not find a match for value",({"value":value$13450})));;if(url$13451){(err$13456["location"]=["location",url$13451,start$13452,end$13453]);}throw err$13456;};
var $13257=function(){var $13258$13260;($13258$13260=function(tags$13264){var it$0$13267;(it$0$13267=function(){if((!$10422($13258$13260)(this))){return Object.create($13258$13260.prototype);}else{return this;}}());;(it$0$13267["tags"]=tags$13264);return it$0$13267;});;($13258$13260.prototype["create"]=function(){var $13276$13278;($13276$13278=arguments);;var t0$13283;var message$13287;var args$13288;(t0$13283=$13276$13278.length);if((t0$13283>=0)){(message$13287=function(){if((0>=t0$13283)){return "";}else{return $13276$13278[0];}}());(args$13288=Array.prototype.slice.call($13276$13278,1));var it$0$13292;(it$0$13292=this);;var self$13297;(self$13297=this);;var e$13302;(e$13302=Error(message$13287));;(e$13302["::tags"]=it$0$13292.tags);(e$13302["args"]=args$13288);var temp$13310;(temp$13310=$13426(args$13288));;var $length$13315;($length$13315=temp$13310.length);;var $index$13320;($index$13320=0);;$13303:for(;($index$13320<$length$13315);($index$13320++)){var m$13328;(m$13328=temp$13310[$index$13320]);;var t0$13333;var t1$13334;var i$13338;var arg$13339;(t0$13333=m$13328);if(((t0$13333 instanceof Array)&&((t1$13334=t0$13333.length),(t1$13334===2)))){(i$13338=t0$13333[0]);(arg$13339=t0$13333[1]);(e$13302[i$13338]=arg$13339);}else{$13448(m$13328);;}}(e$13302["length"]=args$13288.length);(e$13302["name"]=["E"].concat(it$0$13292.tags).join("."));return e$13302;}else{$13448($13276$13278);}});($13258$13260.prototype["::check"]=function(e$13350){var it$0$13353;(it$0$13353=this);;var self$13358;(self$13358=this);;var tags$13363;if(((!e$13350)||(!$10422(Error)(e$13350)))){return false;}(tags$13363=(e$13350["::tags"]||[]));;var temp$13372;(temp$13372=it$0$13353.tags);;var $length$13377;($length$13377=temp$13372.length);;var $index$13382;($index$13382=0);;$13364:for(;($index$13382<$length$13377);($index$13382++)){var m$13390;(m$13390=temp$13372[$index$13382]);;var tag$13398;(tag$13398=m$13390);if((tags$13363.indexOf(tag$13398)===-1)){return false;}else{false;;}}return true;});($13258$13260.prototype["::deconstruct"]=function(e$13406){var it$0$13409;(it$0$13409=this);;var self$13414;(self$13414=this);;return e$13406.args;});$10438($13258$13260,$10438(function(){var accum$13419;(accum$13419=({}));(accum$13419["::name"]="$13258");return accum$13419;}(),function(){var accum$13423;(accum$13423=({}));(accum$13423["::egclass"]=true);return accum$13423;}()));return $13258$13260;}();
var $13533=function($13534$13536,key$13537){var ph$13541;(ph$13541=$13534$13536);;var $13539$13546;($13539$13546=ph$13541);;var bridge$13540$13551;(bridge$13540$13551=$13539$13546);if(((bridge$13540$13551===null)||(bridge$13540$13551===(void 0)))){return false;}else{var x$13559;if((typeof($13539$13546)==="string")){(x$13559=$13539$13546);return (key$13537 in String.prototype);}else{var x$13564;if((typeof($13539$13546)==="number")){(x$13564=$13539$13546);return (key$13537 in Number.prototype);}else{var x$13569;(x$13569=$13539$13546);return (key$13537 in x$13569);}}}};
var $13477=function($13478$13480){var ph$13486;var x$13487;var t0$13489;(t0$13489=$13478$13480);(x$13487=t0$13489);(ph$13486=t0$13489);;var $13482$13493;($13482$13493=ph$13486);;var bridge$13483$13498;(bridge$13483$13498=$13482$13493);if((function(){var bridge$13484$13504;(bridge$13484$13504=bridge$13483$13498);return (function(){var bridge$13485$13507;(bridge$13485$13507=bridge$13484$13504);return ((bridge$13485$13507===(void 0))||(bridge$13485$13507===null));}()||(typeof(bridge$13484$13504)==="string"));}()||(typeof(bridge$13483$13498)==="number"))){return x$13487;}else{if($13533($13482$13493,"::clone")){$13482$13493["::clone"];return x$13487["::clone"]();}else{$13482$13493;if((Object.getPrototypeOf(x$13487)===Object.prototype)){var dest$13520;(dest$13520=({}));;var k$13525;(k$13525=null);$13519:for(k$13525 in x$13487){if(Object.prototype.hasOwnProperty.call(x$13487,k$13525)){(dest$13520[k$13525]=x$13487[k$13525]);}}return dest$13520;}else{var other$13531;(other$13531=$13482$13493);throw $13257(["clone"]).create("Object cannot be cloned",({"obj":x$13487}));}}}};
var $13461=function(a$13463,b$13464){var dest$13468;(dest$13468=$13477(a$13463));;var k$13473;(k$13473=null);$13467:for(k$13473 in b$13464){if(Object.prototype.hasOwnProperty.call(b$13464,k$13473)){(dest$13468[k$13473]=b$13464[k$13473]);}}return dest$13468;};
var $13571=Object.keys;
var $13572=function(type$13574){return function(value$13577){var f$13580;(f$13580=type$13574[":::project"]);;if((f$13580===(void 0))){(f$13580=type$13574["::project"]);if((f$13580===(void 0))){return [true,type$13574(value$13577)];}else{var rval$13586;(rval$13586=false);;try{(rval$13586=[true,f$13580(value$13577)]);}catch(excv$13592){var e$13598;(e$13598=excv$13592);(rval$13586=[false,null]);}return rval$13586;}}else{return f$13580.call(type$13574,value$13577);}};};
var $13600=function(xs$13602,ys$13603){var acc$13608;(acc$13608=[]);;var temp$13613;(temp$13613=$13426(xs$13602));;var $length$13618;($length$13618=temp$13613.length);;var $index$13623;($index$13623=0);;$13605:for(;($index$13623<$length$13618);($index$13623++)){var m$13631;(m$13631=temp$13613[$index$13623]);;var t0$13636;var t1$13637;var i$13641;var x$13642;(t0$13636=m$13631);if(((t0$13636 instanceof Array)&&((t1$13637=t0$13636.length),(t1$13637===2)))){(i$13641=t0$13636[0]);(x$13642=t0$13636[1]);acc$13608.push([x$13642,$10437(ys$13603,i$13641)]);}else{$13448(m$13631);;}}return acc$13608;};
var $13648=function(from$13650,to$13651){var rval$13655;(rval$13655=[]);;var i$13660;(i$13660=from$13650);;$13654:for(;(i$13660<=to$13651);(i$13660++)){rval$13655.push(i$13660);}return rval$13655;};var accum$11195;var accum$11199;var accum$11801;var accum$11805;var $10482$10486;var __lt____gt__$10487;var $10483$10488;var __lt____lt____colon__$10489;var util$10490;var GenSym$10491;var gensym$10492;var neighbours$10493;var classify$10494;var classify_contiguous$10495;var identity$10496;var $10485$10497;var checker_db$10498;var PatternParser$10499;var PatternProcessor$10500;var assemble_conditions$10501;var assemble_pattern$10502;var inject_below_uses$10503;var parse_pattern$10504;var checkall$10505;var same_block$10506;var parse_clauses$10507;var opt_clauses$10508;var weave_clauses$10509;($10482$10486=require("./pp"));;(__lt____gt__$10487=$10482$10486["<>"]);;($10483$10488=require("./location"));;(__lt____lt____colon__$10489=$10483$10488["<<:"]);;(util$10490=require("./util"));;(GenSym$10491=util$10490.GenSym);;(gensym$10492=util$10490.gensym);;(neighbours$10493=util$10490.neighbours);;(classify$10494=util$10490.classify);;(classify_contiguous$10495=util$10490.classify_contiguous);;(identity$10496=util$10490.identity);;($10485$10497=require("./expand"));;(checker_db$10498=$10485$10497.checker_db);;(PatternParser$10499=function(scope$10552,pattern$10553,opt$10554){var it$0$10557;(it$0$10557=function(){if((!$10422(PatternParser$10499)(this))){return Object.create(PatternParser$10499.prototype);}else{return this;}}());;(it$0$10557["opt"]=opt$10554);(it$0$10557["arguments"]=[]);(it$0$10557["vars"]=[]);(it$0$10557["specials"]=({}));(it$0$10557["pattern"]=it$0$10557.expand(scope$10552,pattern$10553,(opt$10554.tags||({})),true,it$0$10557.opt.indexable));return it$0$10557;});;(PatternParser$10499.prototype["parse_specs"]=function(scope$10567,specs$10568,tags$10569){var $index$10615;var $length$10610;var temp$10605;var acc$10600;var rest$10582;var has_defaults$10583;var rval$10584;var self$10577;var it$0$10572;(it$0$10572=this);;(self$10577=this);;(rest$10582=(void 0));;(has_defaults$10583=false);;(rval$10584=classify$10494("fw","bw","keys","defaults",(((acc$10600=[])),(((temp$10605=scope$10567.step_all(["pattern"],specs$10568))),((($length$10610=temp$10605.length)),((($index$10615=0)),function(){$10593:for(;($index$10615<$length$10610);($index$10615++)){var v$10667;var v$10662;var variable$10655;var value$10656;var key$10649;var subp$10650;var key$10644;var variable$10637;var $10595$10631;var $10596$10632;var $10597$10633;var $10598$10634;var t0$10628;var t1$10629;var m$10623;(m$10623=temp$10605[$index$10615]);;(t0$10628=m$10623);if((($10596$10632=(t0$10628 instanceof Array))&&((t1$10629=t0$10628.length),(($10598$10634=(t1$10629===2))&&(t0$10628[0]==="dynsplice"))))){(variable$10637=t0$10628[1]);acc$10600.push(((rest$10582=it$0$10572.expand(scope$10567,variable$10637,tags$10569)),["ignore"]));}else{if(($10598$10634&&(t0$10628[0]==="assoc"))){(key$10644=t0$10628[1]);acc$10600.push(["keys",[key$10644,it$0$10572.expand(scope$10567,key$10644,tags$10569)]]);}else{if(($10596$10632&&(($10598$10634=(t1$10629===3))&&(t0$10628[0]==="assoc")))){(key$10649=t0$10628[1]);(subp$10650=t0$10628[2]);acc$10600.push(["keys",[key$10649,it$0$10572.expand(scope$10567,subp$10650,tags$10569)]]);}else{if(($10598$10634&&(t0$10628[0]==="default"))){(variable$10655=t0$10628[1]);(value$10656=t0$10628[2]);acc$10600.push(((has_defaults$10583=true),function(){if(rest$10582){throw $13257(["syntax","pattern"]).create("No default arguments after rest arg.");}else{return ["defaults",[it$0$10572.expand(scope$10567,variable$10655,tags$10569),value$10656]];}}()));}else{(v$10662=m$10623);if(((rest$10582===(void 0))&&(!has_defaults$10583))){acc$10600.push(["fw",it$0$10572.expand(scope$10567,v$10662,tags$10569)]);}else{(v$10667=m$10623);acc$10600.push(["bw",it$0$10572.expand(scope$10567,v$10667,tags$10569)]);}}}}}}}()))),acc$10600)));;(rval$10584["rest"]=rest$10582);return rval$10584;});(PatternParser$10499.prototype["expand"]=function(){var x$10733;var x$10742;var x$10758;var x$10763;var variable$10769;var variable$10781;var x$10816;var msg$10823;var msg$10838;var $index$10871;var $length$10866;var temp$10861;var acc$10856;var $index$10975;var $length$10970;var temp$10965;var acc$10960;var $index$11006;var $length$11001;var temp$10996;var t0$11067;var t1$11068;var t2$11069;var $index$11097;var $length$11092;var temp$11087;var acc$11082;var patts$11076;var canon$10895;var normalize$10896;var pps$10897;var vars$10898;var patt$11156;var msg$11177;var other$11174;var keys$11162;var fw$11144;var bw$11145;var defaults$11146;var rest$11147;var $11123$11141;var t0$11134;var t1$11135;var t2$11136;var t3$11137;var t4$11138;var t5$11139;var $11122$11129;var specs$11124;var other$11189;var mode$11183;var subp$11184;var args$11118;var xs$10891;var xs$10850;var x$10844;var f$10829;var arg$10830;var f$10810;var arguments$10811;var checker$10804;var subp$10805;var projector$10798;var subp$10799;var condition$10792;var subp$10793;var v$10787;var v$10775;var type$10749;var $10711$10725;var $10712$10726;var $10713$10727;var $10714$10728;var t0$10721;var bridge$10710$10722;var t1$10723;var $10709$10716;var expr$10702;var rval$10703;var self$10697;var it$0$10692;var scope$10684;var pattern$10685;var tags$10686;var toplevel$10687;var checked$10688;var t0$10680;var $10673$10675;($10673$10675=arguments);;(t0$10680=$10673$10675.length);if(((t0$10680>=3)&&(t0$10680<=5))){(scope$10684=$10673$10675[0]);(pattern$10685=$10673$10675[1]);(tags$10686=$10673$10675[2]);(toplevel$10687=function(){if((3>=t0$10680)){return false;}else{return $10673$10675[3];}}());(checked$10688=function(){if((4>=t0$10680)){return false;}else{return $10673$10675[4];}}());(it$0$10692=this);;(self$10697=this);;(expr$10702=scope$10684.step(["pattern"],pattern$10685));;(rval$10703=((($10709$10716=expr$10702)),function(){if((((x$10733=$10709$10716)),((x$10733 instanceof Array)&&(x$10733[0]==="void")))){return ["check",checker_db$10498.null,["ignore"]];}else{if((((x$10742=$10709$10716)),((x$10742 instanceof Array)&&(x$10742[0]==="ignore")))){return expr$10702;}else{if((($10709$10716 instanceof Array)&&((t0$10721=$10709$10716.length),((t0$10721===2)&&($10709$10716[0]==="special"))))){(type$10749=$10709$10716[1]);(it$0$10692.specials[type$10749]=true);return expr$10702;}else{(bridge$10710$10722=$10709$10716);if(((((x$10758=bridge$10710$10722)),((x$10758 instanceof Array)&&(x$10758[0]==="symbol")))||(((x$10763=bridge$10710$10722)),((x$10763 instanceof Array)&&(x$10763[0]==="variable"))))){(variable$10769=$13461(expr$10702,tags$10686));;it$0$10692.vars.push(variable$10769);return ["assign",variable$10769];}else{if((($10711$10725=($10709$10716 instanceof Array))&&((t0$10721=$10709$10716.length),(($10713$10727=(t0$10721===2))&&(($10714$10728=($10709$10716[0]==="value"))&&((v$10775=$10709$10716[1]),it$0$10692.opt.strings_as_variables)))))){(variable$10781=__lt____lt____colon__$10489($13461(["symbol",v$10775],tags$10686),expr$10702));;it$0$10692.vars.push(variable$10781);return ["assign",variable$10781];}else{if($10714$10728){(v$10787=$10709$10716[1]);return ["check",checker_db$10498(v$10787),["ignore"]];}else{if(($10711$10725&&(($10713$10727=(t0$10721===3))&&($10709$10716[0]==="test")))){(condition$10792=$10709$10716[1]);(subp$10793=$10709$10716[2]);return ["test",condition$10792,it$0$10692.expand(scope$10684,subp$10793,tags$10686,toplevel$10687,false)];}else{if(($10713$10727&&($10709$10716[0]==="project"))){(projector$10798=$10709$10716[1]);(subp$10799=$10709$10716[2]);return ["project",projector$10798,it$0$10692.expand(scope$10684,subp$10799,tags$10686,toplevel$10687,true)];}else{if(($10713$10727&&($10709$10716[0]==="check"))){(checker$10804=$10709$10716[1]);(subp$10805=$10709$10716[2]);return ["check",checker$10804,it$0$10692.expand(scope$10684,subp$10805,tags$10686,toplevel$10687,true)];}else{if(($10713$10727&&(($10714$10728=($10709$10716[0]==="send"))&&((f$10810=$10709$10716[1]),((t1$10723=$10709$10716[2]),(((x$10816=t1$10723)),((x$10816 instanceof Array)&&(x$10816[0]==="data")))))))){(arguments$10811=t1$10723);if(toplevel$10687){it$0$10692.arguments.unshift(arguments$10811);return it$0$10692.expand(scope$10684,f$10810,tags$10686,true,false);}else{(msg$10823="Function arguments can only be declared as a top level pattern.");;throw $13257(["syntax","pattern"]).create(msg$10823,({"node":expr$10702,"arg":arguments$10811}));}}else{if($10714$10728){(f$10829=$10709$10716[1]);(arg$10830=$10709$10716[2]);return ["assign",expr$10702];}else{$10709$10716;if((!it$0$10692.opt.allow_nested)){(msg$10838="Nested patterns are not allowed here.");;throw $13257(["syntax","pattern"]).create(msg$10838,({"node":expr$10702}));}else{if((($10711$10725=($10709$10716 instanceof Array))&&((t0$10721=$10709$10716.length),((t0$10721===2)&&($10709$10716[0]==="neg"))))){(x$10844=$10709$10716[1]);return ["neg",it$0$10692.expand(scope$10684,x$10844,tags$10686)];}else{if(($10711$10725&&(($10713$10727=(t0$10721>=1))&&($10709$10716[0]==="all")))){(xs$10850=Array.prototype.slice.call($10709$10716,1));return ["all"].concat((((acc$10856=[])),(((temp$10861=xs$10850)),((($length$10866=temp$10861.length)),((($index$10871=0)),function(){$10853:for(;($index$10871<$length$10866);($index$10871++)){var x$10887;var m$10879;(m$10879=temp$10861[$index$10871]);;(x$10887=m$10879);acc$10856.push(it$0$10692.expand(scope$10684,x$10887,tags$10686));}}()))),acc$10856));}else{if(($10713$10727&&($10709$10716[0]==="any"))){(xs$10891=Array.prototype.slice.call($10709$10716,1));(canon$10895=function(all$10904){return all$10904.sort().join(",");});;(normalize$10896=function(vars$10910){var $index$10930;var $length$10925;var temp$10920;var acc$10915;return canon$10895((((acc$10915=[])),(((temp$10920=vars$10910)),((($length$10925=temp$10920.length)),((($index$10930=0)),function(){$10912:for(;($index$10930<$length$10925);($index$10930++)){var v$10948;var t0$10943;var t1$10944;var m$10938;(m$10938=temp$10920[$index$10930]);;(t0$10943=m$10938);if(((t0$10943 instanceof Array)&&((t1$10944=t0$10943.length),((t1$10944===2)&&(t0$10943[0]==="symbol"))))){(v$10948=t0$10943[1]);acc$10915.push(v$10948);}else{$13448(m$10938,"/home/olivier/git/earl-grey/src/pattern.eg",3853,3910);;}}}()))),acc$10915));});;(pps$10897=(((acc$10960=[])),(((temp$10965=xs$10891)),((($length$10970=temp$10965.length)),((($index$10975=0)),function(){$10957:for(;($index$10975<$length$10970);($index$10975++)){var x$10991;var m$10983;(m$10983=temp$10965[$index$10975]);;(x$10991=m$10983);acc$10960.push(PatternParser$10499(scope$10684,x$10991,$13461(it$0$10692.opt,({"tags":tags$10686}))));}}()))),acc$10960));;(temp$10996=neighbours$10493(pps$10897));;($length$11001=temp$10996.length);;($index$11006=0);;$10899:for(;($index$11006<$length$11001);($index$11006++)){var $index$11044;var $length$11039;var temp$11034;var pp1$11024;var pp2$11025;var t0$11019;var t1$11020;var m$11014;(m$11014=temp$10996[$index$11006]);;(t0$11019=m$11014);if(((t0$11019 instanceof Array)&&((t1$11020=t0$11019.length),(t1$11020===2)))){(pp1$11024=t0$11019[0]);(pp2$11025=t0$11019[1]);(temp$11034=pps$10897);;($length$11039=temp$11034.length);;($index$11044=0);;$11030:for(;($index$11044<$length$11039);($index$11044++)){var pp$11060;var m$11052;(m$11052=temp$11034[$index$11044]);;(pp$11060=m$11052);normalize$10896(pp$11060.vars);}if((normalize$10896(pp1$11024.vars)!==normalize$10896(pp2$11025.vars))){throw $13257(["syntax","pattern"]).create("Both branches of 'or' must contain the same variables",({"vars1":__lt____lt____colon__$10489(pp1$11024.vars.sort(),pp1$11024.pattern),"vars2":__lt____lt____colon__$10489(pp2$11025.vars.sort(),pp2$11025.pattern)}));}if((canon$10895($13571(pp1$11024.specials))!==canon$10895($13571(pp2$11025.specials)))){throw $13257(["syntax","pattern"]).create("Both branches of 'or' must contain the same special tokens",({"special1":__lt____lt____colon__$10489($13571(pp1$11024.specials).sort(),pp1$11024.pattern),"special2":__lt____lt____colon__$10489($13571(pp2$11025.specials).sort(),pp2$11025.pattern)}));}}else{$13448(m$11014,"/home/olivier/git/earl-grey/src/pattern.eg",4002,4799);;}}(t0$11067=pps$10897);if(((t0$11067 instanceof Array)&&((t1$11068=t0$11067.length),((t1$11068>=1)&&((t2$11069=t0$11067[0]),$13533(t2$11069,"vars")))))){(vars$10898=t2$11069.vars);Array.prototype.slice.call(t0$11067,1);;}else{$13448(pps$10897,"/home/olivier/git/earl-grey/src/pattern.eg",4816,4819);}(it$0$10692["vars"]=it$0$10692.vars.concat(vars$10898));(patts$11076=(((acc$11082=[])),(((temp$11087=pps$10897)),((($length$11092=temp$11087.length)),((($index$11097=0)),function(){$11079:for(;($index$11097<$length$11092);($index$11097++)){var pp$11113;var m$11105;(m$11105=temp$11087[$index$11097]);;(pp$11113=m$11105);acc$11082.push(pp$11113.pattern);}}()))),acc$11082));;return ["any"].concat(patts$11076);}else{if(($10713$10727&&($10709$10716[0]==="data"))){(args$11118=Array.prototype.slice.call($10709$10716,1));(specs$11124=it$0$10692.parse_specs(scope$10684,args$11118,tags$10686));;($11122$11129=specs$11124);;if((($11123$11141=$13533($11122$11129,"keys"))&&((t0$11134=$11122$11129.keys),((t0$11134 instanceof Array)&&((t1$11135=t0$11134.length),((t1$11135===0)&&($13533($11122$11129,"fw")&&((fw$11144=$11122$11129.fw),($13533($11122$11129,"bw")&&((bw$11145=$11122$11129.bw),($13533($11122$11129,"defaults")&&((defaults$11146=$11122$11129.defaults),$13533($11122$11129,"rest"))))))))))))){(rest$11147=$11122$11129.rest);(patt$11156=__lt____lt____colon__$10489(["array_pattern",fw$11144,bw$11145,defaults$11146,rest$11147],pattern$10685));;if(checked$10688){return patt$11156;}else{return ["check",checker_db$10498.Array,patt$11156];}}else{if(($11123$11141&&((keys$11162=$11122$11129.keys),($13533($11122$11129,"fw")&&((t0$11134=$11122$11129.fw),((t0$11134 instanceof Array)&&((t1$11135=t0$11134.length),((t1$11135===0)&&($13533($11122$11129,"bw")&&((t2$11136=$11122$11129.bw),((t2$11136 instanceof Array)&&((t3$11137=t2$11136.length),((t3$11137===0)&&($13533($11122$11129,"defaults")&&((t4$11138=$11122$11129.defaults),((t4$11138 instanceof Array)&&((t5$11139=t4$11138.length),((t5$11139===0)&&($13533($11122$11129,"rest")&&($11122$11129.rest===(void 0))))))))))))))))))))){return ["object_pattern"].concat(keys$11162);}else{(other$11174=$11122$11129);(msg$11177="Pattern must be an array or an object.");;throw $13257(["syntax","pattern"]).create(msg$11177,({"node":expr$10702,"specs":specs$11124}));}}}else{if(($10711$10725&&((t0$10721===3)&&($10709$10716[0]==="mode")))){(mode$11183=$10709$10716[1]);(subp$11184=$10709$10716[2]);return it$0$10692.expand(scope$10684,subp$11184,$13461(tags$10686,({"declare_mode":mode$11183})),toplevel$10687,checked$10688);}else{(other$11189=$10709$10716);throw $13257(["syntax","pattern"]).create("Illegal pattern",({"node":other$11189}));}}}}}}}}}}}}}}}}}}()));;return (it$0$10692.opt.wrap_pattern||identity$10496)(__lt____lt____colon__$10489(rval$10703,pattern$10685),toplevel$10687);}else{$13448($10673$10675);}});$10438(PatternParser$10499,$10438(((accum$11195=({})),((accum$11195["::name"]="PatternParser"),accum$11195)),((accum$11199=({})),((accum$11199["::egclass"]=true),accum$11199))));PatternParser$10499;(PatternProcessor$10500=function(){var it$0$11207;(it$0$11207=function(){if((!$10422(PatternProcessor$10500)(this))){return Object.create(PatternProcessor$10500.prototype);}else{return this;}}());;(it$0$11207["temps"]=[]);(it$0$11207["parts"]=[]);(it$0$11207["gen"]=GenSym$10491("t"));return it$0$11207;});;(PatternProcessor$10500.prototype["do"]=function(part$11217){var self$11225;var it$0$11220;(it$0$11220=this);;(self$11225=this);;return it$0$11220.parts.push(["do",part$11217]);});(PatternProcessor$10500.prototype["check"]=function(){var self$11253;var it$0$11248;var part$11243;var tags$11244;var t0$11239;var $11232$11234;($11232$11234=arguments);;(t0$11239=$11232$11234.length);if(((t0$11239>=1)&&(t0$11239<=2))){(part$11243=$11232$11234[0]);(tags$11244=function(){if((1>=t0$11239)){return ({});}else{return $11232$11234[1];}}());(it$0$11248=this);;(self$11253=this);;return it$0$11248.parts.push($13461(["check",part$11243],tags$11244));}else{$13448($11232$11234);}});(PatternProcessor$10500.prototype["temp"]=function(){var x$11301;var x$11306;var init$11313;var bridge$11284$11295;var $11283$11290;var self$11285;var it$0$11278;var x$11273;var v$11274;var t0$11269;var $11262$11264;($11262$11264=arguments);;(t0$11269=$11262$11264.length);if(((t0$11269>=1)&&(t0$11269<=2))){(x$11273=$11262$11264[0]);(v$11274=function(){if((1>=t0$11269)){return null;}else{return $11262$11264[1];}}());(it$0$11278=this);;(self$11285=this);;($11283$11290=x$11273);;(bridge$11284$11295=$11283$11290);if((((((x$11301=bridge$11284$11295)),((x$11301 instanceof Array)&&(x$11301[0]==="variable")))||(((x$11306=bridge$11284$11295)),((x$11306 instanceof Array)&&(x$11306[0]==="symbol"))))&&($13533($11283$11290,"single_assignment")&&($11283$11290.single_assignment&&(!v$11274))))){return x$11273;}else{(init$11313=$11283$11290);(v$11274=(v$11274||["symbol",it$0$11278.gen()]));(v$11274["single_assignment"]=true);it$0$11278.temps.push(v$11274);it$0$11278.do(["send",["symbol",":="],["data",v$11274,init$11313]]);return v$11274;}}else{$13448($11262$11264);}});(PatternProcessor$10500.prototype["process"]=function(pattern$11321,rhs$11322,fns$11323){var x$11360;var x$11389;var t$11401;var t$11412;var pp$11422;var $index$11450;var $length$11445;var temp$11440;var t$11432;var $index$11508;var $length$11503;var temp$11498;var acc$11493;var fn$11479;var parts$11480;var t$11474;var $index$11560;var $length$11555;var temp$11550;var acc$11545;var t$11538;var otherwise$11659;var $11641$11643;var $index$11673;var $length$11668;var temp$11663;var $index$11710;var $length$11705;var temp$11700;var end$11752;var pos$11747;var $index$11772;var $length$11767;var temp$11762;var acc$11757;var nfw$11599;var nbw$11600;var ndflt$11601;var extract_length$11602;var check_length$11603;var lo$11604;var hi$11605;var t$11606;var len$11607;var fw$11592;var bw$11593;var dflt$11594;var rest$11595;var subp$11534;var xs$11470;var xs$11428;var patt$11418;var projector$11407;var subp$11408;var checker$11396;var subp$11397;var checker$11385;var condition$11378;var subp$11379;var kind$11373;var sym$11367;var $11340$11352;var $11341$11353;var $11342$11354;var $11343$11355;var t0$11350;var $11339$11345;var rval$11336;var self$11331;var it$0$11326;(it$0$11326=this);;(self$11331=this);;(rval$11336=((($11339$11345=pattern$11321)),function(){if((((x$11360=$11339$11345)),((x$11360 instanceof Array)&&(x$11360[0]==="ignore")))){return it$0$11326.do(rhs$11322);}else{if((($11340$11352=($11339$11345 instanceof Array))&&((t0$11350=$11339$11345.length),(($11342$11354=(t0$11350===2))&&($11339$11345[0]==="assign"))))){(sym$11367=$11339$11345[1]);return it$0$11326.parts.push(fns$11323.assign(sym$11367,rhs$11322));}else{if(($11342$11354&&($11339$11345[0]==="special"))){(kind$11373=$11339$11345[1]);return it$0$11326.process(fns$11323.special(pattern$11321,rhs$11322),rhs$11322,fns$11323);}else{if(($11340$11352&&(($11342$11354=(t0$11350===3))&&($11339$11345[0]==="test")))){(condition$11378=$11339$11345[1]);(subp$11379=$11339$11345[2]);it$0$11326.process(subp$11379,rhs$11322,fns$11323);return it$0$11326.check(condition$11378,({"test":true}));}else{if(($11342$11354&&(($11343$11355=($11339$11345[0]==="check"))&&((checker$11385=$11339$11345[1]),(((x$11389=$11339$11345[2])),((x$11389 instanceof Array)&&(x$11389[0]==="ignore"))))))){return it$0$11326.check(["send",checker$11385,["data",rhs$11322]]);}else{if($11343$11355){(checker$11396=$11339$11345[1]);(subp$11397=$11339$11345[2]);(t$11401=it$0$11326.temp(rhs$11322));;it$0$11326.check(["send",checker$11396,["data",t$11401]]);return it$0$11326.process(subp$11397,t$11401,fns$11323);}else{if(($11342$11354&&($11339$11345[0]==="project"))){(projector$11407=$11339$11345[1]);(subp$11408=$11339$11345[2]);(t$11412=it$0$11326.temp(["send",projector$11407,["data",rhs$11322]]));;it$0$11326.check(["send",t$11412,["value",0]]);return it$0$11326.process(subp$11408,["send",t$11412,["value",1]],fns$11323);}else{if(($11340$11352&&((t0$11350===2)&&($11339$11345[0]==="neg")))){(patt$11418=$11339$11345[1]);return it$0$11326.check(["send",["symbol","not"],["data",["void"],(((pp$11422=PatternProcessor$10500())),pp$11422.process(patt$11418,rhs$11322,fns$11323),assemble_conditions$10501(pp$11422))]]);}else{if(($11340$11352&&(($11342$11354=(t0$11350>=1))&&($11339$11345[0]==="all")))){(xs$11428=Array.prototype.slice.call($11339$11345,1));(t$11432=it$0$11326.temp(rhs$11322));;(temp$11440=xs$11428);;($length$11445=temp$11440.length);;($index$11450=0);;$11433:for(;($index$11450<$length$11445);($index$11450++)){var x$11466;var m$11458;(m$11458=temp$11440[$index$11450]);;(x$11466=m$11458);it$0$11326.process(x$11466,t$11432,fns$11323);}return null;}else{if(($11342$11354&&($11339$11345[0]==="any"))){(xs$11470=Array.prototype.slice.call($11339$11345,1));(t$11474=it$0$11326.temp(rhs$11322,["symbol",gensym$10492("bridge")]));;return it$0$11326.check((((fn$11479=function(x$11484,rest$11485){return ["send",["symbol","or"],["data",x$11484,rest$11485]];})),((parts$11480=(((acc$11493=[])),(((temp$11498=xs$11470)),((($length$11503=temp$11498.length)),((($index$11508=0)),function(){$11490:for(;($index$11508<$length$11503);($index$11508++)){var pp$11527;var x$11524;var m$11516;(m$11516=temp$11498[$index$11508]);;(x$11524=m$11516);acc$11493.push((((pp$11527=PatternProcessor$10500())),pp$11527.process(x$11524,t$11474,fns$11323),assemble_conditions$10501(pp$11527)));}}()))),acc$11493))),util$10490.construct(parts$11480,fn$11479,["symbol","false"])));}else{if(($11342$11354&&($11339$11345[0]==="object_pattern"))){(subp$11534=Array.prototype.slice.call($11339$11345,1));(t$11538=it$0$11326.temp(rhs$11322));;(acc$11545=[]);;(temp$11550=subp$11534);;($length$11555=temp$11550.length);;($index$11560=0);;$11539:for(;($index$11560<$length$11555);($index$11560++)){var k$11580;var v$11581;var t0$11573;var t1$11574;var t2$11575;var t3$11576;var m$11568;(m$11568=temp$11550[$index$11560]);;(t0$11573=m$11568);if(((t0$11573 instanceof Array)&&((t1$11574=t0$11573.length),((t1$11574===2)&&((t2$11575=t0$11573[0]),((t2$11575 instanceof Array)&&((t3$11576=t2$11575.length),((t3$11576===2)&&(t2$11575[0]==="value"))))))))){(k$11580=t2$11575[1]);(v$11581=t0$11573[1]);acc$11545.push((it$0$11326.check(["send",["symbol","___hasprop"],["data",t$11538,["value",k$11580]]]),it$0$11326.process(v$11581,["send",t$11538,["value",k$11580]],fns$11323)));}else{$13448(m$11568,"/home/olivier/git/earl-grey/src/pattern.eg",8142,8274);;}}return acc$11545;}else{if(($11340$11352&&((t0$11350===5)&&($11339$11345[0]==="array_pattern")))){(fw$11592=$11339$11345[1]);(bw$11593=$11339$11345[2]);(dflt$11594=$11339$11345[3]);(rest$11595=$11339$11345[4]);(nfw$11599=fw$11592.length);;(nbw$11600=bw$11593.length);;(ndflt$11601=dflt$11594.length);;(extract_length$11602=true);;(check_length$11603=true);;(lo$11604=(nfw$11599+nbw$11600));;(hi$11605=(lo$11604+ndflt$11601));;(t$11606=it$0$11326.temp(rhs$11322));;(len$11607=it$0$11326.temp(["send",t$11606,["send",["symbol","."],["data",["void"],["symbol","length"]]]]));;it$0$11326.check(((($11641$11643=rest$11595)),function(){if($11641$11643){return ["send",["symbol",">="],["data",len$11607,["value",lo$11604]]];}else{$11641$11643;if((lo$11604===hi$11605)){return ["send",["symbol","==="],["data",len$11607,["value",lo$11604]]];}else{(otherwise$11659=$11641$11643);return ["send",["symbol","and"],["data",["send",["symbol",">="],["data",len$11607,["value",lo$11604]]],["send",["symbol","<="],["data",len$11607,["value",hi$11605]]]]];}}}()));(temp$11663=$13426(fw$11592));;($length$11668=temp$11663.length);;($index$11673=0);;$11608:for(;($index$11673<$length$11668);($index$11673++)){var i$11691;var m$11692;var t0$11686;var t1$11687;var m$11681;(m$11681=temp$11663[$index$11673]);;(t0$11686=m$11681);if(((t0$11686 instanceof Array)&&((t1$11687=t0$11686.length),(t1$11687===2)))){(i$11691=t0$11686[0]);(m$11692=t0$11686[1]);it$0$11326.process(m$11692,["send",t$11606,["value",i$11691]],fns$11323);}else{$13448(m$11681,"/home/olivier/git/earl-grey/src/pattern.eg",9006,9092);;}}(temp$11700=$13426(dflt$11594));;($length$11705=temp$11700.length);;($index$11710=0);;$11610:for(;($index$11710<$length$11705);($index$11710++)){var idx$11740;var i$11730;var patt$11731;var value$11732;var t0$11723;var t1$11724;var t2$11725;var t3$11726;var m$11718;(m$11718=temp$11700[$index$11710]);;(t0$11723=m$11718);if(((t0$11723 instanceof Array)&&((t1$11724=t0$11723.length),((t1$11724===2)&&((i$11730=t0$11723[0]),((t2$11725=t0$11723[1]),((t2$11725 instanceof Array)&&((t3$11726=t2$11725.length),(t3$11726===2))))))))){(patt$11731=t2$11725[0]);(value$11732=t2$11725[1]);(idx$11740=(i$11730+nfw$11599));;it$0$11326.process(patt$11731,["send",["symbol","if"],["data",["send",["symbol",">="],["data",["value",(idx$11740+nbw$11600)],len$11607]],value$11732,["send",t$11606,["value",idx$11740]]]],fns$11323);}else{$13448(m$11718,"/home/olivier/git/earl-grey/src/pattern.eg",9092,9261);;}}if((rest$11595!==(void 0))){(pos$11747=(nfw$11599+ndflt$11601));;(end$11752=function(){if((nbw$11600>0)){return [["value",(-nbw$11600)]];}else{return [];}}());;it$0$11326.process(rest$11595,["send",["send",["send",["send",["symbol","Array"],["send",["symbol","."],["data",["void"],["symbol","prototype"]]]],["send",["symbol","."],["data",["void"],["symbol","slice"]]]],["send",["symbol","."],["data",["void"],["symbol","call"]]]],["data",t$11606,["value",pos$11747]].concat(end$11752)],fns$11323);}else{[];}(acc$11757=[]);;(temp$11762=$13426(bw$11593));;($length$11767=temp$11762.length);;($index$11772=0);;$11612:for(;($index$11772<$length$11767);($index$11772++)){var i$11790;var m$11791;var t0$11785;var t1$11786;var m$11780;(m$11780=temp$11762[$index$11772]);;(t0$11785=m$11780);if(((t0$11785 instanceof Array)&&((t1$11786=t0$11785.length),(t1$11786===2)))){(i$11790=t0$11785[0]);(m$11791=t0$11785[1]);acc$11757.push(it$0$11326.process(m$11791,["send",["symbol","___js_fetch"],["data",t$11606,["send",["symbol","-"],["data",len$11607,["value",(nbw$11600-i$11790)]]]]],fns$11323));}else{$13448(m$11780,"/home/olivier/git/earl-grey/src/pattern.eg",9712,9863);;}}return acc$11757;}else{$13448($11339$11345);}}}}}}}}}}}}}()));;return rval$11336;});$10438(PatternProcessor$10500,$10438(((accum$11801=({})),((accum$11801["::name"]="PatternProcessor"),accum$11801)),((accum$11805=({})),((accum$11805["::egclass"]=true),accum$11805))));PatternProcessor$10500;(assemble_conditions$10501=function(pp$11811){var $index$11893;var $length$11888;var temp$11883;var acc$11878;var decls$11872;var construct$11814;(construct$11814=function($11817$11819){var x$11862;var rest$11863;var x$11855;var x$11847;var rest$11848;var $11822$11838;var $11823$11839;var t0$11834;var t1$11835;var t2$11836;var $11821$11829;var ph$11824;(ph$11824=$11817$11819);;($11821$11829=ph$11824);;if((($11822$11838=($11821$11829 instanceof Array))&&((t0$11834=$11821$11829.length),(t0$11834===0)))){return ["value",true];}else{if(($11822$11838&&((t0$11834>=1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="do")))))))){(x$11847=t1$11835[1]);(rest$11848=Array.prototype.slice.call($11821$11829,1));return ["multi",x$11847,construct$11814(rest$11848)];}else{if(($11822$11838&&((t0$11834===1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="check")))))))){(x$11855=t1$11835[1]);return x$11855;}else{if(($11822$11838&&((t0$11834>=1)&&((t1$11835=$11821$11829[0]),((t1$11835 instanceof Array)&&((t2$11836=t1$11835.length),((t2$11836===2)&&(t1$11835[0]==="check")))))))){(x$11862=t1$11835[1]);(rest$11863=Array.prototype.slice.call($11821$11829,1));return ["send",["symbol","and"],["data",x$11862,construct$11814(rest$11863)]];}else{$13448($11821$11829);}}}}});;if(pp$11811.temps.length){(decls$11872=(((acc$11878=[])),(((temp$11883=pp$11811.temps)),((($length$11888=temp$11883.length)),((($index$11893=0)),function(){$11875:for(;($index$11893<$length$11888);($index$11893++)){var t$11909;var m$11901;(m$11901=temp$11883[$index$11893]);;(t$11909=m$11901);acc$11878.push(["declare",t$11909]);}}()))),acc$11878));;return ["multi"].concat(decls$11872).concat([construct$11814(pp$11811.parts)]);}else{return construct$11814(pp$11811.parts);}});;(assemble_pattern$10502=function(){var $index$11963;var $length$11958;var temp$11953;var $index$12012;var $length$12007;var temp$12002;var test$12105;var lead$11933;var trail$11934;var construct$11935;var parts$11927;var t$11928;var f$11929;var t0$11923;var $11916$11918;($11916$11918=arguments);;(t0$11923=$11916$11918.length);if(((t0$11923>=2)&&(t0$11923<=3))){(parts$11927=$11916$11918[0]);(t$11928=$11916$11918[1]);(f$11929=function(){if((2>=t0$11923)){return null;}else{return $11916$11918[2];}}());(lead$11933=[]);;(temp$11953=parts$11927.slice(0));;($length$11958=temp$11953.length);;($index$11963=0);;$11936:for(;($index$11963<$length$11958);($index$11963++)){var x$11992;var x$11985;var $11938$11979;var $11939$11980;var $11940$11981;var $11941$11982;var t0$11976;var t1$11977;var m$11971;(m$11971=temp$11953[$index$11963]);;(t0$11976=m$11971);if((($11939$11980=(t0$11976 instanceof Array))&&((t1$11977=t0$11976.length),(($11941$11982=(t1$11977===2))&&(t0$11976[0]==="do"))))){(x$11985=t0$11976[1]);lead$11933.push(x$11985);parts$11927.shift();}else{if(($11941$11982&&(t0$11976[0]==="check"))){(x$11992=t0$11976[1]);break $11936;}else{$13448(m$11971,"/home/olivier/git/earl-grey/src/pattern.eg",10324,10434);;}}}(trail$11934=[]);;(temp$12002=parts$11927.slice(0).reverse());;($length$12007=temp$12002.length);;($index$12012=0);;$11942:for(;($index$12012<$length$12007);($index$12012++)){var x$12041;var x$12034;var $11944$12028;var $11945$12029;var $11946$12030;var $11947$12031;var t0$12025;var t1$12026;var m$12020;(m$12020=temp$12002[$index$12012]);;(t0$12025=m$12020);if((($11945$12029=(t0$12025 instanceof Array))&&((t1$12026=t0$12025.length),(($11947$12031=(t1$12026===2))&&(t0$12025[0]==="do"))))){(x$12034=t0$12025[1]);trail$11934.unshift(x$12034);parts$11927.pop();}else{if(($11947$12031&&(t0$12025[0]==="check"))){(x$12041=t0$12025[1]);break $11942;}else{$13448(m$12020,"/home/olivier/git/earl-grey/src/pattern.eg",10448,10570);;}}}(construct$11935=function($12048$12050){var other$12101;var x$12093;var rest$12094;var x$12086;var x$12078;var rest$12079;var $12053$12069;var $12054$12070;var t0$12065;var t1$12066;var t2$12067;var $12052$12060;var ph$12055;(ph$12055=$12048$12050);;($12052$12060=ph$12055);;if((($12053$12069=($12052$12060 instanceof Array))&&((t0$12065=$12052$12060.length),(t0$12065===0)))){return ["value",true];}else{if(($12053$12069&&((t0$12065>=1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="do")))))))){(x$12078=t1$12066[1]);(rest$12079=Array.prototype.slice.call($12052$12060,1));return ["multi",x$12078,construct$11935(rest$12079)];}else{if(($12053$12069&&((t0$12065===1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="check")))))))){(x$12086=t1$12066[1]);return x$12086;}else{if(($12053$12069&&((t0$12065>=1)&&((t1$12066=$12052$12060[0]),((t1$12066 instanceof Array)&&((t2$12067=t1$12066.length),((t2$12067===2)&&(t1$12066[0]==="check")))))))){(x$12093=t1$12066[1]);(rest$12094=Array.prototype.slice.call($12052$12060,1));return ["send",["symbol","and"],["data",x$12093,construct$11935(rest$12094)]];}else{(other$12101=$12052$12060);throw $13257(["oops"]).create("?!?",other$12101);}}}}});;if(parts$11927.length){(test$12105=construct$11935(parts$11927));;return ["multi"].concat(lead$11933).concat([function(){if(f$11929){return ["send",["symbol","if"],["data",test$12105,["multi"].concat(trail$11934).concat([t$11928]),f$11929]];}else{return ["send",["symbol","if"],["data",test$12105,["multi"].concat(trail$11934).concat([t$11928])]];}}()]);}else{return ["multi"].concat(lead$11933).concat(trail$11934).concat([t$11928]);}}else{$13448($11916$11918);}});;(inject_below_uses$10503=function($12114$12116,fn$12117){var other$12141;var scope$12134;var x$12135;var t0$12130;var $12119$12125;var ph$12120;(ph$12120=$12114$12116);;($12119$12125=ph$12120);;if((($12119$12125 instanceof Array)&&((t0$12130=$12119$12125.length),((t0$12130===3)&&($12119$12125[0]==="use"))))){(scope$12134=$12119$12125[1]);(x$12135=$12119$12125[2]);return ["use",scope$12134,inject_below_uses$10503(x$12135,fn$12117)];}else{(other$12141=$12119$12125);return fn$12117(other$12141);}});;(parse_pattern$10504=function(scope$12147,pattern$12148,rhs$12149,opt$12150){var t0$12161;var $index$12200;var $length$12195;var temp$12190;var acc$12185;var parse$12153;var target$12154;var proc$12155;(parse$12153=PatternParser$10499(scope$12147,pattern$12148,opt$12150));;if(((!opt$12150.allow_arguments)&&parse$12153.arguments.length)){throw $13257(["syntax","pattern","arguments"]).create("Arguments cannot be declared in this pattern",({"args":parse$12153.arguments[0]}));}(t0$12161=$13572((opt$12150.wrap_target||identity$10496))(function(){if(parse$12153.arguments.length){return inject_below_uses$10503(rhs$12149,function(x$12164){return util$10490.construct(parse$12153.arguments.concat([x$12164]),function(args$12167,rest$12168){return ["send",["symbol","->"],["data",args$12167,rest$12168]];});});}else{return rhs$12149;}}()));if(t0$12161[0]){(target$12154=t0$12161[1]);;}else{$13448(function(){if(parse$12153.arguments.length){return inject_below_uses$10503(rhs$12149,function(x$12173){return util$10490.construct(parse$12153.arguments.concat([x$12173]),function(args$12176,rest$12177){return ["send",["symbol","->"],["data",args$12176,rest$12177]];});});}else{return rhs$12149;}}(),"/home/olivier/git/earl-grey/src/pattern.eg",11963,12396);}(proc$12155=PatternProcessor$10500());;proc$12155.process(parse$12153.pattern,target$12154,opt$12150);if(opt$12150.finalize){return ["splice"].concat(opt$12150.declare(scope$12147,parse$12153.vars)).concat([["multi"].concat((((acc$12185=[])),(((temp$12190=proc$12155.temps)),((($length$12195=temp$12190.length)),((($index$12200=0)),function(){$12182:for(;($index$12200<$length$12195);($index$12200++)){var t$12216;var m$12208;(m$12208=temp$12190[$index$12200]);;(t$12216=m$12208);acc$12185.push(["declare",t$12216]);}}()))),acc$12185)).concat([assemble_pattern$10502(proc$12155.parts,opt$12150.success(target$12154),opt$12150.failure(target$12154))])]);}else{return [parse$12153.vars,proc$12155.temps,proc$12155.parts];}});;(checkall$10505=["send","data","multi","assign","void","check","do"]);;(same_block$10506=function($12224$12226,ban1$12227,ban2$12228){var $index$12329;var $length$12324;var temp$12319;var other$12350;var type1$12302;var args1$12303;var type2$12304;var args2$12305;var m1$12293;var m2$12294;var v1$12284;var v2$12285;var s1$12275;var s2$12276;var v1$12263;var v2$12264;var $12231$12254;var $12232$12255;var $12233$12256;var $12234$12257;var $12235$12258;var $12236$12259;var $12237$12260;var t0$12248;var t1$12249;var t2$12250;var t3$12251;var t4$12252;var $12230$12243;var ph$12238;(ph$12238=$12224$12226);;($12230$12243=ph$12238);;if((($12231$12254=($12230$12243 instanceof Array))&&((t0$12248=$12230$12243.length),(($12233$12256=(t0$12248===2))&&((t1$12249=$12230$12243[0]),(($12235$12258=(t1$12249 instanceof Array))&&((t2$12250=t1$12249.length),(($12237$12260=(t2$12250===2))&&((t1$12249[0]==="variable")&&((v1$12263=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="variable"))))))))))))))){(v2$12264=t3$12251[1]);return (v1$12263===v2$12264);}else{if(($12237$12260&&((t1$12249[0]==="symbol")&&((s1$12275=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="symbol"))))))))){(s2$12276=t3$12251[1]);return (((!$10437(ban1$12227,s1$12275))&&(!$10437(ban2$12228,s2$12276)))&&(s1$12275===s2$12276));}else{if(($12237$12260&&((t1$12249[0]==="value")&&((v1$12284=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="value"))))))))){(v2$12285=t3$12251[1]);return (v1$12284===v2$12285);}else{if(($12237$12260&&((t1$12249[0]==="macro")&&((m1$12293=t1$12249[1]),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252===2)&&(t3$12251[0]==="macro"))))))))){(m2$12294=t3$12251[1]);return (m1$12293===m2$12294);}else{if(($12235$12258&&((t2$12250>=1)&&((type1$12302=t1$12249[0]),((args1$12303=Array.prototype.slice.call(t1$12249,1)),((t3$12251=$12230$12243[1]),((t3$12251 instanceof Array)&&((t4$12252=t3$12251.length),((t4$12252>=1)&&((type2$12304=t3$12251[0]),((args2$12305=Array.prototype.slice.call(t3$12251,1)),(checkall$10505.indexOf(type1$12302)!==-1)))))))))))){if(((type1$12302===type2$12304)&&(args1$12303.length===args2$12305.length))){(temp$12319=$13600(args1$12303,args2$12305));;($length$12324=temp$12319.length);;($index$12329=0);;$12315:for(;($index$12329<$length$12324);($index$12329++)){var pair$12345;var m$12337;(m$12337=temp$12319[$index$12329]);;(pair$12345=m$12337);if((!same_block$10506(pair$12345,ban1$12227,ban2$12228))){return false;}}return true;}else{return false;}}else{(other$12350=$12230$12243);return false;}}}}}});;(parse_clauses$10507=function(scope$12356,target$12357,stmts$12358,opt$12359){var $index$12389;var $length$12384;var temp$12379;var acc$12374;var $index$12565;var $length$12560;var temp$12555;var acc$12550;var $index$12612;var $length$12607;var temp$12602;var acc$12597;var decls$12591;var all_temps$12362;var the_parts$12363;var unique_temps$12364;(all_temps$12362=[]);;(the_parts$12363=(((acc$12374=[])),(((temp$12379=scope$12356.step_all(["clause"],stmts$12358))),((($length$12384=temp$12379.length)),((($index$12389=0)),function(){$12370:for(;($index$12389<$length$12384);($index$12389++)){var accum$12464;var accum$12475;var t0$12460;var t1$12461;var $index$12498;var $length$12493;var temp$12488;var bod$12525;var placeholder$12414;var special_fn$12415;var vars$12416;var temps$12417;var blocks$12418;var vars2$12419;var x$12534;var other$12541;var b$12531;var pattern$12408;var body$12409;var $12372$12405;var t0$12402;var t1$12403;var m$12397;(m$12397=temp$12379[$index$12389]);;(t0$12402=m$12397);if(((t0$12402 instanceof Array)&&((t1$12403=t0$12402.length),((t1$12403===3)&&(t0$12402[0]==="clause"))))){(pattern$12408=t0$12402[1]);(body$12409=t0$12402[2]);acc$12374.push((((placeholder$12414=(void 0))),((special_fn$12415=function($12427$12429,value$12430){var t0$12436;var t1$12437;var other$12456;var $12432$12443;var ph$12433;var expr$12434;(t0$12436=$12427$12429);if(((t0$12436 instanceof Array)&&((t1$12437=t0$12436.length),((t1$12437===2)&&(t0$12436[0]==="special"))))){(ph$12433=t0$12436[1]);(expr$12434=t0$12436);;}else{$13448($12427$12429);}($12432$12443=ph$12433);;if(($12432$12443==="match")){(placeholder$12414=__lt____lt____colon__$10489(["symbol",scope$12356.gensym("ph")],expr$12434));return ["assign",placeholder$12414];}else{(other$12456=$12432$12443);throw $13257(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$12434}));}})),((t0$12460=parse_pattern$10504(scope$12356,pattern$12408,target$12357,$13461(opt$12359,$10438(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12415}),$10438(((accum$12464=({})),((accum$12464["assign"]=function(v$12468,value$12469){return ["do",__lt____lt____colon__$10489(["assign",v$12468,value$12469],v$12468)];}),accum$12464)),({"finalize":false})))))),function(){if(((t0$12460 instanceof Array)&&((t1$12461=t0$12460.length),(t1$12461===3)))){(vars$12416=t0$12460[0]);(temps$12417=t0$12460[1]);(blocks$12418=t0$12460[2]);}else{return $13448(parse_pattern$10504(scope$12356,pattern$12408,target$12357,$13461(opt$12359,$10438(({"allow_arguments":false,"allow_nested":true,"special":special_fn$12415}),$10438(((accum$12475=({})),((accum$12475["assign"]=function(v$12479,value$12480){return ["do",__lt____lt____colon__$10489(["assign",v$12479,value$12480],v$12479)];}),accum$12475)),({"finalize":false}))))),"/home/olivier/git/earl-grey/src/pattern.eg",14023,14370);}}()),(all_temps$12362=all_temps$12362.concat(temps$12417)),function(){if(placeholder$12414){return vars$12416.push(placeholder$12414);}}(),((vars2$12419=({}))),(((temp$12488=vars$12416)),((($length$12493=temp$12488.length)),((($index$12498=0)),function(){$12420:for(;($index$12498<$length$12493);($index$12498++)){var other$12522;var xxx$12516;var t0$12511;var t1$12512;var m$12506;(m$12506=temp$12488[$index$12498]);;(t0$12511=m$12506);if(((t0$12511 instanceof Array)&&((t1$12512=t0$12511.length),((t1$12512===2)&&(t0$12511[0]==="symbol"))))){(xxx$12516=t0$12511[1]);(vars2$12419[xxx$12516]=true);}else{(other$12522=m$12506);throw $13257(["syntax","unexpected"]).create();}}}()))),(((bod$12525=function(){if(placeholder$12414){return parse_clauses$10507(scope$12356,placeholder$12414,$13572(["multi"])(body$12409)[1],opt$12359);}else{if(opt$12359.wrap){return opt$12359.wrap(body$12409);}else{return body$12409;}}}())),["clause",vars$12416,vars2$12419,blocks$12418,bod$12525])));}else{if((((x$12534=t0$12402)),((x$12534 instanceof Array)&&(x$12534[0]==="block")))){(b$12531=t0$12402);acc$12374.push(b$12531);}else{(other$12541=m$12397);acc$12374.push(function(){throw $13257(["syntax","clause"]).create("Illegal clause",({"clause":other$12541}));}());}}}}()))),acc$12374));;if(opt$12359.fallback){the_parts$12363.push(["block",opt$12359.fallback(target$12357)]);}(unique_temps$12364=$13571(util$10490.mkset((((acc$12550=[])),(((temp$12555=all_temps$12362)),((($length$12560=temp$12555.length)),((($index$12565=0)),function(){$12547:for(;($index$12565<$length$12560);($index$12565++)){var t$12583;var t0$12578;var t1$12579;var m$12573;(m$12573=temp$12555[$index$12565]);;(t0$12578=m$12573);if(((t0$12578 instanceof Array)&&((t1$12579=t0$12578.length),((t1$12579===2)&&(t0$12578[0]==="symbol"))))){(t$12583=t0$12578[1]);acc$12550.push(t$12583);}else{$13448(m$12573,"/home/olivier/git/earl-grey/src/pattern.eg",15180,15210);;}}}()))),acc$12550))));;(decls$12591=(((acc$12597=[])),(((temp$12602=unique_temps$12364)),((($length$12607=temp$12602.length)),((($index$12612=0)),function(){$12594:for(;($index$12612<$length$12607);($index$12612++)){var t$12628;var m$12620;(m$12620=temp$12602[$index$12612]);;(t$12628=m$12620);acc$12597.push(["declare",["symbol",t$12628]]);}}()))),acc$12597));;return ["multi"].concat(decls$12591).concat([weave_clauses$10509(the_parts$12363)]);});;(opt_clauses$10508=function(clauses$12635){var $index$12664;var $length$12659;var temp$12654;var acc$12649;var $index$12799;var $length$12794;var temp$12789;var acc$12784;var $index$12844;var $length$12839;var temp$12834;var acc$12829;var $index$12888;var $length$12883;var temp$12878;var acc$12873;var shares$12638;var max$12639;var temps$12640;var shared_last$12641;var idx_last$12642;var new_clauses$12643;(shares$12638=(((acc$12649=[])),(((temp$12654=$13426(clauses$12635.slice(1)))),((($length$12659=temp$12654.length)),((($index$12664=0)),function(){$12646:for(;($index$12664<$length$12659);($index$12664++)){var t0$12703;var t1$12704;var $index$12727;var $length$12722;var temp$12717;var varsd0$12696;var blocks0$12697;var share$12698;var idx$12699;var i$12684;var vars$12685;var varsd$12686;var blocks$12687;var body$12688;var t0$12677;var t1$12678;var t2$12679;var t3$12680;var m$12672;(m$12672=temp$12654[$index$12664]);;(t0$12677=m$12672);if(((t0$12677 instanceof Array)&&((t1$12678=t0$12677.length),((t1$12678===2)&&((i$12684=t0$12677[0]),((t2$12679=t0$12677[1]),((t2$12679 instanceof Array)&&((t3$12680=t2$12679.length),((t3$12680===5)&&(t2$12679[0]==="clause")))))))))){(vars$12685=t2$12679[1]);(varsd$12686=t2$12679[2]);(blocks$12687=t2$12679[3]);(body$12688=t2$12679[4]);acc$12649.push((((t0$12703=$10437(clauses$12635,i$12684)),function(){if(((t0$12703 instanceof Array)&&((t1$12704=t0$12703.length),((t1$12704===5)&&(t0$12703[0]==="clause"))))){t0$12703[1];(varsd0$12696=t0$12703[2]);(blocks0$12697=t0$12703[3]);t0$12703[4];}else{return $13448($10437(clauses$12635,i$12684),"/home/olivier/git/earl-grey/src/pattern.eg",15483,15503);}}()),((share$12698=0)),((idx$12699=0)),(((temp$12717=blocks$12687)),((($length$12722=temp$12717.length)),((($index$12727=0)),function(){$12700:for(;($index$12727<$length$12722);($index$12727++)){var x$12758;var x$12767;var other$12774;var $12746$12748;var b$12743;var m$12735;(m$12735=temp$12717[$index$12727]);;(b$12743=m$12735);if(same_block$10506([$10437(blocks0$12697,share$12698),b$12743],varsd0$12696,varsd$12686)){(share$12698++);($12746$12748=b$12743);;if((((x$12758=$12746$12748)),((x$12758 instanceof Array)&&(x$12758[0]==="do")))){null;}else{if((((x$12767=$12746$12748)),((x$12767 instanceof Array)&&(x$12767[0]==="check")))){(idx$12699=share$12698);}else{(other$12774=$12746$12748);__lt____gt__$10487(null,other$12774);}}}else{break $12700;}}}()))),[share$12698,idx$12699]));}else{$13448(m$12672,"/home/olivier/git/earl-grey/src/pattern.eg",15359,15880);;}}}()))),acc$12649));;(max$12639=$10437(Math.max,(((acc$12784=[])),(((temp$12789=shares$12638)),((($length$12794=temp$12789.length)),((($index$12799=0)),function(){$12781:for(;($index$12799<$length$12794);($index$12799++)){var x$12817;var t0$12812;var t1$12813;var m$12807;(m$12807=temp$12789[$index$12799]);;(t0$12812=m$12807);if(((t0$12812 instanceof Array)&&((t1$12813=t0$12812.length),(t1$12813===2)))){(x$12817=t0$12812[0]);t0$12812[1];acc$12784.push(x$12817);}else{$13448(m$12807,"/home/olivier/git/earl-grey/src/pattern.eg",15894,15923);;}}}()))),acc$12784)));;shares$12638.push([0,0]);(temps$12640=(((acc$12829=[])),(((temp$12834=$13648(1,max$12639))),((($length$12839=temp$12834.length)),((($index$12844=0)),function(){$12826:for(;($index$12844<$length$12839);($index$12844++)){var m$12852;(m$12852=temp$12834[$index$12844]);;m$12852;acc$12829.push(["symbol",gensym$10492()]);}}()))),acc$12829));;(shared_last$12641=0);;(idx_last$12642=0);;(new_clauses$12643=(((acc$12873=[])),(((temp$12878=$13426(clauses$12635))),((($length$12883=temp$12878.length)),((($index$12888=0)),function(){$12870:for(;($index$12888<$length$12883);($index$12888++)){var t0$12926;var t1$12927;var $index$12962;var $length$12957;var temp$12952;var acc$12947;var rest$13011;var newblocks$13007;var share$12920;var idx$12921;var shared$12922;var n_to_share$12923;var to_share$12924;var other$13018;var i$12908;var vars$12909;var varsd$12910;var blocks$12911;var body$12912;var t0$12901;var t1$12902;var t2$12903;var t3$12904;var m$12896;(m$12896=temp$12878[$index$12888]);;(t0$12901=m$12896);if(((t0$12901 instanceof Array)&&((t1$12902=t0$12901.length),((t1$12902===2)&&((i$12908=t0$12901[0]),((t2$12903=t0$12901[1]),((t2$12903 instanceof Array)&&((t3$12904=t2$12903.length),((t3$12904===5)&&(t2$12903[0]==="clause")))))))))){(vars$12909=t2$12903[1]);(varsd$12910=t2$12903[2]);(blocks$12911=t2$12903[3]);(body$12912=t2$12903[4]);acc$12873.push((((t0$12926=$10437(shares$12638,i$12908)),function(){if(((t0$12926 instanceof Array)&&((t1$12927=t0$12926.length),(t1$12927===2)))){(share$12920=t0$12926[0]);(idx$12921=t0$12926[1]);}else{return $13448($10437(shares$12638,i$12908),"/home/olivier/git/earl-grey/src/pattern.eg",16144,16163);}}()),((shared$12922=function(){if(idx_last$12642){return [["check",$10437(temps$12640,(idx_last$12642-1))]];}else{return [];}}())),((n_to_share$12923=Math.max(shared_last$12641,share$12920))),((to_share$12924=(((acc$12947=[])),(((temp$12952=$13426(blocks$12911.slice(shared_last$12641,n_to_share$12923)))),((($length$12957=temp$12952.length)),((($index$12962=0)),function(){$12940:for(;($index$12962<$length$12957);($index$12962++)){var j$12996;var x$12997;var j$12986;var x$12987;var $12942$12980;var $12943$12981;var $12944$12982;var $12945$12983;var t0$12975;var t1$12976;var t2$12977;var t3$12978;var m$12970;(m$12970=temp$12952[$index$12962]);;(t0$12975=m$12970);if((($12943$12981=(t0$12975 instanceof Array))&&((t1$12976=t0$12975.length),(($12945$12983=(t1$12976===2))&&((j$12986=t0$12975[0]),((t2$12977=t0$12975[1]),((t2$12977 instanceof Array)&&((t3$12978=t2$12977.length),((t3$12978===2)&&(t2$12977[0]==="check")))))))))){(x$12987=t2$12977[1]);acc$12947.push(["check",["assign",$10437(temps$12640,(shared_last$12641+j$12986)),x$12987]]);}else{if(($12945$12983&&((j$12996=t0$12975[0]),((t2$12977=t0$12975[1]),((t2$12977 instanceof Array)&&((t3$12978=t2$12977.length),((t3$12978===2)&&(t2$12977[0]==="do")))))))){(x$12997=t2$12977[1]);acc$12947.push(["do",x$12997]);}else{$13448(m$12970,"/home/olivier/git/earl-grey/src/pattern.eg",16292,16463);;}}}}()))),acc$12947))),(shared_last$12641=share$12920),(idx_last$12642=idx$12921),(((newblocks$13007=(((rest$13011=blocks$12911.slice(n_to_share$12923))),shared$12922.concat(to_share$12924).concat(rest$13011)))),["clause",vars$12909,varsd$12910,newblocks$13007,body$12912])));}else{(other$13018=m$12896);acc$12873.push(function(){throw $13257(["oops"]).create("what",({"value":other$13018}));}());}}}()))),acc$12873));;return [temps$12640,new_clauses$12643];});;(weave_clauses$10509=function(parts$13025){var $index$13071;var $length$13066;var temp$13061;var $index$13237;var $length$13232;var temp$13227;var acc$13222;var groups$13028;var reassemble$13029;var new_temps$13030;var helper$13031;(groups$13028=classify_contiguous$10495(parts$13025,function($13040$13042){var t0$13046;var t1$13047;var cls$13044;(t0$13046=$13040$13042);if(((t0$13046 instanceof Array)&&((t1$13047=t0$13046.length),(t1$13047>=1)))){(cls$13044=t0$13046[0]);Array.prototype.slice.call(t0$13046,1);;}else{$13448($13040$13042);}return cls$13044;}));;(reassemble$13029=[]);;(new_temps$13030=[]);;(temp$13061=groups$13028);;($length$13066=temp$13061.length);;($index$13071=0);;$13032:for(;($index$13071<$length$13066);($index$13071++)){var t0$13101;var t1$13102;var ts$13098;var new_clauses$13099;var elems$13109;var elems$13093;var $13034$13087;var $13035$13088;var $13036$13089;var $13037$13090;var t0$13084;var t1$13085;var m$13079;(m$13079=temp$13061[$index$13071]);;(t0$13084=m$13079);if((($13035$13088=(t0$13084 instanceof Array))&&((t1$13085=t0$13084.length),(($13037$13090=(t1$13085>=1))&&(t0$13084[0]==="clause"))))){(elems$13093=Array.prototype.slice.call(t0$13084,1));(t0$13101=opt_clauses$10508(elems$13093));if(((t0$13101 instanceof Array)&&((t1$13102=t0$13101.length),(t1$13102===2)))){(ts$13098=t0$13101[0]);(new_clauses$13099=t0$13101[1]);;}else{$13448(opt_clauses$10508(elems$13093),"/home/olivier/git/earl-grey/src/pattern.eg",16958,16986);}(new_temps$13030=new_temps$13030.concat(ts$13098));(reassemble$13029=reassemble$13029.concat(new_clauses$13099));}else{if(($13037$13090&&(t0$13084[0]==="block"))){(elems$13109=Array.prototype.slice.call(t0$13084,1));(reassemble$13029=reassemble$13029.concat(elems$13109));}else{$13448(m$13079,"/home/olivier/git/earl-grey/src/pattern.eg",16892,17097);;}}}(helper$13031=function($13116$13118){var $index$13197;var $length$13192;var temp$13187;var acc$13182;var decls$13176;var vars$13168;var varsd$13169;var blocks$13170;var body$13171;var rest$13172;var body$13157;var rest$13158;var $13121$13144;var $13122$13145;var $13123$13146;var $13124$13147;var $13125$13148;var $13126$13149;var t0$13137;var t1$13138;var t2$13139;var t3$13140;var t4$13141;var t5$13142;var $13120$13132;var ph$13127;(ph$13127=$13116$13118);;($13120$13132=ph$13127);;if((($13121$13144=($13120$13132 instanceof Array))&&((t0$13137=$13120$13132.length),(t0$13137===0)))){return ["multi"];}else{if(($13121$13144&&(($13123$13146=(t0$13137>=1))&&((t1$13138=$13120$13132[0]),(($13125$13148=(t1$13138 instanceof Array))&&((t2$13139=t1$13138.length),((t2$13139===2)&&((t1$13138[0]==="block")&&((t3$13140=$13572(["multi"])(t1$13138[1])),(t3$13140[0]&&((t4$13141=t3$13140[1]),((t5$13142=t4$13141.length),(t5$13142>=0))))))))))))){(body$13157=Array.prototype.slice.call(t4$13141,0));(rest$13158=Array.prototype.slice.call($13120$13132,1));return ["multi"].concat(body$13157).concat([helper$13031(rest$13158)]);}else{if(($13125$13148&&((t2$13139===5)&&(t1$13138[0]==="clause")))){(vars$13168=t1$13138[1]);(varsd$13169=t1$13138[2]);(blocks$13170=t1$13138[3]);(body$13171=t1$13138[4]);(rest$13172=Array.prototype.slice.call($13120$13132,1));(decls$13176=(((acc$13182=[])),(((temp$13187=vars$13168)),((($length$13192=temp$13187.length)),((($index$13197=0)),function(){$13179:for(;($index$13197<$length$13192);($index$13197++)){var v$13213;var m$13205;(m$13205=temp$13187[$index$13197]);;(v$13213=m$13205);acc$13182.push(["declare",v$13213]);}}()))),acc$13182));;return ["tagscope","back",["multi"].concat(decls$13176).concat([assemble_pattern$10502(blocks$13170,body$13171,["use","back",helper$13031(rest$13172)])])];}else{$13448($13120$13132);}}}});;return ["multi"].concat((((acc$13222=[])),(((temp$13227=new_temps$13030)),((($length$13232=temp$13227.length)),((($index$13237=0)),function(){$13219:for(;($index$13237<$length$13232);($index$13237++)){var t$13253;var m$13245;(m$13245=temp$13227[$index$13237]);;(t$13253=m$13245);acc$13222.push(["declare",t$13253]);}}()))),acc$13222)).concat([helper$13031(reassemble$13029)]);});;(exports["PatternParser"]=PatternParser$10499);(exports["PatternProcessor"]=PatternProcessor$10500);(exports["parse_clauses"]=parse_clauses$10507);(exports["parse_pattern"]=parse_pattern$10504);
