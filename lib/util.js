var $43350=(function(type$43353){var f$43357;(f$43357=type$43353["::check"]);if((f$43357===(void 0))){return (function(value$43363){return (value$43363 instanceof type$43353);});}else{return (function(value$43367){return f$43357.call(type$43353,value$43367);});}});
var $43369=(function(dest$43372,values$43373){var k$43378;(k$43378=null);$43376:for(k$43378 in values$43373){if(values$43373.hasOwnProperty(k$43378)){(dest$43372[k$43378]=values$43373[k$43378]);}}return dest$43372;});
var $43386=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $43387=(function($43389$43392){var ph$43398;(ph$43398=$43389$43392);var $43394$43404;($43394$43404=ph$43398);var bridge$43396$43409;var x$43413;(bridge$43396$43409=$43394$43404);if((((typeof(bridge$43396$43409)==="string")&&((x$43413=bridge$43396$43409),true))||((typeof(bridge$43396$43409)==="number")&&((x$43413=bridge$43396$43409),true)))){return ["value",x$43413];}else{var other$43424;(other$43424=$43394$43404);return other$43424["::serialize_ast"]();}});
var $43426=(function(obj$43429){var results$43434;(results$43434=[]);var k$43439;(k$43439=null);$43433:for(k$43439 in obj$43429){if(Object.prototype.hasOwnProperty.call(obj$43429,k$43439)){results$43434.push([k$43439,$43386(obj$43429,k$43439)]);}}return results$43434;});
var $43695=(function(arr$43698){var results$43704;var l$43705;(results$43704=[]);(l$43705=arr$43698.length);var i$43714;(i$43714=0);$43703:for(;(i$43714<l$43705);(i$43714++)){results$43704.push([i$43714,$43386(arr$43698,i$43714)]);}return results$43704;});
var $43462=(function(){var $43463$43469;($43463$43469=(function(tags$43474){var it$0$43477;(it$0$43477=(function(){if((!$43350($43463$43469)(this))){return Object.create($43463$43469.prototype);}else{return this;}})());(it$0$43477["tags"]=tags$43474);return it$0$43477;}));($43463$43469.prototype["create"]=(function(){var it$0$43497;var self$43498;(it$0$43497=this);(self$43498=this);var $43495$43507;($43495$43507=arguments);var t0$43512;var message$43516;var args$43517;(t0$43512=$43495$43507.length);if((t0$43512>=0)){(message$43516=(function(){if((0>=t0$43512)){return "";}else{return $43495$43507[0];}})());(args$43517=Array.prototype.slice.call($43495$43507,1));var e$43530;(e$43530=Error(message$43516));(e$43530["::tags"]=it$0$43497.tags);(e$43530["args"]=args$43517);var temp$43546;(temp$43546=$43695(args$43517));var $length$43552;($length$43552=temp$43546.length);var $index$43558;($index$43558=0);$43531:for(;($index$43558<$length$43552);($index$43558++)){var m$43567;(m$43567=temp$43546[$index$43558]);var t0$43572;var t1$43573;var i$43577;var arg$43578;(t0$43572=m$43567);if(((t0$43572 instanceof Array)&&(((t1$43573=t0$43572.length)),(t1$43573===2)))){(i$43577=t0$43572[0]);(arg$43578=t0$43572[1]);(e$43530[i$43577]=arg$43578);}else{$43443(m$43567);}}(e$43530["length"]=args$43517.length);(e$43530["name"]=["E"].concat(it$0$43497.tags).join("."));return e$43530;}else{$43443($43495$43507);}}));($43463$43469.prototype["::check"]=(function(e$43608){var it$0$43612;var self$43613;(it$0$43612=this);(self$43613=this);var tags$43623;if(((!e$43608)||(!$43350(Error)(e$43608)))){return false;}(tags$43623=(e$43608["::tags"]||[]));var temp$43634;(temp$43634=it$0$43612.tags);var $length$43640;($length$43640=temp$43634.length);var $index$43646;($index$43646=0);$43624:for(;($index$43646<$length$43640);($index$43646++)){var m$43655;(m$43655=temp$43634[$index$43646]);var tag$43663;(tag$43663=m$43655);if((tags$43623.indexOf(tag$43663)===-1)){return false;}else{false;}}return true;}));($43463$43469.prototype["::deconstruct"]=(function(e$43672){var it$0$43676;var self$43677;(it$0$43676=this);(self$43677=this);return e$43672.args;}));$43369($43463$43469,$43369((function(){var accum$43688;(accum$43688=({}));(accum$43688["::name"]="$43463");return accum$43688;})(),(function(){var accum$43692;(accum$43692=({}));(accum$43692["::egclass"]=true);return accum$43692;})()));return $43463$43469;})();
var $43443=(function(value$43446,url$43447,start$43448,end$43449){var err$43453;(err$43453=$43462(["match"]).create("Could not find a match for value",({"value":value$43446})));if(url$43447){(err$43453["location"]=["location",url$43447,start$43448,end$43449]);}throw err$43453;});
var send$42995;var __array_methods$42996;var __re_methods$42997;(send$42995=(function(obj$43010,$43007$43011){var ph$43017;var msg$43018;var t0$43020;(t0$43020=$43007$43011);(msg$43018=t0$43020);(ph$43017=t0$43020);var $43013$43029;($43013$43029=ph$43017);var bridge$43015$43034;(bridge$43015$43034=$43013$43029);if(((typeof(bridge$43015$43034)==="string")||(typeof(bridge$43015$43034)==="number"))){return obj$43010[msg$43018];}else{var other$43046;(other$43046=$43013$43029);return obj$43010["::send"](msg$43018);}}));(Array[":::project"]=(function($43052$43055){var ph$43060;var value$43061;var t0$43063;(t0$43063=$43052$43055);(value$43061=t0$43063);(ph$43060=t0$43063);var $43057$43072;($43057$43072=ph$43060);if($43350(Array)($43057$43072)){return [true,value$43061];}else{$43057$43072;return [true,[value$43061]];}}));(__array_methods$42996=$43369((function(){var accum$43093;(accum$43093=({}));(accum$43093["::check"]=(function(value$43098){if((value$43098 instanceof Array)){var i$43104;(i$43104=0);$43101:for(;(i$43104<this.length);(i$43104++)){if(($43386(this,i$43104)!==$43386(value$43098,i$43104))){return false;}}return true;}else{return false;}}));return accum$43093;})(),$43369((function(){var accum$43113;(accum$43113=({}));(accum$43113["::clone"]=(function(){return $43369(this.slice(0),this);}));return accum$43113;})(),$43369((function(){var accum$43120;(accum$43120=({}));(accum$43120[":::project"]=(function(value$43125){if((value$43125 instanceof Array)){var i$43131;(i$43131=0);$43128:for(;(i$43131<this.length);(i$43131++)){if(($43386(this,i$43131)!==$43386(value$43125,i$43131))){return [true,this.concat([value$43125])];}}return [true,value$43125];}else{return [true,this.concat([value$43125])];}}));return accum$43120;})(),(function(){var accum$43140;(accum$43140=({}));(accum$43140["::serialize_ast"]=(function(){return ["array"].concat(this.map($43387));}));return accum$43140;})()))));var temp$43150;(temp$43150=$43426(__array_methods$42996));var $length$43156;($length$43156=temp$43150.length);var $index$43162;($index$43162=0);$42998:for(;($index$43162<$length$43156);($index$43162++)){var m$43171;(m$43171=temp$43150[$index$43162]);var t0$43176;var t1$43177;var k$43181;var v$43182;(t0$43176=m$43171);if(((t0$43176 instanceof Array)&&(((t1$43177=t0$43176.length)),(t1$43177===2)))){(k$43181=t0$43176[0]);(v$43182=t0$43176[1]);if((!$43386(Array.prototype,k$43181))){Object.defineProperty(Array.prototype,k$43181,({"enumerable":false,"value":v$43182}));}}else{$43443(m$43171);}}(__re_methods$42997=$43369((function(){var accum$43202;(accum$43202=({}));(accum$43202["::check"]=(function($43206$43209){var ph$43214;(ph$43214=$43206$43209);var $43211$43220;($43211$43220=ph$43214);var value$43228;if((typeof($43211$43220)==="string")){(value$43228=$43211$43220);if(value$43228.match(this)){return true;}else{return false;}}else{var other$43233;(other$43233=$43211$43220);return false;}}));return accum$43202;})(),(function(){var accum$43236;(accum$43236=({}));(accum$43236[":::project"]=(function($43240$43243){var ph$43248;(ph$43248=$43240$43243);var $43245$43254;($43245$43254=ph$43248);var value$43262;if((typeof($43245$43254)==="string")){(value$43262=$43245$43254);var $43265$43270;($43265$43270=value$43262.match(this));var m$43278;if(($43265$43270===null)){(m$43278=$43265$43270);return [false,null];}else{var m$43283;(m$43283=$43265$43270);return [true,m$43283];}}else{var other$43287;(other$43287=$43245$43254);return [false,null];}}));return accum$43236;})()));var temp$43293;(temp$43293=$43426(__re_methods$42997));var $length$43299;($length$43299=temp$43293.length);var $index$43305;($index$43305=0);$43001:for(;($index$43305<$length$43299);($index$43305++)){var m$43314;(m$43314=temp$43293[$index$43305]);var t0$43319;var t1$43320;var k$43324;var v$43325;(t0$43319=m$43314);if(((t0$43319 instanceof Array)&&(((t1$43320=t0$43319.length)),(t1$43320===2)))){(k$43324=t0$43319[0]);(v$43325=t0$43319[1]);if((!$43386(RegExp.prototype,k$43324))){Object.defineProperty(RegExp.prototype,k$43324,({"enumerable":false,"value":v$43325}));}}else{$43443(m$43314);}}if((!Function.prototype["::send"])){Object.defineProperty(Function.prototype,"::send",$43369(({"enumerable":false}),(function(){var accum$43343;(accum$43343=({}));(accum$43343["value"]=(function(args$43348){return this.apply(this,args$43348);}));return accum$43343;})()));}var GenSym$43735;var gensym$43736;var identity$43737;var binsearch$43738;var classify$43739;var classify_contiguous$43740;var neighbours$43741;var partition$43742;var product$43743;var construct$43744;var mkset$43745;var Body$43746;(GenSym$43735=(function(prefix$43751){var id$43756;(id$43756=0);return (function(){var r$43783;var pfx$43774;var t0$43770;var $43761$43765;($43761$43765=arguments);(t0$43770=$43761$43765.length);if(((t0$43770>=0)&&(t0$43770<=1))){(pfx$43774=(function(){if((0>=t0$43770)){return "";}else{return $43761$43765[0];}})());(r$43783=((pfx$43774+prefix$43751)+[true,String(id$43756)][1]));(id$43756++);return r$43783;}else{$43443($43761$43765);}});}));(gensym$43736=GenSym$43735("$"));(identity$43737=(function(x$43797){return x$43797;}));(binsearch$43738=(function(xs$43804,x$43805){var lo$43810;var hi$43811;(lo$43810=0);(hi$43811=(xs$43804.length-1));$43818:while((lo$43810<=hi$43811)){var $43824$43838;var mid$43828;var v$43829;(mid$43828=(lo$43810+((hi$43811-lo$43810)>>1)));(v$43829=$43386(xs$43804,mid$43828));($43824$43838=$43386(xs$43804,mid$43828));if(($43824$43838<x$43805)){(lo$43810=(mid$43828+1));}else{if(($43824$43838>x$43805)){(hi$43811=(mid$43828-1));}else{$43824$43838;return (mid$43828+1);}}}return lo$43810;}));(classify$43739=(function(){var $index$43913;var $length$43907;var temp$43901;var results$43891;var classes$43881;var xs$43882;var t0$43877;var $43868$43872;($43868$43872=arguments);(t0$43877=$43868$43872.length);if((t0$43877>=1)){(classes$43881=Array.prototype.slice.call($43868$43872,0,-1));(xs$43882=$43868$43872[(t0$43877-1)]);(results$43891=({"rest":[]}));(temp$43901=classes$43881);($length$43907=temp$43901.length);($index$43913=0);$43892:for(;($index$43913<$length$43907);($index$43913++)){var cls$43930;var m$43922;(m$43922=temp$43901[$index$43913]);(cls$43930=m$43922);(results$43891[cls$43930]=[]);}$43936:while(xs$43882.length){var x$43972;var other$43992;var cls$43979;var x$43980;var newxs$43955;var t0$43951;var $43939$43946;($43939$43946=xs$43882.shift());if((($43939$43946 instanceof Array)&&(((t0$43951=$43939$43946.length)),((t0$43951>=1)&&($43939$43946[0]==="splice"))))){(newxs$43955=Array.prototype.slice.call($43939$43946,1));(xs$43882=newxs$43955.concat(xs$43882));}else{if((((x$43972=$43939$43946)),((x$43972 instanceof Array)&&(x$43972[0]==="ignore")))){null;}else{if((($43939$43946 instanceof Array)&&(((t0$43951=$43939$43946.length)),((t0$43951===2)&&((cls$43979=$43939$43946[0]),((x$43980=$43939$43946[1]),$43386(results$43891,cls$43979))))))){$43386(results$43891,cls$43979).push(x$43980);}else{(other$43992=$43939$43946);results$43891.rest.push(other$43992);}}}}return results$43891;}else{$43443($43868$43872);}}));(classify_contiguous$43740=(function(xs$44001,classifier$44002){var $index$44038;var $length$44032;var temp$44026;var groups$44008;var currcls$44009;var curr$44010;(groups$44008=[]);(currcls$44009=null);(curr$44010=null);(temp$44026=xs$44001);($length$44032=temp$44026.length);($index$44038=0);$44011:for(;($index$44038<$length$44032);($index$44038++)){var cls$44059;var x$44055;var m$44047;(m$44047=temp$44026[$index$44038]);(x$44055=m$44047);(cls$44059=classifier$44002(x$44055));if((cls$44059===currcls$44009)){curr$44010.push(x$44055);}else{if(curr$44010){groups$44008.push(curr$44010);}(curr$44010=[cls$44059,x$44055]);(currcls$44009=cls$44059);}}if(curr$44010){groups$44008.push(curr$44010);}return groups$44008;}));(neighbours$43741=(function($44078$44081){var x$44120;var y$44121;var rest$44122;var x$44115;var $44087$44102;var $44088$44103;var t0$44100;var $44083$44095;var ph$44089;(ph$44089=$44078$44081);($44083$44095=ph$44089);if((($44087$44102=($44083$44095 instanceof Array))&&(((t0$44100=$44083$44095.length)),(t0$44100===0)))){return [];}else{if(($44087$44102&&(t0$44100===1))){(x$44115=$44083$44095[0]);return [];}else{if(($44087$44102&&(t0$44100>=2))){(x$44120=$44083$44095[0]);(y$44121=$44083$44095[1]);(rest$44122=Array.prototype.slice.call($44083$44095,2));return [[x$44120,y$44121]].concat(neighbours$43741([y$44121].concat(rest$44122)));}else{$43443($44083$44095);}}}}));(partition$43742=(function(xs$44132,predicate$44133){var $index$44165;var $length$44159;var temp$44153;var t$44138;var f$44139;(t$44138=[]);(f$44139=[]);(temp$44153=xs$44132);($length$44159=temp$44153.length);($index$44165=0);$44140:for(;($index$44165<$length$44159);($index$44165++)){var x$44187;var x$44182;var m$44174;(m$44174=temp$44153[$index$44165]);(x$44182=m$44174);if(predicate$44133(x$44182)){t$44138.push(x$44182);}else{(x$44187=m$44174);f$44139.push(x$44187);}}return [t$44138,f$44139];}));(product$43743=(function(a$44194,b$44195){var $index$44221;var $length$44215;var temp$44209;var results$44199;(results$44199=[]);(temp$44209=a$44194);($length$44215=temp$44209.length);($index$44221=0);$44200:for(;($index$44221<$length$44215);($index$44221++)){var $index$44263;var $length$44257;var temp$44251;var acc$44245;var x$44238;var m$44230;(m$44230=temp$44209[$index$44221]);(x$44238=m$44230);(results$44199=results$44199.concat((((acc$44245=[])),(((temp$44251=b$44195)),((($length$44257=temp$44251.length)),((($index$44263=0)),(function(){$44240:for(;($index$44263<$length$44257);($index$44263++)){var y$44280;var m$44272;(m$44272=temp$44251[$index$44263]);(y$44280=m$44272);acc$44245.push([x$44238,y$44280]);}})()))),acc$44245)));}return results$44199;}));(construct$43744=(function($44287$44290,fn$44291,zero$44292){var x$44331;var rest$44332;var x$44326;var $44298$44313;var $44299$44314;var t0$44311;var $44294$44306;var ph$44300;(ph$44300=$44287$44290);($44294$44306=ph$44300);if((($44298$44313=($44294$44306 instanceof Array))&&(((t0$44311=$44294$44306.length)),(t0$44311===0)))){return zero$44292;}else{if(($44298$44313&&(t0$44311===1))){(x$44326=$44294$44306[0]);return x$44326;}else{if(($44298$44313&&(t0$44311>=1))){(x$44331=$44294$44306[0]);(rest$44332=Array.prototype.slice.call($44294$44306,1));return fn$44291(x$44331,construct$43744(rest$44332,fn$44291,zero$44292));}else{$43443($44294$44306);}}}}));(mkset$43745=(function(xs$44342){var $index$44368;var $length$44362;var temp$44356;var rval$44346;(rval$44346=({}));(temp$44356=xs$44342);($length$44362=temp$44356.length);($index$44368=0);$44347:for(;($index$44368<$length$44362);($index$44368++)){var x$44385;var m$44377;(m$44377=temp$44356[$index$44368]);(x$44385=m$44377);(rval$44346[x$44385]=true);}return rval$44346;}));(Body$43746=(function($44395$44398){var t0$44406;var xs$44424;var t0$44420;var $44400$44415;var ph$44403;var x$44404;(t0$44406=$44395$44398);(x$44404=t0$44406);(ph$44403=t0$44406);($44400$44415=ph$44403);if((($44400$44415 instanceof Array)&&(((t0$44420=$44400$44415.length)),((t0$44420>=1)&&($44400$44415[0]==="multi"))))){(xs$44424=Array.prototype.slice.call($44400$44415,1));return xs$44424;}else{$44400$44415;return [x$44404];}}));(exports["GenSym"]=GenSym$43735);(exports["gensym"]=gensym$43736);(exports["identity"]=identity$43737);(exports["binsearch"]=binsearch$43738);(exports["classify"]=classify$43739);(exports["classify_contiguous"]=classify_contiguous$43740);(exports["neighbours"]=neighbours$43741);(exports["partition"]=partition$43742);(exports["construct"]=construct$43744);(exports["mkset"]=mkset$43745);(exports["product"]=product$43743);(exports["Body"]=Body$43746);
