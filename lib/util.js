var τ2235=function(type){var τ2236=type["::check"];var f;if((τ2236===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ2236),true)){return function(value){return f.call(type,value);};}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2236}));}}};
var τ2237=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};
var τ2227=function(){var τ2228=function(tags){var τ2229=function(){if((!τ2235(τ2228)(this))){return Object.create(τ2228.prototype);}else{return this;}}();(τ2229["tags"]=tags);return τ2229;};τ2237(τ2228);(τ2228.prototype["create"]=function(){var τ2230=Array.prototype.slice.call(arguments,0);var τp0;var message;var args;if(((τ2230 instanceof Array)&&(((τp0=τ2230.length),true)&&((τp0>=0)&&((message=function(){if((0>=τp0)){return "";}else{return τ2230[0];}}()),true,(args=τ2230.slice(1)),true))))){var τ2229=this;var e=Error(message);(e["::tags"]=τ2229.tags);(e["args"]=args);(e["name"]=["E"].concat(τ2229.tags).join("."));return e;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2230}));}});(τ2228.prototype["::check"]=function(e){var τ2229=this;if(((!e)||(!τ2235(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var τ2231=τ2229.tags;var τ2232=τ2231.length;for(var τ2233=0;(τ2233<τ2232);(τ2233++)){var τ2234=τ2231[τ2233];var tag;var other;if(((tag=τ2234),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=τ2234),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2234}));}}}false;return true;});(τ2228.prototype["::deconstruct"]=function(e){var τ2229=this;return e.args;});return τ2228;}();
var τ2238=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ2239=function(τ2240){var τ2241=τ2240;var x;var x;var other;if((((typeof(τ2241)==="string")&&((x=τ2241),true))||((typeof(τ2241)==="number")&&((x=τ2241),true)))){return ["value",x];}else{if(((other=τ2241),true)){return other["::serialize_ast"]();}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2241}));}}};
var send=function(obj,τ2220){var msg;var τ2219;(msg=τ2220);true;(τ2219=τ2220);var τ2221=τ2219;var other;if(((typeof(τ2221)==="string")||(typeof(τ2221)==="number"))){return obj[msg];}else{if(((other=τ2221),true)){return obj["::send"](msg);}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2221}));}}};(Array[":::project"]=function(τ2223){var value;var τ2222;(value=τ2223);true;(τ2222=τ2223);var τ2224=τ2222;var _;if(τ2235(Array)(τ2224)){return [true,value];}else{if(((_=τ2224),true)){return [true,[value]];}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2224}));}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ2238(["array"],this.map(τ2239));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ2225=value.match(this);var m;var m;if(((τ2225===null)&&((m=τ2225),true))){return [false,null];}else{if(((m=τ2225),true)){return [true,m];}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2225}));}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ2226=value.match(this);var m;var m;if(((τ2226===null)&&((m=τ2226),true))){return [false,null];}else{if(((m=τ2226),true)){return [true,m];}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2226}));}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var GenSym=function(prefix){var id=0;return function(){var τ2242=Array.prototype.slice.call(arguments,0);var τp0;var pfx;if(((τ2242 instanceof Array)&&(((τp0=τ2242.length),true)&&(((τp0>=0)&&(τp0<=1))&&((pfx=function(){if((0>=τp0)){return null;}else{return τ2242[0];}}()),true))))){var r=(((pfx||"")+prefix)+[true,String(id)][1]);(id++);return r;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2242}));}};};var gensym=GenSym("$");var uuid=function(){return gensym("#");};var identity=function(x){return x;};var items=function(obj){var results=[];for(k in obj){results.push([k,send(obj,k)]);}return results;};var keys=function(obj){var results=[];for(k in obj){results.push(k);}return results;};var enumerate=function(arr){var results=[];var l=arr.length;for(var i=0;(i<l);(i++)){results.push([i,send(arr,i)]);}return results;};var binsearch=function(xs,x){var lo=0;var hi=(xs.length-1);while((lo<=hi)){var mid=(lo+((hi-lo)>>1));var v=send(xs,mid);var τ2243=send(xs,mid);var _;if((τ2243<x)){(lo=(mid+1));}else{if((τ2243>x)){(hi=(mid-1));}else{if(((_=τ2243),true)){return (mid+1);}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2243}));}}}}return lo;};var __classify=function(xs){var results=({});while(xs.length){var τ2244=xs.shift();var τp0;var τp1;var newxs;var τp0;var cls;var x;var τ2245=false;var τ2246=false;var τ2247=false;if(((τ2245=(τ2244 instanceof Array))&&((τ2246=((τp0=τ2244.length),true))&&((τ2247=(τp0===2))&&(((τp1=τ2244[0]),(τp1==="splice"))&&((newxs=τ2244[1]),true)))))){(xs=newxs.concat(xs));}else{if((τ2247&&((cls=τ2244[0]),true,(x=τ2244[1]),true))){if((!send(results,cls))){(results[cls]=[]);}else{null;}send(results,cls).push(x);}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2244}));}}}return results;};var classify=function(){var τ2248=Array.prototype.slice.call(arguments,0);var τp0;var classes;var xs;if(((τ2248 instanceof Array)&&(((τp0=τ2248.length),true)&&((τp0>=1)&&((classes=τ2248.slice(0,-1)),true,(xs=send(τ2248,(τp0-1))),true))))){var results=({"rest":[]});var τ2249=classes;var τ2250=τ2249.length;for(var τ2251=0;(τ2251<τ2250);(τ2251++)){var τ2252=τ2249[τ2251];var cls;var other;if(((cls=τ2252),true)){(results[cls]=[]);}else{if(((other=τ2252),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2252}));}}}false;while(xs.length){var τ2253=xs.shift();var τp0;var τp1;var newxs;var τp0;var cls;var x;var other;var τ2254=false;if(((τ2254=(τ2253 instanceof Array))&&(((τp0=τ2253.length),true)&&((τp0>=1)&&(((τp1=τ2253[0]),(τp1==="splice"))&&((newxs=τ2253.slice(1)),true)))))){(xs=newxs.concat(xs));}else{if((τ2254&&(τ2253[0]==="ignore"))){null;}else{if((τ2254&&(((τp0=τ2253.length),true)&&((τp0===2)&&((cls=τ2253[0]),true,(x=τ2253[1]),true,send(results,cls)))))){send(results,cls).push(x);}else{if(((other=τ2253),true)){results.rest.push(other);}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2253}));}}}}}return results;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2248}));}};var classify_contiguous=function(xs,classifier){var groups=[];var currcls=null;var curr=null;var τ2255=xs;var τ2256=τ2255.length;for(var τ2257=0;(τ2257<τ2256);(τ2257++)){var τ2258=τ2255[τ2257];var x;var other;if(((x=τ2258),true)){var cls=classifier(x);if((cls===currcls)){curr.push(x);}else{if(curr){groups.push(curr);}else{null;}(curr=[cls,x]);(currcls=cls);}}else{if(((other=τ2258),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2258}));}}}false;if(curr){groups.push(curr);}else{null;}return groups;};var neighbours=function(τ2259){var τ2260=τ2259;var τp0;var τp0;var x;var τp0;var x;var y;var rest;var τ2261=false;var τ2262=false;if(((τ2261=(τ2260 instanceof Array))&&((τ2262=((τp0=τ2260.length),true))&&(τp0===0)))){return [];}else{if((τ2262&&((τp0===1)&&((x=τ2260[0]),true)))){return [];}else{if((τ2262&&((τp0>=2)&&((x=τ2260[0]),true,(y=τ2260[1]),true,(rest=τ2260.slice(2)),true)))){return [[x,y]].concat(neighbours([y].concat(rest)));}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2260}));}}}};var zip=function(xs,ys){var τ2263=[];var τ2264=enumerate(xs);var τ2265=τ2264.length;for(var τ2266=0;(τ2266<τ2265);(τ2266++)){var τ2267=τ2264[τ2266];var τp0;var i;var x;var other;if(((τ2267 instanceof Array)&&(((τp0=τ2267.length),true)&&((τp0===2)&&((i=τ2267[0]),true,(x=τ2267[1]),true))))){τ2263.push([x,send(ys,i)]);}else{if(((other=τ2267),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2267}));}}}return τ2263;};var partition=function(xs,predicate){var t=[];var f=[];var τ2268=xs;var τ2269=τ2268.length;for(var τ2270=0;(τ2270<τ2269);(τ2270++)){var τ2271=τ2268[τ2270];var x;var x;var other;if(((x=τ2271),true,predicate(x))){t.push(x);}else{if(((x=τ2271),true)){f.push(x);}else{if(((other=τ2271),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2271}));}}}}false;return [t,f];};var construct=function(τ2272,fn,zero){var τ2273=τ2272;var τp0;var τp0;var x;var τp0;var x;var rest;var τ2274=false;var τ2275=false;if(((τ2274=(τ2273 instanceof Array))&&((τ2275=((τp0=τ2273.length),true))&&(τp0===0)))){return zero;}else{if((τ2275&&((τp0===1)&&((x=τ2273[0]),true)))){return x;}else{if((τ2275&&((τp0>=1)&&((x=τ2273[0]),true,(rest=τ2273.slice(1)),true)))){return fn(x,construct(rest,fn,zero));}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2273}));}}}};var set=function(xs){var rval=({});var τ2276=xs;var τ2277=τ2276.length;for(var τ2278=0;(τ2278<τ2277);(τ2278++)){var τ2279=τ2276[τ2278];var x;var other;if(((x=τ2279),true)){(rval[x]=true);}else{if(((other=τ2279),true)){false;}else{throw τ2227(["match"]).create("Could not find a match",({"value":τ2279}));}}}false;return rval;};(exports["GenSym"]=GenSym);(exports["gensym"]=gensym);(exports["uuid"]=uuid);(exports["identity"]=identity);(exports["items"]=items);(exports["keys"]=keys);(exports["enumerate"]=enumerate);(exports["binsearch"]=binsearch);(exports["classify"]=classify);(exports["classify_contiguous"]=classify_contiguous);(exports["neighbours"]=neighbours);(exports["zip"]=zip);(exports["partition"]=partition);(exports["construct"]=construct);(exports["set"]=set);
