var $21257=function(type$21259){var f$21262;(f$21262=type$21259["::check"]);;if((f$21262===(void 0))){return function(value$21267){return (value$21267 instanceof type$21259);};}else{return function(value$21270){return f$21262.call(type$21259,value$21270);};}};
var $21272=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $21273=function($21274$21276){var ph$21280;(ph$21280=$21274$21276);;var $21278$21285;($21278$21285=ph$21280);;var bridge$21279$21290;var x$21294;(bridge$21279$21290=$21278$21285);if((((typeof(bridge$21279$21290)==="string")&&((x$21294=bridge$21279$21290),true))||((typeof(bridge$21279$21290)==="number")&&((x$21294=bridge$21279$21290),true)))){return ["value",x$21294];}else{var other$21301;(other$21301=$21278$21285);return other$21301["::serialize_ast"]();}};
var send$21141;(send$21141=function(obj$21146,$21144$21147){var ph$21151;var msg$21152;var t0$21154;(t0$21154=$21144$21147);(msg$21152=t0$21154);(ph$21151=t0$21154);;var $21149$21158;($21149$21158=ph$21151);;var bridge$21150$21163;(bridge$21150$21163=$21149$21158);if(((typeof(bridge$21150$21163)==="string")||(typeof(bridge$21150$21163)==="number"))){return obj$21146[msg$21152];}else{var other$21171;(other$21171=$21149$21158);return obj$21146["::send"](msg$21152);}});;(Array[":::project"]=function($21174$21176){var ph$21179;var value$21180;var t0$21182;(t0$21182=$21174$21176);(value$21180=t0$21182);(ph$21179=t0$21182);;var $21178$21186;($21178$21186=ph$21179);;if($21257(Array)($21178$21186)){return [true,value$21180];}else{$21178$21186;return [true,[value$21180]];}});(Array.prototype["::check"]=function(value$21200){if((value$21200 instanceof Array)){var i$21205;(i$21205=0);;$21203:for(;(i$21205<this.length);(i$21205++)){if(($21272(this,i$21205)!==$21272(value$21200,i$21205))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return this.slice(0);});(Array.prototype[":::project"]=function(value$21216){if((value$21216 instanceof Array)){var i$21221;(i$21221=0);;$21219:for(;(i$21221<this.length);(i$21221++)){if(($21272(this,i$21221)!==$21272(value$21216,i$21221))){return [true,[value$21216]];}}return [true,value$21216.slice(this.length)];}else{return [true,[value$21216]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($21273));});(RegExp.prototype["::check"]=function(value$21232){return value$21232.match(this);});(RegExp.prototype[":::project"]=function(value$21235){var $21237$21239;($21237$21239=value$21235.match(this));;var m$21247;if(($21237$21239===null)){(m$21247=$21237$21239);return [false,null];}else{var m$21252;(m$21252=$21237$21239);return [true,m$21252];}});(Function.prototype["::send"]=function(args$21255){return this.apply(this,args$21255);});
var $22080=function(dest$22082,values$22083){var k$22088;(k$22088=null);$22086:for(k$22088 in values$22083){if(values$22083.hasOwnProperty(k$22088)){(dest$22082[k$22088]=values$22083[k$22088]);}}return dest$22082;};
var $21973=function(){var $21974$21976;($21974$21976=function(tags$21980){var it$0$21983;(it$0$21983=function(){if((!$21257($21974$21976)(this))){return Object.create($21974$21976.prototype);}else{return this;}}());;(it$0$21983["tags"]=tags$21980);return it$0$21983;});;($21974$21976.prototype["create"]=function(){var $21992$21994;($21992$21994=arguments);;var t0$21999;var message$22003;var args$22004;(t0$21999=$21992$21994.length);if((t0$21999>=0)){(message$22003=function(){if((0>=t0$21999)){return "";}else{return $21992$21994[0];}}());(args$22004=Array.prototype.slice.call($21992$21994,1));var it$0$22008;(it$0$22008=this);;var e$22013;(e$22013=Error(message$22003));;(e$22013["::tags"]=it$0$22008.tags);(e$22013["args"]=args$22004);(e$22013["name"]=["E"].concat(it$0$22008.tags).join("."));return e$22013;}else{$21960($21992$21994);}});($21974$21976.prototype["::check"]=function(e$22022){var it$0$22025;(it$0$22025=this);;var tags$22030;if(((!e$22022)||(!$21257(Error)(e$22022)))){return false;}(tags$22030=(e$22022["::tags"]||[]));;var temp$22039;(temp$22039=it$0$22025.tags);;var $length$22044;($length$22044=temp$22039.length);;var $index$22049;($index$22049=0);;$22031:for(;($index$22049<$length$22044);($index$22049++)){var m$22057;(m$22057=temp$22039[$index$22049]);;var tag$22065;(tag$22065=m$22057);if((tags$22030.indexOf(tag$22065)===(-1))){return false;}else{false;;}}return true;});($21974$21976.prototype["::deconstruct"]=function(e$22073){var it$0$22076;(it$0$22076=this);;return e$22073.args;});$22080($21974$21976,({}));return $21974$21976;}();
var $21960=function(value$21962,url$21963,start$21964,end$21965){var err$21968;(err$21968=$21973(["match"]).create("Could not find a match for value",({"value":value$21962})));;if(url$21963){(err$21968["location"]=["location",url$21963,start$21964,end$21965]);}throw err$21968;};var GenSym$21304;var gensym$21305;var uuid$21306;var identity$21307;var items$21308;var keys$21309;var enumerate$21310;var binsearch$21311;var __classify$21312;var classify$21313;var classify_contiguous$21314;var neighbours$21315;var zip$21316;var partition$21317;var construct$21318;var set$21319;var make_object$21320;(GenSym$21304=function(prefix$21324){var id$21327;(id$21327=0);;return function(){var r$21347;var pfx$21343;var t0$21339;var $21332$21334;($21332$21334=arguments);;(t0$21339=$21332$21334.length);if(((t0$21339>=0)&&(t0$21339<=1))){(pfx$21343=function(){if((0>=t0$21339)){return null;}else{return $21332$21334[0];}}());(r$21347=(((pfx$21343||"")+prefix$21324)+[true,String(id$21327)][1]));;(id$21327++);return r$21347;}else{$21960($21332$21334);}};});;(gensym$21305=GenSym$21304("$"));;(uuid$21306=function(){return gensym$21305("#");});;(identity$21307=function(x$21365){return x$21365;});;(items$21308=function(obj$21371){var k$21380;var results$21375;(results$21375=[]);;(k$21380=null);$21374:for(k$21380 in obj$21371){if(Object.prototype.hasOwnProperty.call(obj$21371,k$21380)){results$21375.push([k$21380,$21272(obj$21371,k$21380)]);}}return results$21375;});;(keys$21309=function(obj$21388){var k$21397;var results$21392;(results$21392=[]);;(k$21397=null);$21391:for(k$21397 in obj$21388){if(Object.prototype.hasOwnProperty.call(obj$21388,k$21397)){results$21392.push(k$21397);}}return results$21392;});;(enumerate$21310=function(arr$21405){var i$21418;var results$21409;var l$21410;(results$21409=[]);;(l$21410=arr$21405.length);;(i$21418=0);;$21408:for(;(i$21418<l$21410);(i$21418++)){results$21409.push([i$21418,$21272(arr$21405,i$21418)]);}return results$21409;});;(binsearch$21311=function(xs$21429,x$21430){var lo$21433;var hi$21434;(lo$21433=0);;(hi$21434=(xs$21429.length-1));;$21441:while((lo$21433<=hi$21434)){var $21445$21455;var mid$21446;var v$21447;(mid$21446=(lo$21433+((hi$21434-lo$21433)>>1)));;(v$21447=$21272(xs$21429,mid$21446));;($21445$21455=$21272(xs$21429,mid$21446));;if(($21445$21455<x$21430)){(lo$21433=(mid$21446+1));}else{if(($21445$21455>x$21430)){(hi$21434=(mid$21446-1));}else{$21445$21455;return (mid$21446+1);}}}return lo$21433;});;(__classify$21312=function(xs$21476){var results$21479;(results$21479=({}));;$21483:while(xs$21476.length){var cls$21509;var x$21510;var newxs$21503;var $21487$21498;var $21488$21499;var $21489$21500;var t0$21496;var $21486$21491;($21486$21491=xs$21476.shift());;if((($21487$21498=($21486$21491 instanceof Array))&&((t0$21496=$21486$21491.length),(($21489$21500=(t0$21496===2))&&($21486$21491[0]==="splice"))))){(newxs$21503=$21486$21491[1]);(xs$21476=newxs$21503.concat(xs$21476));}else{if($21489$21500){(cls$21509=$21486$21491[0]);(x$21510=$21486$21491[1]);if((!$21272(results$21479,cls$21509))){(results$21479[cls$21509]=[]);}$21272(results$21479,cls$21509).push(x$21510);}else{$21960($21486$21491);;}}}return results$21479;});;(classify$21313=function(){var $index$21555;var $length$21550;var temp$21545;var results$21537;var classes$21532;var xs$21533;var t0$21528;var $21521$21523;($21521$21523=arguments);;(t0$21528=$21521$21523.length);if((t0$21528>=1)){(classes$21532=Array.prototype.slice.call($21521$21523,0,-1));(xs$21533=$21521$21523[(t0$21528-1)]);(results$21537=({"rest":[]}));;(temp$21545=classes$21532);;($length$21550=temp$21545.length);;($index$21555=0);;$21538:for(;($index$21555<$length$21550);($index$21555++)){var cls$21571;var m$21563;(m$21563=temp$21545[$index$21555]);;(cls$21571=m$21563);(results$21537[cls$21571]=[]);}$21573:while(xs$21533.length){var x$21595;var other$21611;var cls$21602;var x$21603;var newxs$21587;var t0$21583;var $21576$21578;($21576$21578=xs$21533.shift());;if((($21576$21578 instanceof Array)&&((t0$21583=$21576$21578.length),((t0$21583>=1)&&($21576$21578[0]==="splice"))))){(newxs$21587=Array.prototype.slice.call($21576$21578,1));(xs$21533=newxs$21587.concat(xs$21533));}else{if((((x$21595=$21576$21578)),((x$21595 instanceof Array)&&(x$21595[0]==="ignore")))){null;}else{if((($21576$21578 instanceof Array)&&((t0$21583=$21576$21578.length),((t0$21583===2)&&((cls$21602=$21576$21578[0]),((x$21603=$21576$21578[1]),$21272(results$21537,cls$21602))))))){$21272(results$21537,cls$21602).push(x$21603);}else{(other$21611=$21576$21578);results$21537.rest.push(other$21611);}}}}return results$21537;}else{$21960($21521$21523);}});;(classify_contiguous$21314=function(xs$21619,classifier$21620){var $index$21649;var $length$21644;var temp$21639;var groups$21623;var currcls$21624;var curr$21625;(groups$21623=[]);;(currcls$21624=null);;(curr$21625=null);;(temp$21639=xs$21619);;($length$21644=temp$21639.length);;($index$21649=0);;$21626:for(;($index$21649<$length$21644);($index$21649++)){var cls$21668;var x$21665;var m$21657;(m$21657=temp$21639[$index$21649]);;(x$21665=m$21657);(cls$21668=classifier$21620(x$21665));;if((cls$21668===currcls$21624)){curr$21625.push(x$21665);}else{if(curr$21625){groups$21623.push(curr$21625);}(curr$21625=[cls$21668,x$21665]);(currcls$21624=cls$21668);}}if(curr$21625){groups$21623.push(curr$21625);}return groups$21623;});;(neighbours$21315=function($21678$21680){var x$21711;var y$21712;var rest$21713;var x$21706;var $21683$21697;var $21684$21698;var t0$21695;var $21682$21690;var ph$21685;(ph$21685=$21678$21680);;($21682$21690=ph$21685);;if((($21683$21697=($21682$21690 instanceof Array))&&((t0$21695=$21682$21690.length),(t0$21695===0)))){return [];}else{if(($21683$21697&&(t0$21695===1))){(x$21706=$21682$21690[0]);return [];}else{if(($21683$21697&&(t0$21695>=2))){(x$21711=$21682$21690[0]);(y$21712=$21682$21690[1]);(rest$21713=Array.prototype.slice.call($21682$21690,2));return [[x$21711,y$21712]].concat(neighbours$21315([y$21712].concat(rest$21713)));}else{$21960($21682$21690);}}}});;(zip$21316=function(xs$21722,ys$21723){var $index$21743;var $length$21738;var temp$21733;var acc$21728;(acc$21728=[]);;(temp$21733=enumerate$21310(xs$21722));;($length$21738=temp$21733.length);;($index$21743=0);;$21725:for(;($index$21743<$length$21738);($index$21743++)){var i$21761;var x$21762;var t0$21756;var t1$21757;var m$21751;(m$21751=temp$21733[$index$21743]);;(t0$21756=m$21751);if(((t0$21756 instanceof Array)&&((t1$21757=t0$21756.length),(t1$21757===2)))){(i$21761=t0$21756[0]);(x$21762=t0$21756[1]);acc$21728.push([x$21762,$21272(ys$21723,i$21761)]);}else{$21960(m$21751,"/home/olivier/git/earl-grey/src/util.eg",2248,2300);;}}return acc$21728;});;(partition$21317=function(xs$21772,predicate$21773){var $index$21798;var $length$21793;var temp$21788;var t$21776;var f$21777;(t$21776=[]);;(f$21777=[]);;(temp$21788=xs$21772);;($length$21793=temp$21788.length);;($index$21798=0);;$21778:for(;($index$21798<$length$21793);($index$21798++)){var x$21819;var x$21814;var m$21806;(m$21806=temp$21788[$index$21798]);;(x$21814=m$21806);if(predicate$21773(x$21814)){t$21776.push(x$21814);}else{(x$21819=m$21806);f$21777.push(x$21819);}}return [t$21776,f$21777];});;(construct$21318=function($21824$21826,fn$21827,zero$21828){var x$21859;var rest$21860;var x$21854;var $21831$21845;var $21832$21846;var t0$21843;var $21830$21838;var ph$21833;(ph$21833=$21824$21826);;($21830$21838=ph$21833);;if((($21831$21845=($21830$21838 instanceof Array))&&((t0$21843=$21830$21838.length),(t0$21843===0)))){return zero$21828;}else{if(($21831$21845&&(t0$21843===1))){(x$21854=$21830$21838[0]);return x$21854;}else{if(($21831$21845&&(t0$21843>=1))){(x$21859=$21830$21838[0]);(rest$21860=Array.prototype.slice.call($21830$21838,1));return fn$21827(x$21859,construct$21318(rest$21860,fn$21827,zero$21828));}else{$21960($21830$21838);}}}});;(set$21319=function(xs$21869){var $index$21890;var $length$21885;var temp$21880;var rval$21872;(rval$21872=({}));;(temp$21880=xs$21869);;($length$21885=temp$21880.length);;($index$21890=0);;$21873:for(;($index$21890<$length$21885);($index$21890++)){var x$21906;var m$21898;(m$21898=temp$21880[$index$21890]);;(x$21906=m$21898);(rval$21872[x$21906]=true);}return rval$21872;});;(make_object$21320=function(pairs$21912){var $index$21933;var $length$21928;var temp$21923;var rval$21915;(rval$21915=({}));;(temp$21923=pairs$21912);;($length$21928=temp$21923.length);;($index$21933=0);;$21916:for(;($index$21933<$length$21928);($index$21933++)){var k$21951;var v$21952;var t0$21946;var t1$21947;var m$21941;(m$21941=temp$21923[$index$21933]);;(t0$21946=m$21941);if(((t0$21946 instanceof Array)&&((t1$21947=t0$21946.length),(t1$21947===2)))){(k$21951=t0$21946[0]);(v$21952=t0$21946[1]);(rval$21915[k$21951]=v$21952);}else{$21960(m$21941,"/home/olivier/git/earl-grey/src/util.eg",2652,2695);;}}return rval$21915;});;(exports["GenSym"]=GenSym$21304);(exports["gensym"]=gensym$21305);(exports["uuid"]=uuid$21306);(exports["identity"]=identity$21307);(exports["items"]=items$21308);(exports["keys"]=keys$21309);(exports["enumerate"]=enumerate$21310);(exports["binsearch"]=binsearch$21311);(exports["classify"]=classify$21313);(exports["classify_contiguous"]=classify_contiguous$21314);(exports["neighbours"]=neighbours$21315);(exports["zip"]=zip$21316);(exports["partition"]=partition$21317);(exports["construct"]=construct$21318);(exports["set"]=set$21319);(exports["make_object"]=make_object$21320);
