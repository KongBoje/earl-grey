require("earlgrey-runtime");
var $31897=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});var GenSym$31205;var gensym$31206;var identity$31207;var binsearch$31208;var classify$31209;var classify_contiguous$31210;var partition$31211;var product$31212;var construct$31213;var mkset$31214;var Body$31215;(GenSym$31205=(function(prefix$31220){var id$31225;(id$31225=0);return (function(){var r$31252;var pfx$31243;var t0$31239;var $31230$31234;($31230$31234=arguments);(t0$31239=$31230$31234.length);if(((t0$31239>=0)&&(t0$31239<=1))){(pfx$31243=(function(){if((0>=t0$31239)){return "";}else{return $31230$31234[0];}})());(r$31252=((pfx$31243+prefix$31220)+[true,String(id$31225)][1]));(id$31225++);return r$31252;}else{___match_error($31230$31234);}});}));(gensym$31206=GenSym$31205("$"));(identity$31207=(function(x$31266){return x$31266;}));(binsearch$31208=(function(xs$31273,x$31274){var lo$31279;var hi$31280;(lo$31279=0);(hi$31280=(xs$31273.length-1));$31287:while((lo$31279<=hi$31280)){var $31293$31307;var mid$31297;var v$31298;(mid$31297=(lo$31279+((hi$31280-lo$31279)>>1)));(v$31298=$31897(xs$31273,mid$31297));($31293$31307=$31897(xs$31273,mid$31297));if(($31293$31307<x$31274)){(lo$31279=(mid$31297+1));}else{if(($31293$31307>x$31274)){(hi$31280=(mid$31297-1));}else{$31293$31307;return (mid$31297+1);}}}return lo$31279;}));(classify$31209=(function(){var $index$31382;var $length$31376;var temp$31370;var results$31360;var classes$31350;var xs$31351;var t0$31346;var $31337$31341;($31337$31341=arguments);(t0$31346=$31337$31341.length);if((t0$31346>=1)){(classes$31350=Array.prototype.slice.call($31337$31341,0,-1));(xs$31351=$31337$31341[(t0$31346-1)]);(results$31360=({"rest":[]}));(temp$31370=classes$31350);($length$31376=temp$31370.length);($index$31382=0);$31361:for(;($index$31382<$length$31376);($index$31382++)){var cls$31399;var m$31391;(m$31391=temp$31370[$index$31382]);(cls$31399=m$31391);(results$31360[cls$31399]=[]);}$31405:while(xs$31351.length){var x$31441;var other$31461;var cls$31448;var x$31449;var newxs$31424;var t0$31420;var $31408$31415;($31408$31415=xs$31351.shift());if((($31408$31415 instanceof Array)&&(((t0$31420=$31408$31415.length)),((t0$31420>=1)&&($31408$31415[0]==="splice"))))){(newxs$31424=Array.prototype.slice.call($31408$31415,1));(xs$31351=newxs$31424.concat(xs$31351));}else{if((((x$31441=$31408$31415)),((x$31441 instanceof Array)&&(x$31441[0]==="ignore")))){null;}else{if((($31408$31415 instanceof Array)&&(((t0$31420=$31408$31415.length)),((t0$31420===2)&&((cls$31448=$31408$31415[0]),((x$31449=$31408$31415[1]),$31897(results$31360,cls$31448))))))){$31897(results$31360,cls$31448).push(x$31449);}else{(other$31461=$31408$31415);results$31360.rest.push(other$31461);}}}}return results$31360;}else{___match_error($31337$31341);}}));(classify_contiguous$31210=(function(xs$31470,classifier$31471){var $index$31507;var $length$31501;var temp$31495;var groups$31477;var currcls$31478;var curr$31479;(groups$31477=[]);(currcls$31478=null);(curr$31479=null);(temp$31495=xs$31470);($length$31501=temp$31495.length);($index$31507=0);$31480:for(;($index$31507<$length$31501);($index$31507++)){var cls$31528;var x$31524;var m$31516;(m$31516=temp$31495[$index$31507]);(x$31524=m$31516);(cls$31528=classifier$31471(x$31524));if((cls$31528===currcls$31478)){curr$31479.push(x$31524);}else{if(curr$31479){groups$31477.push(curr$31479);}(curr$31479=[cls$31528,x$31524]);(currcls$31478=cls$31528);}}if(curr$31479){groups$31477.push(curr$31479);}return groups$31477;}));(partition$31211=(function(xs$31548,predicate$31549){var $index$31581;var $length$31575;var temp$31569;var t$31554;var f$31555;(t$31554=[]);(f$31555=[]);(temp$31569=xs$31548);($length$31575=temp$31569.length);($index$31581=0);$31556:for(;($index$31581<$length$31575);($index$31581++)){var x$31603;var x$31598;var m$31590;(m$31590=temp$31569[$index$31581]);(x$31598=m$31590);if(predicate$31549(x$31598)){t$31554.push(x$31598);}else{(x$31603=m$31590);f$31555.push(x$31603);}}return [t$31554,f$31555];}));(product$31212=(function(a$31610,b$31611){var $index$31637;var $length$31631;var temp$31625;var results$31615;(results$31615=[]);(temp$31625=a$31610);($length$31631=temp$31625.length);($index$31637=0);$31616:for(;($index$31637<$length$31631);($index$31637++)){var $index$31679;var $length$31673;var temp$31667;var acc$31661;var x$31654;var m$31646;(m$31646=temp$31625[$index$31637]);(x$31654=m$31646);(results$31615=results$31615.concat((((acc$31661=[])),(((temp$31667=b$31611)),((($length$31673=temp$31667.length)),((($index$31679=0)),(function(){$31656:for(;($index$31679<$length$31673);($index$31679++)){var y$31696;var m$31688;(m$31688=temp$31667[$index$31679]);(y$31696=m$31688);acc$31661.push([x$31654,y$31696]);}})()))),acc$31661)));}return results$31615;}));(construct$31213=(function($31703$31706,fn$31707,zero$31708){var x$31747;var rest$31748;var x$31742;var $31714$31729;var $31715$31730;var t0$31727;var $31710$31722;var ph$31716;(ph$31716=$31703$31706);($31710$31722=ph$31716);if((($31714$31729=($31710$31722 instanceof Array))&&(((t0$31727=$31710$31722.length)),(t0$31727===0)))){return zero$31708;}else{if(($31714$31729&&(t0$31727===1))){(x$31742=$31710$31722[0]);return x$31742;}else{if(($31714$31729&&(t0$31727>=1))){(x$31747=$31710$31722[0]);(rest$31748=Array.prototype.slice.call($31710$31722,1));return fn$31707(x$31747,construct$31213(rest$31748,fn$31707,zero$31708));}else{___match_error($31710$31722);}}}}));(mkset$31214=(function(xs$31758){var $index$31784;var $length$31778;var temp$31772;var rval$31762;(rval$31762=({}));(temp$31772=xs$31758);($length$31778=temp$31772.length);($index$31784=0);$31763:for(;($index$31784<$length$31778);($index$31784++)){var x$31801;var m$31793;(m$31793=temp$31772[$index$31784]);(x$31801=m$31793);(rval$31762[x$31801]=true);}return rval$31762;}));(Body$31215=(function($31811$31814){var t0$31822;var xs$31840;var t0$31836;var $31816$31831;var ph$31819;var x$31820;(t0$31822=$31811$31814);(x$31820=t0$31822);(ph$31819=t0$31822);($31816$31831=ph$31819);if((($31816$31831 instanceof Array)&&(((t0$31836=$31816$31831.length)),((t0$31836>=1)&&($31816$31831[0]==="multi"))))){(xs$31840=Array.prototype.slice.call($31816$31831,1));return xs$31840;}else{$31816$31831;return [x$31820];}}));(exports["GenSym"]=GenSym$31205);(exports["gensym"]=gensym$31206);(exports["identity"]=identity$31207);(exports["binsearch"]=binsearch$31208);(exports["classify"]=classify$31209);(exports["classify_contiguous"]=classify_contiguous$31210);(exports["partition"]=partition$31211);(exports["construct"]=construct$31213);(exports["mkset"]=mkset$31214);(exports["product"]=product$31212);(exports["Body"]=Body$31215);
