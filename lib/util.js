var $39632=function(type$39635){var f$39639;(f$39639=type$39635["::check"]);if((f$39639===(void 0))){return function(value$39645){return (value$39645 instanceof type$39635);};}else{return function(value$39649){return f$39639.call(type$39635,value$39649);};}};
var $39651=(function(o,m){if(typeof(m)==='string'||typeof(m)==='number'){return o[m];}else{return o['::send'](m);}});
var $39652=function(dest$39655,values$39656){var k$39661;(k$39661=null);$39659:for(k$39661 in values$39656){if(values$39656.hasOwnProperty(k$39661)){(dest$39655[k$39661]=values$39656[k$39661]);}}return dest$39655;};
var $39669=function($39671$39674){var ph$39680;(ph$39680=$39671$39674);var $39676$39686;($39676$39686=ph$39680);var bridge$39678$39691;var x$39695;(bridge$39678$39691=$39676$39686);if((((typeof(bridge$39678$39691)==="string")&&((x$39695=bridge$39678$39691),true))||((typeof(bridge$39678$39691)==="number")&&((x$39695=bridge$39678$39691),true)))){return ["value",x$39695];}else{var other$39706;(other$39706=$39676$39686);return other$39706["::serialize_ast"]();}};
var send$39406;(send$39406=function(obj$39413,$39410$39414){var ph$39420;var msg$39421;var t0$39423;(t0$39423=$39410$39414);(msg$39421=t0$39423);(ph$39420=t0$39423);var $39416$39432;($39416$39432=ph$39420);var bridge$39418$39437;(bridge$39418$39437=$39416$39432);if(((typeof(bridge$39418$39437)==="string")||(typeof(bridge$39418$39437)==="number"))){return obj$39413[msg$39421];}else{var other$39449;(other$39449=$39416$39432);return obj$39413["::send"](msg$39421);}});(Array[":::project"]=function($39455$39458){var ph$39463;var value$39464;var t0$39466;(t0$39466=$39455$39458);(value$39464=t0$39466);(ph$39463=t0$39466);var $39460$39475;($39460$39475=ph$39463);if($39632(Array)($39460$39475)){return [true,value$39464];}else{$39460$39475;return [true,[value$39464]];}});(Array.prototype["::check"]=function(value$39493){if((value$39493 instanceof Array)){var i$39499;(i$39499=0);$39496:for(;(i$39499<this.length);(i$39499++)){if(($39651(this,i$39499)!==$39651(value$39493,i$39499))){return false;}}return true;}else{return false;}});(Array.prototype["::clone"]=function(){return $39652(this.slice(0),this);});(Array.prototype[":::project"]=function(value$39518){if((value$39518 instanceof Array)){var i$39524;(i$39524=0);$39521:for(;(i$39524<this.length);(i$39524++)){if(($39651(this,i$39524)!==$39651(value$39518,i$39524))){return [true,[value$39518]];}}return [true,value$39518.slice(this.length)];}else{return [true,[value$39518]];}});(Array.prototype["::serialize_ast"]=function(){return ["array"].concat(this.map($39669));});(RegExp.prototype["::check"]=function($39542$39545){var ph$39550;(ph$39550=$39542$39545);var $39547$39556;($39547$39556=ph$39550);var value$39564;if((typeof($39547$39556)==="string")){(value$39564=$39547$39556);if(value$39564.match(this)){return true;}else{return false;}}else{var other$39569;(other$39569=$39547$39556);return false;}});(RegExp.prototype[":::project"]=function($39575$39578){var ph$39583;(ph$39583=$39575$39578);var $39580$39589;($39580$39589=ph$39583);var value$39597;if((typeof($39580$39589)==="string")){(value$39597=$39580$39589);var $39600$39605;($39600$39605=value$39597.match(this));var m$39613;if(($39600$39605===null)){(m$39613=$39600$39605);return [false,null];}else{var m$39618;(m$39618=$39600$39605);return [true,m$39618];}}else{var other$39622;(other$39622=$39580$39589);return [false,null];}});(Function.prototype["::send"]=function(args$39629){return this.apply(this,args$39629);});
var $40674=function(arr$40677){var results$40683;var l$40684;(results$40683=[]);(l$40684=arr$40677.length);var i$40693;(i$40693=0);$40682:for(;(i$40693<l$40684);(i$40693++)){results$40683.push([i$40693,$39651(arr$40677,i$40693)]);}return results$40683;};
var $40441=function(){var $40442$40448;($40442$40448=function(tags$40453){var it$0$40456;(it$0$40456=function(){if((!$39632($40442$40448)(this))){return Object.create($40442$40448.prototype);}else{return this;}}());(it$0$40456["tags"]=tags$40453);return it$0$40456;});($40442$40448.prototype["create"]=function(){var it$0$40476;var self$40477;(it$0$40476=this);(self$40477=this);var $40474$40486;($40474$40486=arguments);var t0$40491;var message$40495;var args$40496;(t0$40491=$40474$40486.length);if((t0$40491>=0)){(message$40495=function(){if((0>=t0$40491)){return "";}else{return $40474$40486[0];}}());(args$40496=Array.prototype.slice.call($40474$40486,1));var e$40509;(e$40509=Error(message$40495));(e$40509["::tags"]=it$0$40476.tags);(e$40509["args"]=args$40496);var temp$40525;(temp$40525=$40674(args$40496));var $length$40531;($length$40531=temp$40525.length);var $index$40537;($index$40537=0);$40510:for(;($index$40537<$length$40531);($index$40537++)){var m$40546;(m$40546=temp$40525[$index$40537]);var t0$40551;var t1$40552;var i$40556;var arg$40557;(t0$40551=m$40546);if(((t0$40551 instanceof Array)&&(((t1$40552=t0$40551.length)),(t1$40552===2)))){(i$40556=t0$40551[0]);(arg$40557=t0$40551[1]);(e$40509[i$40556]=arg$40557);}else{$40422(m$40546);}}(e$40509["length"]=args$40496.length);(e$40509["name"]=["E"].concat(it$0$40476.tags).join("."));return e$40509;}else{$40422($40474$40486);}});($40442$40448.prototype["::check"]=function(e$40587){var it$0$40591;var self$40592;(it$0$40591=this);(self$40592=this);var tags$40602;if(((!e$40587)||(!$39632(Error)(e$40587)))){return false;}(tags$40602=(e$40587["::tags"]||[]));var temp$40613;(temp$40613=it$0$40591.tags);var $length$40619;($length$40619=temp$40613.length);var $index$40625;($index$40625=0);$40603:for(;($index$40625<$length$40619);($index$40625++)){var m$40634;(m$40634=temp$40613[$index$40625]);var tag$40642;(tag$40642=m$40634);if((tags$40602.indexOf(tag$40642)===-1)){return false;}else{false;}}return true;});($40442$40448.prototype["::deconstruct"]=function(e$40651){var it$0$40655;var self$40656;(it$0$40655=this);(self$40656=this);return e$40651.args;});$39652($40442$40448,$39652(function(){var accum$40667;(accum$40667=({}));(accum$40667["::name"]="$40442");return accum$40667;}(),function(){var accum$40671;(accum$40671=({}));(accum$40671["::egclass"]=true);return accum$40671;}()));return $40442$40448;}();
var $40422=function(value$40425,url$40426,start$40427,end$40428){var err$40432;(err$40432=$40441(["match"]).create("Could not find a match for value",({"value":value$40425})));if(url$40426){(err$40432["location"]=["location",url$40426,start$40427,end$40428]);}throw err$40432;};var GenSym$39721;var gensym$39722;var identity$39723;var binsearch$39724;var classify$39725;var classify_contiguous$39726;var neighbours$39727;var partition$39728;var product$39729;var construct$39730;var mkset$39731;(GenSym$39721=function(prefix$39736){var id$39741;(id$39741=0);return function(){var r$39768;var pfx$39759;var t0$39755;var $39746$39750;($39746$39750=arguments);(t0$39755=$39746$39750.length);if(((t0$39755>=0)&&(t0$39755<=1))){(pfx$39759=function(){if((0>=t0$39755)){return "";}else{return $39746$39750[0];}}());(r$39768=((pfx$39759+prefix$39736)+[true,String(id$39741)][1]));(id$39741++);return r$39768;}else{$40422($39746$39750);}};});(gensym$39722=GenSym$39721("$"));(identity$39723=function(x$39782){return x$39782;});(binsearch$39724=function(xs$39789,x$39790){var lo$39795;var hi$39796;(lo$39795=0);(hi$39796=(xs$39789.length-1));$39803:while((lo$39795<=hi$39796)){var $39809$39823;var mid$39813;var v$39814;(mid$39813=(lo$39795+((hi$39796-lo$39795)>>1)));(v$39814=$39651(xs$39789,mid$39813));($39809$39823=$39651(xs$39789,mid$39813));if(($39809$39823<x$39790)){(lo$39795=(mid$39813+1));}else{if(($39809$39823>x$39790)){(hi$39796=(mid$39813-1));}else{$39809$39823;return (mid$39813+1);}}}return lo$39795;});(classify$39725=function(){var $index$39898;var $length$39892;var temp$39886;var results$39876;var classes$39866;var xs$39867;var t0$39862;var $39853$39857;($39853$39857=arguments);(t0$39862=$39853$39857.length);if((t0$39862>=1)){(classes$39866=Array.prototype.slice.call($39853$39857,0,-1));(xs$39867=$39853$39857[(t0$39862-1)]);(results$39876=({"rest":[]}));(temp$39886=classes$39866);($length$39892=temp$39886.length);($index$39898=0);$39877:for(;($index$39898<$length$39892);($index$39898++)){var cls$39915;var m$39907;(m$39907=temp$39886[$index$39898]);(cls$39915=m$39907);(results$39876[cls$39915]=[]);}$39921:while(xs$39867.length){var x$39957;var other$39977;var cls$39964;var x$39965;var newxs$39940;var t0$39936;var $39924$39931;($39924$39931=xs$39867.shift());if((($39924$39931 instanceof Array)&&(((t0$39936=$39924$39931.length)),((t0$39936>=1)&&($39924$39931[0]==="splice"))))){(newxs$39940=Array.prototype.slice.call($39924$39931,1));(xs$39867=newxs$39940.concat(xs$39867));}else{if((((x$39957=$39924$39931)),((x$39957 instanceof Array)&&(x$39957[0]==="ignore")))){null;}else{if((($39924$39931 instanceof Array)&&(((t0$39936=$39924$39931.length)),((t0$39936===2)&&((cls$39964=$39924$39931[0]),((x$39965=$39924$39931[1]),$39651(results$39876,cls$39964))))))){$39651(results$39876,cls$39964).push(x$39965);}else{(other$39977=$39924$39931);results$39876.rest.push(other$39977);}}}}return results$39876;}else{$40422($39853$39857);}});(classify_contiguous$39726=function(xs$39986,classifier$39987){var $index$40023;var $length$40017;var temp$40011;var groups$39993;var currcls$39994;var curr$39995;(groups$39993=[]);(currcls$39994=null);(curr$39995=null);(temp$40011=xs$39986);($length$40017=temp$40011.length);($index$40023=0);$39996:for(;($index$40023<$length$40017);($index$40023++)){var cls$40044;var x$40040;var m$40032;(m$40032=temp$40011[$index$40023]);(x$40040=m$40032);(cls$40044=classifier$39987(x$40040));if((cls$40044===currcls$39994)){curr$39995.push(x$40040);}else{if(curr$39995){groups$39993.push(curr$39995);}(curr$39995=[cls$40044,x$40040]);(currcls$39994=cls$40044);}}if(curr$39995){groups$39993.push(curr$39995);}return groups$39993;});(neighbours$39727=function($40063$40066){var x$40105;var y$40106;var rest$40107;var x$40100;var $40072$40087;var $40073$40088;var t0$40085;var $40068$40080;var ph$40074;(ph$40074=$40063$40066);($40068$40080=ph$40074);if((($40072$40087=($40068$40080 instanceof Array))&&(((t0$40085=$40068$40080.length)),(t0$40085===0)))){return [];}else{if(($40072$40087&&(t0$40085===1))){(x$40100=$40068$40080[0]);return [];}else{if(($40072$40087&&(t0$40085>=2))){(x$40105=$40068$40080[0]);(y$40106=$40068$40080[1]);(rest$40107=Array.prototype.slice.call($40068$40080,2));return [[x$40105,y$40106]].concat(neighbours$39727([y$40106].concat(rest$40107)));}else{$40422($40068$40080);}}}});(partition$39728=function(xs$40117,predicate$40118){var $index$40150;var $length$40144;var temp$40138;var t$40123;var f$40124;(t$40123=[]);(f$40124=[]);(temp$40138=xs$40117);($length$40144=temp$40138.length);($index$40150=0);$40125:for(;($index$40150<$length$40144);($index$40150++)){var x$40172;var x$40167;var m$40159;(m$40159=temp$40138[$index$40150]);(x$40167=m$40159);if(predicate$40118(x$40167)){t$40123.push(x$40167);}else{(x$40172=m$40159);f$40124.push(x$40172);}}return [t$40123,f$40124];});(product$39729=function(a$40179,b$40180){var $index$40206;var $length$40200;var temp$40194;var results$40184;(results$40184=[]);(temp$40194=a$40179);($length$40200=temp$40194.length);($index$40206=0);$40185:for(;($index$40206<$length$40200);($index$40206++)){var $index$40248;var $length$40242;var temp$40236;var acc$40230;var x$40223;var m$40215;(m$40215=temp$40194[$index$40206]);(x$40223=m$40215);(results$40184=results$40184.concat((((acc$40230=[])),(((temp$40236=b$40180)),((($length$40242=temp$40236.length)),((($index$40248=0)),function(){$40225:for(;($index$40248<$length$40242);($index$40248++)){var y$40265;var m$40257;(m$40257=temp$40236[$index$40248]);(y$40265=m$40257);acc$40230.push([x$40223,y$40265]);}}()))),acc$40230)));}return results$40184;});(construct$39730=function($40272$40275,fn$40276,zero$40277){var x$40316;var rest$40317;var x$40311;var $40283$40298;var $40284$40299;var t0$40296;var $40279$40291;var ph$40285;(ph$40285=$40272$40275);($40279$40291=ph$40285);if((($40283$40298=($40279$40291 instanceof Array))&&(((t0$40296=$40279$40291.length)),(t0$40296===0)))){return zero$40277;}else{if(($40283$40298&&(t0$40296===1))){(x$40311=$40279$40291[0]);return x$40311;}else{if(($40283$40298&&(t0$40296>=1))){(x$40316=$40279$40291[0]);(rest$40317=Array.prototype.slice.call($40279$40291,1));return fn$40276(x$40316,construct$39730(rest$40317,fn$40276,zero$40277));}else{$40422($40279$40291);}}}});(mkset$39731=function(xs$40327){var $index$40353;var $length$40347;var temp$40341;var rval$40331;(rval$40331=({}));(temp$40341=xs$40327);($length$40347=temp$40341.length);($index$40353=0);$40332:for(;($index$40353<$length$40347);($index$40353++)){var x$40370;var m$40362;(m$40362=temp$40341[$index$40353]);(x$40370=m$40362);(rval$40331[x$40370]=true);}return rval$40331;});(exports["GenSym"]=GenSym$39721);(exports["gensym"]=gensym$39722);(exports["identity"]=identity$39723);(exports["binsearch"]=binsearch$39724);(exports["classify"]=classify$39725);(exports["classify_contiguous"]=classify_contiguous$39726);(exports["neighbours"]=neighbours$39727);(exports["partition"]=partition$39728);(exports["construct"]=construct$39730);(exports["mkset"]=mkset$39731);(exports["product"]=product$39729);
