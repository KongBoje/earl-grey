var τ131=function(type){var τ132=type["::check"];var f;if((τ132===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ132),true)){return function(value){return f.call(type,value);};}else{throw ["Could not find a match",τ132];}}};
var τ133=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ134=function(τ135){var τ136=τ135;var x;var x;var other;if((((typeof(τ136)==="string")&&((x=τ136),true))||((typeof(τ136)==="number")&&((x=τ136),true)))){return ["value",x];}else{if(((other=τ136),true)){return other["::serialize_ast"]();}else{throw ["Could not find a match",τ136];}}};
var send=function(obj,τ124){var msg;var τ123;(msg=τ124);true;(τ123=τ124);var τ125=τ123;var other;if(((typeof(τ125)==="string")||(typeof(τ125)==="number"))){return obj[msg];}else{if(((other=τ125),true)){return obj["::send"](msg);}else{throw ["Could not find a match",τ125];}}};(Array[":::project"]=function(τ127){var value;var τ126;(value=τ127);true;(τ126=τ127);var τ128=τ126;var _;if(τ131(Array)(τ128)){return [true,value];}else{if(((_=τ128),true)){return [true,[value]];}else{throw ["Could not find a match",τ128];}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ133(["array"],this.map(τ134));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ129=value.match(this);var m;var m;if(((τ129===null)&&((m=τ129),true))){return [false,null];}else{if(((m=τ129),true)){return [true,m];}else{throw ["Could not find a match",τ129];}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ130=value.match(this);var m;var m;if(((τ130===null)&&((m=τ130),true))){return [false,null];}else{if(((m=τ130),true)){return [true,m];}else{throw ["Could not find a match",τ130];}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var τ137=require("./location");var __lt____lt____colon__=τ137["<<:"];var aslist=function(τ138){var τ139=τ138;var τp0;var τp1;var args;var other;if(((τ139 instanceof Array)&&(((τp0=τ139.length),true)&&((τp0>=1)&&(((τp1=τ139[0]),(τp1==="multi"))&&((args=τ139.slice(1)),true)))))){return args;}else{if(((other=τ139),true)){return [other];}else{throw ["Could not find a match",τ139];}}};var transform=function(expr,cb){var tr=function(x){return transform(x,cb);};var result=function(){var τ141;try{(τ141=cb.call(tr,expr));}catch(τ140){(τ141=function(){var τ142=expr;var τp0;var τp1;var τp0;var τp1;var s;var τp0;var τp1;var v;var τp0;var name;var args;var τ143=false;var τ144=false;var τ145=false;if(((τ143=(τ142 instanceof Array))&&((τ144=((τp0=τ142.length),true))&&((τp0===1)&&((τp1=τ142[0]),(τp1==="void")))))){return ["void"];}else{if((τ144&&((τ145=(τp0===2))&&(((τp1=τ142[0]),(τp1==="symbol"))&&((s=τ142[1]),true))))){return expr;}else{if((τ145&&(((τp1=τ142[0]),(τp1==="value"))&&((v=τ142[1]),true)))){return expr;}else{if((τ144&&((τp0>=1)&&((name=τ142[0]),true,(args=τ142.slice(1)),true)))){return τ133([name],args.map(tr));}else{throw ["Could not find a match",τ142];}}}}}());}return τ141;}();return __lt____lt____colon__(result,expr);};var gensym_factory=function(prefix){(prefix=("τ"+prefix));var id=0;return function(){var name=(prefix+String(id));(id=(id+1));return ["symbol",name];};};var gensym=gensym_factory("");(exports["aslist"]=aslist);(exports["transform"]=transform);(exports["gensym"]=gensym);(exports["gensym_factory"]=gensym_factory);
