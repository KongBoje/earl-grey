var τ112=function(type){var τ113=type["::check"];var f;if((τ113===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ113),true)){return function(value){return f.call(type,value);};}else{throw ["Could not find a match",τ113];}}};
var τ114=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ115=function(τ116){var τ117=τ116;var x;var x;var other;if((((typeof(τ117)==="string")&&((x=τ117),true))||((typeof(τ117)==="number")&&((x=τ117),true)))){return ["value",x];}else{if(((other=τ117),true)){return other["::serialize_ast"]();}else{throw ["Could not find a match",τ117];}}};
var send=function(obj,τ105){var msg;var τ104;(msg=τ105);true;(τ104=τ105);var τ106=τ104;var other;if(((typeof(τ106)==="string")||(typeof(τ106)==="number"))){return obj[msg];}else{if(((other=τ106),true)){return obj["::send"](msg);}else{throw ["Could not find a match",τ106];}}};(Array[":::project"]=function(τ108){var value;var τ107;(value=τ108);true;(τ107=τ108);var τ109=τ107;var _;if(τ112(Array)(τ109)){return [true,value];}else{if(((_=τ109),true)){return [true,[value]];}else{throw ["Could not find a match",τ109];}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ114(["array"],this.map(τ115));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ110=value.match(this);var m;var m;if(((τ110===null)&&((m=τ110),true))){return [false,null];}else{if(((m=τ110),true)){return [true,m];}else{throw ["Could not find a match",τ110];}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ111=value.match(this);var m;var m;if(((τ111===null)&&((m=τ111),true))){return [false,null];}else{if(((m=τ111),true)){return [true,m];}else{throw ["Could not find a match",τ111];}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var τ118=require("./location");var __lt____lt____colon__=τ118["<<:"];var aslist=function(τ119){var τ120=τ119;var τp0;var τp1;var args;var other;if(((τ120 instanceof Array)&&(((τp0=τ120.length),true)&&((τp0>=1)&&(((τp1=τ120[0]),(τp1==="multi"))&&((args=τ120.slice(1)),true)))))){return args;}else{if(((other=τ120),true)){return [other];}else{throw ["Could not find a match",τ120];}}};var transform=function(expr,cb){var tr=function(x){return transform(x,cb);};var result=function(){var τ122;try{(τ122=cb.call(tr,expr));}catch(τ121){(τ122=function(){var τ123=expr;var τp0;var τp1;var τp0;var τp1;var s;var τp0;var τp1;var v;var τp0;var name;var args;var τ124=false;var τ125=false;var τ126=false;if(((τ124=(τ123 instanceof Array))&&((τ125=((τp0=τ123.length),true))&&((τp0===1)&&((τp1=τ123[0]),(τp1==="void")))))){return ["void"];}else{if((τ125&&((τ126=(τp0===2))&&(((τp1=τ123[0]),(τp1==="symbol"))&&((s=τ123[1]),true))))){return expr;}else{if((τ126&&(((τp1=τ123[0]),(τp1==="value"))&&((v=τ123[1]),true)))){return expr;}else{if((τ125&&((τp0>=1)&&((name=τ123[0]),true,(args=τ123.slice(1)),true)))){return τ114([name],args.map(tr));}else{throw ["Could not find a match",τ123];}}}}}());}return τ122;}();return __lt____lt____colon__(result,expr);};var gensym_factory=function(prefix){(prefix=("τ"+prefix));var id=0;return function(){var name=(prefix+String(id));(id=(id+1));return ["symbol",name];};};var gensym=gensym_factory("");(exports["aslist"]=aslist);(exports["transform"]=transform);(exports["gensym"]=gensym);(exports["gensym_factory"]=gensym_factory);
