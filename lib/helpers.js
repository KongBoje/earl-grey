var τ746=function(type){var τ747=type["::check"];var f;if((τ747===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ747),true)){return function(value){return f.call(type,value);};}else{throw τ738(["match"]).create("Could not find a match",({"value":τ747}));}}};
var τ748=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};
var τ738=function(){var τ739=function(tags){var τ740=function(){if((!τ746(τ739)(this))){return Object.create(τ739.prototype);}else{return this;}}();(τ740["tags"]=tags);return τ740;};τ748(τ739);(τ739.prototype["create"]=function(){var τ741=Array.prototype.slice.call(arguments,0);var τp0;var message;var args;if(((τ741 instanceof Array)&&(((τp0=τ741.length),true)&&((τp0>=0)&&((message=function(){if((0>=τp0)){return "";}else{return τ741[0];}}()),true,(args=τ741.slice(1)),true))))){var τ740=this;var e=Error(message);(e["::tags"]=τ740.tags);(e["args"]=args);(e["name"]=["E"].concat(τ740.tags).join("."));return e;}else{throw τ738(["match"]).create("Could not find a match",({"value":τ741}));}});(τ739.prototype["::check"]=function(e){var τ740=this;if(((!e)||(!τ746(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var τ742=τ740.tags;var τ743=τ742.length;for(var τ744=0;(τ744<τ743);(τ744++)){var τ745=τ742[τ744];var tag;var other;if(((tag=τ745),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=τ745),true)){false;}else{throw τ738(["match"]).create("Could not find a match",({"value":τ745}));}}}false;return true;});(τ739.prototype["::deconstruct"]=function(e){var τ740=this;return e.args;});return τ739;}();
var τ749=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ750=function(τ751){var τ752=τ751;var x;var x;var other;if((((typeof(τ752)==="string")&&((x=τ752),true))||((typeof(τ752)==="number")&&((x=τ752),true)))){return ["value",x];}else{if(((other=τ752),true)){return other["::serialize_ast"]();}else{throw τ738(["match"]).create("Could not find a match",({"value":τ752}));}}};
var send=function(obj,τ731){var msg;var τ730;(msg=τ731);true;(τ730=τ731);var τ732=τ730;var other;if(((typeof(τ732)==="string")||(typeof(τ732)==="number"))){return obj[msg];}else{if(((other=τ732),true)){return obj["::send"](msg);}else{throw τ738(["match"]).create("Could not find a match",({"value":τ732}));}}};(Array[":::project"]=function(τ734){var value;var τ733;(value=τ734);true;(τ733=τ734);var τ735=τ733;var _;if(τ746(Array)(τ735)){return [true,value];}else{if(((_=τ735),true)){return [true,[value]];}else{throw τ738(["match"]).create("Could not find a match",({"value":τ735}));}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ749(["array"],this.map(τ750));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ736=value.match(this);var m;var m;if(((τ736===null)&&((m=τ736),true))){return [false,null];}else{if(((m=τ736),true)){return [true,m];}else{throw τ738(["match"]).create("Could not find a match",({"value":τ736}));}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ737=value.match(this);var m;var m;if(((τ737===null)&&((m=τ737),true))){return [false,null];}else{if(((m=τ737),true)){return [true,m];}else{throw τ738(["match"]).create("Could not find a match",({"value":τ737}));}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var τ753=require("./location");var __lt____lt____colon__=τ753["<<:"];var aslist=function(τ754){var τ755=τ754;var τp0;var τp1;var args;var other;if(((τ755 instanceof Array)&&(((τp0=τ755.length),true)&&((τp0>=1)&&(((τp1=τ755[0]),(τp1==="multi"))&&((args=τ755.slice(1)),true)))))){return args;}else{if(((other=τ755),true)){return [other];}else{throw τ738(["match"]).create("Could not find a match",({"value":τ755}));}}};var transform=function(expr,cb){var tr=function(x){return transform(x,cb);};var result=function(){var τ757;try{(τ757=cb.call(tr,expr));}catch(τ756){(τ757=function(){var τ758=expr;var τp0;var τp1;var τp0;var τp1;var s;var τp0;var τp1;var v;var τp0;var name;var args;var τ759=false;var τ760=false;var τ761=false;if(((τ759=(τ758 instanceof Array))&&((τ760=((τp0=τ758.length),true))&&((τp0===1)&&((τp1=τ758[0]),(τp1==="void")))))){return ["void"];}else{if((τ760&&((τ761=(τp0===2))&&(((τp1=τ758[0]),(τp1==="symbol"))&&((s=τ758[1]),true))))){return expr;}else{if((τ761&&(((τp1=τ758[0]),(τp1==="value"))&&((v=τ758[1]),true)))){return expr;}else{if((τ760&&((τp0>=1)&&((name=τ758[0]),true,(args=τ758.slice(1)),true)))){return τ749([name],args.map(tr));}else{throw τ738(["match"]).create("Could not find a match",({"value":τ758}));}}}}}());}return τ757;}();return __lt____lt____colon__(result,expr);};var gensym_factory=function(prefix){(prefix=("τ"+prefix));var id=0;return function(){var name=(prefix+String(id));(id=(id+1));return ["symbol",name];};};var gensym=gensym_factory("");(exports["aslist"]=aslist);(exports["transform"]=transform);(exports["gensym"]=gensym);(exports["gensym_factory"]=gensym_factory);
