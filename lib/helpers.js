var τ265=function(type){var τ266=type["::check"];var f;if((τ266===(void 0))){return function(value){return (value instanceof type);};}else{if(((f=τ266),true)){return function(value){return f.call(type,value);};}else{throw τ257(["match"]).create("Could not find a match",({"value":τ266}));}}};
var τ267=function(dest,values){for(k in values){if(values.hasOwnProperty(k)){(dest[k]=send(values,k));}else{null;}}return dest;};
var τ257=function(){var τ258=function(tags){var τ259=function(){if((!τ265(τ258)(this))){return Object.create(τ258.prototype);}else{return this;}}();(τ259["tags"]=tags);return τ259;};τ267(τ258);(τ258.prototype["create"]=function(){var τ260=Array.prototype.slice.call(arguments,0);var τp0;var message;var args;if(((τ260 instanceof Array)&&(((τp0=τ260.length),true)&&((τp0>=0)&&((message=function(){if((0>=τp0)){return "";}else{return τ260[0];}}()),true,(args=τ260.slice(1)),true))))){var τ259=this;var e=Error(message);(e["::tags"]=τ259.tags);(e["args"]=args);(e["name"]=["E"].concat(τ259.tags).join("."));return e;}else{throw τ257(["match"]).create("Could not find a match",({"value":τ260}));}});(τ258.prototype["::check"]=function(e){var τ259=this;if(((!e)||(!τ265(Error)(e)))){return false;}else{null;}var tags=(e["::tags"]||[]);var τ261=τ259.tags;var τ262=τ261.length;for(var τ263=0;(τ263<τ262);(τ263++)){var τ264=τ261[τ263];var tag;var other;if(((tag=τ264),true,(tags.indexOf(tag)===(-1)))){return false;}else{if(((other=τ264),true)){false;}else{throw τ257(["match"]).create("Could not find a match",({"value":τ264}));}}}false;return true;});(τ258.prototype["::deconstruct"]=function(e){var τ259=this;return e.args;});return τ258;}();
var τ268=function(){var r=[];for(var i=0;(i<arguments.length);(i++)){(r=r.concat(arguments[i]));}return r;};
var τ269=function(τ270){var τ271=τ270;var x;var x;var other;if((((typeof(τ271)==="string")&&((x=τ271),true))||((typeof(τ271)==="number")&&((x=τ271),true)))){return ["value",x];}else{if(((other=τ271),true)){return other["::serialize_ast"]();}else{throw τ257(["match"]).create("Could not find a match",({"value":τ271}));}}};
var send=function(obj,τ250){var msg;var τ249;(msg=τ250);true;(τ249=τ250);var τ251=τ249;var other;if(((typeof(τ251)==="string")||(typeof(τ251)==="number"))){return obj[msg];}else{if(((other=τ251),true)){return obj["::send"](msg);}else{throw τ257(["match"]).create("Could not find a match",({"value":τ251}));}}};(Array[":::project"]=function(τ253){var value;var τ252;(value=τ253);true;(τ252=τ253);var τ254=τ252;var _;if(τ265(Array)(τ254)){return [true,value];}else{if(((_=τ254),true)){return [true,[value]];}else{throw τ257(["match"]).create("Could not find a match",({"value":τ254}));}}});(Array.prototype["::check"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){return false;}else{null;}}return true;}else{return false;}});(Array.prototype[":::project"]=function(value){if((value instanceof Array)){for(var i=0;(i<this.length);(i++)){if((send(this,i)!==send(value,i))){var rval=this.slice(0);rval.push(value);return [true,rval];}else{null;}}return [true,value];}else{var rval=this.slice(0);rval.push(value);return [true,rval];}});(Array.prototype[":::deconstruct"]=function(value){return [true,value.slice(this.length)];});(Array.prototype["::serialize_ast"]=function(){return τ268(["array"],this.map(τ269));});(RegExp.prototype["::check"]=function(value){return value.match(this);});(RegExp.prototype[":::project"]=function(value){var τ255=value.match(this);var m;var m;if(((τ255===null)&&((m=τ255),true))){return [false,null];}else{if(((m=τ255),true)){return [true,m];}else{throw τ257(["match"]).create("Could not find a match",({"value":τ255}));}}});(RegExp.prototype[":::deconstruct"]=function(value){var τ256=value.match(this);var m;var m;if(((τ256===null)&&((m=τ256),true))){return [false,null];}else{if(((m=τ256),true)){return [true,m];}else{throw τ257(["match"]).create("Could not find a match",({"value":τ256}));}}});(Function.prototype["::send"]=function(args){return this.apply(this,args);});var τ272=require("./location");var __lt____lt____colon__=τ272["<<:"];var aslist=function(τ273){var τ274=τ273;var τp0;var τp1;var args;var other;if(((τ274 instanceof Array)&&(((τp0=τ274.length),true)&&((τp0>=1)&&(((τp1=τ274[0]),(τp1==="multi"))&&((args=τ274.slice(1)),true)))))){return args;}else{if(((other=τ274),true)){return [other];}else{throw τ257(["match"]).create("Could not find a match",({"value":τ274}));}}};var transform=function(expr,cb){var tr=function(x){return transform(x,cb);};var result=function(){var τ276;try{(τ276=cb.call(tr,expr));}catch(τ275){(τ276=function(){var τ277=τ275;var e;var ___exc;if(((e=τ277),true)){var τ278=expr;var τp0;var τp1;var τp0;var τp1;var s;var τp0;var τp1;var v;var τp0;var name;var args;var τ279=false;var τ280=false;var τ281=false;if(((τ279=(τ278 instanceof Array))&&((τ280=((τp0=τ278.length),true))&&((τp0===1)&&((τp1=τ278[0]),(τp1==="void")))))){return ["void"];}else{if((τ280&&((τ281=(τp0===2))&&(((τp1=τ278[0]),(τp1==="symbol"))&&((s=τ278[1]),true))))){return expr;}else{if((τ281&&(((τp1=τ278[0]),(τp1==="value"))&&((v=τ278[1]),true)))){return expr;}else{if((τ280&&((τp0>=1)&&((name=τ278[0]),true,(args=τ278.slice(1)),true)))){return τ268([name],args.map(tr));}else{throw τ257(["match"]).create("Could not find a match",({"value":τ278}));}}}}}else{if(((___exc=τ277),true)){throw ___exc;}else{throw τ257(["match"]).create("Could not find a match",({"value":τ277}));}}}());}return τ276;}();return __lt____lt____colon__(result,expr);};var gensym_factory=function(prefix){(prefix=("τ"+prefix));var id=0;return function(){var name=(prefix+String(id));(id=(id+1));return ["symbol",name];};};var gensym=gensym_factory("");(exports["aslist"]=aslist);(exports["transform"]=transform);(exports["gensym"]=gensym);(exports["gensym_factory"]=gensym_factory);
