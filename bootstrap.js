var ___lib=require("./lib");var special_ops=({"(":"PFX","[":"PFX","{":"PFX",")":"SFX","]":"SFX","}":"SFX",",":"IFX",":":"IFX",".":"PFX"});var regexps=function(){var id=RegExp("(?:^[a-zA-Z$_](?:[a-zA-Z$_0-9]*))");var id_f=function(m,wsb,wsa,last_op){return ["ID","ID",m[0]];};var numr=RegExp("(?:^((?:\\d+))[rR]((?:[A-Za-z0-9_]+))(?:(?:\\.((?:[A-Za-z0-9_]+)))?))");var numr_f=function(m,wsb,wsa,last_op){var _tmp0;var _tmp1;var radix;var int;var frac;if((((_tmp0=m),(_tmp0 instanceof Array))&&(((_tmp1=_tmp0.length),(_tmp1==4))&&(_tmp0[0],true,(radix=_tmp0[1]),true,(int=_tmp0[2]),true,(frac=_tmp0[3]),true)))){false;}else{throw "a condition failed";}(value=parseInt(int.replace(RegExp("_","g"),""),radix));if(frac){(frac=frac.replace(RegExp("_","g"),""));(value=(value+(parseInt(frac,radix)/Math.pow(radix,frac.length))));}else{false;}return ["ID","NUM",value];};var num=RegExp("(?:^((?:[0-9_]+))(?:(?:\\.((?:\\d+)))?)(?:(?:[eE]((?:[+-]?)(?:[0-9_]+)))?))");var num_f=function(m,wsb,wsa,last_op){return ["ID","NUM",parseFloat(m[0].replace(RegExp("_","g"),""))];};var str=RegExp("(?:^\"((?:(?:(?:\\\\\\\\|\\\\\")|[^\"])*))\")");var str_f=function(m,wsb,wsa,last_op){var repl=({"\\\"":"\"","\\\\":"\\","\\n":"\n"});var r=m[1].replace(RegExp("((?:(?:\\\\\"|\\\\\\\\)|\\\\n))","g"),function(m){return ___lib.send(repl,m);});return ["ID","STR",r];};var op=RegExp("(?:^(?:[+\\-*/~\\^<>=%&|?!#.:]+))");var op2=RegExp("(?:^[\\(\\[\\{\\}\\]\\),])");var op3=RegExp("(?:^(?:(?:(?:(?:(?:(?:(?:(?:with|where)|when)|and)|not)|or)|in)|instanceof)|mod)\\b)");var op4=RegExp("(?:^`((?:[A-Za-z0-9_]+))`)");var op_f=function(m,wsb,wsa,last_op){var op=(m[1]||m[0]);if((op in special_ops)){var fixity=___lib.send(special_ops,op);var width=function(){var _tmp2=fixity;var other;var _tmp3;var _tmp4;var _tmp5;if((((_tmp5=_tmp2),(_tmp5=="IFX"))&&(_tmp5,true))){if((wsb||wsa)){return "wide";}else{return "short";}}else{if((((_tmp4=_tmp2),(_tmp4=="SFX"))&&(_tmp4,true))){if(wsb){return "wide";}else{return "short";}}else{if((((_tmp3=_tmp2),(_tmp3=="PFX"))&&(_tmp3,true))){if(wsa){return "wide";}else{return "short";}}else{if(((other=_tmp2),true)){throw "OopsA";}else{throw ["Could not find a match",_tmp2];}}}}}();return ["OP",fixity,width,op];}else{if((wsa&&wsb)){return ["OP",function(){if(last_op){return "PFX";}else{if(true){return "IFX";}else{return false;}}}(),"wide",op];}else{if(((!wsa)&&(!wsb))){return ["OP",function(){if(last_op){return "PFX";}else{if(true){return "IFX";}else{return false;}}}(),"short",op];}else{if(wsa){if(last_op){return ["OP","PFX","wide",op];}else{if(true){return ["OP","SFX","short",op];}else{return false;}}}else{if(wsb){return ["OP","PFX","short",op];}else{if(true){return ["OP","PFX","short",op];}else{return false;}}}}}}};var indent=RegExp("(?:^(?:(?:\n((?: *)))+))");var indent_f=function(m,wsb,wsa,last_op){var ilen=m[1].length;return ["INDENT",ilen];};var cmnt=RegExp("(?:^;(?:[^\n]*))");var cmnt_f=function(m,wsb,wsa,last_op){return ["IGNORE"];};var unkn=RegExp("(?:^.)");var unkn_f=function(m,wsb,wsa,last_op){throw ("unknown character: "+m[0]);};return [[op3,op_f],[id,id_f],[numr,numr_f],[num,num_f],[str,str_f],[op,op_f],[op2,op_f],[op4,op_f],[indent,indent_f],[cmnt,cmnt_f],[unkn,unkn_f]];}();var ws_re=RegExp("(?:^(?: *)(?:(?:\n(?: *)\\\\(?: *))*))");var eol_re=RegExp("(?:^(?: *)(?:\n|$))");var indent_tracker=function(){var curr=false;var stack=[];var stacks=[stack];return function(token){var _tmp6=token;var other;var _tmp7;var _tmp8;var _tmp9;var fixity;var width;var _tmp10;var _tmp12;var _tmp11;var _tmp13;var _tmp14;var _tmp15;var fixity;var width;var _tmp16;var _tmp18;var _tmp17;var _tmp19;var _tmp20;var _tmp21;var stuff;var _tmp22;var _tmp23;var _tmp24;var new_indent;if((((_tmp22=_tmp6),(_tmp22 instanceof Array))&&(((_tmp23=_tmp22.length),(_tmp23==2))&&(((_tmp24=_tmp22[0]),(_tmp24=="INDENT"))&&(_tmp24,true,(new_indent=_tmp22[1]),true))))){if((curr===false)){(curr=new_indent);return [["OP","IFX","wide",","]];}else{if((new_indent>curr)){stack.push(curr);(curr=new_indent);return [["OP","PFX","wide","["]];}else{if((new_indent==curr)){return [["OP","IFX","wide",","]];}else{if((new_indent<curr)){var rval=[];while(((stack.length>0)&&(new_indent<curr))){(curr=stack.pop());rval.push(["OP","SFX","wide","]"]);}rval.push(["OP","IFX","wide",","]);return rval;}else{if(true){throw [curr,new_indent];}else{return false;}}}}}}else{if((((_tmp19=_tmp6),(_tmp19 instanceof Array))&&(((_tmp20=_tmp19.length),(_tmp20>=1))&&(((_tmp21=_tmp19[0]),(_tmp21=="ID"))&&(_tmp21,true,(stuff=_tmp19.slice(1)),true))))){return [token];}else{if((((_tmp13=_tmp6),(_tmp13 instanceof Array))&&(((_tmp14=_tmp13.length),(_tmp14==4))&&(((_tmp15=_tmp13[0]),(_tmp15=="OP"))&&(_tmp15,true,(fixity=_tmp13[1]),true,(width=_tmp13[2]),true,(_tmp16=_tmp13[3]),((((_tmp17=_tmp16),(_tmp17=="["))&&(_tmp17,true))||(((_tmp18=_tmp16),(_tmp18=="{"))&&(_tmp18,true)))))))){stack.push(curr);stacks.push(stack);(stack=[]);(curr=false);return [token];}else{if((((_tmp7=_tmp6),(_tmp7 instanceof Array))&&(((_tmp8=_tmp7.length),(_tmp8==4))&&(((_tmp9=_tmp7[0]),(_tmp9=="OP"))&&(_tmp9,true,(fixity=_tmp7[1]),true,(width=_tmp7[2]),true,(_tmp10=_tmp7[3]),((((_tmp11=_tmp10),(_tmp11=="]"))&&(_tmp11,true))||(((_tmp12=_tmp10),(_tmp12=="}"))&&(_tmp12,true)))))))){var rval=stack.map(function(x){return ["OP","SFX","short","]"];});(stack=stacks.pop());(curr=stack.pop());rval.push(token);return rval;}else{if(((other=_tmp6),true)){return [token];}else{throw ["Could not find a match",_tmp6];}}}}}};};var process_token=function(token,last_op,wsa,wsb,pos,endpos,accum){var _tmp25;var _tmp26;var type;var result;if((((_tmp25=token),(_tmp25 instanceof Array))&&(((_tmp26=_tmp25.length),(_tmp26>=1))&&((type=_tmp25[0]),true,(result=_tmp25.slice(1)),true)))){false;}else{throw "a condition failed";}var _tmp27=type;var other;var _tmp28;var _tmp29;var _tmp30;if((((_tmp30=_tmp27),(_tmp30=="IGNORE"))&&(_tmp30,true))){return last_op;}else{if((((_tmp29=_tmp27),(_tmp29=="ID"))&&(_tmp29,true))){if((!last_op)){var w=["IFX",function(){if(wsb){return "wide";}else{return "short";}}(),"WHITE"];(w["location"]=[pos,pos]);accum.push(w);}else{false;}accum.push(result);return false;}else{if((((_tmp28=_tmp27),(_tmp28=="OP"))&&(_tmp28,true))){if(last_op){var v=["VOID"];(v["location"]=[pos,pos]);accum.push(v);}else{false;}var _tmp31=result[0];var _tmp32;var _tmp33;var _tmp34;if((((_tmp34=_tmp31),(_tmp34=="IFX"))&&(_tmp34,true))){accum.push(result);return true;}else{if((((_tmp33=_tmp31),(_tmp33=="PFX"))&&(_tmp33,true))){if((!last_op)){var w=["IFX",function(){if(wsb){return "wide";}else{return "short";}}(),"WHITE"];(w["location"]=[pos,pos]);var v=["VOID"];(v["location"]=[pos,pos]);accum.push(w);accum.push(v);}else{false;}accum.push(result);return true;}else{if((((_tmp32=_tmp31),(_tmp32=="SFX"))&&(_tmp32,true))){accum.push(result);var v=["VOID"];(v["location"]=[endpos,endpos]);accum.push(v);return false;}else{throw ["Could not find a match",_tmp31];}}}}else{if(((other=_tmp27),true)){throw "OopsB";}else{throw ["Could not find a match",_tmp27];}}}}};var tokenize=function(text){var last_op=true;var results=[];var wsb=text.match(ws_re)[0].length;(text=text.slice(wsb));(pos=wsb);var indent=indent_tracker();while(text){for(var i=0;(i<regexps.length);(++i)){var _tmp35;var _tmp36;var re;var fn;if((((_tmp35=___lib.send(regexps,i)),(_tmp35 instanceof Array))&&(((_tmp36=_tmp35.length),(_tmp36==2))&&((re=_tmp35[0]),true,(fn=_tmp35[1]),true)))){false;}else{throw "a condition failed";}var m=text.match(re);if(m){var skip=m[0].length;var endpos=(pos+skip);(text=text.slice(skip));var wsa=text.match(ws_re)[0].length;var eol=(text.match(eol_re)&&true);var bwsb=(wsb>0);var bwsa=function(){if(eol){return bwsb;}else{return (wsa>0);}}();var token=fn(m,bwsb,bwsa,last_op);var tokens=indent(token);tokens.forEach(function(x){return (last_op=process_token(x,last_op,bwsa,bwsb,pos,endpos,results));});(text=text.slice(wsa));(wsb=wsa);(pos=(endpos+wsa));break;}else{false;}}}if(last_op){var v=["VOID"];(v["location"]=[pos,pos]);results.push(v);}else{false;}return results;};var MAX=(1/0);var order_map=({"IFX":({"wide":({",":[[15,1],[15,1]],"with":[[15,999],[15,10]],"where":[[15,11],[15,10]],"|>":[[15,11],[15,10]],"->":[[15,11],[15,10]],"=>":[[15,11],[15,10]],"=":[[15,11],[15,10]],":=":[[15,11],[15,10]],"+=":[[15,11],[15,10]],"-=":[[15,11],[15,10]],"*=":[[15,11],[15,10]],"/=":[[15,11],[15,10]],"<<=":[[15,11],[15,10]],">>=":[[15,11],[15,10]],">>>=":[[15,11],[15,10]],"when":[[15,100],[15,101]],"||":[[15,110],[15,111]],"&&":[[15,120],[15,121]],"or":[[15,110],[15,111]],"and":[[15,120],[15,121]],"not":[[15,130],[15,131]],"==":[[15,200],[15,201]],"!=":[[15,200],[15,201]],">=":[[15,200],[15,201]],"<=":[[15,200],[15,201]],">":[[15,200],[15,201]],"<":[[15,200],[15,201]],"^.":[[15,400],[15,401]],"|.":[[15,410],[15,411]],"&.":[[15,420],[15,421]],"<<":[[1,500],[1,501]],">>":[[1,500],[1,501]],">>>":[[1,500],[1,501]],"+":[[1,550],[1,551]],"-":[[1,550],[1,551]],"*":[[1,560],[1,561]],"/":[[1,560],[1,561]],"mod":[[1,560],[1,561]],"**":[[1,571],[1,570]],"default":[[8,900],[4,901]],"WHITE":[[15,1000],[15,1001]],":":[[15,1001],[15,2]]}),"short":({"default":[[15,1900],[15,1901]],"WHITE":[[15,2000],[15,2001]],",":[[15,1],[15,1]],":":[[15,1001],[15,2]]})}),"PFX":({"wide":({"default":[[15,MAX],[15,900]],"not":[[15,130],[15,131]],".":[[15,MAX],[15,3000]],"#":[[15,MAX],[15,3000]],"<>":[[15,MAX],[15,5]],"(":[[15,MAX],[15,1]],"[":[[15,MAX],[15,1]],"{":[[15,MAX],[15,1]]}),"short":({"default":[[15,MAX],[15,1900]],".":[[15,MAX],[15,3000]],"#":[[15,MAX],[15,3000]],"(":[[15,MAX],[15,1]],"[":[[15,MAX],[15,1]],"{":[[15,MAX],[15,1]]})}),"SFX":({"wide":({"default":[[15,901],[15,MAX]],")":[[15,1],[15,MAX]],"]":[[15,1],[15,MAX]],"}":[[15,1],[15,MAX]]}),"short":({"default":[[15,1901],[15,MAX]],")":[[15,1],[15,MAX]],"]":[[15,1],[15,MAX]],"}":[[15,1],[15,MAX]]})})});var DONE=(-1);var NONE=0;var LEFT=1;var RIGHT=2;var BOTH=3;var oparse=function(next,order,finalize){var between=finalize(next());var right_op=next();var stack=[];var left_op=null;var current=null;while(true){var o=function(){if(((!left_op)&&(!right_op))){return DONE;}else{if(true){return ((((!left_op)&&RIGHT)||((!right_op)&&LEFT))||order(left_op,right_op));}else{return false;}}}();var _tmp37=o;var other;var _tmp38;var _tmp39;var _tmp40;var _tmp41;var _tmp42;if((((_tmp42=_tmp37),(_tmp42==DONE))&&(_tmp42,true))){return between;}else{if((((_tmp41=_tmp37),(_tmp41==LEFT))&&(_tmp41,true))){current.push(between);(between=finalize(current));var v=stack.pop();(left_op=v[0]);(current=v[1]);}else{if((((_tmp40=_tmp37),(_tmp40==RIGHT))&&(_tmp40,true))){stack.push([left_op,current]);(left_op=right_op);(current=[[right_op],between]);(between=finalize(next()));(right_op=next());}else{if((((_tmp39=_tmp37),(_tmp39==BOTH))&&(_tmp39,true))){current[0].push(right_op);current.push(between);(left_op=right_op);(between=finalize(next()));(right_op=next());}else{if((((_tmp38=_tmp37),(_tmp38==NONE))&&(_tmp38,true))){throw ((("Undefined priority between "+left_op)+" and ")+right_op);}else{if(((other=_tmp37),true)){throw "OopsC";}else{throw ["Could not find a match",_tmp37];}}}}}}}};var consult=function(_tmp43){var _tmp44;var _tmp45;var fixity;var width;var op;if((((_tmp44=_tmp43),(_tmp44 instanceof Array))&&(((_tmp45=_tmp44.length),(_tmp45==3))&&((fixity=_tmp44[0]),true,(width=_tmp44[1]),true,(op=_tmp44[2]),true)))){false;}else{throw "a condition failed";}var map=___lib.send(___lib.send(order_map,fixity),width);return (___lib.send(map,op)||map.default);};var order=function(o1,o2){var _tmp46;var _tmp47;var code1;var ord1;if((((_tmp46=consult(o1)[1]),(_tmp46 instanceof Array))&&(((_tmp47=_tmp46.length),(_tmp47==2))&&((code1=_tmp46[0]),true,(ord1=_tmp46[1]),true)))){false;}else{throw "a condition failed";}var _tmp48;var _tmp49;var code2;var ord2;if((((_tmp48=consult(o2)[0]),(_tmp48 instanceof Array))&&(((_tmp49=_tmp48.length),(_tmp49==2))&&((code2=_tmp48[0]),true,(ord2=_tmp48[1]),true)))){false;}else{throw "a condition failed";}if(((code1&code2)==0)){throw ["Cannot mix",o1,o2];}else{if((ord1>ord2)){return LEFT;}else{if((ord1<ord2)){return RIGHT;}else{if((ord1==ord2)){return BOTH;}else{return false;}}}}};var finalize=function(x){var _tmp50=x;var other;var _tmp51;var _tmp52;var ops;var args;var _tmp53;var _tmp54;var _tmp55;var _tmp56;var _tmp57;var _tmp58;var value;var _tmp59;var _tmp60;var _tmp61;var value;var _tmp62;var _tmp63;var _tmp64;var value;if((((_tmp62=_tmp50),(_tmp62 instanceof Array))&&(((_tmp63=_tmp62.length),(_tmp63==2))&&(((_tmp64=_tmp62[0]),(_tmp64=="ID"))&&(_tmp64,true,(value=_tmp62[1]),true))))){return value;}else{if((((_tmp59=_tmp50),(_tmp59 instanceof Array))&&(((_tmp60=_tmp59.length),(_tmp60==2))&&(((_tmp61=_tmp59[0]),(_tmp61=="NUM"))&&(_tmp61,true,(value=_tmp59[1]),true))))){return ["value",value];}else{if((((_tmp56=_tmp50),(_tmp56 instanceof Array))&&(((_tmp57=_tmp56.length),(_tmp57==2))&&(((_tmp58=_tmp56[0]),(_tmp58=="STR"))&&(_tmp58,true,(value=_tmp56[1]),true))))){return ["value",value];}else{if((((_tmp53=_tmp50),(_tmp53 instanceof Array))&&(((_tmp54=_tmp53.length),(_tmp54==1))&&(((_tmp55=_tmp53[0]),(_tmp55=="VOID"))&&(_tmp55,true))))){return null;}else{if((((_tmp51=_tmp50),(_tmp51 instanceof Array))&&(((_tmp52=_tmp51.length),(_tmp52>=1))&&((ops=_tmp51[0]),true,(args=_tmp51.slice(1)),true)))){(ops=ops.map(function(o){return o[2];}));var op=ops[0];var _tmp65=[ops,args];var other;var _tmp66;var _tmp67;var _tmp68;var _tmp69;var _tmp70;var _tmp71;var a;var b;var _tmp72;var _tmp73;var _tmp74;var _tmp75;var _tmp76;var _tmp77;var _tmp78;var _tmp79;var _tmp80;var _tmp81;var _tmp82;var _tmp83;var _tmp84;var _tmp85;var _tmp86;var _tmp87;var _tmp88;var _tmp89;var _tmp90;var _tmp91;var _tmp92;var _tmp93;var _tmp94;var _tmp96;var _tmp95;var _tmp97;var _tmp98;var _tmp99;var _tmp100;var _tmp101;var _tmp102;var _tmp103;var target;var body;var _tmp104;var _tmp105;var _tmp106;var _tmp107;var _tmp108;var _tmp109;var _tmp110;var f;var body;var _tmp111;var _tmp112;var _tmp113;var _tmp114;var _tmp115;var _tmp116;var _tmp117;var _tmp118;var f;var arg;var body;if((((_tmp111=_tmp65),(_tmp111 instanceof Array))&&(((_tmp112=_tmp111.length),(_tmp112==2))&&(((_tmp113=_tmp111[0]),(_tmp113 instanceof Array))&&(((_tmp114=_tmp113.length),(_tmp114==2))&&(((_tmp115=_tmp113[0]),(_tmp115=="WHITE"))&&((_tmp115,true,(_tmp116=_tmp113[1]),(_tmp116==":"))&&((_tmp116,true,(_tmp117=_tmp111[1]),(_tmp117 instanceof Array))&&(((_tmp118=_tmp117.length),(_tmp118==3))&&((f=_tmp117[0]),true,(arg=_tmp117[1]),true,(body=_tmp117[2]),true)))))))))){return ["send",f,["data",["code",arg],["code",body]]];}else{if((((_tmp104=_tmp65),(_tmp104 instanceof Array))&&(((_tmp105=_tmp104.length),(_tmp105==2))&&(((_tmp106=_tmp104[0]),(_tmp106 instanceof Array))&&(((_tmp107=_tmp106.length),(_tmp107==1))&&(((_tmp108=_tmp106[0]),(_tmp108==":"))&&((_tmp108,true,(_tmp109=_tmp104[1]),(_tmp109 instanceof Array))&&(((_tmp110=_tmp109.length),(_tmp110==2))&&((f=_tmp109[0]),true,(body=_tmp109[1]),true))))))))){return ["send",f,["data",["code",body]]];}else{if((((_tmp97=_tmp65),(_tmp97 instanceof Array))&&(((_tmp98=_tmp97.length),(_tmp98==2))&&(((_tmp99=_tmp97[0]),(_tmp99 instanceof Array))&&(((_tmp100=_tmp99.length),(_tmp100==1))&&(((_tmp101=_tmp99[0]),(_tmp101=="with"))&&((_tmp101,true,(_tmp102=_tmp97[1]),(_tmp102 instanceof Array))&&(((_tmp103=_tmp102.length),(_tmp103==2))&&((target=_tmp102[0]),true,(body=_tmp102[1]),true))))))))){(body=function(){var _tmp130=body;var other;var _tmp131;var _tmp132;var _tmp133;var rest;if((((_tmp131=_tmp130),(_tmp131 instanceof Array))&&(((_tmp132=_tmp131.length),(_tmp132>=1))&&(((_tmp133=_tmp131[0]),(_tmp133=="multi"))&&(_tmp133,true,(rest=_tmp131.slice(1)),true))))){return rest;}else{if(((other=_tmp130),true)){return [body];}else{throw ["Could not find a match",_tmp130];}}}());var _tmp119=target;var other;var _tmp120;var _tmp121;var _tmp122;var args;var _tmp123;var _tmp124;var _tmp125;var f;var _tmp126;var _tmp127;var _tmp128;var args;var _tmp129;if((((_tmp129=_tmp119),(_tmp129===null))&&(_tmp129,true))){return ["data"].concat(body);}else{if((((_tmp123=_tmp119),(_tmp123 instanceof Array))&&(((_tmp124=_tmp123.length),(_tmp124==3))&&(((_tmp125=_tmp123[0]),(_tmp125=="send"))&&((_tmp125,true,(f=_tmp123[1]),true,(_tmp126=_tmp123[2]),(_tmp126 instanceof Array))&&(((_tmp127=_tmp126.length),(_tmp127>=1))&&(((_tmp128=_tmp126[0]),(_tmp128=="data"))&&(_tmp128,true,(args=_tmp126.slice(1)),true)))))))){return ["send",f,["data"].concat(args).concat(body)];}else{if((((_tmp120=_tmp119),(_tmp120 instanceof Array))&&(((_tmp121=_tmp120.length),(_tmp121>=1))&&(((_tmp122=_tmp120[0]),(_tmp122=="data"))&&(_tmp122,true,(args=_tmp120.slice(1)),true))))){return target.concat(body);}else{if(((other=_tmp119),true)){return ["send",target,["data"].concat(body)];}else{throw ["Could not find a match",_tmp119];}}}}}else{if((((_tmp90=_tmp65),(_tmp90 instanceof Array))&&(((_tmp91=_tmp90.length),(_tmp91==2))&&(((_tmp92=_tmp90[0]),(_tmp92 instanceof Array))&&(((_tmp93=_tmp92.length),(_tmp93>=1))&&(((_tmp94=_tmp92[0]),((((_tmp95=_tmp94),(_tmp95=="["))&&(_tmp95,true))||(((_tmp96=_tmp94),(_tmp96==","))&&(_tmp96,true))))&&(_tmp92.slice(1),true,_tmp90[1],true))))))){if((op=="[")){(args=args.slice(1,(-1)));}else{false;}(args=function(){var f=function(x){return (x!==null);};return args.filter(f);}());var result=function(){var _tmp134=args;var other;var _tmp135;var _tmp136;var x;var _tmp137;var _tmp138;if((((_tmp137=_tmp134),(_tmp137 instanceof Array))&&((_tmp138=_tmp137.length),(_tmp138==0)))){throw "At least one expression must be enclosed in []";}else{if((((_tmp135=_tmp134),(_tmp135 instanceof Array))&&(((_tmp136=_tmp135.length),(_tmp136==1))&&((x=_tmp135[0]),true)))){return x;}else{if(((other=_tmp134),true)){return ["multi"].concat(args);}else{throw ["Could not find a match",_tmp134];}}}}();return result;}else{if((((_tmp85=_tmp65),(_tmp85 instanceof Array))&&(((_tmp86=_tmp85.length),(_tmp86==2))&&(((_tmp87=_tmp85[0]),(_tmp87 instanceof Array))&&(((_tmp88=_tmp87.length),(_tmp88>=1))&&(((_tmp89=_tmp87[0]),(_tmp89=="{"))&&(_tmp89,true,_tmp87.slice(1),true,_tmp85[1],true))))))){var f=function(x){return (x!==null);};return ["data"].concat(args.slice(1,(-1)).filter(f));}else{if((((_tmp80=_tmp65),(_tmp80 instanceof Array))&&(((_tmp81=_tmp80.length),(_tmp81==2))&&(((_tmp82=_tmp80[0]),(_tmp82 instanceof Array))&&(((_tmp83=_tmp82.length),(_tmp83==1))&&(((_tmp84=_tmp82[0]),(_tmp84=="WHITE"))&&(_tmp84,true,_tmp80[1],true))))))){return ["send"].concat(args);}else{if((((_tmp72=_tmp65),(_tmp72 instanceof Array))&&(((_tmp73=_tmp72.length),(_tmp73==2))&&(((_tmp74=_tmp72[0]),(_tmp74 instanceof Array))&&(((_tmp75=_tmp74.length),(_tmp75==1))&&((_tmp74[0],true,(_tmp76=_tmp72[1]),(_tmp76 instanceof Array))&&(((_tmp77=_tmp76.length),(_tmp77==2))&&(((_tmp78=_tmp76[0]),(_tmp78===null))&&((_tmp78,true,(_tmp79=_tmp76[1]),(_tmp79===null))&&(_tmp79,true)))))))))){return op;}else{if((((_tmp66=_tmp65),(_tmp66 instanceof Array))&&(((_tmp67=_tmp66.length),(_tmp67==2))&&(((_tmp68=_tmp66[0]),(_tmp68 instanceof Array))&&(((_tmp69=_tmp68.length),(_tmp69==1))&&((_tmp68[0],true,(_tmp70=_tmp66[1]),(_tmp70 instanceof Array))&&(((_tmp71=_tmp70.length),(_tmp71==2))&&((a=_tmp70[0]),true,(b=_tmp70[1]),true)))))))){return ["send",op,["data",a,b]];}else{if(((other=_tmp65),true)){throw ["Unknown node",ops,args];}else{throw ["Could not find a match",_tmp65];}}}}}}}}}}else{if(((other=_tmp50),true)){throw "OopsE";}else{throw ["Could not find a match",_tmp50];}}}}}}};var parse=function(text){var results=tokenize(text);var next=function(){return results.shift();};return oparse(next,order,finalize);};var Env=function(parent){var store=Object();var self=function(expr){return ["bind_env",self,expr];};(self["resolve"]=function(name){var attempt=___lib.send(store,name);if(attempt){return attempt;}else{if(true){return self.parent.resolve(name);}else{return false;}}});(self["register"]=function(name,value){return (store[name]=value);});(self["register_macro"]=function(name,m){return (store[name]=["macro",m]);});(self["fork"]=function(){return Env(self);});(self["parent"]=parent);(self["store"]=store);return self;};var js_contexts=({"js_for":["multi","multi","multi","multi"]});var expand=function(env,context,expr){(expr=expand.step(env,context,expr));var _tmp139=expr;var other;var _tmp140;var _tmp141;var _tmp142;var type;var _tmp143;var _tmp155;var _tmp144;var _tmp154;var _tmp145;var _tmp153;var _tmp146;var _tmp152;var _tmp147;var _tmp151;var _tmp148;var _tmp150;var _tmp149;var args;var _tmp156;var _tmp157;var _tmp158;var lhs;var rhs;var _tmp159;var _tmp160;var _tmp161;var binding;var value;var _tmp162;var _tmp163;var _tmp164;var bindings;var body;var _tmp165;var _tmp166;var _tmp167;var args;var _tmp168;var _tmp169;var _tmp170;var type;var _tmp171;var _tmp179;var _tmp172;var _tmp178;var _tmp173;var _tmp177;var _tmp174;var _tmp176;var _tmp175;var args;var _tmp180;var _tmp181;var _tmp182;var v;var _tmp183;var _tmp184;var _tmp185;var f;var arg;var _tmp186;var _tmp187;var _tmp188;if((((_tmp188=_tmp139),(typeof(_tmp188)=="string"))&&(_tmp188,true))){return expr;}else{if((((_tmp187=_tmp139),(_tmp187===null))&&(_tmp187,true))){return null;}else{if((((_tmp186=_tmp139),(_tmp186===undefined))&&(_tmp186,true))){throw "undefined? why?";}else{if((((_tmp183=_tmp139),(_tmp183 instanceof Array))&&(((_tmp184=_tmp183.length),(_tmp184==3))&&(((_tmp185=_tmp183[0]),(_tmp185=="send"))&&(_tmp185,true,(f=_tmp183[1]),true,(arg=_tmp183[2]),true))))){(f=expand(env,"head",f));return ["send",f,expand(env,"tail",arg)];}else{if((((_tmp180=_tmp139),(_tmp180 instanceof Array))&&(((_tmp181=_tmp180.length),(_tmp181==2))&&(((_tmp182=_tmp180[0]),(_tmp182=="value"))&&(_tmp182,true,(v=_tmp180[1]),true))))){return expr;}else{if((((_tmp168=_tmp139),(_tmp168 instanceof Array))&&(((_tmp169=_tmp168.length),(_tmp169>=1))&&(((_tmp170=_tmp168[0]),(type=_tmp170),true,(_tmp171=_tmp170),(((_tmp172=_tmp171),(((_tmp173=_tmp172),(((_tmp174=_tmp173),((((_tmp175=_tmp174),(_tmp175=="multi"))&&(_tmp175,true))||(((_tmp176=_tmp174),(_tmp176=="code"))&&(_tmp176,true))))||(((_tmp177=_tmp173),(_tmp177=="array"))&&(_tmp177,true))))||(((_tmp178=_tmp172),(_tmp178=="object"))&&(_tmp178,true))))||(((_tmp179=_tmp171),(_tmp179=="splice"))&&(_tmp179,true))))&&((args=_tmp168.slice(1)),true))))){var arr=[];while((args.length>0)){var x=expand.step(env,type,args.shift());var _tmp189=x;var other;var _tmp190;var _tmp191;var _tmp192;var stmts;if((((_tmp190=_tmp189),(_tmp190 instanceof Array))&&(((_tmp191=_tmp190.length),(_tmp191>=1))&&(((_tmp192=_tmp190[0]),(_tmp192=="splice"))&&(_tmp192,true,(stmts=_tmp190.slice(1)),true))))){(args=stmts.concat(args));}else{if(((other=_tmp189),true)){arr.push(x);}else{throw ["Could not find a match",_tmp189];}}}var f=function(x){return expand(env,type,x);};return [type].concat(arr.map(f));}else{if((((_tmp165=_tmp139),(_tmp165 instanceof Array))&&(((_tmp166=_tmp165.length),(_tmp166>=1))&&(((_tmp167=_tmp165[0]),(_tmp167=="data"))&&(_tmp167,true,(args=_tmp165.slice(1)),true))))){var is_obj=false;var obj=["object"];var arr=["array"];while((args.length>0)){var x=expand.step(env,"data",args.shift());var _tmp193=x;var other;var _tmp194;var _tmp195;var _tmp196;var exprs;var _tmp197;var _tmp198;var _tmp199;var k;var v;var _tmp200;var _tmp201;var _tmp202;if((((_tmp200=_tmp193),(_tmp200 instanceof Array))&&(((_tmp201=_tmp200.length),(_tmp201==1))&&(((_tmp202=_tmp200[0]),(_tmp202=="assoc"))&&(_tmp202,true))))){(is_obj=true);}else{if((((_tmp197=_tmp193),(_tmp197 instanceof Array))&&(((_tmp198=_tmp197.length),(_tmp198==3))&&(((_tmp199=_tmp197[0]),(_tmp199=="assoc"))&&(_tmp199,true,(k=_tmp197[1]),true,(v=_tmp197[2]),true))))){(is_obj=true);obj.push(["array",k,v]);}else{if((((_tmp194=_tmp193),(_tmp194 instanceof Array))&&(((_tmp195=_tmp194.length),(_tmp195>=1))&&(((_tmp196=_tmp194[0]),(_tmp196=="splice"))&&(_tmp196,true,(exprs=_tmp194.slice(1)),true))))){(args=exprs.concat(args));}else{if(((other=_tmp193),true)){arr.push(other);}else{throw ["Could not find a match",_tmp193];}}}}}var r=function(){if(((arr.length>1)&&is_obj)){arr.push(obj);return arr;}else{if(is_obj){return obj;}else{if(true){return arr;}else{return false;}}}}();return expand(env,context,r);}else{if((((_tmp162=_tmp139),(_tmp162 instanceof Array))&&(((_tmp163=_tmp162.length),(_tmp163==3))&&(((_tmp164=_tmp162[0]),(_tmp164=="lambda"))&&(_tmp164,true,(bindings=_tmp162[1]),true,(body=_tmp162[2]),true))))){return ["lambda",bindings.map(function(x){return expand(env,"decl",x);}),expand(env,"multi",body)];}else{if((((_tmp159=_tmp139),(_tmp159 instanceof Array))&&(((_tmp160=_tmp159.length),(_tmp160==3))&&(((_tmp161=_tmp159[0]),(_tmp161=="declare"))&&(_tmp161,true,(binding=_tmp159[1]),true,(value=_tmp159[2]),true))))){return ["declare",expand(env,"decl",binding),expand(env,"multi",value)];}else{if((((_tmp156=_tmp139),(_tmp156 instanceof Array))&&(((_tmp157=_tmp156.length),(_tmp157==3))&&(((_tmp158=_tmp156[0]),(_tmp158=="assign"))&&(_tmp158,true,(lhs=_tmp156[1]),true,(rhs=_tmp156[2]),true))))){return ["assign",expand(env,"decl",lhs),expand(env,"multi",rhs)];}else{if((((_tmp140=_tmp139),(_tmp140 instanceof Array))&&(((_tmp141=_tmp140.length),(_tmp141>=1))&&(((_tmp142=_tmp140[0]),(type=_tmp142),true,(_tmp143=_tmp142),(((_tmp144=_tmp143),(((_tmp145=_tmp144),(((_tmp146=_tmp145),(((_tmp147=_tmp146),(((_tmp148=_tmp147),((((_tmp149=_tmp148),(_tmp149=="js_while"))&&(_tmp149,true))||(((_tmp150=_tmp148),(_tmp150=="js_for"))&&(_tmp150,true))))||(((_tmp151=_tmp147),(_tmp151=="js_break"))&&(_tmp151,true))))||(((_tmp152=_tmp146),(_tmp152=="js_continue"))&&(_tmp152,true))))||(((_tmp153=_tmp145),(_tmp153=="js_return"))&&(_tmp153,true))))||(((_tmp154=_tmp144),(_tmp154=="js_throw"))&&(_tmp154,true))))||(((_tmp155=_tmp143),(_tmp155=="if"))&&(_tmp155,true))))&&((args=_tmp140.slice(1)),true))))){var ctxs=(___lib.send(js_contexts,type)||[]);var f=function(x,i){return expand(env,(___lib.send(ctxs,i)||"expr"),x);};return [type].concat(args.map(f));}else{if(((other=_tmp139),true)){throw ["Oops",expr,context];}else{throw ["Could not find a match",_tmp139];}}}}}}}}}}}}};(expand["step"]=function(env,context,expr){var _tmp203=expr;var other;var _tmp204;var _tmp205;var type;var args;var _tmp206;var _tmp207;var _tmp208;var f;var arg;var _tmp209;var _tmp210;var _tmp211;var m;var _tmp212;var _tmp213;var _tmp214;if((((_tmp214=_tmp203),(typeof(_tmp214)=="string"))&&(_tmp214,true))){var v=env.resolve(expr);var _tmp215=[v,context];var other;var _tmp216;var _tmp217;var _tmp218;var _tmp219;var _tmp220;var m;var _tmp221;var _tmp222;var _tmp223;var _tmp224;var _tmp225;var m;var _tmp226;var _tmp227;var _tmp228;var _tmp229;if((((_tmp227=_tmp215),(_tmp227 instanceof Array))&&(((_tmp228=_tmp227.length),(_tmp228==2))&&(((_tmp229=_tmp227[0]),(_tmp229===undefined))&&(_tmp229,true,_tmp227[1],true))))){return expr;}else{if((((_tmp221=_tmp215),(_tmp221 instanceof Array))&&(((_tmp222=_tmp221.length),(_tmp222==2))&&(((_tmp223=_tmp221[0]),(_tmp223 instanceof Array))&&(((_tmp224=_tmp223.length),(_tmp224==2))&&(((_tmp225=_tmp223[0]),(_tmp225=="macro"))&&((_tmp225,true,(m=_tmp223[1]),true,(_tmp226=_tmp221[1]),(_tmp226=="head"))&&(_tmp226,true)))))))){return v;}else{if((((_tmp216=_tmp215),(_tmp216 instanceof Array))&&(((_tmp217=_tmp216.length),(_tmp217==2))&&(((_tmp218=_tmp216[0]),(_tmp218 instanceof Array))&&(((_tmp219=_tmp218.length),(_tmp219==2))&&(((_tmp220=_tmp218[0]),(_tmp220=="macro"))&&(_tmp220,true,(m=_tmp218[1]),true,_tmp216[1],true))))))){return expand.step(env,context,m(env,context,null));}else{if(((other=_tmp215),true)){return v;}else{throw ["Could not find a match",_tmp215];}}}}}else{if((((_tmp213=_tmp203),(_tmp213===null))&&(_tmp213,true))){return null;}else{if((((_tmp212=_tmp203),(_tmp212===undefined))&&(_tmp212,true))){throw "undefined? why?";}else{if((((_tmp209=_tmp203),(_tmp209 instanceof Array))&&(((_tmp210=_tmp209.length),(_tmp210==2))&&(((_tmp211=_tmp209[0]),(_tmp211=="macro"))&&(_tmp211,true,(m=_tmp209[1]),true))))){if((context=="head")){return expr;}else{if(true){return expand.step(env,context,m(env,context,null));}else{return false;}}}else{if((((_tmp206=_tmp203),(_tmp206 instanceof Array))&&(((_tmp207=_tmp206.length),(_tmp207==3))&&(((_tmp208=_tmp206[0]),(_tmp208=="send"))&&(_tmp208,true,(f=_tmp206[1]),true,(arg=_tmp206[2]),true))))){(f=expand.step(env,"head",f));var _tmp230=f;var other;var _tmp231;var _tmp232;var _tmp233;var m;if((((_tmp231=_tmp230),(_tmp231 instanceof Array))&&(((_tmp232=_tmp231.length),(_tmp232==2))&&(((_tmp233=_tmp231[0]),(_tmp233=="macro"))&&(_tmp233,true,(m=_tmp231[1]),true))))){return expand.step(env,context,m(env,context,arg));}else{if(((other=_tmp230),true)){return expr;}else{throw ["Could not find a match",_tmp230];}}}else{if((((_tmp204=_tmp203),(_tmp204 instanceof Array))&&(((_tmp205=_tmp204.length),(_tmp205>=1))&&((type=_tmp204[0]),true,(args=_tmp204.slice(1)),true)))){return expr;}else{if(((other=_tmp203),true)){throw ["Oops2",expr];}else{throw ["Could not find a match",_tmp203];}}}}}}}});var aslist=function(expr){var _tmp234=expr;var other;var _tmp235;var _tmp236;var _tmp237;var args;var _tmp238;var _tmp239;if((((_tmp239=_tmp234),(_tmp239===null))&&(_tmp239,true))){return [null];}else{if((((_tmp238=_tmp234),(_tmp238===undefined))&&(_tmp238,true))){return [undefined];}else{if((((_tmp235=_tmp234),(_tmp235 instanceof Array))&&(((_tmp236=_tmp235.length),(_tmp236>=1))&&(((_tmp237=_tmp235[0]),(_tmp237=="multi"))&&(_tmp237,true,(args=_tmp235.slice(1)),true))))){return args;}else{if(((other=_tmp234),true)){return [other];}else{throw ["Could not find a match",_tmp234];}}}}};var nullenv=({"resolve":function(x){return undefined;}});var stdenv=Env(nullenv);stdenv.register("+","___plus");stdenv.register("-","___minus");stdenv.register("*","___times");stdenv.register("/","___div");stdenv.register("%","___mod");stdenv.register("^","___binxor");stdenv.register("&","___binand");stdenv.register("|","___binor");stdenv.register("~","___binnot");stdenv.register("&&","___and");stdenv.register("||","___or");stdenv.register("and","___and");stdenv.register("or","___or");stdenv.register("not","___not");stdenv.register("===","___is");stdenv.register("!==","___isnt");stdenv.register("!=","___neq");stdenv.register("<","___lt");stdenv.register(">","___gt");stdenv.register("<=","___lte");stdenv.register(">=","___gte");stdenv.register("<<","___shl");stdenv.register(">>","___shr");stdenv.register(">>>","___shr2");stdenv.register("in","___in");stdenv.register("instanceof","___instanceof");stdenv.register("++","___plusplus");stdenv.register("--","___minusminus");stdenv.register("Struct",["send","___lib",["value","Struct"]]);var make_checker=function(value,op){return function(env,context,expr){return ["send",op,["data",expr[1],value]];};};stdenv.register_macro("**",function(env,context,_tmp240){var _tmp241;var _tmp242;var _tmp243;var a;var b;if((((_tmp241=_tmp240),(_tmp241 instanceof Array))&&(((_tmp242=_tmp241.length),(_tmp242==3))&&(((_tmp243=_tmp241[0]),(_tmp243=="data"))&&(_tmp243,true,(a=_tmp241[1]),true,(b=_tmp241[2]),true))))){false;}else{throw "a condition failed";}return ["send",["send","Math",["value","pow"]],["data",a,b]];});stdenv.register_macro("//",function(env,context,_tmp244){var _tmp245;var _tmp246;var _tmp247;var a;var b;if((((_tmp245=_tmp244),(_tmp245 instanceof Array))&&(((_tmp246=_tmp245.length),(_tmp246==3))&&(((_tmp247=_tmp245[0]),(_tmp247=="data"))&&(_tmp247,true,(a=_tmp245[1]),true,(b=_tmp245[2]),true))))){false;}else{throw "a condition failed";}var div=["send","___div",["data",a,b]];return ["send",["send","Math",["value","floor"]],["data",div]];});stdenv.register_macro("<>",function(env,context,_tmp248){var _tmp249;var _tmp250;var _tmp251;var _tmp252;var x;if((((_tmp249=_tmp248),(_tmp249 instanceof Array))&&(((_tmp250=_tmp249.length),(_tmp250==3))&&(((_tmp251=_tmp249[0]),(_tmp251=="data"))&&((_tmp251,true,(_tmp252=_tmp249[1]),(_tmp252===null))&&(_tmp252,true,(x=_tmp249[2]),true)))))){false;}else{throw "a condition failed";}return ["send",["send","___lib",["value","pr"]],["data",x]];});stdenv.register_macro("#",function(env,context,_tmp253){var _tmp254;var _tmp255;var _tmp256;var _tmp257;var tag;if((((_tmp254=_tmp253),(_tmp254 instanceof Array))&&(((_tmp255=_tmp254.length),(_tmp255==3))&&(((_tmp256=_tmp254[0]),(_tmp256=="data"))&&((_tmp256,true,(_tmp257=_tmp254[1]),(_tmp257===null))&&(_tmp257,true,(tag=_tmp254[2]),true)))))){false;}else{throw "a condition failed";}(tag=["value",tag]);var f=function(env,context,expr){if((context=="pattern")){var f=function(env,context,expr){return ["send","___eq",["data",["send",expr[1],["value","#"]],tag]];};return ["check",["macro",f],(expr||["ignore"])];}else{if(true){var _tmp258=expr;var _tmp259;var _tmp260;var _tmp261;var args;var _tmp262;if((((_tmp262=_tmp258),(_tmp262===null))&&(_tmp262,true))){var d=["data",tag];return ["send",["send","___lib",["value","StructFactory"]],d];}else{if((((_tmp259=_tmp258),(_tmp259 instanceof Array))&&(((_tmp260=_tmp259.length),(_tmp260>=1))&&(((_tmp261=_tmp259[0]),(_tmp261=="data"))&&(_tmp261,true,(args=_tmp259.slice(1)),true))))){var d=["data",tag].concat(args);return ["send",["send","___lib",["value","Struct"]],d];}else{throw ["Could not find a match",_tmp258];}}}else{return false;}}};return ["macro",f];});stdenv.register_macro("when",function(env,context,_tmp263){var _tmp264;var _tmp265;var _tmp266;var pattern;var condition;if((((_tmp264=_tmp263),(_tmp264 instanceof Array))&&(((_tmp265=_tmp264.length),(_tmp265==3))&&(((_tmp266=_tmp264[0]),(_tmp266=="data"))&&(_tmp266,true,(pattern=_tmp264[1]),true,(condition=_tmp264[2]),true))))){false;}else{throw "a condition failed";}var _tmp267=pattern;var other;var _tmp268;if((((_tmp268=_tmp267),(_tmp268===null))&&(_tmp268,true))){return ["test",condition,["ignore"]];}else{if(((other=_tmp267),true)){return ["test",condition,pattern];}else{throw ["Could not find a match",_tmp267];}}});var andf=function(env,context,expr){var _tmp269=[context,expr];var other;var _tmp270;var _tmp271;var _tmp272;var _tmp273;var _tmp274;var _tmp275;var _tmp276;var _tmp277;var _tmp278;var a;var b;if((((_tmp273=_tmp269),(_tmp273 instanceof Array))&&(((_tmp274=_tmp273.length),(_tmp274==2))&&(((_tmp275=_tmp273[0]),(_tmp275=="pattern"))&&((_tmp275,true,(_tmp276=_tmp273[1]),(_tmp276 instanceof Array))&&(((_tmp277=_tmp276.length),(_tmp277==3))&&(((_tmp278=_tmp276[0]),(_tmp278=="data"))&&(_tmp278,true,(a=_tmp276[1]),true,(b=_tmp276[2]),true)))))))){return ["all",a,b];}else{if((((_tmp270=_tmp269),(_tmp270 instanceof Array))&&(((_tmp271=_tmp270.length),(_tmp271==2))&&((_tmp270[0],true,(_tmp272=_tmp270[1]),(_tmp272===null))&&(_tmp272,true))))){return "___and";}else{if(((other=_tmp269),true)){return ["send","___and",expr];}else{throw ["Could not find a match",_tmp269];}}}};stdenv.register_macro("&&",andf);stdenv.register_macro("and",andf);var orf=function(env,context,expr){var _tmp279=[context,expr];var other;var _tmp280;var _tmp281;var _tmp282;var _tmp283;var _tmp284;var _tmp285;var _tmp286;var _tmp287;var _tmp288;var a;var b;if((((_tmp283=_tmp279),(_tmp283 instanceof Array))&&(((_tmp284=_tmp283.length),(_tmp284==2))&&(((_tmp285=_tmp283[0]),(_tmp285=="pattern"))&&((_tmp285,true,(_tmp286=_tmp283[1]),(_tmp286 instanceof Array))&&(((_tmp287=_tmp286.length),(_tmp287==3))&&(((_tmp288=_tmp286[0]),(_tmp288=="data"))&&(_tmp288,true,(a=_tmp286[1]),true,(b=_tmp286[2]),true)))))))){return ["any",a,b];}else{if((((_tmp280=_tmp279),(_tmp280 instanceof Array))&&(((_tmp281=_tmp280.length),(_tmp281==2))&&((_tmp280[0],true,(_tmp282=_tmp280[1]),(_tmp282===null))&&(_tmp282,true))))){return "___or";}else{if(((other=_tmp279),true)){return ["send","___or",expr];}else{throw ["Could not find a match",_tmp279];}}}};stdenv.register_macro("||",orf);stdenv.register_macro("or",orf);var partial_pattern=function(operator){return function(env,context,expr){var _tmp289=[context,expr];var other;var _tmp290;var _tmp291;var _tmp292;var _tmp293;var _tmp294;var _tmp295;var _tmp296;var _tmp297;var _tmp298;var _tmp299;var val;if((((_tmp293=_tmp289),(_tmp293 instanceof Array))&&(((_tmp294=_tmp293.length),(_tmp294==2))&&(((_tmp295=_tmp293[0]),(_tmp295=="pattern"))&&((_tmp295,true,(_tmp296=_tmp293[1]),(_tmp296 instanceof Array))&&(((_tmp297=_tmp296.length),(_tmp297==3))&&(((_tmp298=_tmp296[0]),(_tmp298=="data"))&&((_tmp298,true,(_tmp299=_tmp296[1]),(_tmp299===null))&&(_tmp299,true,(val=_tmp296[2]),true))))))))){return ["check",["macro",make_checker(val,operator)],["ignore"]];}else{if((((_tmp290=_tmp289),(_tmp290 instanceof Array))&&(((_tmp291=_tmp290.length),(_tmp291==2))&&((_tmp290[0],true,(_tmp292=_tmp290[1]),(_tmp292===null))&&(_tmp292,true))))){return operator;}else{if(((other=_tmp289),true)){return ["send",operator,expr];}else{throw ["Could not find a match",_tmp289];}}}};};stdenv.register_macro("==",partial_pattern("___eq"));stdenv.register_macro("!=",partial_pattern("___neq"));stdenv.register_macro("<=",partial_pattern("___leq"));stdenv.register_macro(">=",partial_pattern("___geq"));stdenv.register_macro("<",partial_pattern("___lt"));stdenv.register_macro(">",partial_pattern("___gt"));stdenv.register_macro("*",function(env,context,expr){var _tmp300=[context,expr];var other;var _tmp301;var _tmp302;var _tmp303;var _tmp304;var _tmp305;var _tmp306;var _tmp307;var _tmp308;var _tmp309;var val;var _tmp310;if((((_tmp304=_tmp300),(_tmp304 instanceof Array))&&(((_tmp305=_tmp304.length),(_tmp305==2))&&(((_tmp306=_tmp304[0]),(_tmp306=="pattern"))&&((_tmp306,true,(_tmp307=_tmp304[1]),(_tmp307 instanceof Array))&&(((_tmp308=_tmp307.length),(_tmp308==3))&&(((_tmp309=_tmp307[0]),(_tmp309=="data"))&&((_tmp309,true,(val=_tmp307[1]),true,(_tmp310=_tmp307[2]),(_tmp310===null))&&(_tmp310,true))))))))){return ["dynsplice",val];}else{if((((_tmp301=_tmp300),(_tmp301 instanceof Array))&&(((_tmp302=_tmp301.length),(_tmp302==2))&&((_tmp301[0],true,(_tmp303=_tmp301[1]),(_tmp303===null))&&(_tmp303,true))))){return "___times";}else{if(((other=_tmp300),true)){return ["send","___times",expr];}else{throw ["Could not find a match",_tmp300];}}}});stdenv.register_macro(".",function(env,context,expr){var _tmp311=expr;var other;var _tmp312;var _tmp313;var _tmp314;var _tmp315;var _tmp316;var s;if((((_tmp312=_tmp311),(_tmp312 instanceof Array))&&(((_tmp313=_tmp312.length),(_tmp313==3))&&(((_tmp314=_tmp312[0]),(_tmp314=="data"))&&((_tmp314,true,(_tmp315=_tmp312[1]),(_tmp315===null))&&((_tmp315,true,(_tmp316=_tmp312[2]),(typeof(_tmp316)=="string"))&&((s=_tmp316),true))))))){return ["value",s];}else{if(((other=_tmp311),true)){throw ["invalid",expr];}else{throw ["Could not find a match",_tmp311];}}});stdenv.register_macro("where",function(env,context,_tmp317){var _tmp318;var _tmp319;var _tmp320;var a;var b;if((((_tmp318=_tmp317),(_tmp318 instanceof Array))&&(((_tmp319=_tmp318.length),(_tmp319==3))&&(((_tmp320=_tmp318[0]),(_tmp320=="data"))&&(_tmp320,true,(a=_tmp318[1]),true,(b=_tmp318[2]),true))))){false;}else{throw "a condition failed";}return ["send","let",["data",["code",b],["code",a]]];});stdenv.register_macro("let",function(env,context,_tmp321){var _tmp322;var _tmp323;var _tmp324;var _tmp325;var _tmp326;var _tmp327;var a;var _tmp328;var _tmp329;var _tmp330;var b;if((((_tmp322=_tmp321),(_tmp322 instanceof Array))&&(((_tmp323=_tmp322.length),(_tmp323==3))&&(((_tmp324=_tmp322[0]),(_tmp324=="data"))&&((_tmp324,true,(_tmp325=_tmp322[1]),(_tmp325 instanceof Array))&&(((_tmp326=_tmp325.length),(_tmp326==2))&&(((_tmp327=_tmp325[0]),(_tmp327=="code"))&&((_tmp327,true,(a=_tmp325[1]),true,(_tmp328=_tmp322[2]),(_tmp328 instanceof Array))&&(((_tmp329=_tmp328.length),(_tmp329==2))&&(((_tmp330=_tmp328[0]),(_tmp330=="code"))&&(_tmp330,true,(b=_tmp328[1]),true))))))))))){false;}else{throw "a condition failed";}var bindings=aslist(a);var body=aslist(b);return ["multi"].concat(bindings).concat(body);});stdenv.register_macro("->",function(env,context,_tmp331){var _tmp332;var _tmp333;var _tmp334;var args;var stmts;if((((_tmp332=_tmp331),(_tmp332 instanceof Array))&&(((_tmp333=_tmp332.length),(_tmp333==3))&&(((_tmp334=_tmp332[0]),(_tmp334=="data"))&&(_tmp334,true,(args=_tmp332[1]),true,(stmts=_tmp332[2]),true))))){false;}else{throw "a condition failed";}var body=["multi"];(args=args.slice(1).map(function(x){var _tmp335=x;var other;var _tmp336;if((((_tmp336=_tmp335),(typeof(_tmp336)=="string"))&&(_tmp336,true))){return x;}else{if(((other=_tmp335),true)){var t=gensym();body.push(["send","=",["data",x,t]]);return t;}else{throw ["Could not find a match",_tmp335];}}}));body.push(stmts);return ["lambda",args,body];});stdenv.register_macro("=>",function(env,context,_tmp337){var _tmp338;var _tmp339;var _tmp340;var binding;var value;if((((_tmp338=_tmp337),(_tmp338 instanceof Array))&&(((_tmp339=_tmp338.length),(_tmp339==3))&&(((_tmp340=_tmp338[0]),(_tmp340=="data"))&&(_tmp340,true,(binding=_tmp338[1]),true,(value=_tmp338[2]),true))))){false;}else{throw "a condition failed";}if((context=="data")){return ["assoc",binding,value];}else{if(true){throw (("Illegal context for '=>' ("+context)+")");}else{return false;}}});stdenv.register_macro("=",function(env,context,expr){var _tmp341=[context,expr];var other;var _tmp342;var _tmp343;var _tmp344;var _tmp345;var _tmp346;var _tmp347;var binding;var value;var _tmp348;var _tmp349;var _tmp350;var _tmp351;var _tmp352;var _tmp353;var _tmp354;var _tmp355;var _tmp356;var f;var _tmp357;var _tmp358;var _tmp359;var args;var value;var _tmp360;var _tmp361;var _tmp362;var _tmp363;var _tmp364;var _tmp365;var _tmp366;var _tmp367;var _tmp368;var _tmp369;var lhs;var rhs;if((((_tmp364=_tmp341),(_tmp364 instanceof Array))&&(((_tmp365=_tmp364.length),(_tmp365==2))&&(((_tmp366=_tmp364[0]),(_tmp366=="multi"))&&((_tmp366,true,(_tmp367=_tmp364[1]),(_tmp367 instanceof Array))&&(((_tmp368=_tmp367.length),(_tmp368==3))&&(((_tmp369=_tmp367[0]),(_tmp369=="data"))&&(_tmp369,true,(lhs=_tmp367[1]),true,(rhs=_tmp367[2]),true)))))))){var p=parse_lhs(env,lhs,rhs);var vars=make_declarations(p[0]);var r=["splice"].concat(vars);var clauses=p[1];var mkif=function(x){return ["if",x,["value",false],["js_throw",["value","a condition failed"]]];};if((clauses.length==1)){var clause=clauses[0];var last=___lib.send(clause,(clause.length-1));var _tmp370=last;var other;var _tmp371;var _tmp372;var _tmp373;var _tmp374;if((((_tmp371=_tmp370),(_tmp371 instanceof Array))&&(((_tmp372=_tmp371.length),(_tmp372==2))&&(((_tmp373=_tmp371[0]),(_tmp373=="value"))&&((_tmp373,true,(_tmp374=_tmp371[1]),(_tmp374===true))&&(_tmp374,true)))))){if(((vars.length==1)&&(clause.length==3))){(r=["declare"].concat(clause[1].slice(1)));}else{if(true){(r=r.concat(clause.slice(1,(-1))));}else{false;}}}else{if(((other=_tmp370),true)){r.push(mkif(clause));}else{throw ["Could not find a match",_tmp370];}}}else{if(true){var ands=make_pattern_test(clauses);r.push(mkif(ands));}else{false;}}return r;}else{if((((_tmp360=_tmp341),(_tmp360 instanceof Array))&&(((_tmp361=_tmp360.length),(_tmp361==2))&&(((_tmp362=_tmp360[0]),(_tmp362=="data"))&&((_tmp362,true,(_tmp363=_tmp360[1]),(_tmp363===null))&&(_tmp363,true)))))){return ["assoc"];}else{if((((_tmp348=_tmp341),(_tmp348 instanceof Array))&&(((_tmp349=_tmp348.length),(_tmp349==2))&&(((_tmp350=_tmp348[0]),(_tmp350=="data"))&&((_tmp350,true,(_tmp351=_tmp348[1]),(_tmp351 instanceof Array))&&(((_tmp352=_tmp351.length),(_tmp352==3))&&(((_tmp353=_tmp351[0]),(_tmp353=="data"))&&((_tmp353,true,(_tmp354=_tmp351[1]),(_tmp354 instanceof Array))&&(((_tmp355=_tmp354.length),(_tmp355==3))&&(((_tmp356=_tmp354[0]),(_tmp356=="send"))&&((_tmp356,true,(f=_tmp354[1]),true,(_tmp357=_tmp354[2]),(_tmp357 instanceof Array))&&(((_tmp358=_tmp357.length),(_tmp358>=1))&&(((_tmp359=_tmp357[0]),(_tmp359=="data"))&&(_tmp359,true,(args=_tmp357.slice(1)),true,(value=_tmp351[2]),true)))))))))))))){return ["assoc",["value",f],["lambda",args,value]];}else{if((((_tmp342=_tmp341),(_tmp342 instanceof Array))&&(((_tmp343=_tmp342.length),(_tmp343==2))&&(((_tmp344=_tmp342[0]),(_tmp344=="data"))&&((_tmp344,true,(_tmp345=_tmp342[1]),(_tmp345 instanceof Array))&&(((_tmp346=_tmp345.length),(_tmp346==3))&&(((_tmp347=_tmp345[0]),(_tmp347=="data"))&&(_tmp347,true,(binding=_tmp345[1]),true,(value=_tmp345[2]),true)))))))){return ["assoc",["value",binding],value];}else{if(((other=_tmp341),true)){throw (("Illegal context for '=' ("+context)+")");}else{throw ["Could not find a match",_tmp341];}}}}}});var make_assigner=function(op){return function(env,context,_tmp375){var _tmp376;var _tmp377;var _tmp378;var a;var b;if((((_tmp376=_tmp375),(_tmp376 instanceof Array))&&(((_tmp377=_tmp376.length),(_tmp377==3))&&(((_tmp378=_tmp376[0]),(_tmp378=="data"))&&(_tmp378,true,(a=_tmp376[1]),true,(b=_tmp376[2]),true))))){false;}else{throw "a condition failed";}return ["assign",a,["send",op,["data",a,b]]];};};stdenv.register_macro(":=",function(env,context,_tmp379){var _tmp380;var _tmp381;var _tmp382;var a;var b;if((((_tmp380=_tmp379),(_tmp380 instanceof Array))&&(((_tmp381=_tmp380.length),(_tmp381==3))&&(((_tmp382=_tmp380[0]),(_tmp382=="data"))&&(_tmp382,true,(a=_tmp380[1]),true,(b=_tmp380[2]),true))))){false;}else{throw "a condition failed";}return ["assign",a,b];});stdenv.register_macro("+=",make_assigner("+"));stdenv.register_macro("-=",make_assigner("-"));stdenv.register_macro("*=",make_assigner("*"));stdenv.register_macro("/=",make_assigner("/"));stdenv.register_macro("<<=",make_assigner("<<"));stdenv.register_macro(">>=",make_assigner(">>"));stdenv.register_macro(">>>=",make_assigner(">>>"));stdenv.register_macro("if",function(env,context,_tmp383){var _tmp384;var _tmp385;var _tmp386;var test;var a;var b;if((((_tmp384=_tmp383),(_tmp384 instanceof Array))&&(((_tmp385=_tmp384.length),(_tmp385==4))&&(((_tmp386=_tmp384[0]),(_tmp386=="data"))&&(_tmp386,true,(test=_tmp384[1]),true,(a=_tmp384[2]),true,(b=_tmp384[3]),true))))){false;}else{throw "a condition failed";}return ["if",test,a,b];});stdenv.register_macro("cond",function(env,context,_tmp387){var _tmp388;var _tmp389;var _tmp390;var _tmp391;var _tmp392;var _tmp393;var clauses;if((((_tmp388=_tmp387),(_tmp388 instanceof Array))&&(((_tmp389=_tmp388.length),(_tmp389==2))&&(((_tmp390=_tmp388[0]),(_tmp390=="data"))&&((_tmp390,true,(_tmp391=_tmp388[1]),(_tmp391 instanceof Array))&&(((_tmp392=_tmp391.length),(_tmp392==2))&&(((_tmp393=_tmp391[0]),(_tmp393=="code"))&&(_tmp393,true,(clauses=_tmp391[1]),true)))))))){false;}else{throw "a condition failed";}var handle=function(xs){if((xs.length==0)){return ["value",false];}else{if(true){var first=xs[0][2];var rest=xs.slice(1);return ["if",first[1],first[2],handle(rest)];}else{return false;}}};return handle(aslist(clauses));});stdenv.register_macro("while",function(env,context,expr){var _tmp394;var _tmp395;var _tmp396;var _tmp397;var _tmp398;var _tmp399;var test;var _tmp400;var _tmp401;var _tmp402;var body;if((((_tmp394=expr),(_tmp394 instanceof Array))&&(((_tmp395=_tmp394.length),(_tmp395==3))&&(((_tmp396=_tmp394[0]),(_tmp396=="data"))&&((_tmp396,true,(_tmp397=_tmp394[1]),(_tmp397 instanceof Array))&&(((_tmp398=_tmp397.length),(_tmp398==2))&&(((_tmp399=_tmp397[0]),(_tmp399=="code"))&&((_tmp399,true,(test=_tmp397[1]),true,(_tmp400=_tmp394[2]),(_tmp400 instanceof Array))&&(((_tmp401=_tmp400.length),(_tmp401==2))&&(((_tmp402=_tmp400[0]),(_tmp402=="code"))&&(_tmp402,true,(body=_tmp400[1]),true))))))))))){false;}else{throw "a condition failed";}return ["js_while",test,body];});stdenv.register_macro("for",function(env,context,expr){var _tmp403;var _tmp404;var _tmp405;var _tmp406;var _tmp407;var _tmp408;var _tmp409;var _tmp410;var _tmp411;var a;var b;var c;var _tmp412;var _tmp413;var _tmp414;var body;if((((_tmp403=expr),(_tmp403 instanceof Array))&&(((_tmp404=_tmp403.length),(_tmp404==3))&&(((_tmp405=_tmp403[0]),(_tmp405=="data"))&&((_tmp405,true,(_tmp406=_tmp403[1]),(_tmp406 instanceof Array))&&(((_tmp407=_tmp406.length),(_tmp407==2))&&(((_tmp408=_tmp406[0]),(_tmp408=="code"))&&((_tmp408,true,(_tmp409=_tmp406[1]),(_tmp409 instanceof Array))&&(((_tmp410=_tmp409.length),(_tmp410==4))&&(((_tmp411=_tmp409[0]),(_tmp411=="multi"))&&((_tmp411,true,(a=_tmp409[1]),true,(b=_tmp409[2]),true,(c=_tmp409[3]),true,(_tmp412=_tmp403[2]),(_tmp412 instanceof Array))&&(((_tmp413=_tmp412.length),(_tmp413==2))&&(((_tmp414=_tmp412[0]),(_tmp414=="code"))&&(_tmp414,true,(body=_tmp412[1]),true)))))))))))))){false;}else{throw "a condition failed";}return ["js_for",a,b,c,body];});stdenv.register_macro("return",function(env,context,expr){return ["js_return",expr];});stdenv.register_macro("throw",function(env,context,expr){return ["js_throw",expr];});stdenv.register_macro("break",function(env,context,expr){return ["js_break"];});stdenv.register_macro("continue",function(env,context,expr){return ["js_continue"];});var rx_wrap=function(x){return (("(?:"+x)+")");};var rx_quote=function(x){return x.replace(RegExp("([.?*+\\^$\\[\\]\\(\\)\\{\\}|\\\\])","g"),"\\$1");};var rx_quote2=function(x){return x.replace(RegExp("([\\[\\]\\(\\)\\{\\}\\^])","g"),"\\$1");};var rx_build=function(expr){var _tmp415=expr;var otherA;var _tmp416;var _tmp417;var _tmp418;var args;var _tmp419;var _tmp420;var _tmp421;var args;var _tmp422;var _tmp423;var _tmp424;var _tmp425;var _tmp426;var _tmp427;var _tmp428;var _tmp429;var b;var _tmp430;var _tmp431;var _tmp432;var _tmp433;var _tmp434;var _tmp435;var _tmp436;var _tmp437;var b;var _tmp438;var _tmp439;var _tmp440;var _tmp441;var _tmp442;var _tmp443;var _tmp444;var a;var _tmp445;var _tmp446;var _tmp447;var _tmp448;var _tmp449;var _tmp450;var _tmp451;var _tmp452;var a;var _tmp453;var _tmp454;var _tmp455;var _tmp456;var _tmp457;var _tmp458;var _tmp459;var _tmp460;var a;var _tmp461;var _tmp462;var _tmp463;var _tmp464;var _tmp465;var _tmp466;var _tmp467;var _tmp468;var a;var b;var _tmp469;var _tmp470;var _tmp471;var _tmp472;var _tmp473;var _tmp474;var _tmp475;var a;var b;var _tmp476;var _tmp477;var _tmp478;var x;var _tmp479;var _tmp480;var _tmp481;var _tmp482;var _tmp483;var _tmp484;var _tmp485;var _tmp486;var _tmp487;var _tmp488;var _tmp489;var _tmp490;var _tmp491;if((((_tmp491=_tmp415),(_tmp491=="any"))&&(_tmp491,true))){return ".";}else{if((((_tmp490=_tmp415),(_tmp490=="start"))&&(_tmp490,true))){return "^";}else{if((((_tmp489=_tmp415),(_tmp489=="end"))&&(_tmp489,true))){return "$";}else{if((((_tmp488=_tmp415),(_tmp488=="alpha"))&&(_tmp488,true))){return "\\a";}else{if((((_tmp487=_tmp415),(_tmp487=="digit"))&&(_tmp487,true))){return "\\d";}else{if((((_tmp486=_tmp415),(_tmp486=="word"))&&(_tmp486,true))){return "\\w";}else{if((((_tmp485=_tmp415),(_tmp485=="space"))&&(_tmp485,true))){return "\\s";}else{if((((_tmp484=_tmp415),(_tmp484=="boundary"))&&(_tmp484,true))){return "\\b";}else{if((((_tmp483=_tmp415),(_tmp483=="a"))&&(_tmp483,true))){return "\\a";}else{if((((_tmp482=_tmp415),(_tmp482=="d"))&&(_tmp482,true))){return "\\d";}else{if((((_tmp481=_tmp415),(_tmp481=="w"))&&(_tmp481,true))){return "\\w";}else{if((((_tmp480=_tmp415),(_tmp480=="s"))&&(_tmp480,true))){return "\\s";}else{if((((_tmp479=_tmp415),(_tmp479=="b"))&&(_tmp479,true))){return "\\b";}else{if((((_tmp476=_tmp415),(_tmp476 instanceof Array))&&(((_tmp477=_tmp476.length),(_tmp477==2))&&(((_tmp478=_tmp476[0]),(_tmp478=="value"))&&(_tmp478,true,(x=_tmp476[1]),true))))){return rx_quote(x);}else{if((((_tmp469=_tmp415),(_tmp469 instanceof Array))&&(((_tmp470=_tmp469.length),(_tmp470==3))&&(((_tmp471=_tmp469[0]),(_tmp471=="send"))&&((_tmp471,true,(_tmp472=_tmp469[1]),(_tmp472=="||"))&&((_tmp472,true,(_tmp473=_tmp469[2]),(_tmp473 instanceof Array))&&(((_tmp474=_tmp473.length),(_tmp474==3))&&(((_tmp475=_tmp473[0]),(_tmp475=="data"))&&(_tmp475,true,(a=_tmp473[1]),true,(b=_tmp473[2]),true))))))))){return rx_wrap(((rx_build(a)+"|")+rx_build(b)));}else{if((((_tmp462=_tmp415),(_tmp462 instanceof Array))&&(((_tmp463=_tmp462.length),(_tmp463==3))&&(((_tmp464=_tmp462[0]),(_tmp464=="send"))&&((_tmp464,true,(_tmp465=_tmp462[1]),(_tmp465=="or"))&&((_tmp465,true,(_tmp466=_tmp462[2]),(_tmp466 instanceof Array))&&(((_tmp467=_tmp466.length),(_tmp467==3))&&(((_tmp468=_tmp466[0]),(_tmp468=="data"))&&(_tmp468,true,(a=_tmp466[1]),true,(b=_tmp466[2]),true))))))))){return rx_wrap(((rx_build(a)+"|")+rx_build(b)));}else{if((((_tmp454=_tmp415),(_tmp454 instanceof Array))&&(((_tmp455=_tmp454.length),(_tmp455==3))&&(((_tmp456=_tmp454[0]),(_tmp456=="send"))&&((_tmp456,true,(_tmp457=_tmp454[1]),(_tmp457=="*"))&&((_tmp457,true,(_tmp458=_tmp454[2]),(_tmp458 instanceof Array))&&(((_tmp459=_tmp458.length),(_tmp459==3))&&(((_tmp460=_tmp458[0]),(_tmp460=="data"))&&((_tmp460,true,(a=_tmp458[1]),true,(_tmp461=_tmp458[2]),(_tmp461===null))&&(_tmp461,true)))))))))){return rx_wrap((rx_build(a)+"*"));}else{if((((_tmp446=_tmp415),(_tmp446 instanceof Array))&&(((_tmp447=_tmp446.length),(_tmp447==3))&&(((_tmp448=_tmp446[0]),(_tmp448=="send"))&&((_tmp448,true,(_tmp449=_tmp446[1]),(_tmp449=="+"))&&((_tmp449,true,(_tmp450=_tmp446[2]),(_tmp450 instanceof Array))&&(((_tmp451=_tmp450.length),(_tmp451==3))&&(((_tmp452=_tmp450[0]),(_tmp452=="data"))&&((_tmp452,true,(a=_tmp450[1]),true,(_tmp453=_tmp450[2]),(_tmp453===null))&&(_tmp453,true)))))))))){return rx_wrap((rx_build(a)+"+"));}else{if((((_tmp438=_tmp415),(_tmp438 instanceof Array))&&(((_tmp439=_tmp438.length),(_tmp439==3))&&(((_tmp440=_tmp438[0]),(_tmp440=="send"))&&((_tmp440,true,(_tmp441=_tmp438[1]),(_tmp441=="?"))&&((_tmp441,true,(_tmp442=_tmp438[2]),(_tmp442 instanceof Array))&&(((_tmp443=_tmp442.length),(_tmp443==3))&&(((_tmp444=_tmp442[0]),(_tmp444=="data"))&&((_tmp444,true,(a=_tmp442[1]),true,(_tmp445=_tmp442[2]),(_tmp445===null))&&(_tmp445,true)))))))))){return rx_wrap((rx_build(a)+"?"));}else{if((((_tmp430=_tmp415),(_tmp430 instanceof Array))&&(((_tmp431=_tmp430.length),(_tmp431==3))&&(((_tmp432=_tmp430[0]),(_tmp432=="send"))&&((_tmp432,true,(_tmp433=_tmp430[1]),(_tmp433==">>"))&&((_tmp433,true,(_tmp434=_tmp430[2]),(_tmp434 instanceof Array))&&(((_tmp435=_tmp434.length),(_tmp435==3))&&(((_tmp436=_tmp434[0]),(_tmp436=="data"))&&((_tmp436,true,(_tmp437=_tmp434[1]),(_tmp437===null))&&(_tmp437,true,(b=_tmp434[2]),true)))))))))){var x=rx_quote2(b[1]);return (("["+x)+"]");}else{if((((_tmp422=_tmp415),(_tmp422 instanceof Array))&&(((_tmp423=_tmp422.length),(_tmp423==3))&&(((_tmp424=_tmp422[0]),(_tmp424=="send"))&&((_tmp424,true,(_tmp425=_tmp422[1]),(_tmp425==">>!"))&&((_tmp425,true,(_tmp426=_tmp422[2]),(_tmp426 instanceof Array))&&(((_tmp427=_tmp426.length),(_tmp427==3))&&(((_tmp428=_tmp426[0]),(_tmp428=="data"))&&((_tmp428,true,(_tmp429=_tmp426[1]),(_tmp429===null))&&(_tmp429,true,(b=_tmp426[2]),true)))))))))){var x=rx_quote2(b[1]);return (("[^"+x)+"]");}else{if((((_tmp419=_tmp415),(_tmp419 instanceof Array))&&(((_tmp420=_tmp419.length),(_tmp420>=1))&&(((_tmp421=_tmp419[0]),(_tmp421=="data"))&&(_tmp421,true,(args=_tmp419.slice(1)),true))))){return (("("+args.map(rx_build).join(""))+")");}else{if((((_tmp416=_tmp415),(_tmp416 instanceof Array))&&(((_tmp417=_tmp416.length),(_tmp417>=1))&&(((_tmp418=_tmp416[0]),(_tmp418=="multi"))&&(_tmp418,true,(args=_tmp416.slice(1)),true))))){return (("(?:"+args.map(rx_build).join(""))+")");}else{if(((otherA=_tmp415),true)){throw "OopsF";}else{throw ["Could not find a match",_tmp415];}}}}}}}}}}}}}}}}}}}}}}}}};stdenv.register_macro("Rx",function(env,context,expr){return ["send","RegExp",["array",["value",rx_build(expr)]]];});stdenv.register_macro("Rxg",function(env,context,expr){return ["send","RegExp",["array",["value",rx_build(expr)],["value","g"]]];});stdenv.register_macro("?",function(env,context,_tmp492){var _tmp493;var _tmp494;var _tmp495;var expr;var _tmp496;if((((_tmp493=_tmp492),(_tmp493 instanceof Array))&&(((_tmp494=_tmp493.length),(_tmp494==3))&&(((_tmp495=_tmp493[0]),(_tmp495=="data"))&&((_tmp495,true,(expr=_tmp493[1]),true,(_tmp496=_tmp493[2]),(_tmp496===null))&&(_tmp496,true)))))){false;}else{throw "a condition failed";}var checker=function(){var _tmp497=expr;var other;var _tmp498;var _tmp499;var _tmp500;var _tmp501;var _tmp502;var _tmp503;var _tmp504;if((((_tmp504=_tmp497),(_tmp504===null))&&(_tmp504,true))){throw "not implemented";}else{if((((_tmp503=_tmp497),(_tmp503=="String"))&&(_tmp503,true))){var f=function(env,context,_tmp505){var _tmp506;var _tmp507;var _tmp508;var expr;if((((_tmp506=_tmp505),(_tmp506 instanceof Array))&&(((_tmp507=_tmp506.length),(_tmp507==2))&&(((_tmp508=_tmp506[0]),(_tmp508=="data"))&&(_tmp508,true,(expr=_tmp506[1]),true))))){false;}else{throw "a condition failed";}return ["send","___eq",["data",["send","typeof",["data",expr]],["value","string"]]];};return ["macro",f];}else{if((((_tmp502=_tmp497),(_tmp502=="Number"))&&(_tmp502,true))){var f=function(env,context,_tmp509){var _tmp510;var _tmp511;var _tmp512;var expr;if((((_tmp510=_tmp509),(_tmp510 instanceof Array))&&(((_tmp511=_tmp510.length),(_tmp511==2))&&(((_tmp512=_tmp510[0]),(_tmp512=="data"))&&(_tmp512,true,(expr=_tmp510[1]),true))))){false;}else{throw "a condition failed";}return ["send","___eq",["data",["send","typeof",["data",expr]],["value","number"]]];};return ["macro",f];}else{if((((_tmp501=_tmp497),(_tmp501=="true"))&&(_tmp501,true))){return ["macro",make_checker(["value",true],"___is")];}else{if((((_tmp500=_tmp497),(_tmp500=="false"))&&(_tmp500,true))){return ["macro",make_checker(["value",false],"___is")];}else{if((((_tmp499=_tmp497),(_tmp499=="null"))&&(_tmp499,true))){return ["macro",make_checker(["value",null],"___is")];}else{if((((_tmp498=_tmp497),(_tmp498=="undefined"))&&(_tmp498,true))){return ["macro",make_checker(["value",undefined],"___is")];}else{if(((other=_tmp497),true)){return ["send",["send","___lib",["value","checker"]],["data",expr]];}else{throw ["Could not find a match",_tmp497];}}}}}}}}}();var mac=function(env,context,expr){var _tmp513=context;var other;var _tmp514;if((((_tmp514=_tmp513),(_tmp514=="pattern"))&&(_tmp514,true))){return ["check",checker,(expr||["ignore"])];}else{if(((other=_tmp513),true)){return ["send",checker,["data",expr]];}else{throw ["Could not find a match",_tmp513];}}};return ["macro",mac];});stdenv.register_macro("!",function(env,context,_tmp515){var _tmp516;var _tmp517;var _tmp518;var expr;var _tmp519;if((((_tmp516=_tmp515),(_tmp516 instanceof Array))&&(((_tmp517=_tmp516.length),(_tmp517==3))&&(((_tmp518=_tmp516[0]),(_tmp518=="data"))&&((_tmp518,true,(expr=_tmp516[1]),true,(_tmp519=_tmp516[2]),(_tmp519===null))&&(_tmp519,true)))))){false;}else{throw "a condition failed";}var projector=function(){var _tmp520=expr;var other;var _tmp521;var _tmp522;var _tmp523;if((((_tmp523=_tmp520),(_tmp523===null))&&(_tmp523,true))){throw "not implemented";}else{if((((_tmp522=_tmp520),(_tmp522=="String"))&&(_tmp522,true))){var f=function(env,context,_tmp524){var _tmp525;var _tmp526;var _tmp527;var expr;if((((_tmp525=_tmp524),(_tmp525 instanceof Array))&&(((_tmp526=_tmp525.length),(_tmp526==2))&&(((_tmp527=_tmp525[0]),(_tmp527=="data"))&&(_tmp527,true,(expr=_tmp525[1]),true))))){false;}else{throw "a condition failed";}return ["data",["value",true],["send","String",["data",expr]]];};return ["macro",f];}else{if((((_tmp521=_tmp520),(_tmp521=="Number"))&&(_tmp521,true))){var f=function(env,context,_tmp528){var _tmp529;var _tmp530;var _tmp531;var expr;if((((_tmp529=_tmp528),(_tmp529 instanceof Array))&&(((_tmp530=_tmp529.length),(_tmp530==2))&&(((_tmp531=_tmp529[0]),(_tmp531=="data"))&&(_tmp531,true,(expr=_tmp529[1]),true))))){false;}else{throw "a condition failed";}return ["data",["value",true],["send","parseFloat",["data",expr]]];};return ["macro",f];}else{if(((other=_tmp520),true)){return ["send",["send","___lib",["value","projector"]],["data",expr]];}else{throw ["Could not find a match",_tmp520];}}}}}();var mac=function(env,context,expr){var _tmp532=context;var other;var _tmp533;if((((_tmp533=_tmp532),(_tmp533=="pattern"))&&(_tmp533,true))){return ["project",projector,(expr||["ignore"])];}else{if(((other=_tmp532),true)){return ["send",projector,["data",expr]];}else{throw ["Could not find a match",_tmp532];}}};return ["macro",mac];});var tempnum=0;var gensym=function(){var name=("_tmp"+tempnum);(tempnum=(tempnum+1));return name;};var parse_lhs=function(env,lhs,rhs){var vars=[];var clauses=[];var current=["multi"];var mktemp=function(){var t=gensym();vars.push(t);return t;};var newclause=function(){if((current.length>1)){clauses.push(current);}else{false;}return (current=["multi"]);};var helper=function(lhs,curr){return helper_noexpand(expand.step(env,"pattern",lhs),curr);};var helper_noexpand=function(lhs,curr){var _tmp534=lhs;var other;var _tmp535;var _tmp536;var _tmp537;var specs;var _tmp538;var _tmp539;var _tmp540;var fname;var spec;var _tmp541;var _tmp542;var _tmp543;var projector;var expr;var _tmp544;var _tmp545;var _tmp546;var checker;var expr;var _tmp547;var _tmp548;var _tmp549;var xs;var _tmp550;var _tmp551;var _tmp552;var xs;var _tmp553;var _tmp554;var _tmp555;var condition;var pattern;var _tmp556;var _tmp557;var _tmp558;var v;var _tmp559;var _tmp560;var _tmp562;var _tmp563;var _tmp564;var _tmp561;var _tmp565;if((((_tmp565=_tmp534),(_tmp565===null))&&(_tmp565,true))){var x=["check",["macro",make_checker(["value",null],"___eq")],["ignore"]];return helper_noexpand(x,curr);}else{if(((_tmp560=_tmp534),((((_tmp561=_tmp560),(_tmp561=="_"))&&(_tmp561,true))||(((_tmp562=_tmp560),(_tmp562 instanceof Array))&&(((_tmp563=_tmp562.length),(_tmp563==1))&&(((_tmp564=_tmp562[0]),(_tmp564=="ignore"))&&(_tmp564,true))))))){current.push(curr);return current.push(["value",true]);}else{if((((_tmp559=_tmp534),(typeof(_tmp559)=="string"))&&(_tmp559,true))){vars.push(lhs);current.push(["assign",lhs,curr]);return current.push(["value",true]);}else{if((((_tmp556=_tmp534),(_tmp556 instanceof Array))&&(((_tmp557=_tmp556.length),(_tmp557==2))&&(((_tmp558=_tmp556[0]),(_tmp558=="value"))&&(_tmp558,true,(v=_tmp556[1]),true))))){var x=["check",["macro",make_checker(lhs,"___eq")],["ignore"]];return helper_noexpand(x,curr);}else{if((((_tmp553=_tmp534),(_tmp553 instanceof Array))&&(((_tmp554=_tmp553.length),(_tmp554==3))&&(((_tmp555=_tmp553[0]),(_tmp555=="test"))&&(_tmp555,true,(condition=_tmp553[1]),true,(pattern=_tmp553[2]),true))))){helper(pattern,curr);current.push(condition);return newclause();}else{if((((_tmp550=_tmp534),(_tmp550 instanceof Array))&&(((_tmp551=_tmp550.length),(_tmp551>=1))&&(((_tmp552=_tmp550[0]),(_tmp552=="all"))&&(_tmp552,true,(xs=_tmp550.slice(1)),true))))){var temp=mktemp();(current=current.concat([["assign",temp,curr]]));return xs.forEach(function(x){return helper(x,temp);});}else{if((((_tmp547=_tmp534),(_tmp547 instanceof Array))&&(((_tmp548=_tmp547.length),(_tmp548>=1))&&(((_tmp549=_tmp547[0]),(_tmp549=="any"))&&(_tmp549,true,(xs=_tmp547.slice(1)),true))))){var normalize=function(vars){return vars.filter(function(x){return (x.slice(0,4)!=="_tmp");}).sort().join(",");};var temp=mktemp();(current=current.concat([["assign",temp,curr]]));var myvars=undefined;var clauses=[];xs.forEach(function(x){var p=parse_lhs(env,x,temp);if((myvars===undefined)){(myvars=p[0]);}else{if((normalize(p[0])!==normalize(myvars))){throw [["Must have the same set of variables in both branches!",myvars]];}else{if(true){(vars=vars.concat(p[0]));}else{false;}}}return clauses.push(make_pattern_test(p[1]));});current.push(make_or_pattern(clauses));(vars=vars.concat(myvars));return newclause();}else{if((((_tmp544=_tmp534),(_tmp544 instanceof Array))&&(((_tmp545=_tmp544.length),(_tmp545==3))&&(((_tmp546=_tmp544[0]),(_tmp546=="check"))&&(_tmp546,true,(checker=_tmp544[1]),true,(expr=_tmp544[2]),true))))){var temp=mktemp();(current=current.concat([["assign",temp,curr],["send",checker,["data",temp]]]));newclause();return helper(expr,temp);}else{if((((_tmp541=_tmp534),(_tmp541 instanceof Array))&&(((_tmp542=_tmp541.length),(_tmp542==3))&&(((_tmp543=_tmp541[0]),(_tmp543=="project"))&&(_tmp543,true,(projector=_tmp541[1]),true,(expr=_tmp541[2]),true))))){var temp=mktemp();var temp2=mktemp();(current=current.concat([["assign",temp,curr],["assign",temp2,["send",projector,["data",temp]]],["send",temp2,["value",0]]]));newclause();return helper(expr,["send",temp2,["value",1]]);}else{if((((_tmp538=_tmp534),(_tmp538 instanceof Array))&&(((_tmp539=_tmp538.length),(_tmp539==3))&&(((_tmp540=_tmp538[0]),(_tmp540=="send"))&&(_tmp540,true,(fname=_tmp538[1]),true,(spec=_tmp538[2]),true))))){return helper(fname,["send","->",["data",spec,curr]]);}else{if((((_tmp535=_tmp534),(_tmp535 instanceof Array))&&(((_tmp536=_tmp535.length),(_tmp536>=1))&&(((_tmp537=_tmp535[0]),(_tmp537=="data"))&&(_tmp537,true,(specs=_tmp535.slice(1)),true))))){var fw=0;var bw=0;var rest=undefined;var members=specs.map(function(x){var v=expand.step(env,"pattern",x);var _tmp566=v;var other;var _tmp567;var _tmp568;var _tmp569;var variable;if((((_tmp567=_tmp566),(_tmp567 instanceof Array))&&(((_tmp568=_tmp567.length),(_tmp568==2))&&(((_tmp569=_tmp567[0]),(_tmp569=="dynsplice"))&&(_tmp569,true,(variable=_tmp567[1]),true))))){(rest=variable);}else{if(((other=_tmp566),true)){if((rest===undefined)){(fw=(fw+1));}else{if(true){(bw=(bw+1));}else{false;}}}else{throw ["Could not find a match",_tmp566];}}return v;});var cmp=function(){if((rest===undefined)){return "___eq";}else{if(true){return "___gte";}else{return false;}}}();var temp=mktemp();var len=mktemp();(current=current.concat([["assign",temp,curr],["send","___instanceof",["data",temp,"Array"]]]));newclause();(current=current.concat([["assign",len,["send",temp,["value","length"]]],["send",cmp,["data",len,["value",(fw+bw)]]]]));newclause();for(var j=0;(j<fw);(++j)){helper_noexpand(___lib.send(members,j),["send",temp,["value",j]]);}if((rest!==undefined)){var slice=function(){if((bw>0)){return ["data",["value",fw],["value",(-bw)]];}else{if(true){return ["data",["value",fw]];}else{return false;}}}();helper_noexpand(___lib.send(members,fw)[1],["send",["send",temp,["value","slice"]],slice]);}else{false;}for(var j=0;(j<bw);(++j)){helper_noexpand(___lib.send(members,((fw+j)+1)),["send",temp,["send","___minus",["data",len,["value",(bw-j)]]]]);}}else{if(((other=_tmp534),true)){throw "OopsG";}else{throw ["Could not find a match",_tmp534];}}}}}}}}}}}}};helper(lhs,rhs);if((current.length>1)){clauses.push(current);}else{false;}return [vars,clauses];};var make_declarations=function(vars){return vars.map(function(name){return ["declare",name,["value",undefined]];});};var make_pattern_test=function(clauses){var ands=clauses.pop();while((clauses.length>0)){(ands=["send","___and",["data",clauses.pop(),ands]]);}return ands;};var make_or_pattern=function(clauses){var ors=clauses.pop();while((clauses.length>0)){(ors=["send","___or",["data",clauses.pop(),ors]]);}return ors;};stdenv.register_macro("|>",function(env,context,_tmp570){var _tmp571;var _tmp572;var _tmp573;var to_match;var cl;if((((_tmp571=_tmp570),(_tmp571 instanceof Array))&&(((_tmp572=_tmp571.length),(_tmp572==3))&&(((_tmp573=_tmp571[0]),(_tmp573=="data"))&&(_tmp573,true,(to_match=_tmp571[1]),true,(cl=_tmp571[2]),true))))){false;}else{throw "a condition failed";}var temp=gensym();var clauses=function(){var _tmp574=cl;var other;var _tmp575;var _tmp576;var _tmp577;var cls;if((((_tmp575=_tmp574),(_tmp575 instanceof Array))&&(((_tmp576=_tmp575.length),(_tmp576>=1))&&(((_tmp577=_tmp575[0]),(_tmp577=="multi"))&&(_tmp577,true,(cls=_tmp575.slice(1)),true))))){return cls;}else{if(((other=_tmp574),true)){return [other];}else{throw ["Could not find a match",_tmp574];}}}();var decls=["multi",["declare",temp,to_match]];var r=["js_throw",["data",["value","Could not find a match"],temp]];while((clauses.length>0)){var _tmp578;var _tmp579;var _tmp580;var _tmp581;var _tmp582;var _tmp583;var _tmp584;var lhs;var body;if((((_tmp578=clauses.pop()),(_tmp578 instanceof Array))&&(((_tmp579=_tmp578.length),(_tmp579==3))&&(((_tmp580=_tmp578[0]),(_tmp580=="send"))&&((_tmp580,true,(_tmp581=_tmp578[1]),(_tmp581=="->"))&&((_tmp581,true,(_tmp582=_tmp578[2]),(_tmp582 instanceof Array))&&(((_tmp583=_tmp582.length),(_tmp583==3))&&(((_tmp584=_tmp582[0]),(_tmp584=="data"))&&(_tmp584,true,(lhs=_tmp582[1]),true,(body=_tmp582[2]),true))))))))){false;}else{throw "a condition failed";}var p=parse_lhs(env,lhs,temp);var test=make_pattern_test(p[1]);(r=["if",test,body,r]);(decls=decls.concat(make_declarations(p[0])));}decls.push(r);return decls;});var js_op_table=({"___plus":"+","___minus":"-","___times":"*","___div":"/","___mod":"%","___binxor":"^","___binand":"&","___binor":"|","___binnot":"~","___and":"&&","___or":"||","___not":"!","___is":"===","___isnt":"!==","___eq":"==","___neq":"!=","___lt":"<","___gt":">","___lte":"<=","___gte":">=","___shl":"<<","___shr":">>","___shr2":">>>","___in":" in ","___instanceof":" instanceof ","___plusplus":"++","___minusminus":"--"});var translate=function(expr,mode){var _tmp585=expr;var other;var _tmp586;var _tmp587;var _tmp588;var f;var msg;var _tmp589;var _tmp590;var _tmp591;var f;var _tmp592;var _tmp593;var _tmp594;var args;var _tmp595;var _tmp596;var _tmp597;var f;var _tmp598;var msg;var _tmp599;var _tmp600;var _tmp601;var s;var _tmp602;var _tmp603;var _tmp604;var args;var _tmp605;var _tmp606;var _tmp607;var args;var _tmp608;var _tmp609;var _tmp610;var value;var _tmp611;var _tmp612;var _tmp613;var value;var _tmp614;var _tmp615;var _tmp616;var _tmp617;var _tmp618;var _tmp619;var _tmp620;var _tmp621;var _tmp622;var args;var _tmp623;var _tmp624;var _tmp625;var args;var _tmp626;var _tmp627;var _tmp628;var lhs;var rhs;var _tmp629;var _tmp630;var _tmp631;var _tmp632;var _tmp633;var _tmp634;var obj;var msg;var rhs;var _tmp635;var _tmp636;var _tmp637;var binding;var value;var _tmp638;var _tmp639;var _tmp640;var binding;var _tmp641;var _tmp642;var _tmp643;var _tmp644;var _tmp645;var _tmp646;var _tmp647;var x;var y;var z;var body;var _tmp648;var _tmp649;var _tmp650;var test;var body;var _tmp651;var _tmp652;var _tmp653;var test;var pos;var neg;var _tmp654;var _tmp655;var _tmp656;var bindings;var body;var _tmp657;var _tmp658;var _tmp659;var v;var _tmp660;var _tmp661;if((((_tmp661=_tmp585),(typeof(_tmp661)=="string"))&&(_tmp661,true))){return translate.expr(translate.mangle(expr),mode);}else{if((((_tmp660=_tmp585),(_tmp660===null))&&(_tmp660,true))){return translate.expr("null",mode);}else{if((((_tmp657=_tmp585),(_tmp657 instanceof Array))&&(((_tmp658=_tmp657.length),(_tmp658==2))&&(((_tmp659=_tmp657[0]),(_tmp659=="value"))&&(_tmp659,true,(v=_tmp657[1]),true))))){var r=function(){var _tmp662=v;var other;var _tmp663;var _tmp671;var _tmp664;var _tmp670;var _tmp665;var _tmp669;var _tmp666;var _tmp668;var _tmp667;var _tmp672;if((((_tmp672=_tmp662),(typeof(_tmp672)=="string"))&&(_tmp672,true))){var repl=({"\"":"\\\"","\n":"\\n","\\":"\\\\"});(v=v.replace(RegExp("((?:(?:\"|\\\\)|\n))","g"),function(m){return ___lib.send(repl,m);}));return (("\""+v)+"\"");}else{if(((_tmp663=_tmp662),(((_tmp664=_tmp663),(((_tmp665=_tmp664),(((_tmp666=_tmp665),((((_tmp667=_tmp666),(typeof(_tmp667)=="number"))&&(_tmp667,true))||(((_tmp668=_tmp666),(_tmp668===true))&&(_tmp668,true))))||(((_tmp669=_tmp665),(_tmp669===false))&&(_tmp669,true))))||(((_tmp670=_tmp664),(_tmp670===null))&&(_tmp670,true))))||(((_tmp671=_tmp663),(_tmp671===undefined))&&(_tmp671,true))))){return String(v);}else{if(((other=_tmp662),true)){return (("?!?["+v)+"]?!?");}else{throw ["Could not find a match",_tmp662];}}}}();return translate.expr(r,mode);}else{if((((_tmp654=_tmp585),(_tmp654 instanceof Array))&&(((_tmp655=_tmp654.length),(_tmp655==3))&&(((_tmp656=_tmp654[0]),(_tmp656=="lambda"))&&(_tmp656,true,(bindings=_tmp654[1]),true,(body=_tmp654[2]),true))))){var a=bindings.join(",");var b=translate.body(body,"return");return translate.expr((((("function("+a)+"){")+b)+"}"),mode);}else{if((((_tmp651=_tmp585),(_tmp651 instanceof Array))&&(((_tmp652=_tmp651.length),(_tmp652==4))&&(((_tmp653=_tmp651[0]),(_tmp653=="if"))&&(_tmp653,true,(test=_tmp651[1]),true,(pos=_tmp651[2]),true,(neg=_tmp651[3]),true))))){var _tmp673=mode;var other;var _tmp674;if((((_tmp674=_tmp673),(_tmp674=="expr"))&&(_tmp674,true))){return translate.body(expr,"expr");}else{if(((other=_tmp673),true)){var a=translate(test,"expr");var b=translate(pos,mode);var c=translate(neg,mode);return (((((("if("+a)+"){")+b)+"}else{")+c)+"}");}else{throw ["Could not find a match",_tmp673];}}}else{if((((_tmp648=_tmp585),(_tmp648 instanceof Array))&&(((_tmp649=_tmp648.length),(_tmp649==3))&&(((_tmp650=_tmp648[0]),(_tmp650=="js_while"))&&(_tmp650,true,(test=_tmp648[1]),true,(body=_tmp648[2]),true))))){var _tmp675=mode;var other;var _tmp676;if((((_tmp676=_tmp675),(_tmp676=="expr"))&&(_tmp676,true))){return translate.body(expr,"expr");}else{if(((other=_tmp675),true)){var a=translate(test,"expr");var b=translate(body,"stmt");return (((("while("+a)+"){")+b)+"}");}else{throw ["Could not find a match",_tmp675];}}}else{if((((_tmp645=_tmp585),(_tmp645 instanceof Array))&&(((_tmp646=_tmp645.length),(_tmp646==5))&&(((_tmp647=_tmp645[0]),(_tmp647=="js_for"))&&(_tmp647,true,(x=_tmp645[1]),true,(y=_tmp645[2]),true,(z=_tmp645[3]),true,(body=_tmp645[4]),true))))){var _tmp677=mode;var other;var _tmp678;if((((_tmp678=_tmp677),(_tmp678=="expr"))&&(_tmp678,true))){return translate.body(expr,"expr");}else{if(((other=_tmp677),true)){var a=translate(x,"stmt");var b=translate(y,"stmt");var c=translate(z,"expr");var d=translate(body,"stmt");return (((((("for("+a)+b)+c)+"){")+d)+"}");}else{throw ["Could not find a match",_tmp677];}}}else{if((((_tmp638=_tmp585),(_tmp638 instanceof Array))&&(((_tmp639=_tmp638.length),(_tmp639==3))&&(((_tmp640=_tmp638[0]),(_tmp640=="declare"))&&((_tmp640,true,(binding=_tmp638[1]),true,(_tmp641=_tmp638[2]),(_tmp641 instanceof Array))&&(((_tmp642=_tmp641.length),(_tmp642==2))&&(((_tmp643=_tmp641[0]),(_tmp643=="value"))&&((_tmp643,true,(_tmp644=_tmp641[1]),(_tmp644===undefined))&&(_tmp644,true))))))))){var _tmp679=mode;var other;var _tmp680;var _tmp682;var _tmp681;if(((_tmp680=_tmp679),((((_tmp681=_tmp680),(_tmp681=="expr"))&&(_tmp681,true))||(((_tmp682=_tmp680),(_tmp682=="return"))&&(_tmp682,true))))){throw "Invalid in expr ctx";}else{if(((other=_tmp679),true)){var a=translate(binding,"expr");return (("var "+a)+";");}else{throw ["Could not find a match",_tmp679];}}}else{if((((_tmp635=_tmp585),(_tmp635 instanceof Array))&&(((_tmp636=_tmp635.length),(_tmp636==3))&&(((_tmp637=_tmp635[0]),(_tmp637=="declare"))&&(_tmp637,true,(binding=_tmp635[1]),true,(value=_tmp635[2]),true))))){var _tmp683=mode;var other;var _tmp684;var _tmp686;var _tmp685;if(((_tmp684=_tmp683),((((_tmp685=_tmp684),(_tmp685=="expr"))&&(_tmp685,true))||(((_tmp686=_tmp684),(_tmp686=="return"))&&(_tmp686,true))))){throw "Invalid in expr ctx";}else{if(((other=_tmp683),true)){var a=translate(binding,"expr");var b=translate(value,"expr");return (((("var "+a)+"=")+b)+";");}else{throw ["Could not find a match",_tmp683];}}}else{if((((_tmp629=_tmp585),(_tmp629 instanceof Array))&&(((_tmp630=_tmp629.length),(_tmp630==3))&&(((_tmp631=_tmp629[0]),(_tmp631=="assign"))&&((_tmp631,true,(_tmp632=_tmp629[1]),(_tmp632 instanceof Array))&&(((_tmp633=_tmp632.length),(_tmp633==3))&&(((_tmp634=_tmp632[0]),(_tmp634=="send"))&&(_tmp634,true,(obj=_tmp632[1]),true,(msg=_tmp632[2]),true,(rhs=_tmp629[2]),true)))))))){var a=translate(obj,"expr");var b=translate(msg,"expr");var c=translate(rhs,"expr");return translate.expr((((((("("+a)+"[")+b)+"]=")+c)+")"),mode);}else{if((((_tmp626=_tmp585),(_tmp626 instanceof Array))&&(((_tmp627=_tmp626.length),(_tmp627==3))&&(((_tmp628=_tmp626[0]),(_tmp628=="assign"))&&(_tmp628,true,(lhs=_tmp626[1]),true,(rhs=_tmp626[2]),true))))){var a=translate(lhs,"expr");var b=translate(rhs,"expr");return translate.expr((((("("+a)+"=")+b)+")"),mode);}else{if((((_tmp623=_tmp585),(_tmp623 instanceof Array))&&(((_tmp624=_tmp623.length),(_tmp624>=1))&&(((_tmp625=_tmp623[0]),(_tmp625=="multi"))&&(_tmp625,true,(args=_tmp623.slice(1)),true))))){var isdecl=function(x){var _tmp687=x;var other;var _tmp688;var _tmp689;var _tmp690;var variable;var value;if((((_tmp688=_tmp687),(_tmp688 instanceof Array))&&(((_tmp689=_tmp688.length),(_tmp689==3))&&(((_tmp690=_tmp688[0]),(_tmp690=="declare"))&&(_tmp690,true,(variable=_tmp688[1]),true,(value=_tmp688[2]),true))))){return true;}else{if(((other=_tmp687),true)){return false;}else{throw ["Could not find a match",_tmp687];}}};if((args.length==1)){return translate(args[0],mode);}else{if(((mode=="expr")&&(!args.some(isdecl)))){var xs=args.map(function(x){return translate(x,"expr");});return (("("+xs.join(","))+")");}else{if(true){return translate.body(expr,mode);}else{return false;}}}}else{if((((_tmp620=_tmp585),(_tmp620 instanceof Array))&&(((_tmp621=_tmp620.length),(_tmp621>=1))&&(((_tmp622=_tmp620[0]),(_tmp622=="splice"))&&(_tmp622,true,(args=_tmp620.slice(1)),true))))){return translate(["multi"].concat(args),mode);}else{if((((_tmp617=_tmp585),(_tmp617 instanceof Array))&&(((_tmp618=_tmp617.length),(_tmp618==1))&&(((_tmp619=_tmp617[0]),(_tmp619=="js_break"))&&(_tmp619,true))))){if((mode=="expr")){throw "Invalid break in ctx";}else{if(true){return "break;";}else{return false;}}}else{if((((_tmp614=_tmp585),(_tmp614 instanceof Array))&&(((_tmp615=_tmp614.length),(_tmp615==1))&&(((_tmp616=_tmp614[0]),(_tmp616=="js_continue"))&&(_tmp616,true))))){if((mode=="expr")){throw "Invalid continue in ctx";}else{if(true){return "continue;";}else{return false;}}}else{if((((_tmp611=_tmp585),(_tmp611 instanceof Array))&&(((_tmp612=_tmp611.length),(_tmp612==2))&&(((_tmp613=_tmp611[0]),(_tmp613=="js_return"))&&(_tmp613,true,(value=_tmp611[1]),true))))){if((mode=="expr")){throw "Invalid return in ctx";}else{if(true){return (("return "+translate(value,"expr"))+";");}else{return false;}}}else{if((((_tmp608=_tmp585),(_tmp608 instanceof Array))&&(((_tmp609=_tmp608.length),(_tmp609==2))&&(((_tmp610=_tmp608[0]),(_tmp610=="js_throw"))&&(_tmp610,true,(value=_tmp608[1]),true))))){if(true){return (("throw "+translate(value,"expr"))+";");}else{return false;}}else{if((((_tmp605=_tmp585),(_tmp605 instanceof Array))&&(((_tmp606=_tmp605.length),(_tmp606>=1))&&(((_tmp607=_tmp605[0]),(_tmp607=="array"))&&(_tmp607,true,(args=_tmp605.slice(1)),true))))){var r=function(){var f=function(x){return translate(x,"expr");};return (("["+args.map(f).join(","))+"]");}();return translate.expr(r,mode);}else{if((((_tmp602=_tmp585),(_tmp602 instanceof Array))&&(((_tmp603=_tmp602.length),(_tmp603>=1))&&(((_tmp604=_tmp602[0]),(_tmp604=="object"))&&(_tmp604,true,(args=_tmp602.slice(1)),true))))){var r=function(){var f=function(x){var a=translate(x[1],"expr");var b=translate(x[2],"expr");return ((a+":")+b);};return (("({"+args.map(f).join(","))+"})");}();return translate.expr(r,mode);}else{if((((_tmp595=_tmp585),(_tmp595 instanceof Array))&&(((_tmp596=_tmp595.length),(_tmp596==3))&&(((_tmp597=_tmp595[0]),(_tmp597=="send"))&&((_tmp597,true,(f=_tmp595[1]),true,(_tmp598=_tmp595[2]),(msg=_tmp598),true,(_tmp599=_tmp598),(_tmp599 instanceof Array))&&(((_tmp600=_tmp599.length),(_tmp600==2))&&(((_tmp601=_tmp599[0]),(_tmp601=="value"))&&(_tmp601,true,(s=_tmp599[1]),true)))))))){if(((typeof(s)=="string")&&s.match(RegExp("(?:^(?:[a-zA-Z_$]+)$)")))){var trf=translate(f,"expr");var trmsg=translate(s,"expr");return translate.expr(((trf+".")+trmsg),mode);}else{if(true){var trf=translate(f,"expr");var trmsg=translate(msg,"expr");return translate.expr((((trf+"[")+trmsg)+"]"),mode);}else{return false;}}}else{if((((_tmp589=_tmp585),(_tmp589 instanceof Array))&&(((_tmp590=_tmp589.length),(_tmp590==3))&&(((_tmp591=_tmp589[0]),(_tmp591=="send"))&&((_tmp591,true,(f=_tmp589[1]),true,(_tmp592=_tmp589[2]),(_tmp592 instanceof Array))&&(((_tmp593=_tmp592.length),(_tmp593>=1))&&(((_tmp594=_tmp592[0]),(_tmp594=="array"))&&(_tmp594,true,(args=_tmp592.slice(1)),true)))))))){var op=((typeof(f)=="string")&&___lib.send(js_op_table,f));if(op){return translate.expr(translate.op(op,args[0],args[1]),mode);}else{if(true){var trf=translate(f,"expr");var trargs=args.map(function(x){return translate(x,"expr");});return translate.expr((((trf+"(")+trargs.join(","))+")"),mode);}else{return false;}}}else{if((((_tmp586=_tmp585),(_tmp586 instanceof Array))&&(((_tmp587=_tmp586.length),(_tmp587==3))&&(((_tmp588=_tmp586[0]),(_tmp588=="send"))&&(_tmp588,true,(f=_tmp586[1]),true,(msg=_tmp586[2]),true))))){var trf=translate(f,"expr");var trmsg=translate(msg,"expr");return translate.expr((((("___lib.send("+trf)+",")+trmsg)+")"),mode);}else{if(((other=_tmp585),true)){throw other;}else{throw ["Could not find a match",_tmp585];}}}}}}}}}}}}}}}}}}}}}}}};(translate["mangle"]=function(name){var tr=({"+":"__plus__","-":"__minus__","*":"__asterisk__","/":"__slash__","%":"__percent__","^":"__caret__","#":"__hash__","&":"__amp__","|":"__pipe__","@":"__at__","!":"__bang__","?":"__qmark__","=":"__equal__","<":"__lt__",">":"__gt__","~":"__tilde__",".":"__dot__"});var r=[];for(var i=0;(i<name.length);(++i)){var c=___lib.send(name,i);r.push((___lib.send(tr,c)||c));}return r.join("");});(translate["body"]=function(b,mode){(orig=b);(b=aslist(b));var trst=function(stmt){return translate(stmt,"stmt");};var _tmp691=mode;var other;var _tmp692;var _tmp693;var _tmp694;if((((_tmp694=_tmp691),(_tmp694=="expr"))&&(_tmp694,true))){var x=["send",["lambda",[],orig],["array"]];return translate(x,mode);}else{if((((_tmp693=_tmp691),(_tmp693=="return"))&&(_tmp693,true))){var stmts=b.slice(0,(-1));var ret=___lib.send(b,(b.length-1));return (stmts.map(trst).join("")+translate(ret,"return"));}else{if((((_tmp692=_tmp691),(_tmp692=="stmt"))&&(_tmp692,true))){return b.map(trst).join("");}else{if(((other=_tmp691),true)){throw "OopsH";}else{throw ["Could not find a match",_tmp691];}}}}});(translate["expr"]=function(x,mode){var _tmp695=mode;var other;var _tmp696;var _tmp697;var _tmp698;if((((_tmp698=_tmp695),(_tmp698=="expr"))&&(_tmp698,true))){return x;}else{if((((_tmp697=_tmp695),(_tmp697=="stmt"))&&(_tmp697,true))){return (x+";");}else{if((((_tmp696=_tmp695),(_tmp696=="return"))&&(_tmp696,true))){return (("return "+x)+";");}else{if(((other=_tmp695),true)){throw "OopsI";}else{throw ["Could not find a match",_tmp695];}}}}});(translate["op"]=function(op,a,b){(e=function(){if((a===null)){return (op+translate(b,"expr"));}else{if((b===null)){return (translate(a,"expr")+op);}else{if(true){return ((translate(a,"expr")+op)+translate(b,"expr"));}else{return false;}}}}());return (("("+e)+")");});var fs=require("fs");var file=process.argv[2];var f=function(err,data){var p=parse(data);var ex=expand(stdenv,"top",["multi",p]);var prelude="var ___lib=require(\"./lib\");";return console.log((prelude+translate(ex,"stmt")));};fs.readFile(file,"utf8",f);
