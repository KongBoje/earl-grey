
'use strict';require('earlgrey-runtime/6');let $targ$0;let $0$0;let Body$0;$0$0=require("./helpers");Body$0=getProperty($0$0,"Body","./helpers");$targ$0=(function(mac$0){let t0$0;let t0$12;let t0$17;let t0$22;let t0$24;let t0$27;let $targ$1;let __require_mac$0;let getreqs$0;let $targ$2;let require_mac$0;let $targ$3;let requiremac_mac$0;let $targ$4;let provide_mac$0;let $targ$5;let inject_mac$0;let $targ$6;let globals_mac$0;let exports$0;exports$0=({});$targ$1=(function(context$0,info$0,form$0,expr$0){let req$0;req$0=__amp____colon__(["variable","require"],({"top":true}));return ["send",req$0,expr$0];});t0$0=getProjector(mac$0("__require"))($targ$1);if(t0$0[0]){__require_mac$0=t0$0[1];}else{___match_error($targ$1);}getreqs$0=(function getreqs(info$1,req$1,expr$1){let stmts$0;let names$0;let topfetch$0;let produce$0;stmts$0=[];names$0=[];topfetch$0=(function topfetch(){let pkg$0;let v$0;let args$0;let t0$1;let m$0$0;m$0$0=arguments;t0$1=m$0$0.length;if(((t0$1>=2)&&(t0$1<=3))){pkg$0=m$0$0[0];v$0=m$0$0[1];if((2>=t0$1)){args$0=null;}else{args$0=m$0$0[2];}stmts$0.push((args$0?["send",["symbol","="],["data",["send",["symbol","let"],v$0],["send",["send",req$1,["data",pkg$0]],args$0]]]:["send",["symbol","="],["data",["send",["symbol","let"],v$0],["send",req$1,["data",pkg$0]]]]));return v$0;}else{return ___match_error(m$0$0);}});produce$0=(function produce(temp$0$0,fetch$0){let t0$2;let t0$4;let t0$5;let m$1;let pkgv$0;let rqn$0;let name$1;let s$3;let args$3;let pkg$2;let subp$1;let pkg$1;let s$2;let name$0;let subp$0;let s$1;let s$0;let $$14535$0;let $$14536$0;let $$14537$0;let $$14538$0;let $$14539$0;let $$14540$0;let $$14541$0;let $$14542$0;let $$14543$0;let t0$3;let t1$0;let t2$0;let bridge$$14530$0;let t3$0;let t4$0;let t5$0;let t6$0;let t7$0;let expr$2;let ph$0$0;t0$2=temp$0$0;expr$2=t0$2;ph$0$0=t0$2;t0$3=ph$0$0;t1$0=t0$3.length;if((($$14537$0=(t1$0===2))&&(t0$3[0]==="symbol"))){s$0=t0$3[1];names$0.push(expr$2);return fetch$0(["value",s$0],expr$2);}else{if(($$14537$0&&((t0$3[0]==="value")&&((t2$0=t0$3[1]),(typeof(t2$0)==="string"))))){s$1=t2$0;return fetch$0(expr$2,__amp____colon__(["symbol",info$1.gensym()],({"reqname":s$1})));}else{bridge$$14530$0=ph$0$0;if(((Array.isArray(bridge$$14530$0)&&((t0$4=bridge$$14530$0.length),((t0$4>=1)&&((bridge$$14530$0[0]==="multi")&&((subp$0=Array.prototype.slice.call(bridge$$14530$0,1)),true)))))||(Array.isArray(bridge$$14530$0)&&((t0$5=bridge$$14530$0.length),((t0$5>=1)&&((bridge$$14530$0[0]==="data")&&((subp$0=Array.prototype.slice.call(bridge$$14530$0,1)),true))))))){m$1=null;$1:for(m$1 of subp$0){let p$0;p$0=m$1;produce$0(p$0,fetch$0);}return null;}else{t0$3=ph$0$0;t1$0=t0$3.length;if((($$14537$0=(t1$0===3))&&(($$14538$0=(t0$3[0]==="send"))&&((t2$0=t0$3[1]),(($$14540$0=Array.isArray(t2$0))&&((t3$0=t2$0.length),(($$14542$0=(t3$0===2))&&(($$14543$0=(t2$0[0]==="symbol"))&&((t2$0[1]==="^")&&((t4$0=t0$3[2]),(Array.isArray(t4$0)&&((t5$0=t4$0.length),((t5$0===3)&&((t4$0[0]==="data")&&((t6$0=t4$0[1]),(Array.isArray(t6$0)&&((t7$0=t6$0.length),((t7$0===1)&&(t6$0[0]==="void"))))))))))))))))))){name$0=t4$0[2];return fetch$0(name$0,__amp____colon__(["symbol",info$1.gensym()],({"reqname":name$0})));}else{if(($$14543$0&&((t2$0[1]==="as")&&((t4$0=t0$3[2]),(Array.isArray(t4$0)&&((t5$0=t4$0.length),((t5$0===3)&&(t4$0[0]==="data")))))))){pkg$1=t4$0[1];s$2=t4$0[2];names$0.push(s$2);return produce$0(pkg$1,(function(){let the_pkg$0;let args$1;let t0$6;let m$2$0;m$2$0=arguments;t0$6=m$2$0.length;if(((t0$6>=2)&&(t0$6<=3))){the_pkg$0=m$2$0[0];m$2$0[1];if((2>=t0$6)){args$1=null;}else{args$1=m$2$0[2];}return fetch$0(the_pkg$0,s$2,args$1);}else{return ___match_error(m$2$0);}}));}else{if(($$14543$0&&((t2$0[1]==="->")&&((t4$0=t0$3[2]),(Array.isArray(t4$0)&&((t5$0=t4$0.length),((t5$0===3)&&(t4$0[0]==="data")))))))){pkg$2=t4$0[1];subp$1=t4$0[2];pkgv$0=produce$0(pkg$2,fetch$0);rqn$0=(pkgv$0.reqname||pkgv$0[1]);return produce$0(subp$1,(function(){let x$0;let pkg$3;let v$1;let args$2;let t0$7;let m$3$0;m$3$0=arguments;t0$7=m$3$0.length;if(((t0$7>=2)&&(t0$7<=3))){pkg$3=m$3$0[0];v$1=m$3$0[1];if((2>=t0$7)){args$2=null;}else{args$2=m$3$0[2];}if(args$2){x$0=["send",["send",["symbol","getProperty"],["data",pkgv$0,pkg$3,["value",rqn$0]]],args$2];}else{x$0=["send",["symbol","getProperty"],["data",pkgv$0,pkg$3,["value",rqn$0]]];}stmts$0.push(["send",["symbol","="],["data",["send",["symbol","let"],v$1],x$0]]);return v$1;}else{return ___match_error(m$3$0);}}));}else{if(($$14538$0&&((name$1=t2$0),(Array.isArray(t2$0)&&((t3$0=t2$0.length),((t3$0===2)&&((t2$0[0]==="symbol")&&((s$3=t2$0[1]),(t4$0=t0$3[2]),(args$3=t4$0),(Array.isArray(t4$0)&&((t5$0=t4$0.length),((t5$0>=1)&&(t4$0[0]==="data")))))))))))){Array.prototype.slice.call(t4$0,1);names$0.push(name$1);return fetch$0(["value",s$3],name$1,args$3);}else{return ___match_error(ph$0$0);}}}}}}}});produce$0(expr$1,topfetch$0);return [stmts$0,names$0];});$targ$2=(function(context$1,info$2,form$1,temp$1$0){let t0$8;let t0$10;let t0$11;let t1$2;let $targ$7;let stmts$1;let expr$3;let field$0;let req$2;let $$14759$0;let $$14760$0;let t0$9;let t1$1;let bridge$$14758$0;let arg$0;let ph$1$0;t0$8=temp$1$0;arg$0=t0$8;ph$1$0=t0$8;req$2=info$2.mark(["symbol","__require"]);t0$9=ph$1$0;t1$1=t0$9.length;if(((t1$1===1)&&(t0$9[0]==="void"))){return ["variable","require"];}else{if(((t1$1===2)&&(t0$9[0]==="value"))){field$0=t0$9[1];return ["send",req$2,arg$0];}else{bridge$$14758$0=ph$1$0;if(((Array.isArray(bridge$$14758$0)&&((t0$10=bridge$$14758$0.length),((t0$10===2)&&((bridge$$14758$0[0]==="data")&&((expr$3=bridge$$14758$0[1]),true)))))||((expr$3=arg$0),true))){$targ$7=getreqs$0(info$2,req$2,expr$3);t0$11=$targ$7;if((Array.isArray(t0$11)&&((t1$2=t0$11.length),(t1$2===2)))){stmts$1=t0$11[0];t0$11[1];}else{___match_error($targ$7);}return ["splice"].concat(stmts$1);}else{return ___match_error(ph$1$0);}}}});t0$12=getProjector(mac$0("require"))($targ$2);if(t0$12[0]){require_mac$0=t0$12[1];}else{___match_error($targ$2);}$targ$3=(function(context$2,info$3,form$2,temp$2$0){let t0$13;let t0$14;let t0$15;let t1$3;let m$4;let acc$0;let temp$3;let vs$0;let body$0;let m$5;let acc$1;let temp$4;let macs$0;let req$3;let $targ$8;let stmts$2;let vars$0;let the_macros$0;let expr$4;let bridge$$14833$0;let arg$1;let ph$2$0;t0$13=temp$2$0;arg$1=t0$13;ph$2$0=t0$13;bridge$$14833$0=ph$2$0;if(((Array.isArray(bridge$$14833$0)&&((t0$14=bridge$$14833$0.length),((t0$14===2)&&((bridge$$14833$0[0]==="data")&&((expr$4=bridge$$14833$0[1]),true)))))||((expr$4=arg$1),true))){req$3=["symbol","__require"];$targ$8=getreqs$0(info$3,req$3,expr$4);t0$15=$targ$8;if((Array.isArray(t0$15)&&((t1$3=t0$15.length),(t1$3===2)))){stmts$2=t0$15[0];vars$0=t0$15[1];}else{___match_error($targ$8);}[stmts$2,vars$0];acc$0=[];temp$3=null;m$4=null;$2:for(m$4 of vars$0){let v$2;v$2=m$4;temp$3=["send",["symbol","="],["data",["void"],v$2]];acc$0.push(temp$3);}vs$0=acc$0;body$0=["multi"].concat(stmts$2).concat([["data"].concat(vs$0)]);the_macros$0=info$3.go(body$0,"parse","eval");acc$1=[];temp$4=null;m$5=null;$3:for(m$5 of items(the_macros$0)){let f$0;let k$0;let v$3;let t0$16;let t1$4;t0$16=m$5;if((Array.isArray(t0$16)&&((t1$4=t0$16.length),((t1$4===2)&&((k$0=t0$16[0]),(v$3=t0$16[1]),(typeof(v$3)==="function")))))){f$0=(function f(ctx$0,info$4,form$3,expr$5){return v$3.call(info$4,expr$5);});temp$4=["declare_raw",__amp____colon__(["symbol",k$0],({"env":info$3.env})),["macro",f$0]];acc$1.push(temp$4);}else{false;}}macs$0=acc$1;return ["splice"].concat(macs$0);}else{return ___match_error(ph$2$0);}});t0$17=getProjector(mac$0("requireMacros"))($targ$3);if(t0$17[0]){requiremac_mac$0=t0$17[1];}else{___match_error($targ$3);}$targ$4=(function(context$3,temp$5$0,form$4,temp$6$0){let t0$18;let t1$5;let t2$1;let t3$1;let t4$1;let m$6;let acc$2;let temp$7;let exp$0;let expr$6;t0$18=temp$6$0;if((Array.isArray(t0$18)&&((t1$5=t0$18.length),((t1$5===2)&&((t0$18[0]==="data")&&((t2$1=getProjector(Body$0)(t0$18[1])),(t2$1[0]&&((t3$1=t2$1[1]),(t4$1=t3$1.length),(t4$1>=0))))))))){expr$6=Array.prototype.slice.call(t3$1,0);}else{___match_error(temp$6$0);}exp$0=form$4.env.mark(["symbol","exports"]);return ["sink",["multi"].concat(((acc$2=[]),(temp$7=null),(m$6=null),(function(){$4:for(m$6 of expr$6){let t0$20;let t0$21;let other$0;let s$5;let name$3;let s$4;let name$2;let $$15022$0;let t0$19;let t1$6;let t2$2;let t3$2;let t4$2;let t5$1;let bridge$$15020$0;t0$19=m$6;s$4=t0$19;if((Array.isArray(t0$19)&&((t1$6=t0$19.length),((t1$6===2)&&(t0$19[0]==="symbol"))))){name$2=t0$19[1];temp$7=["send",["symbol","="],["data",["send",exp$0,["value",name$2]],s$4]];acc$2.push(temp$7);}else{if((Array.isArray(t0$19)&&((t1$6=t0$19.length),((t1$6===3)&&((t0$19[0]==="send")&&((t2$2=t0$19[1]),(Array.isArray(t2$2)&&((t3$2=t2$2.length),((t3$2===2)&&((t2$2[0]==="symbol")&&((t2$2[1]==="as")&&((t4$2=t0$19[2]),(Array.isArray(t4$2)&&((t5$1=t4$2.length),((t5$1===3)&&((t4$2[0]==="data")&&((s$5=t4$2[1]),(bridge$$15020$0=t4$2[2]),((Array.isArray(bridge$$15020$0)&&((t0$20=bridge$$15020$0.length),((t0$20===2)&&((bridge$$15020$0[0]==="symbol")&&((name$3=bridge$$15020$0[1]),true)))))||(Array.isArray(bridge$$15020$0)&&((t0$21=bridge$$15020$0.length),((t0$21===2)&&((bridge$$15020$0[0]==="value")&&((name$3=bridge$$15020$0[1]),true))))))))))))))))))))))){temp$7=["send",["symbol","="],["data",["send",exp$0,["value",name$3]],s$5]];acc$2.push(temp$7);}else{other$0=m$6;throw ErrorFactory(["syntax","provide"]).create("Each clause of provide must be 'sym' or 'sym as name'");acc$2.push(temp$7);}}}})(),acc$2))];});t0$22=getProjector(mac$0("provide"))($targ$4);if(t0$22[0]){provide_mac$0=t0$22[1];}else{___match_error($targ$4);}$targ$5=(function(context$4,temp$8$0,form$5,temp$9$0){let t0$23;let t1$7;let t2$3;let t3$3;let t4$3;let expr$7;t0$23=temp$9$0;if((Array.isArray(t0$23)&&((t1$7=t0$23.length),((t1$7===2)&&((t0$23[0]==="data")&&((t2$3=getProjector(Body$0)(t0$23[1])),(t2$3[0]&&((t3$3=t2$3[1]),(t4$3=t3$3.length),(t4$3>=0))))))))){expr$7=Array.prototype.slice.call(t3$3,0);}else{___match_error(temp$9$0);}return ["restmacro",(function(stmts$3){let exp$1;exp$1=form$5.env.mark(["symbol","exports"]);return [["multi",["send",["symbol","globals"],["data",["symbol","module"]]],["send",["symbol","="],["data",["send",["send",["symbol","module"],["send",["symbol","."],["data",["void"],["symbol","exports"]]]],["data"].concat(expr$7)],["multi",["send",["symbol","="],["data",["send",["symbol","var"],exp$1],["data",["symbol","="]]]],["multi"].concat(stmts$3),exp$1]]]]];})];});t0$24=getProjector(mac$0("inject"))($targ$5);if(t0$24[0]){inject_mac$0=t0$24[1];}else{___match_error($targ$5);}$targ$6=(function(context$5,temp$10$0,form$6,temp$11$0){let t0$25;let t1$8;let t2$4;let t3$4;let t4$4;let m$7;let acc$3;let temp$12;let globs$0;let vars$1;t0$25=temp$11$0;if((Array.isArray(t0$25)&&((t1$8=t0$25.length),((t1$8===2)&&((t0$25[0]==="data")&&((t2$4=getProjector(Body$0)(t0$25[1])),(t2$4[0]&&((t3$4=t2$4[1]),(t4$4=t3$4.length),(t4$4>=0))))))))){vars$1=Array.prototype.slice.call(t3$4,0);}else{___match_error(temp$11$0);}acc$3=[];temp$12=null;m$7=null;$5:for(m$7 of vars$1){let variable$0;let s$6;let t0$26;let t1$9;t0$26=m$7;variable$0=t0$26;if((Array.isArray(t0$26)&&((t1$9=t0$26.length),((t1$9===2)&&(t0$26[0]==="symbol"))))){s$6=t0$26[1];temp$12=["declare_raw",variable$0,__amp____colon__(["variable",s$6],({"top":true}))];acc$3.push(temp$12);}else{___match_error(m$7);}}globs$0=acc$3;return ["splice"].concat(globs$0).concat([["symbol","undefined"]]);});t0$27=getProjector(mac$0("globals"))($targ$6);if(t0$27[0]){globals_mac$0=t0$27[1];}else{___match_error($targ$6);}return exports$0;});(module["exports"]=$targ$0);[];
//# sourceMappingURL=modularity.js.map

