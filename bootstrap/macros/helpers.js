
'use strict';require('earlgrey-runtime/6');let accum$1;let accum$2;let accum$3;let accum$4;let accum$5;let accum$6;let accum$7;let accum$8;let accum$9;let accum$10;let $targ$10;let $targ$11;let $targ$12;let $targ$13;let $targ$14;let $targ$15;let $targ$16;let $targ$17;let $targ$18;let $targ$19;let $targ$20;let $targ$21;let $targ$22;let $targ$23;let $targ$24;let $targ$25;let $targ$26;let $targ$27;let $targ$28;let $targ$29;let $targ$30;let $targ$31;let $0$0;let __lt____lt____colon__$0;let $1$0;let Scope$0;let mac1$0;let $2$0;let parse_clauses$0;let $3$0;let Body$0;let camelCase$0;let embed_location$0;let error_embed_location$0;let match_error$0;let drop_ctx$0;let expr_mac$0;let expr_mac2$0;let ctx_mac$0;let _default_proj$0;let value_mac$0;let overridable$0;let protected_value$0;let var_operator$0;let accum_flags$0;let build_loop$0;let partial_pattern$0;let make_assigner$0;let disregard_specials$0;let pattern_handlers$0;let named_statement_matcher$0;let grab_statements$0;let flatmacro$0;let AssignmentHandler$0;let qqstruct$0;let qq$0;$0$0=require("../location");__lt____lt____colon__$0=getProperty($0$0,"<<:","../location");$1$0=require("../expand");Scope$0=getProperty($1$0,"Scope","../expand");mac1$0=getProperty($1$0,"mac1","../expand");$2$0=require("../pattern");parse_clauses$0=getProperty($2$0,"parse_clauses","../pattern");$3$0=require("../util");Body$0=getProperty($3$0,"Body","../util");camelCase$0=getProperty($3$0,"camelCase","../util");embed_location$0=(function embed_location(ph$0$0){let other$0;let url$0;let start$0;let end$0;let t0$0;let t1$0;let t2$0;t0$0=ph$0$0;if((___hasprop(t0$0,"location")&&((t1$0=t0$0.location),(___hasprop(t1$0,"source")&&((t2$0=t1$0.source),(___hasprop(t2$0,"url")&&((url$0=t2$0.url),(___hasprop(t1$0,"start")&&((start$0=t1$0.start),___hasprop(t1$0,"end")))))))))){end$0=t1$0.end;return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["value",url$0],["value",start$0],["value",end$0]]];}else{other$0=ph$0$0;return ["send",["send",["symbol","#"],["data",["void"],["symbol","location"]]],["data",["symbol","null"],["value",0],["value",0]]];}});error_embed_location$0=(function error_embed_location(error$0,target$0){return ["send",["symbol","throw"],["send",["symbol","&:"],["data",error$0,["data",["send",["symbol","="],["data",["symbol","location"],embed_location$0(target$0)]]]]]];});match_error$0=(function match_error(target$1){return __lt____lt____colon__$0(["send",["symbol","___match_error"],["data",target$1]],target$1);});drop_ctx$0=(function drop_ctx(f$0){return (function(context$0,info$0,form$0,arg$0){let rval$0;rval$0=false;try{rval$0=f$0(context$0,info$0,form$0,arg$0);rval$0;}catch(excv$0){let t0$2;let e$0;let t0$1;let t1$1;let t2$1;let t3$0;let t4$0;t0$1=excv$0;if((getChecker(ErrorFactory(["match"]))(t0$1)&&(___hasprop(t0$1,"args")&&((t1$1=t0$1.args),(Array.isArray(t1$1)&&((t2$1=t1$1.length),((t2$1===1)&&((t3$0=t1$1[0]),(___hasprop(t3$0,"value")&&((t4$0=t3$0.value),((t4$0===context$0)&&(!(Array.isArray(t4$0)&&((t0$2=t4$0.length),((t0$2===2)&&((t4$0[0]==="expr")&&(t4$0[1]==="expr"))))))))))))))))){rval$0=["nostep",form$0];rval$0;}else{e$0=excv$0;throw e$0;rval$0;}}return rval$0;});});expr_mac$0=(function expr_mac(f$1){return (function(ph$1$0,info$1,form$1,arg$1){let t0$3;let t0$4;let otherwise$0;let bridge$$8667$0;bridge$$8667$0=ph$1$0;if(((Array.isArray(bridge$$8667$0)&&((t0$3=bridge$$8667$0.length),((t0$3===2)&&((bridge$$8667$0[0]==="expr")&&(bridge$$8667$0[1]==="expr")))))||(Array.isArray(bridge$$8667$0)&&((t0$4=bridge$$8667$0.length),((t0$4===2)&&((bridge$$8667$0[0]==="expr")&&(bridge$$8667$0[1]==="head"))))))){return f$1(info$1,form$1,arg$1);}else{otherwise$0=ph$1$0;return ["nostep",form$1];}});});expr_mac2$0=(function expr_mac2(mac$0){return (function(ph$2$0,info$2,f$2,e$1){let x$0;let mac3$0;let f$4;let x$3;let ph$3$0;let t0$5;let t1$2;t0$5=ph$2$0;t1$2=t0$5.length;if(((t1$2===2)&&(t0$5[0]==="project"))){ph$3$0=t0$5[1];if(((x$0=ph$3$0),((x$0 instanceof Array)&&(x$0[0]==="pattern")))){mac3$0=(function mac3(c$0,info$3,f$3,temp$0$0){let t0$6;let t1$3;let x$2;let env$0;let x$1;let t0$7;let t1$4;let ph$4$0;t0$6=temp$0$0;if((Array.isArray(t0$6)&&((t1$3=t0$6.length),((t1$3===2)&&(t0$6[0]==="data"))))){ph$4$0=t0$6[1];}else{___match_error(temp$0$0);}t0$7=ph$4$0;t1$4=t0$7.length;if(((t1$4===3)&&(t0$7[0]==="use"))){env$0=t0$7[1];x$1=t0$7[2];return ["use",env$0,mac$0.call(info$3,__lt____lt____colon__$0(["data",x$1],e$1))];}else{x$2=ph$4$0;return mac$0.call(info$3,__lt____lt____colon__$0(["data",x$2],x$2));}});return ["unconditional",["macro",mac3$0]];}else{f$4=(function f(_ctx$0,_info$0,_form$0,_e$0){return ["data",["value",true],mac$0.call(_info$0,_e$0)];});return ["nostep",["macro",f$4]];}}else{if(((x$3=ph$2$0),((x$3 instanceof Array)&&(x$3[0]==="expr")))){return mac$0.call(info$2,e$1);}else{return ___match_error(ph$2$0);}}});});ctx_mac$0=(function ctx_mac(mac$1){return (function(ctx$0,info$4,f$5,e$2){return mac$1.call(info$4,ctx$0,e$2);});});_default_proj$0=(function _default_proj(name$0){return (function(x$4){return ["send",["symbol","throw"],["send",["send",["symbol","E"],["send",["symbol","."],["data",["void"],["symbol","project"]]]],["data",["send",["symbol","+"],["data",["send",["symbol","+"],["data",["value","Cannot project a value with '"],["value",name$0]]],["value","!'"]]]]]];});});value_mac$0=(function value_mac(){let name$1;let chk$0;let proj$0;let t0$8;let m$0$0;m$0$0=arguments;t0$8=m$0$0.length;if(((t0$8>=2)&&(t0$8<=3))){name$1=m$0$0[0];chk$0=m$0$0[1];if((2>=t0$8)){proj$0=_default_proj$0(name$1);}else{proj$0=m$0$0[2];}return (function(temp$1$0,temp$2$0,form$2,arg$2){let t0$9;let x$5;let m$1;let x$7;let m$3;let x$9;let m$5$0;let ctx$2;let ctx$1;let ph$5$0;t0$9=temp$1$0;ctx$1=t0$9;ph$5$0=t0$9;if(((x$5=ph$5$0),((x$5 instanceof Array)&&(x$5[0]==="check")))){m$1=(function m(){let x$6;let t0$10;let t1$5;let t2$2;let m$2$0;m$2$0=arguments;t0$10=m$2$0.length;if(((t0$10>=1)&&(Array.prototype.slice.call(m$2$0,0,-1),(t1$5=m$2$0[(t0$10-1)]),(Array.isArray(t1$5)&&((t2$2=t1$5.length),((t2$2===2)&&(t1$5[0]==="data"))))))){x$6=t1$5[1];return chk$0(x$6);}else{return ___match_error(m$2$0);}});return ["nostep",["macro",m$1]];}else{if(((x$7=ph$5$0),((x$7 instanceof Array)&&(x$7[0]==="project")))){m$3=(function m(){let x$8;let t0$11;let t1$6;let t2$3;let m$4$0;m$4$0=arguments;t0$11=m$4$0.length;if(((t0$11>=1)&&(Array.prototype.slice.call(m$4$0,0,-1),(t1$6=m$4$0[(t0$11-1)]),(Array.isArray(t1$6)&&((t2$3=t1$6.length),((t2$3===2)&&(t1$6[0]==="data"))))))){x$8=t1$6[1];return proj$0(x$8);}else{return ___match_error(m$4$0);}});return ["nostep",["macro",m$3]];}else{ctx$2=ph$5$0;m$5$0=arg$2;if(((x$9=m$5$0),((x$9 instanceof Array)&&(x$9[0]==="void")))){return ["variable",name$1];}else{return ["send",["variable",name$1],arg$2];}}}});}else{return ___match_error(m$0$0);}});overridable$0=(function overridable(f$6){return (function(temp$3$0,info$5,form$3,arg$3){let t0$12;let x$10;let other$1;let t0$13;let t1$7;let context$1;let ph$6$0;t0$12=temp$3$0;context$1=t0$12;ph$6$0=t0$12;if(((x$10=ph$6$0),((x$10 instanceof Array)&&(x$10[0]==="pattern")))){return ["nostep",form$3];}else{t0$13=ph$6$0;t1$7=t0$13.length;if(((t1$7===2)&&((t0$13[0]==="expr")&&(t0$13[1]==="multi")))){return ["nostep",form$3];}else{other$1=ph$6$0;return f$6(context$1,info$5,form$3,arg$3);}}});});protected_value$0=(function protected_value(name$2,value$0){return (function(ph$7$0,temp$4$0,form$4,arg$4){let x$11;let other$3;let t0$14;let m$6$0;let other$2;if(((x$11=ph$7$0),((x$11 instanceof Array)&&(x$11[0]==="pattern")))){throw ErrorFactory(["syntax","pattern"]).create((("'"+name$2)+"' is not a valid pattern and cannot be redeclared"));}else{other$2=ph$7$0;m$6$0=arg$4;if((Array.isArray(m$6$0)&&((t0$14=m$6$0.length),((t0$14===1)&&(m$6$0[0]==="void"))))){return ["value",value$0];}else{other$3=m$6$0;return ["send",["value",value$0],arg$4];}}});});var_operator$0=(function var_operator(name$3){return (function(ph$8$0,temp$5$0,form$5,expr$0){let t0$15;let x$12;let x$13;let x$14;let other$4;let s$0;let t0$17;let t1$8;let ph$9$0;let $$9087$0;let $$9088$0;let t0$16;let m$7$0;let sym$0;let bridge$$9048$0;let env$1;t0$15=temp$5$0;if(___hasprop(t0$15,"env")){env$1=t0$15.env;}else{___match_error(temp$5$0);}bridge$$9048$0=ph$8$0;if((((x$12=bridge$$9048$0),((x$12 instanceof Array)&&(x$12[0]==="check")))||((x$13=bridge$$9048$0),((x$13 instanceof Array)&&(x$13[0]==="project"))))){return ["nostep",form$5];}else{sym$0=__amp__(["symbol",name$3],({"env":env$1}));m$7$0=expr$0;if((($$9087$0=Array.isArray(m$7$0))&&((t0$16=m$7$0.length),((t0$16===1)&&(m$7$0[0]==="void"))))){return sym$0;}else{if(($$9087$0&&((t0$16===3)&&((m$7$0[0]==="data")&&((x$14=m$7$0[1]),((x$14 instanceof Array)&&(x$14[0]==="void"))))))){ph$9$0=m$7$0[2];t0$17=ph$9$0;if((Array.isArray(t0$17)&&((t1$8=t0$17.length),((t1$8===2)&&(t0$17[0]==="symbol"))))){s$0=t0$17[1];return ["send",sym$0,["value",s$0]];}else{other$4=ph$9$0;return ["send",sym$0,other$4];}}else{return ___match_error(m$7$0);}}}});});accum_flags$0=(function accum_flags(){let make$0;let mac$2;let also_values$0;let t0$18;let m$8$0;m$8$0=arguments;t0$18=m$8$0.length;if(((t0$18>=1)&&(t0$18<=2))){mac$2=m$8$0[0];if((1>=t0$18)){also_values$0=true;}else{also_values$0=m$8$0[1];}make$0=(function make(flags$0){return (function(context$2,info$6,form$6,ph$10$0){let other$5;let flag$1;let flag$0;let $$9164$0;let t0$19;let t1$9;let t2$4;let t3$1;let t4$1;let t5$0;let t6$0;let t7$0;let t8$0;let t9$0;t0$19=ph$10$0;if((Array.isArray(t0$19)&&((t1$9=t0$19.length),((t1$9===2)&&((t0$19[0]==="value")&&((flag$0=t0$19[1]),also_values$0)))))){return ["macro",make$0(flags$0.concat([flag$0]))];}else{t1$9=t0$19.length;if(((t1$9===3)&&((t0$19[0]==="send")&&((t2$4=t0$19[1]),(Array.isArray(t2$4)&&((t3$1=t2$4.length),((t3$1===2)&&((t2$4[0]==="symbol")&&((t2$4[1]===".")&&((t4$1=t0$19[2]),(Array.isArray(t4$1)&&((t5$0=t4$1.length),((t5$0===3)&&((t4$1[0]==="data")&&((t6$0=t4$1[1]),(Array.isArray(t6$0)&&((t7$0=t6$0.length),((t7$0===1)&&((t6$0[0]==="void")&&((t8$0=t4$1[2]),(Array.isArray(t8$0)&&((t9$0=t8$0.length),((t9$0===2)&&(t8$0[0]==="symbol")))))))))))))))))))))))){flag$1=t8$0[1];return ["macro",make$0(flags$0.concat([flag$1]))];}else{other$5=ph$10$0;return mac$2(context$2,info$6,form$6,other$5,flags$0);}}});});return make$0([]);}else{return ___match_error(m$8$0);}});build_loop$0=(function build_loop(info$7,env$2,form$7,li$0,clauses$0,wrap$0,pre$0,post$0,opt$0){let t0$20;let t0$21;let accum$0;let lbl$0;let freshenv$0;let i$0;let len$0;let $targ$0;let first_mac$0;let $targ$1;let last_mac$0;let newscope$0;let m$9;if(env$2){lbl$0=__amp__(["value",info$7.gensym()],({"env":env$2}));}else{lbl$0=["value",info$7.gensym()];}freshenv$0=info$7.expander.mkenv();i$0=__amp__(["symbol","i"],({"env":freshenv$0}));len$0=__amp__(["symbol","len"],({"env":freshenv$0}));$targ$0=(function(temp$6$0,temp$7$0,form$8,subp$0){let x$15;if(((x$15=temp$6$0),((x$15 instanceof Array)&&(x$15[0]==="pattern")))){}else{___match_error(temp$6$0);}return ["test",["send",["symbol","==="],["data",i$0,["value",0]]],subp$0];});t0$20=getProjector(drop_ctx$0)($targ$0);if(t0$20[0]){first_mac$0=t0$20[1];}else{___match_error($targ$0);}$targ$1=(function(temp$8$0,temp$9$0,form$9,subp$1){let x$16;if(((x$16=temp$8$0),((x$16 instanceof Array)&&(x$16[0]==="pattern")))){}else{___match_error(temp$8$0);}return ["test",["send",["symbol","==="],["data",i$0,["send",["symbol","-"],["data",len$0,["value",1]]]]],subp$1];});t0$21=getProjector(drop_ctx$0)($targ$1);if(t0$21[0]){last_mac$0=t0$21[1];}else{___match_error($targ$1);}newscope$0=Scope$0(info$7.scope);env$2.bind(newscope$0,"first",["macro",first_mac$0]);env$2.bind(newscope$0,"last",["macro",last_mac$0]);m$9=__lt____lt____colon__$0(["symbol","m"],form$7);if(opt$0.forof){return ["multi",pre$0,["send",["send",["symbol","for"],lbl$0],["data",["send",["symbol","of"],["data",m$9,li$0]],parse_clauses$0(info$7.with_scope(newscope$0),m$9,clauses$0,__amp__(opt$0,({"wrap":wrap$0})))]],post$0];}else{return ["multi",pre$0,["send",["symbol","let"],["data",["multi",["send",["symbol","="],["data",["symbol","temp"],li$0]],["send",["symbol","="],["data",len$0,["send",["symbol","temp"],["send",["symbol","."],["data",["void"],["symbol","length"]]]]]]],["send",["send",["symbol","for"],lbl$0],["data",["multi",["send",["symbol","="],["data",["send",["symbol","var"],i$0],["value",0]]],["send",["symbol","<"],["data",i$0,len$0]],["send",["symbol","++"],["data",i$0,["void"]]]],["multi",["send",["symbol","="],["data",m$9,["send",["symbol","___js_fetch"],["data",["symbol","temp"],i$0]]]],parse_clauses$0(info$7.with_scope(newscope$0),m$9,clauses$0,__amp__(opt$0,((accum$0=({})),(accum$0["wrap"]=(function wrap(x$17){return wrap$0(x$17,i$0);})),accum$0)))]]]]],post$0];}});partial_pattern$0=(function partial_pattern(operator$0){let x$18;let m$10$0;let op$0;m$10$0=operator$0;if(((x$18=m$10$0),((x$18 instanceof Array)&&(x$18[0]==="symbol")))){op$0=operator$0;}else{if((typeof(m$10$0)==="string")){op$0=["variable",operator$0];}else{op$0=___match_error(m$10$0);}}return (function(context$3,temp$10$0,form$10,expr$1){let x$19;let subp2$0;let m$12;let other$6;let subp$2;let val$0;let $$9360$0;let $$9361$0;let $$9362$0;let t0$22;let t1$10;let t2$5;let m$11$0;m$11$0=[context$3,expr$1];if((($$9360$0=Array.isArray(m$11$0))&&((t0$22=m$11$0.length),(($$9362$0=(t0$22===2))&&(((x$19=m$11$0[0]),((x$19 instanceof Array)&&(x$19[0]==="pattern")))&&((t1$10=m$11$0[1]),(Array.isArray(t1$10)&&((t2$5=t1$10.length),((t2$5===3)&&(t1$10[0]==="data")))))))))){subp$2=t1$10[1];val$0=t1$10[2];if(equal(subp$2,["void"])){subp2$0=["ignore"];}else{subp2$0=subp$2;}m$12=mac1$0((function(x$20){return ["send",op$0,["data",x$20,val$0]];}));return ["check",m$12,subp2$0];}else{if(($$9362$0&&(m$11$0[0],(t1$10=m$11$0[1]),(Array.isArray(t1$10)&&((t2$5=t1$10.length),((t2$5===1)&&(t1$10[0]==="void"))))))){return op$0;}else{other$6=m$11$0;return ["send",op$0,expr$1];}}});});make_assigner$0=(function make_assigner(op$1){return (function(context$4,temp$11$0,form$11,temp$12$0){let t0$23;let t1$11;let a$0;let b$0;t0$23=temp$12$0;if((Array.isArray(t0$23)&&((t1$11=t0$23.length),((t1$11===3)&&(t0$23[0]==="data"))))){a$0=t0$23[1];b$0=t0$23[2];}else{___match_error(temp$12$0);}return ["assign",a$0,["send",["symbol",op$1],["data",a$0,b$0]]];});});disregard_specials$0=(function disregard_specials(temp$13$0,value$1){let t0$24;let t1$12;let kind$0;let expr$2;t0$24=temp$13$0;if((Array.isArray(t0$24)&&((t1$12=t0$24.length),((t1$12===2)&&(t0$24[0]==="special"))))){kind$0=t0$24[1];expr$2=t0$24;}else{___match_error(temp$13$0);}throw ErrorFactory(["syntax","pattern","special"]).create("Special token cannot be used here",({"special":expr$2}));});pattern_handlers$0=({"declare_variables":__amp____colon__(({"allow_nested":true,"allow_arguments":true,"special":disregard_specials$0}),__amp____colon__(((accum$1=({})),(accum$1["assign"]=(function assign(temp$14$0,value$2){let t0$25;let v$1;let name$4;let t0$26;let t1$13;let v$0;let ph$11$0;t0$25=temp$14$0;v$0=t0$25;ph$11$0=t0$25;t0$26=ph$11$0;t1$13=t0$26.length;if(((t1$13===2)&&(t0$26[0]==="symbol"))){name$4=t0$26[1];return ["do",__lt____lt____colon__$0(["assign",v$0,__amp____colon__(value$2,({"name":name$4}))],v$0)];}else{v$1=ph$11$0;return ["do",__lt____lt____colon__$0(["assign",v$1,value$2],v$1)];}})),accum$1),__amp____colon__(({"tags":({"declare_mode":"unqualified"})}),__amp____colon__(((accum$2=({})),(accum$2["declare"]=(function declare(temp$15$0,vars$0){let m$13;let acc$0;let temp$16;acc$0=[];temp$16=null;m$13=null;$4:for(m$13 of vars$0){let m$14$0;let v$2;v$2=m$13;m$14$0=v$2.declare_mode;if((m$14$0==="set")){temp$16=["splice"];}else{if((m$14$0==="let")){temp$16=["declare",__amp__(v$2,({"mutable":false}))];}else{if((m$14$0==="var")){temp$16=["declare",__amp__(v$2,({"mutable":true}))];}else{if((m$14$0==="unqualified")){temp$16=["declare",__amp__(v$2,({"mutable":false,"use_previous":true}))];}else{temp$16=___match_error(m$14$0);}}}}acc$0.push(temp$16);}return acc$0;})),accum$2),__amp____colon__(((accum$3=({})),(accum$3["success"]=(function success(temp$17$0){return ["multi"];})),accum$3),__amp____colon__(((accum$4=({})),(accum$4["failure"]=(function failure(target$2){return match_error$0(target$2);})),accum$4),({"wrapOrder":0}))))))),"build_object":__amp____colon__(({"strings_as_variables":true,"allow_nested":true,"allow_arguments":true,"special":disregard_specials$0}),__amp____colon__(((accum$5=({})),(accum$5["assign"]=(function assign(temp$18$0,value$3,temp$19$0){let t0$27;let t1$14;let t0$28;let bridge$$9586$0;let v$3;bridge$$9586$0=temp$18$0;if(((Array.isArray(bridge$$9586$0)&&((t0$27=bridge$$9586$0.length),((t0$27===2)&&((bridge$$9586$0[0]==="symbol")&&((t1$14=getProjector(camelCase$0)(bridge$$9586$0[1])),(t1$14[0]&&((v$3=t1$14[1]),true)))))))||(Array.isArray(bridge$$9586$0)&&((t0$28=bridge$$9586$0.length),((t0$28===2)&&((bridge$$9586$0[0]==="value")&&((v$3=bridge$$9586$0[1]),true))))))){}else{___match_error(temp$18$0);}return ["do",__lt____lt____colon__$0(["assign",["send",["symbol","accum"],["value",v$3]],value$3],v$3)];})),accum$5),__amp____colon__(((accum$6=({})),(accum$6["declare"]=(function declare(temp$20$0,vars$1){return [["declare",["symbol","accum"],["data",["symbol","="]]]];})),accum$6),__amp____colon__(((accum$7=({})),(accum$7["success"]=(function success(temp$21$0){return ["symbol","accum"];})),accum$7),__amp____colon__(((accum$8=({})),(accum$8["failure"]=(function failure(target$3){return match_error$0(target$3);})),accum$8),({"wrapOrder":0}))))))});named_statement_matcher$0=(function named_statement_matcher(name$5){let t0$30;let $targ$2;let p$0;let $targ$3;$targ$2=(function(ph$12$0){let t0$29;let t1$15;let t2$6;let t3$2;t0$29=ph$12$0;t1$15=t0$29.length;if(((t1$15===3)&&((t0$29[0]==="send")&&((t2$6=t0$29[1]),(Array.isArray(t2$6)&&((t3$2=t2$6.length),((t3$2===2)&&((t2$6[0]==="symbol")&&(t2$6[1]===name$5))))))))){t0$29[2];return true;}else{return false;}});t0$30=getProjector(predicate)($targ$2);if(t0$30[0]){p$0=t0$30[1];}else{___match_error($targ$2);}$targ$3=(function(){return name$5;});(p$0["toString"]=$targ$3);[];return p$0;});grab_statements$0=(function grab_statements(){let stmt$0;let rest$0;let t0$33;let t1$18;let m$16$0;let m$17;let n$0;let bridge$$9814$0;let m$20$0;let matches$0;let rest$2;let t0$36;let t1$20;let t0$37;let t1$21;let $targ$5;let one$0;let rest1$0;let $targ$6;let two$0;let rest2$0;let pattern$2;let others$0;let pattern$1;let min$0;let max$0;let err$0;let opts$0;let pattern$0;let $$9708$0;let $$9709$0;let t0$32;let t1$17;let descr$0;let ph$14$0;let all$0;let transform$0;let t0$31;let t1$16;let m$15$0;m$15$0=arguments;t0$31=m$15$0.length;if(((t0$31>=2)&&(t0$31<=3))){t1$16=m$15$0[0];descr$0=t1$16;ph$14$0=t1$16;all$0=m$15$0[1];if((2>=t0$31)){transform$0=(function(x$21){return x$21;});}else{transform$0=m$15$0[2];}t0$32=ph$14$0;if((typeof(t0$32)==="function")){pattern$0=t0$32;m$16$0=all$0;if((Array.isArray(m$16$0)&&((t0$33=m$16$0.length),((t0$33>=1)&&((t1$18=m$16$0[0]),getChecker(pattern$0)(t1$18)))))){stmt$0=t1$18;rest$0=Array.prototype.slice.call(m$16$0,1);return [transform$0(stmt$0),rest$0];}else{return [null,all$0];}}else{t1$17=t0$32.length;if(((t1$17>=1)&&(t0$32[0]==="any"))){opts$0=Array.prototype.slice.call(t0$32,1);m$17=null;$5:for(m$17 of opts$0){let m$19;let rest$1;let $$9784$0;let $$9785$0;let $$9786$0;let t0$34;let m$18$0;let opt$1;opt$1=m$17;m$18$0=grab_statements$0(opt$1,all$0,transform$0);if((($$9784$0=Array.isArray(m$18$0))&&((t0$34=m$18$0.length),(($$9786$0=(t0$34===2))&&(m$18$0[0]===null))))){m$18$0[1];undefined;}else{if($$9786$0){m$19=m$18$0[0];rest$1=m$18$0[1];return [m$19,rest$1];}else{___match_error(m$18$0);}}}return [null,all$0];}else{if((((t1$17>=2)&&(t1$17<=5))&&(t0$32[0]==="multiple"))){pattern$1=t0$32[1];if((2>=t1$17)){min$0=0;}else{min$0=t0$32[2];}if((3>=t1$17)){max$0=Infinity;}else{max$0=t0$32[3];}if((4>=t1$17)){err$0=true;}else{err$0=t0$32[4];}matches$0=[];rest$2=all$0;$6:while(true){let t0$35;let t1$19;let $targ$4;let _matches$0;$targ$4=grab_statements$0(pattern$1,rest$2,transform$0);t0$35=$targ$4;if((Array.isArray(t0$35)&&((t1$19=t0$35.length),(t1$19===2)))){_matches$0=t0$35[0];rest$2=t0$35[1];}else{___match_error($targ$4);}[_matches$0,rest$2];if(equal(_matches$0,null)){break $6;}matches$0.push(_matches$0);if(equal(rest$2,[])){break $6;}}m$20$0=matches$0.length;n$0=m$20$0;bridge$$9814$0=m$20$0;if(((bridge$$9814$0<min$0)||(bridge$$9814$0>max$0))){if(err$0){throw ErrorFactory(["syntax","wrong_multiplicity"]).create(((((((((n$0+" instances of the pattern '")+pattern$1)+"' were found.")+" between ")+min$0)+" and ")+max$0)+" were expected."),({"pattern":pattern$1,"matches":matches$0}));}return [["multiple"],all$0];}else{return [["multiple"].concat(matches$0),rest$2];}}else{if(((t1$17===1)&&(t0$32[0]==="seq"))){return [["seq"],all$0];}else{if(((t1$17>=2)&&(t0$32[0]==="seq"))){pattern$2=t0$32[1];others$0=Array.prototype.slice.call(t0$32,2);$targ$5=grab_statements$0(pattern$2,all$0,transform$0);t0$36=$targ$5;if((Array.isArray(t0$36)&&((t1$20=t0$36.length),(t1$20===2)))){one$0=t0$36[0];rest1$0=t0$36[1];}else{___match_error($targ$5);}[one$0,rest1$0];if((one$0===null)){return [null,all$0];}$targ$6=grab_statements$0(["seq"].concat(others$0),rest1$0,transform$0);t0$37=$targ$6;if((Array.isArray(t0$37)&&((t1$21=t0$37.length),(t1$21===2)))){two$0=t0$37[0];rest2$0=t0$37[1];}else{___match_error($targ$6);}[two$0,rest2$0];if((two$0===null)){return [null,all$0];}return [["seq",one$0].concat(two$0.slice(1)),rest2$0];}else{throw ErrorFactory(["unknown_pattern"]).create(descr$0);}}}}}}else{return ___match_error(m$15$0);}});flatmacro$0=(function flatmacro(pattern$3,assemble$0){return ["restmacro",(function(stmts$0){let t0$38;let t1$22;let $targ$7;let result$0;let rest$3;$targ$7=grab_statements$0(pattern$3,stmts$0);t0$38=$targ$7;if((Array.isArray(t0$38)&&((t1$22=t0$38.length),(t1$22===2)))){result$0=t0$38[0];rest$3=t0$38[1];}else{___match_error($targ$7);}[result$0,rest$3];return [assemble$0(result$0)].concat(rest$3);})];});AssignmentHandler$0=(function AssignmentHandler(temp$22$0,temp$23$0){let $targ$8;let $it$0;if((!getChecker(AssignmentHandler$0)(this))){$it$0=Object.create(AssignmentHandler$0.prototype);}else{$it$0=this;}($it$0["subp"]=temp$22$0);($it$0["wrapPlaceholder"]=temp$23$0);$targ$8=1;($it$0["wrapAssignmentOrder"]=$targ$8);[];return $it$0;});(AssignmentHandler$0.prototype["expand"]=(function expand(info$8){let $targ$9;let $it$1;let self$0;$it$1=this;self$0=this;$targ$9=info$8.env.mark(["symbol",info$8.gensym("$get")]);($it$1["placeholder"]=$targ$9);[];if($it$1.subp){return ["all",$it$1.subp,$it$1.placeholder];}else{return $it$1.placeholder;}}));(AssignmentHandler$0.prototype["wrapAssignment"]=(function wrapAssignment(expr$3,info$9,opt$2){let $it$2;let self$1;$it$2=this;self$1=this;return ["splice",expr$3,$it$2.wrapPlaceholder($it$2.placeholder)];}));__amp____colon__(AssignmentHandler$0,__amp____colon__(((accum$9=({})),(accum$9["::name"]="AssignmentHandler"),accum$9),((accum$10=({})),(accum$10["::egclass"]=true),accum$10)));qqstruct$0=(function qqstruct(name$6,args$0){return ["data",["value",name$6]].concat(args$0);});qq$0=(function qq(){let m$22;let acc$1;let temp$24;let m$23;let acc$2;let temp$25;let m$24;let acc$3;let temp$26;let res$0;let name$7;let args$2;let ops$0;let args$1;let insert$2;let insert$1;let insert$0;let v$4;let s$2;let s$1;let $$10009$0;let $$10010$0;let $$10011$0;let $$10012$0;let $$10013$0;let $$10014$0;let $$10015$0;let $$10016$0;let $$10017$0;let t0$40;let t1$24;let t2$7;let t3$3;let t4$2;let t5$1;let t6$1;let t7$1;let expr$4;let ph$16$0;let annotate$0;let t0$39;let t1$23;let m$21$0;m$21$0=arguments;t0$39=m$21$0.length;if(((t0$39>=1)&&(t0$39<=2))){t1$23=m$21$0[0];expr$4=t1$23;ph$16$0=t1$23;if((1>=t0$39)){annotate$0=false;}else{annotate$0=m$21$0[1];}t0$40=ph$16$0;t1$24=t0$40.length;if((($$10011$0=(t1$24===2))&&(t0$40[0]==="symbol"))){s$1=t0$40[1];return qqstruct$0("symbol",[["value",s$1]]);}else{if(($$10011$0&&(t0$40[0]==="char"))){s$2=t0$40[1];return qqstruct$0("char",[["value",s$2]]);}else{if(((t1$24===1)&&(t0$40[0]==="void"))){return qqstruct$0("void",[]);}else{if(((t1$24===2)&&(t0$40[0]==="value"))){v$4=t0$40[1];return qqstruct$0("value",[expr$4]);}else{if((($$10011$0=(t1$24===3))&&(($$10012$0=(t0$40[0]==="send"))&&((t2$7=t0$40[1]),(($$10014$0=Array.isArray(t2$7))&&((t3$3=t2$7.length),(($$10016$0=(t3$3===2))&&(($$10017$0=(t2$7[0]==="symbol"))&&((t2$7[1]==="^")&&((t4$2=t0$40[2]),(Array.isArray(t4$2)&&((t5$1=t4$2.length),((t5$1===3)&&((t4$2[0]==="data")&&((t6$1=t4$2[1]),(Array.isArray(t6$1)&&((t7$1=t6$1.length),((t7$1===1)&&(t6$1[0]==="void"))))))))))))))))))){insert$0=t4$2[2];return insert$0;}else{if(($$10017$0&&((t2$7[1]==="^=")&&((t4$2=t0$40[2]),(Array.isArray(t4$2)&&((t5$1=t4$2.length),((t5$1===3)&&((t4$2[0]==="data")&&((t6$1=t4$2[1]),(Array.isArray(t6$1)&&((t7$1=t6$1.length),((t7$1===1)&&(t6$1[0]==="void"))))))))))))){insert$1=t4$2[2];return qqstruct$0("value",[insert$1]);}else{if(($$10017$0&&((t2$7[1]==="^*")&&((t4$2=t0$40[2]),(Array.isArray(t4$2)&&((t5$1=t4$2.length),((t5$1===3)&&((t4$2[0]==="data")&&((t6$1=t4$2[1]),(Array.isArray(t6$1)&&((t7$1=t6$1.length),((t7$1===1)&&(t6$1[0]==="void"))))))))))))){insert$2=t4$2[2];return ["send",["symbol","*"],["data",["void"],insert$2]];}else{if(((t1$24>=2)&&(t0$40[0]==="mismix"))){ops$0=t0$40[1];args$1=Array.prototype.slice.call(t0$40,2);return qqstruct$0("mismix",[["data"].concat(((acc$1=[]),(temp$24=null),(m$22=null),(function(){$7:for(m$22 of ops$0){let op$2;op$2=m$22;temp$24=qq$0(op$2,annotate$0);acc$1.push(temp$24);}})(),acc$1))].concat(((acc$2=[]),(temp$25=null),(m$23=null),(function(){$8:for(m$23 of args$1){let arg$5;arg$5=m$23;temp$25=qq$0(arg$5,annotate$0);acc$2.push(temp$25);}})(),acc$2)));}else{if((t1$24>=1)){name$7=t0$40[0];args$2=Array.prototype.slice.call(t0$40,1);res$0=qqstruct$0(name$7,((acc$3=[]),(temp$26=null),(m$24=null),(function(){$9:for(m$24 of args$2){let arg$6;arg$6=m$24;temp$26=qq$0(arg$6,annotate$0);acc$3.push(temp$26);}})(),acc$3));if((annotate$0&&expr$4.fromop)){return ["send",["symbol","&"],["data",res$0,["data",["send",["symbol","="],["data",["symbol","fromop"],["symbol","true"]]]]]];}else{return res$0;}}else{return ___match_error(ph$16$0);}}}}}}}}}}else{return ___match_error(m$21$0);}});$targ$10=embed_location$0;(exports["embed_location"]=$targ$10);[];$targ$11=error_embed_location$0;(exports["error_embed_location"]=$targ$11);[];$targ$12=match_error$0;(exports["match_error"]=$targ$12);[];$targ$13=drop_ctx$0;(exports["drop_ctx"]=$targ$13);[];$targ$14=expr_mac$0;(exports["expr_mac"]=$targ$14);[];$targ$15=expr_mac2$0;(exports["expr_mac2"]=$targ$15);[];$targ$16=ctx_mac$0;(exports["ctx_mac"]=$targ$16);[];$targ$17=value_mac$0;(exports["value_mac"]=$targ$17);[];$targ$18=overridable$0;(exports["overridable"]=$targ$18);[];$targ$19=protected_value$0;(exports["protected_value"]=$targ$19);[];$targ$20=var_operator$0;(exports["var_operator"]=$targ$20);[];$targ$21=accum_flags$0;(exports["accum_flags"]=$targ$21);[];$targ$22=build_loop$0;(exports["build_loop"]=$targ$22);[];$targ$23=partial_pattern$0;(exports["partial_pattern"]=$targ$23);[];$targ$24=make_assigner$0;(exports["make_assigner"]=$targ$24);[];$targ$25=pattern_handlers$0;(exports["pattern_handlers"]=$targ$25);[];$targ$26=Body$0;(exports["Body"]=$targ$26);[];$targ$27=named_statement_matcher$0;(exports["named_statement_matcher"]=$targ$27);[];$targ$28=grab_statements$0;(exports["grab_statements"]=$targ$28);[];$targ$29=flatmacro$0;(exports["flatmacro"]=$targ$29);[];$targ$30=AssignmentHandler$0;(exports["AssignmentHandler"]=$targ$30);[];$targ$31=qq$0;(exports["qq"]=$targ$31);[];
//# sourceMappingURL=helpers.js.map

