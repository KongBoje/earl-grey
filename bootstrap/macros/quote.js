
'use strict';require('earlgrey-runtime/6');let $targ$0;let $0$0;let unescape$0;let $1$0;let Source$0;let $2$0;let qq$0;let opg$0;$0$0=require("../lex");unescape$0=getProperty($0$0,"unescape","../lex");$1$0=require("../location");Source$0=getProperty($1$0,"Source","../location");$2$0=require("./helpers");qq$0=getProperty($2$0,"qq","./helpers");opg$0=require("opg");$targ$0=(function(mac$0){let t0$2;let t0$13;let $targ$1;let quote_mac$0;let tok$0;let gr$0;let prio$0;let finalize$0;let parser$0;let parse$0;let $targ$2;let interpolate_mac$0;let exports$0;exports$0=({});$targ$1=(function(temp$0$0,info$0,form$0,temp$1$0){let t0$0;let t0$1;let t1$0;let parsed$0;let context$0;let ph$0$0;let expr$0;let s$0;t0$0=temp$0$0;context$0=t0$0;ph$0$0=t0$0;t0$1=temp$1$0;expr$0=t0$1;if((Array.isArray(t0$1)&&((t1$0=t0$1.length),((t1$0===2)&&(t0$1[0]==="value"))))){s$0=t0$1[1];}else{___match_error(temp$1$0);}parsed$0=info$0.go(Source$0(s$0,"<quasiquote>"),"source","parse");return info$0.mark(qq$0(parsed$0));});t0$2=getProjector(mac$0("`"))($targ$1);if(t0$2[0]){quote_mac$0=t0$2[1];}else{___match_error($targ$1);}tok$0=opg$0.tokenize.Tokenizer(({"regexps":({"open":"\\$[.A-Za-z0-9_]*\\{|\\{","close":"\\}","other":"\\$|[^\\{\\}$]+"}),"post":[(function(temp$2$0){let t0$3;let t0$4;let tok$1;let ph$1$0;t0$3=temp$2$0;tok$1=t0$3;ph$1$0=t0$3;t0$4=ph$1$0;if((___hasprop(t0$4,"type")&&(t0$4.type==="open"))){return [({"token":"","type":"other","location":tok$1.location.at_start()}),tok$1];}else{return tok$1;}})]}));gr$0=(new opg$0.parse.TokenGroups(({"open":["open"],"close":["close"],"other":["str","other"]})));prio$0=(new opg$0.parse.PriorityOrder(gr$0,({"open":({"left":1002,"right":0}),"close":({"left":0,"right":1003}),"other":({"left":1000,"right":1000})})));finalize$0=(function finalize(temp$3$0){let t0$5;let t0$7;let t1$2;let t2$1;let tag$0;let arg$0;let text$0;let bridge$$16412$0;let m$0;let rval$0;let text$1;let args$0;let token$0;let open$0;let ph$3$0;let _arg$0;let close$0;let $$16415$0;let $$16416$0;let t0$6;let t1$1;let t2$0;let t3$0;let t4$0;let zazz$0;let ph$2$0;t0$5=temp$3$0;zazz$0=t0$5;ph$2$0=t0$5;t0$6=ph$2$0;t1$1=t0$6.length;if(((t1$1===5)&&((t0$6[0]===null)&&((t2$0=t0$6[1]),(___hasprop(t2$0,"type")&&((t2$0.type==="open")&&(___hasprop(t2$0,"token")&&((t3$0=t2$0.token),(open$0=t3$0),(ph$3$0=t3$0),(_arg$0=t0$6[2]),(t4$0=t0$6[3]),(___hasprop(t4$0,"type")&&((t4$0.type==="close")&&(___hasprop(t4$0,"token")&&((close$0=t4$0.token),(t0$6[4]===null))))))))))))){arg$0=(_arg$0||__amp__(["join",""],({"text":""})));text$0=((open$0+arg$0.text)+close$0);bridge$$16412$0=ph$3$0;if((((t0$7=getProjector(RegExp("\\$([^\\{]*){",""))(bridge$$16412$0)),(t0$7[0]&&((t1$2=t0$7[1]),(t2$1=t1$2.length),((t2$1===2)&&(t1$2[0],(tag$0=t1$2[1]),true)))))||((tag$0=""),true))){return __amp____colon__(["bracket",tag$0,arg$0.text],({"text":text$0}));}else{return ___match_error(ph$3$0);}}else{if(((t1$1===3)&&((t0$6[0]===null)&&((t2$0=t0$6[1]),(___hasprop(t2$0,"token")&&((token$0=t2$0.token),(t0$6[2]===null))))))){return __amp____colon__(["join",token$0],({"text":token$0}));}else{args$0=ph$2$0;rval$0=["join"];text$1="";m$0=null;$3:for(m$0 of enumerate(args$0)){let x$0;let sub$0;let token$1;let $$16517$0;let t0$9;let t1$4;let i$0;let arg$1;let ph$4$0;let t0$8;let t1$3;let t2$2;t0$8=m$0;if((Array.isArray(t0$8)&&((t1$3=t0$8.length),(t1$3===2)))){i$0=t0$8[0];t2$2=t0$8[1];arg$1=t2$2;ph$4$0=t2$2;t0$9=ph$4$0;if((___hasprop(t0$9,"token")&&((token$1=t0$9.token),equal((i$0%2),1)))){rval$0.push(token$1);text$1=(text$1+token$1);}else{if((Array.isArray(t0$9)&&((t1$4=t0$9.length),((t1$4>=1)&&(t0$9[0]==="join"))))){sub$0=Array.prototype.slice.call(t0$9,1);text$1=(text$1+arg$1.text);rval$0=rval$0.concat(sub$0);}else{if(((x$0=ph$4$0),((x$0 instanceof Array)&&(x$0[0]==="bracket")))){text$1=(text$1+arg$1.text);rval$0.push(arg$1);}else{if((ph$4$0===null)){undefined;}else{___match_error(ph$4$0);}}}}}else{___match_error(m$0);}}return __amp____colon__(rval$0,({"text":text$1}));}}});parser$0=(new opg$0.parse.Parser(tok$0,prio$0.getOrder(),finalize$0));parse$0=(function parse(text$2){return parser$0.parse(text$2);});$targ$2=(function(context$1,info$1,form$1,temp$4$0){let t0$10;let t1$5;let t0$11;let t1$6;let m$1;let $targ$3;let contents$0;let parts$0;let current$0;let push$0;let expr$1;let s$1;t0$10=temp$4$0;expr$1=t0$10;if((Array.isArray(t0$10)&&((t1$5=t0$10.length),((t1$5===2)&&(t0$10[0]==="value"))))){s$1=t0$10[1];}else{___match_error(temp$4$0);}$targ$3=parse$0(s$1);t0$11=$targ$3;if((Array.isArray(t0$11)&&((t1$6=t0$11.length),((t1$6>=1)&&(t0$11[0]==="join"))))){contents$0=Array.prototype.slice.call(t0$11,1);}else{___match_error($targ$3);}parts$0=[];current$0="";push$0=(function push(){if(nequal(current$0,"")){parts$0.push(["value",current$0]);current$0="";return current$0;}});m$1=null;$4:for(m$1 of contents$0){let tag$1;let p$0;let ph$5$0;let expr$2;let s$2;let $$16618$0;let t0$12;let t1$7;t0$12=m$1;if((typeof(t0$12)==="string")){s$2=t0$12;current$0=(current$0+unescape$0(s$2));}else{if((Array.isArray(t0$12)&&((t1$7=t0$12.length),((t1$7===3)&&(t0$12[0]==="bracket"))))){ph$5$0=t0$12[1];expr$2=t0$12[2];push$0();p$0=form$1.env.mark(["parse",expr$2]);if((ph$5$0==="")){parts$0.push(["send",["symbol","ENode"],["data",["data"],["data",["symbol","="]],["data",p$0]]]);}else{tag$1=ph$5$0;parts$0.push(["send",["symbol","ENode"],["data",["data",["value",tag$1]],["data",["symbol","="]],["data",p$0]]]);}}else{___match_error(m$1);}}}push$0();return ["send",["send",["send",["symbol","ENode"],["data",["data"],["data",["symbol","="]],["data"].concat(parts$0)]],["send",["symbol","."],["data",["void"],["symbol","toString"]]]],["data"]];});t0$13=getProjector(mac$0("'"))($targ$2);if(t0$13[0]){interpolate_mac$0=t0$13[1];}else{___match_error($targ$2);}return exports$0;});(module["exports"]=$targ$0);[];
//# sourceMappingURL=quote.js.map

