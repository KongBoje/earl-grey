
'use strict';require('earlgrey-runtime/6');let $targ$1;let $targ$0;let $0$0;let camelCase$0;let $1$0;let __lt____lt____colon__$0;let $2$0;let expr_mac$0;let pattern_handlers$0;let ctx_mac$0;let named_statement_matcher$0;let flatmacro$0;let match_error$0;let Body$0;let AssignmentHandler$0;let $3$0;let PatternCompiler$0;let parse_clauses$0;$0$0=require("../util");camelCase$0=getProperty($0$0,"camelCase","../util");$1$0=require("../location");__lt____lt____colon__$0=getProperty($1$0,"<<:","../location");$2$0=require("./helpers");expr_mac$0=getProperty($2$0,"expr_mac","./helpers");pattern_handlers$0=getProperty($2$0,"pattern_handlers","./helpers");ctx_mac$0=getProperty($2$0,"ctx_mac","./helpers");named_statement_matcher$0=getProperty($2$0,"named_statement_matcher","./helpers");flatmacro$0=getProperty($2$0,"flatmacro","./helpers");match_error$0=getProperty($2$0,"match_error","./helpers");Body$0=getProperty($2$0,"Body","./helpers");AssignmentHandler$0=getProperty($2$0,"AssignmentHandler","./helpers");$3$0=require("../pattern");PatternCompiler$0=getProperty($3$0,"PatternCompiler","../pattern");parse_clauses$0=getProperty($3$0,"parse_clauses","../pattern");if((typeof(module)==="undefined")){$targ$1=undefined;(global["module"]=$targ$1);(void 0);}$targ$0=(function(mac$0){let t0$0;let t0$1;let t0$4;let t0$7;let t1$4;let t0$9;let t0$12;let t0$20;let t0$25;let t0$33;let t0$35;let t0$38;let _catch$0;let _finally$0;let t0$46;let t0$49;let t0$50;let t1$29;let t0$51;let t0$54;let t0$55;let t1$30;let t0$58;let t0$60;let t0$65;let t0$67;let $targ$2;let var_mac$0;let $targ$3;let setvar_mac$0;let $targ$4;let let_mac$0;let $targ$5;let letrec_mac$0;let $targ$6;let where_mac$0;let $targ$7;let dot_mac$0;let $targ$8;let equal_mac$0;let $targ$9;let fat_arrow_mac$0;let $targ$10;let _lambda_mac$0;let $targ$11;let genarrow_mac$0;let $targ$12;let arrow_mac$0;let try_pattern$0;let $targ$13;let try_mac$0;let $targ$14;let tryop_mac$0;let $targ$15;let throw_mac$0;let $targ$16;let exprvalue_mac$0;let $targ$17;let return_mac$0;let $targ$18;let new_mac$0;let $targ$19;let delete_mac$0;let $targ$20;let splice_mac$0;let $targ$21;let hash_mac$0;let $targ$22;let placeholder_mac$0;let exports$0;exports$0=({});$targ$2=(function(temp$0$0,temp$1$0,form$0,argument$0){let x$0;if(((x$0=temp$0$0),((x$0 instanceof Array)&&(x$0[0]==="pattern")))){}else{___match_error(temp$0$0);}return ["mode","var",argument$0];});t0$0=getProjector(mac$0("var"))($targ$2);if(t0$0[0]){var_mac$0=t0$0[1];}else{___match_error($targ$2,"mac{\"var\"}! var_mac{#pattern, _, form, argument}");}$targ$3=(function(temp$2$0,temp$3$0,form$1,argument$1){let x$1;if(((x$1=temp$2$0),((x$1 instanceof Array)&&(x$1[0]==="pattern")))){}else{___match_error(temp$2$0);}return ["mode","set",argument$1];});t0$1=getProjector(mac$0("set-var"))($targ$3);if(t0$1[0]){setvar_mac$0=t0$1[1];}else{___match_error($targ$3,"mac{\"set-var\"}! setvar_mac{#pattern, _, form, argument}");}$targ$4=(function(ph$0$0,temp$4$0,form$2,argument$2){let x$2;let construct$0;let bindings$0;let body$0;let t0$2;let t1$0;let t2$0;let t3$0;let m$0$0;let other$0;if(((x$2=ph$0$0),((x$2 instanceof Array)&&(x$2[0]==="pattern")))){return ["mode","let",argument$2];}else{other$0=ph$0$0;m$0$0=argument$2;if((Array.isArray(m$0$0)&&((t0$2=m$0$0.length),((t0$2===3)&&((m$0$0[0]==="data")&&((t1$0=getProjector(Body$0)(m$0$0[1])),(t1$0[0]&&((t2$0=t1$0[1]),(t3$0=t2$0.length),(t3$0>=0))))))))){bindings$0=Array.prototype.slice.call(t2$0,0);body$0=m$0$0[2];construct$0=(function construct(ph$1$0){let bind$0;let val$0;let xs$0;let $$6627$0;let $$6628$0;let t0$3;let t1$1;let t2$1;let t3$1;let t4$0;let t5$0;let t6$0;let t7$0;t0$3=ph$1$0;t1$1=t0$3.length;if((t1$1===0)){return body$0;}else{if(((t1$1>=1)&&((t2$1=t0$3[0]),(Array.isArray(t2$1)&&((t3$1=t2$1.length),((t3$1===3)&&((t2$1[0]==="send")&&((t4$0=t2$1[1]),(Array.isArray(t4$0)&&((t5$0=t4$0.length),((t5$0===2)&&((t4$0[0]==="symbol")&&((t4$0[1]==="=")&&((t6$0=t2$1[2]),(Array.isArray(t6$0)&&((t7$0=t6$0.length),((t7$0===3)&&(t6$0[0]==="data")))))))))))))))))){bind$0=t6$0[1];val$0=t6$0[2];xs$0=Array.prototype.slice.call(t0$3,1);return __amp__(["multi",["send",["symbol","="],["data",["send",["symbol","let"],bind$0],val$0]],construct$0(xs$0)],({"nonrecursive":true}));}else{return ___match_error(ph$1$0,"{`^bind = ^val`, *xs}");}}});return construct$0(bindings$0);}else{return ___match_error(m$0$0,"#data{Body! {*bindings}, body}");}}});t0$4=getProjector(mac$0("let"))($targ$4);if(t0$4[0]){let_mac$0=t0$4[1];}else{___match_error($targ$4,"mac{\"let\"}! let_mac{match, _, form, argument}");}$targ$5=(function(temp$5$0,form$3,temp$6$0){let t0$5;let t1$2;let t2$2;let t3$2;let t4$1;let m$1;let acc$0;let temp$7;let let_bindings$0;let bindings$1;let body$1;t0$5=temp$6$0;if((Array.isArray(t0$5)&&((t1$2=t0$5.length),((t1$2===3)&&((t0$5[0]==="data")&&((t2$2=getProjector(Body$0)(t0$5[1])),(t2$2[0]&&((t3$2=t2$2[1]),(t4$1=t3$2.length),(t4$1>=0))))))))){bindings$1=Array.prototype.slice.call(t3$2,0);body$1=t0$5[2];}else{___match_error(temp$6$0);}acc$0=[];temp$7=null;m$1=null;$4:for(m$1 of bindings$1){let b$0;let v$0;let t0$6;let t1$3;let t2$3;let t3$3;let t4$2;let t5$1;t0$6=m$1;if((Array.isArray(t0$6)&&((t1$3=t0$6.length),((t1$3===3)&&((t0$6[0]==="send")&&((t2$3=t0$6[1]),(Array.isArray(t2$3)&&((t3$3=t2$3.length),((t3$3===2)&&((t2$3[0]==="symbol")&&((t2$3[1]==="=")&&((t4$2=t0$6[2]),(Array.isArray(t4$2)&&((t5$1=t4$2.length),((t5$1===3)&&(t4$2[0]==="data")))))))))))))))){b$0=t4$2[1];v$0=t4$2[2];temp$7=["send",["symbol","="],["data",["send",["symbol","let"],b$0],v$0]];acc$0.push(temp$7);}else{___match_error(m$1);}}let_bindings$0=acc$0;return ["multi"].concat(let_bindings$0).concat([body$1]);});t0$7=getProjector(expr_mac$0)($targ$5);if((t0$7[0]&&((t1$4=getProjector(mac$0("letrec"))(t0$7[1])),t1$4[0]))){letrec_mac$0=t1$4[1];}else{___match_error($targ$5,"expr_mac! mac{\"letrec\"}! letrec_mac{_, form, #data{Body! {*bindings}, body}}");}$targ$6=(function(context$0,temp$8$0,form$4,temp$9$0){let t0$8;let t1$5;let body$2;let bindings$2;t0$8=temp$9$0;if((Array.isArray(t0$8)&&((t1$5=t0$8.length),((t1$5===3)&&(t0$8[0]==="data"))))){body$2=t0$8[1];bindings$2=t0$8[2];}else{___match_error(temp$9$0);}return ["send",["symbol","letrec"],["data",bindings$2,body$2]];});t0$9=getProjector(mac$0("where"))($targ$6);if(t0$9[0]){where_mac$0=t0$9[1];}else{___match_error($targ$6,"mac{\"where\"}! where_mac{context, _, form, #data{body, bindings}}");}$targ$7=(function(context$1,temp$10$0,form$5,temp$11$0){let t0$10;let t1$6;let t2$4;let t3$4;let f$0;let expr$0;t0$10=temp$11$0;if((Array.isArray(t0$10)&&((t1$6=t0$10.length),((t1$6===3)&&((t0$10[0]==="data")&&((t2$4=t0$10[1]),(Array.isArray(t2$4)&&((t3$4=t2$4.length),((t3$4===1)&&(t2$4[0]==="void")))))))))){expr$0=t0$10[2];}else{___match_error(temp$11$0);}f$0=(function f(ph$2$0){let m$2;let acc$1;let temp$12;let other$1;let args$0;let x$3;let $$6862$0;let $$6863$0;let t0$11;let t1$7;let t2$5;t0$11=ph$2$0;t1$7=t0$11.length;if(((t1$7===2)&&((t0$11[0]==="symbol")&&((t2$5=getProjector(camelCase$0)(t0$11[1])),t2$5[0])))){x$3=t2$5[1];return ["value",x$3];}else{if(((t1$7>=1)&&(t0$11[0]==="data"))){args$0=Array.prototype.slice.call(t0$11,1);return ["data"].concat(((acc$1=[]),(temp$12=null),(m$2=null),(function(){$5:for(m$2 of args$0){let arg$0;arg$0=m$2;temp$12=f$0(arg$0);acc$1.push(temp$12);}})(),acc$1));}else{other$1=ph$2$0;throw ErrorFactory(["syntax","dot"]).create("Argument to '.' must be a symbol or an array",({"argument":other$1}));}}});return f$0(expr$0);});t0$12=getProjector(mac$0("."))($targ$7);if(t0$12[0]){dot_mac$0=t0$12[1];}else{___match_error($targ$7,"mac{\".\"}! dot_mac{context, _, form, #data{#void{}, expr}}");}$targ$8=(function(ph$3$0,info$0,form$6,expr$1){let x$4;let t0$14;let t1$9;let $targ$23;let lhs$0;let rhs$0;let t0$16;let t1$11;let t2$7;let t3$5;let t4$3;let t0$17;let t1$12;let t2$8;let t3$6;let t4$4;let opt$0;let rhs2$0;let lhs$1;let rhs$2;let s$1;let rhs$1;let x$5;let s$0;let $$6969$0;let $$6970$0;let $$6971$0;let $$6972$0;let t0$15;let bridge$$6966$0;let t1$10;let t2$6;let m$3$0;let opt$1;let rhs2$1;let vs$0;let v$1;let $$7126$0;let $$7127$0;let t0$19;let m$5$0;let expr$2;let pc$0;let assignment$0;let rval$0;let lhs$2;let rhs$3;let t0$18;let m$4$0;let other$2;let t0$13;let t1$8;if(((x$4=ph$3$0),((x$4 instanceof Array)&&(x$4[0]==="pattern")))){$targ$23=expr$1;t0$14=$targ$23;if((Array.isArray(t0$14)&&((t1$9=t0$14.length),((t1$9===3)&&(t0$14[0]==="data"))))){lhs$0=t0$14[1];rhs$0=t0$14[2];}else{___match_error($targ$23,"#data{lhs, rhs}");}[lhs$0,rhs$0];return ["default",lhs$0,rhs$0];}else{t0$13=ph$3$0;t1$8=t0$13.length;if(((t1$8===2)&&((t0$13[0]==="expr")&&(t0$13[1]==="data")))){m$3$0=expr$1;if((Array.isArray(m$3$0)&&((t0$15=m$3$0.length),((t0$15===1)&&(m$3$0[0]==="void"))))){return ["assoc"];}else{bridge$$6966$0=m$3$0;if(((Array.isArray(bridge$$6966$0)&&((t0$16=bridge$$6966$0.length),((t0$16===3)&&((bridge$$6966$0[0]==="data")&&((t1$11=bridge$$6966$0[1]),(x$5=t1$11),(Array.isArray(t1$11)&&((t2$7=t1$11.length),((t2$7===2)&&((t1$11[0]==="symbol")&&((s$0=t1$11[1]),(t3$5=bridge$$6966$0[2]),(Array.isArray(t3$5)&&((t4$3=t3$5.length),((t4$3===1)&&(t3$5[0]==="void"))))))))))))))||(Array.isArray(bridge$$6966$0)&&((t0$17=bridge$$6966$0.length),((t0$17===3)&&((bridge$$6966$0[0]==="data")&&((t1$12=bridge$$6966$0[1]),(Array.isArray(t1$12)&&((t2$8=t1$12.length),((t2$8===1)&&((t1$12[0]==="void")&&((t3$6=bridge$$6966$0[2]),(x$5=t3$6),(Array.isArray(t3$6)&&((t4$4=t3$6.length),((t4$4===2)&&((t3$6[0]==="symbol")&&((s$0=t3$6[1]),true))))))))))))))))){return ["assoc",["value",camelCase$0(s$0)],x$5];}else{if((($$6969$0=Array.isArray(m$3$0))&&((t0$15=m$3$0.length),(($$6971$0=(t0$15===3))&&(($$6972$0=(m$3$0[0]==="data"))&&((t1$10=m$3$0[1]),(Array.isArray(t1$10)&&((t2$6=t1$10.length),((t2$6===2)&&(t1$10[0]==="symbol")))))))))){s$1=t1$10[1];rhs$1=m$3$0[2];return ["assoc",["value",camelCase$0(s$1)],rhs$1];}else{if($$6972$0){lhs$1=m$3$0[1];rhs$2=m$3$0[2];return ["objsplice",["multi",((opt$0=pattern_handlers$0.build_object),(rhs2$0=__lt____lt____colon__$0(["use",info$0.scope,rhs$2],rhs$2)),PatternCompiler$0(lhs$1,info$0,opt$0).extract_from_rhs(rhs2$0))]];}else{return ___match_error(m$3$0,"#data{lhs, rhs}");}}}}}else{other$2=ph$3$0;m$4$0=expr$1;if((Array.isArray(m$4$0)&&((t0$18=m$4$0.length),((t0$18===3)&&(m$4$0[0]==="data"))))){lhs$2=m$4$0[1];rhs$3=m$4$0[2];opt$1=pattern_handlers$0.declare_variables;pc$0=PatternCompiler$0(lhs$2,info$0,opt$1);rhs2$1=__lt____lt____colon__$0(["use",info$0.scope,rhs$3],rhs$3);assignment$0=pc$0.extract_from_rhs(rhs2$1);m$5$0=pc$0.vars;if((($$7126$0=Array.isArray(m$5$0))&&((t0$19=m$5$0.length),(t0$19===0)))){rval$0=["value",undefined];}else{if(($$7126$0&&(t0$19===1))){v$1=m$5$0[0];rval$0=v$1;}else{vs$0=m$5$0;rval$0=["data"].concat(vs$0);}}expr$2=["splice",assignment$0,rval$0];return pc$0.wrapAssignment(expr$2);}else{return ___match_error(m$4$0,"#data{lhs, rhs}");}}}});t0$20=getProjector(mac$0("="))($targ$8);if(t0$20[0]){equal_mac$0=t0$20[1];}else{___match_error($targ$8,"mac{\"=\"}! equal_mac{match, info, form, expr}");}$targ$9=(function(ph$4$0,temp$13$0,temp$14$0,temp$15$0){let t0$21;let t0$22;let t1$13;let x$6;let x$7;let rhs$5;let t0$23;let m$6$0;let x$8;let t0$24;let t1$14;let t2$9;let $targ$24;let stmts$0;let other$3;let env$0;let lhs$3;let rhs$4;t0$21=temp$13$0;if(___hasprop(t0$21,"env")){env$0=t0$21.env;}else{___match_error(temp$13$0);}t0$22=temp$15$0;if((Array.isArray(t0$22)&&((t1$13=t0$22.length),((t1$13===3)&&(t0$22[0]==="data"))))){lhs$3=t0$22[1];rhs$4=t0$22[2];}else{___match_error(temp$15$0);}if(((x$6=ph$4$0),((x$6 instanceof Array)&&(x$6[0]==="pattern")))){m$6$0=[lhs$3,rhs$4];if((Array.isArray(m$6$0)&&((t0$23=m$6$0.length),((t0$23===2)&&((x$7=m$6$0[0]),((x$7 instanceof Array)&&(x$7[0]==="void"))))))){rhs$5=m$6$0[1];return ["assoc",rhs$5];}else{return ["assoc",lhs$3,rhs$4];}}else{if(((x$8=ph$4$0),((x$8 instanceof Array)&&(x$8[0]==="test")))){$targ$24=rhs$4;t0$24=getProjector(Body$0)($targ$24);if((t0$24[0]&&((t1$14=t0$24[1]),(t2$9=t1$14.length),(t2$9>=0)))){stmts$0=Array.prototype.slice.call(t1$14,0);}else{___match_error($targ$24,"Body! {*stmts}");}return ["blocktest",lhs$3,stmts$0];}else{other$3=ph$4$0;return ["assoc",lhs$3,rhs$4];}}});t0$25=getProjector(mac$0("=>"))($targ$9);if(t0$25[0]){fat_arrow_mac$0=t0$25[1];}else{___match_error($targ$9,"mac{\"=>\"}! fat_arrow_mac{match, {=> env}, _, #data{lhs, rhs}}");}$targ$10=(function(context$2,info$1,form$7,ph$5$0){let t0$27;let t0$28;let bridge$$7270$0;let t0$29;let bridge$$7269$0;let accum$0;let m$8;let acc$2;let temp$16;let decls$0;let newargs$0;let _body$0;let x$9;let body2$1;let newp$0;let body2$2;let a$0;let pc2$1;let body2$3;let a$1;let other$5;let fw$1;let bw$0;let defaults$0;let rest$0;let objp$1;let i$0;let objp$0;let fw$0;let t0$30;let t1$16;let t2$10;let t3$7;let t4$5;let m$7$0;let wrap$0;let pc$1;let cpattern$0;let arg$1;let args$1;let pre$0;let body$3;let post$0;let generator$0;let t0$26;let t1$15;let bridge$$7268$0;t0$26=ph$5$0;t1$15=t0$26.length;if((((t1$15>=5)&&(t1$15<=6))&&((t0$26[0]==="data")&&((bridge$$7268$0=t0$26[1]),(((bridge$$7269$0=bridge$$7268$0),(((bridge$$7270$0=bridge$$7269$0),(((arg$1=bridge$$7270$0),(Array.isArray(bridge$$7270$0)&&((t0$27=bridge$$7270$0.length),((t0$27>=1)&&((bridge$$7270$0[0]==="data")&&((args$1=Array.prototype.slice.call(bridge$$7270$0,1)),true))))))||(Array.isArray(bridge$$7270$0)&&((t0$28=bridge$$7270$0.length),((t0$28>=1)&&((bridge$$7270$0[0]==="multi")&&((args$1=Array.prototype.slice.call(bridge$$7270$0,1)),(arg$1=["data"].concat(args$1)),true)))))))||(Array.isArray(bridge$$7269$0)&&((t0$29=bridge$$7269$0.length),((t0$29===1)&&((bridge$$7269$0[0]==="void")&&((args$1=[]),(arg$1=["data"]),true)))))))||((arg$1=["data",arg$1]),(args$1=[arg$1]),true)))))){pre$0=t0$26[2];body$3=t0$26[3];post$0=t0$26[4];if((5>=t1$15)){generator$0=["value",false];}else{generator$0=t0$26[5];}wrap$0=(function wrap(body2$0){let body3$0;if(equal(post$0,["value",null])){body3$0=body2$0;}else{body3$0=["multi",body2$0,post$0];}if(equal(pre$0,["value",null])){return body3$0;}else{return ["multi",pre$0,body3$0];}});pc$1=PatternCompiler$0(arg$1,info$1,__amp__(pattern_handlers$0.declare_variables,__amp____colon__(({"indexable":true,"allow_nested":true}),__amp____colon__(((accum$0=({})),(accum$0["fallback"]=(function fallback(target$0,pattern$0){return match_error$0(target$0,pattern$0);})),accum$0),({"tags":({"declare_mode":"let"}),"insert_object_argument":true})))));cpattern$0=pc$1.compile();m$7$0=cpattern$0;if((Array.isArray(m$7$0)&&((t0$30=m$7$0.length),((t0$30===5)&&((m$7$0[0]==="array_pattern")&&((fw$0=m$7$0[1]),(t1$16=m$7$0[2]),(Array.isArray(t1$16)&&((t2$10=t1$16.length),((t2$10===0)&&((t3$7=m$7$0[3]),(Array.isArray(t3$7)&&((t4$5=t3$7.length),((t4$5===0)&&(m$7$0[4]===(void 0))))))))))))))){decls$0=[];acc$2=[];temp$16=null;m$8=null;$6:for(m$8 of zip(fw$0,args$1)){let bridge$$7470$0;let m$9$0;let newv$0;let pc2$0;let other$4;let expr$3;let v$2;let t0$32;let t1$18;let t2$11;let t3$8;let ph$6$0;let arg$2;let t0$31;let t1$17;t0$31=m$8;if((Array.isArray(t0$31)&&((t1$17=t0$31.length),(t1$17===2)))){ph$6$0=t0$31[0];arg$2=t0$31[1];t0$32=ph$6$0;if((Array.isArray(t0$32)&&((t1$18=t0$32.length),((t1$18===2)&&((t0$32[0]==="assign")&&((t2$11=t0$32[1]),(expr$3=t2$11),(Array.isArray(t2$11)&&((t3$8=t2$11.length),((t3$8===2)&&((t2$11[0]==="symbol")&&((v$2=t2$11[1]),nequal(expr$3.declare_mode,"set")))))))))))){m$9$0=expr$3.declare_mode;if((m$9$0==="let")){temp$16=__amp____colon__(expr$3,({"mutable":false}));}else{if((m$9$0==="var")){temp$16=__amp____colon__(expr$3,({"mutable":true}));}else{bridge$$7470$0=m$9$0;if(((bridge$$7470$0==="unqualified")||(bridge$$7470$0===(void 0)))){temp$16=__amp____colon__(expr$3,({"mutable":false}));}else{temp$16=___match_error(m$9$0,".unqualified or undefined? ");}}}}else{other$4=ph$6$0;newv$0=__amp__(["symbol",info$1.gensym("temp")],({"env":info$1.mkenv(),"location":arg$2.location}));pc2$0=pc$1.fork(other$4);decls$0.push(pc2$0.extract_from_rhs(newv$0));temp$16=newv$0;}acc$2.push(temp$16);}else{___match_error(m$8);}}newargs$0=acc$2;_body$0=pc$1.wrapBody(body$3);return ["lambda",newargs$0,wrap$0(["multi"].concat(decls$0).concat([_body$0])),generator$0];}else{objp$0=m$7$0;if(((x$9=m$7$0),((x$9 instanceof Array)&&(x$9[0]==="object_pattern")))){body2$1=["send",["symbol","match"],["data",["send",["symbol","arguments"],["value",0]],["send",["symbol","->"],["data",arg$1,body$3]]]];return ["lambda",[],wrap$0(body2$1),generator$0];}else{if((Array.isArray(m$7$0)&&((t0$30=m$7$0.length),((t0$30===3)&&((m$7$0[0]==="all")&&((t1$16=m$7$0[1]),(Array.isArray(t1$16)&&((t2$10=t1$16.length),((t2$10===5)&&((t1$16[0]==="array_pattern")&&((fw$1=t1$16[1]),(bw$0=t1$16[2]),(defaults$0=t1$16[3]),(rest$0=t1$16[4]),(objp$1=m$7$0[2]),___hasprop(m$7$0,"insertion_index")))))))))))){i$0=m$7$0.insertion_index;a$0=__lt____lt____colon__$0(["symbol","arguments"],arg$1);fw$1.splice(i$0,0,objp$1);newp$0=["array_pattern",fw$1,bw$0,defaults$0,rest$0];pc2$1=pc$1.fork(newp$0);body2$2=["multi",pc2$1.extract_from_rhs(a$0),pc$1.wrapBody(body$3)];return ["lambda",[],wrap$0(body2$2),generator$0];}else{other$5=m$7$0;a$1=__lt____lt____colon__$0(["symbol","arguments"],arg$1);body2$3=["send",["send",["symbol","match"],["send",["symbol","."],["data",["void"],["symbol","indexable"]]]],["data",a$1,["send",["symbol","->"],["data",arg$1,body$3]]]];return ["lambda",[],wrap$0(body2$3),generator$0];}}}}else{return ___match_error(ph$5$0,"#data{[arg and #data{*args}\n          \\ or #multi{*args} and arg is #data{*args}\n          \\ or #void{} and args is {} and arg is #data{}\n          \\ or arg is #data{arg} and args is {arg}]\n         pre, body, post, generator = #value{false}}");}});t0$33=getProjector(mac$0("_lambda"))($targ$10);if(t0$33[0]){_lambda_mac$0=t0$33[1];}else{___match_error($targ$10,"mac{\"_lambda\"}! _lambda_mac{context, info, form, match}");}$targ$11=(function(ctx$0,temp$17$0,form$8,ph$7$0){let other$6;let args$2;let body$4;let t0$34;let t1$19;t0$34=ph$7$0;t1$19=t0$34.length;if(((t1$19===3)&&(t0$34[0]==="data"))){args$2=t0$34[1];body$4=t0$34[2];return ["send",["symbol","_lambda"],["data",args$2,["value",null],body$4,["value",null],["value",true]]];}else{other$6=ph$7$0;throw ErrorFactory(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$6}));}});t0$35=getProjector(mac$0("*->"))($targ$11);if(t0$35[0]){genarrow_mac$0=t0$35[1];}else{___match_error($targ$11,"mac{\"*->\"}! genarrow_mac{ctx, _, form, match}");}$targ$12=(function(ph$8$0,temp$18$0,form$9,expr$4){let x$10;let t0$36;let t1$20;let $targ$25;let lhs$4;let rhs$6;let other$8;let args$3;let body$5;let t0$37;let m$10$0;let other$7;if(((x$10=ph$8$0),((x$10 instanceof Array)&&(x$10[0]==="clause")))){$targ$25=expr$4;t0$36=$targ$25;if((Array.isArray(t0$36)&&((t1$20=t0$36.length),((t1$20===3)&&(t0$36[0]==="data"))))){lhs$4=t0$36[1];rhs$6=t0$36[2];}else{___match_error($targ$25,"#data{lhs, rhs}");}[lhs$4,rhs$6];return ["clause",lhs$4,rhs$6];}else{other$7=ph$8$0;m$10$0=expr$4;if((Array.isArray(m$10$0)&&((t0$37=m$10$0.length),((t0$37===3)&&(m$10$0[0]==="data"))))){args$3=m$10$0[1];body$5=m$10$0[2];return ["send",["symbol","_lambda"],["data",args$3,["value",null],body$5,["value",null]]];}else{other$8=m$10$0;throw ErrorFactory(["syntax","lambda"]).create("Bad lambda syntax",({"node":other$8}));}}});t0$38=getProjector(mac$0("->"))($targ$12);if(t0$38[0]){arrow_mac$0=t0$38[1];}else{___match_error($targ$12,"mac{\"->\"}! arrow_mac{match, _, form, expr}");}_catch$0=named_statement_matcher$0("catch");_finally$0=named_statement_matcher$0("finally");try_pattern$0=["seq",["multiple",_catch$0],["multiple",_finally$0,0,1]];$targ$13=(function(temp$19$0,info$2,form$10,temp$20$0){let t0$39;let t1$21;let t0$40;let t1$22;let body$6;t0$39=temp$19$0;if((Array.isArray(t0$39)&&((t1$21=t0$39.length),((t1$21===2)&&((t0$39[0]==="expr")&&(t0$39[1]==="multi")))))){}else{___match_error(temp$19$0);}t0$40=temp$20$0;if((Array.isArray(t0$40)&&((t1$22=t0$40.length),((t1$22===2)&&(t0$40[0]==="data"))))){body$6=t0$40[1];}else{___match_error(temp$20$0);}return flatmacro$0(try_pattern$0,(function(temp$21$0){let t0$41;let t1$23;let t2$12;let t3$9;let t4$6;let t5$2;let m$11;let m$12;let t0$45;let $targ$26;let m$13;let env$1;let clauses$0;let finally$1;let make_ebody$0;let catches$0;let finallies$0;t0$41=temp$21$0;if((Array.isArray(t0$41)&&((t1$23=t0$41.length),((t1$23===3)&&((t0$41[0]==="seq")&&((t2$12=t0$41[1]),(Array.isArray(t2$12)&&((t3$9=t2$12.length),((t3$9>=1)&&((t2$12[0]==="multiple")&&((catches$0=Array.prototype.slice.call(t2$12,1)),(t4$6=t0$41[2]),(Array.isArray(t4$6)&&((t5$2=t4$6.length),((t5$2>=1)&&(t4$6[0]==="multiple"))))))))))))))){finallies$0=Array.prototype.slice.call(t4$6,1);}else{___match_error(temp$21$0);}env$1=info$2.mkenv();clauses$0=[];finally$1=["void"];m$11=null;$7:for(m$11 of catches$0){let p$0;let body$7;let t0$42;let t1$24;let t2$13;let t3$10;let t4$7;let t5$3;t0$42=m$11;if((Array.isArray(t0$42)&&((t1$24=t0$42.length),((t1$24===3)&&((t0$42[0]==="send")&&((t2$13=t0$42[1]),(Array.isArray(t2$13)&&((t3$10=t2$13.length),((t3$10===2)&&((t2$13[0]==="symbol")&&((t2$13[1]==="catch")&&((t4$7=t0$42[2]),(Array.isArray(t4$7)&&((t5$3=t4$7.length),((t5$3===3)&&(t4$7[0]==="data")))))))))))))))){p$0=t4$7[1];body$7=t4$7[2];clauses$0.push(env$1.mark(["send",["symbol","->"],["data",p$0,body$7]]));}else{___match_error(m$11);}}m$12=null;$8:for(m$12 of finallies$0){let body$8;let t0$43;let t1$25;let t2$14;let t3$11;let t4$8;let t5$4;t0$43=m$12;if((Array.isArray(t0$43)&&((t1$25=t0$43.length),((t1$25===3)&&((t0$43[0]==="send")&&((t2$14=t0$43[1]),(Array.isArray(t2$14)&&((t3$11=t2$14.length),((t3$11===2)&&((t2$14[0]==="symbol")&&((t2$14[1]==="finally")&&((t4$8=t0$43[2]),(Array.isArray(t4$8)&&((t5$4=t4$8.length),((t5$4===2)&&(t4$8[0]==="data")))))))))))))))){body$8=t4$8[1];finally$1=body$8;finally$1;}else{___match_error(m$12);}}clauses$0.push(env$1.mark(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));make_ebody$0=(function make_ebody(wrap$1){return parse_clauses$0(info$2,["symbol","excv"],clauses$0,({"wrap":wrap$1}));});$targ$26=(function(ph$9$0,e$0){let trystmt$0;let $$7873$0;let $$7874$0;let $$7875$0;let $$7876$0;let t0$44;let t1$26;t0$44=ph$9$0;t1$26=t0$44.length;if((($$7875$0=(t1$26===2))&&(($$7876$0=(t0$44[0]==="expr"))&&(t0$44[1]==="multi")))){return ["nostep",this.form];}else{if(($$7876$0&&(t0$44[1]==="ignore"))){return ["js_try",body$6,["send",["symbol","->"],["data",["data",["symbol","excv"]],make_ebody$0((function(x$11){return x$11;}))]],finally$1];}else{if(($$7876$0&&(t0$44[1]==="expr"))){trystmt$0=["js_try",["send",["symbol","="],["data",["send",["symbol","set-var"],["symbol","rval"]],body$6]],["send",["symbol","->"],["data",["data",["symbol","excv"]],make_ebody$0((function(x$12){return ["send",["symbol","="],["data",["send",["symbol","set-var"],["symbol","rval"]],x$12]];}))]],finally$1];return ["multi",["send",["symbol","="],["data",["send",["symbol","var"],["symbol","rval"]],["symbol","false"]]],trystmt$0,["symbol","rval"]];}else{return ___match_error(ph$9$0,"#expr{.expr}");}}}});t0$45=getProjector(ctx_mac$0)($targ$26);if(t0$45[0]){m$13=t0$45[1];}else{___match_error($targ$26);}return ["macro",m$13];}));});t0$46=getProjector(mac$0("try"))($targ$13);if(t0$46[0]){try_mac$0=t0$46[1];}else{___match_error($targ$13,"mac{\"try\"}! try_mac{#expr{.multi}, info, form, #data{body}}");}$targ$14=(function(ph$10$0,info$3,form$11,temp$22$0){let t0$47;let t1$27;let t2$15;let t3$12;let t4$9;let parsed_clauses$0;let parsed_clauses$1;let trystmt$1;let other$9;let $$7931$0;let $$7932$0;let $$7933$0;let $$7934$0;let t0$48;let t1$28;let expr$5;let clauses$1;t0$47=temp$22$0;if((Array.isArray(t0$47)&&((t1$27=t0$47.length),((t1$27===3)&&((t0$47[0]==="data")&&((expr$5=t0$47[1]),(t2$15=getProjector(Body$0)(t0$47[2])),(t2$15[0]&&((t3$12=t2$15[1]),(t4$9=t3$12.length),(t4$9>=0))))))))){clauses$1=Array.prototype.slice.call(t3$12,0);}else{___match_error(temp$22$0);}t0$48=ph$10$0;t1$28=t0$48.length;if((($$7933$0=(t1$28===2))&&(($$7934$0=(t0$48[0]==="expr"))&&(t0$48[1]==="multi")))){return ["nostep",form$11];}else{if(($$7934$0&&(t0$48[1]==="ignore"))){clauses$1.push(info$3.mkenv().mark(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));parsed_clauses$0=parse_clauses$0(info$3,["symbol","excv"],clauses$1,({"wrap":(function(x$13){return x$13;})}));return ["js_try",expr$5,["send",["symbol","->"],["data",["data",["symbol","excv"]],parsed_clauses$0]],["void"]];}else{other$9=ph$10$0;clauses$1.push(info$3.mkenv().mark(["send",["symbol","->"],["data",["symbol","e"],["send",["symbol","throw"],["symbol","e"]]]]));parsed_clauses$1=parse_clauses$0(info$3,["symbol","excv"],clauses$1,({"wrap":(function(x$14){return ["send",["symbol","="],["data",["send",["symbol","set-var"],["symbol","rval"]],x$14]];})}));trystmt$1=["js_try",["send",["symbol","="],["data",["send",["symbol","set-var"],["symbol","rval"]],expr$5]],["send",["symbol","->"],["data",["data",["symbol","excv"]],parsed_clauses$1]],["void"]];return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["send",["symbol","var"],["symbol","rval"]],["symbol","false"]]],["multi",trystmt$1,["symbol","rval"]]]];}}});t0$49=getProjector(mac$0("!!"))($targ$14);if(t0$49[0]){tryop_mac$0=t0$49[1];}else{___match_error($targ$14,"mac{\"!!\"}! tryop_mac{match, info, form, #data{expr, Body! {*clauses}}}");}$targ$15=(function(temp$23$0,form$12,arg$3){return ["js_throw",arg$3];});t0$50=getProjector(expr_mac$0)($targ$15);if((t0$50[0]&&((t1$29=getProjector(mac$0("throw"))(t0$50[1])),t1$29[0]))){throw_mac$0=t1$29[1];}else{___match_error($targ$15,"expr_mac! mac{\"throw\"}! throw_mac{_, form, arg}");}$targ$16=(function(ph$11$0,temp$24$0,form$13,arg$4){let x$15;let subp$0;let w$0;if(((x$15=ph$11$0),((x$15 instanceof Array)&&(x$15[0]==="pattern")))){if(equal(arg$4,["void"])){subp$0=null;}else{subp$0=arg$4;}w$0=(function w(ph$12){return ph$12;});return ["special",AssignmentHandler$0(subp$0,w$0)];}else{return ___match_error(ph$11$0,"#pattern");}});t0$51=getProjector(mac$0("expr-value"))($targ$16);if(t0$51[0]){exprvalue_mac$0=t0$51[1];}else{___match_error($targ$16,"mac{\"expr-value\"}! exprvalue_mac{match, _, form, arg}");}$targ$17=(function(ph$13$0,temp$25$0,form$14,arg$5){let x$16;let subp$1;let w$1;let t0$52;let t0$53;let otherwise$0;let bridge$$8073$0;if(((x$16=ph$13$0),((x$16 instanceof Array)&&(x$16[0]==="pattern")))){if(equal(arg$5,["void"])){subp$1=null;}else{subp$1=arg$5;}w$1=(function w(ph$14){return ["send",["symbol","return"],ph$14];});return ["special",AssignmentHandler$0(subp$1,w$1)];}else{bridge$$8073$0=ph$13$0;if(((Array.isArray(bridge$$8073$0)&&((t0$52=bridge$$8073$0.length),((t0$52===2)&&((bridge$$8073$0[0]==="expr")&&(bridge$$8073$0[1]==="expr")))))||(Array.isArray(bridge$$8073$0)&&((t0$53=bridge$$8073$0.length),((t0$53===2)&&((bridge$$8073$0[0]==="expr")&&(bridge$$8073$0[1]==="head"))))))){return ["js_return",arg$5];}else{otherwise$0=ph$13$0;return ["nostep",form$14];}}});t0$54=getProjector(mac$0("return"))($targ$17);if(t0$54[0]){return_mac$0=t0$54[1];}else{___match_error($targ$17,"mac{\"return\"}! return_mac{match, _, form, arg}");}$targ$18=(function(temp$26$0,form$15,arg$6){return ["js_new",arg$6];});t0$55=getProjector(expr_mac$0)($targ$18);if((t0$55[0]&&((t1$30=getProjector(mac$0("new"))(t0$55[1])),t1$30[0]))){new_mac$0=t1$30[1];}else{___match_error($targ$18,"expr_mac! mac{\"new\"}! new_mac{_, form, arg}");}$targ$19=(function(context$3,temp$27$0,form$16,temp$28$0){let t0$56;let other$10;let s$2;let t0$57;let t1$31;let arg$7;let ph$15$0;t0$56=temp$28$0;arg$7=t0$56;ph$15$0=t0$56;t0$57=ph$15$0;t1$31=t0$57.length;if(((t1$31===2)&&(t0$57[0]==="symbol"))){s$2=t0$57[1];return ["undeclare",arg$7];}else{other$10=ph$15$0;return ["js_delete",other$10];}});t0$58=getProjector(mac$0("delete"))($targ$19);if(t0$58[0]){delete_mac$0=t0$58[1];}else{___match_error($targ$19,"mac{\"delete\"}! delete_mac{context, _, form, match arg}");}$targ$20=(function(context$4,temp$29$0,form$17,temp$30$0){let t0$59;let t1$32;let t2$16;let t3$13;let t4$10;let stmts$1;t0$59=temp$30$0;if((Array.isArray(t0$59)&&((t1$32=t0$59.length),((t1$32===2)&&((t0$59[0]==="data")&&((t2$16=getProjector(Body$0)(t0$59[1])),(t2$16[0]&&((t3$13=t2$16[1]),(t4$10=t3$13.length),(t4$10>=0))))))))){stmts$1=Array.prototype.slice.call(t3$13,0);}else{___match_error(temp$30$0);}return ["splice"].concat(stmts$1);});t0$60=getProjector(mac$0("splice"))($targ$20);if(t0$60[0]){splice_mac$0=t0$60[1];}else{___match_error($targ$20,"mac{\"splice\"}! splice_mac{context, _, form, #data{Body! {*stmts}}}");}$targ$21=(function(context$5,temp$31$0,form$18,temp$32$0){let t0$61;let t1$33;let t2$17;let t3$14;let t4$11;let t5$5;let f$1;let tag$0;t0$61=temp$32$0;if((Array.isArray(t0$61)&&((t1$33=t0$61.length),((t1$33===3)&&((t0$61[0]==="data")&&((t2$17=t0$61[1]),(Array.isArray(t2$17)&&((t3$14=t2$17.length),((t3$14===1)&&((t2$17[0]==="void")&&((t4$11=t0$61[2]),(Array.isArray(t4$11)&&((t5$5=t4$11.length),((t5$5===2)&&(t4$11[0]==="symbol"))))))))))))))){tag$0=t4$11[1];}else{___match_error(temp$32$0);}tag$0=["value",tag$0];f$1=(function f(ph$16$0,temp$33$0,form$19,expr$6){let x$17;let other$11;let subp$2;let $$8303$0;let $$8304$0;let t0$63;let m$14$0;let checker_mac$0;let x$18;let x$19;let other$12;let args$4;let $$8368$0;let $$8369$0;let t0$64;let m$15$0;if(((x$17=ph$16$0),((x$17 instanceof Array)&&(x$17[0]==="pattern")))){checker_mac$0=["macro",(function(context$6,temp$34$0,form$20,temp$35$0){let t0$62;let t1$34;let expr$7;t0$62=temp$35$0;if((Array.isArray(t0$62)&&((t1$34=t0$62.length),((t1$34===2)&&(t0$62[0]==="data"))))){expr$7=t0$62[1];}else{___match_error(temp$35$0);}return ["send",["symbol","let"],["data",["send",["symbol","="],["data",["symbol","x"],expr$7]],["send",["symbol","and"],["data",["send",["symbol","instanceof"],["data",["symbol","x"],["symbol","Array"]]],["send",["symbol","==="],["data",["send",["symbol","x"],["value",0]],tag$0]]]]]];})];m$14$0=expr$6;if((($$8303$0=Array.isArray(m$14$0))&&((t0$63=m$14$0.length),((t0$63>=1)&&(m$14$0[0]==="data"))))){subp$2=Array.prototype.slice.call(m$14$0,1);return ["data",tag$0].concat(subp$2);}else{if(($$8303$0&&((t0$63===1)&&(m$14$0[0]==="void")))){return ["check",checker_mac$0,["ignore"]];}else{other$11=m$14$0;return ["check",checker_mac$0,expr$6];}}}else{if(((x$18=ph$16$0),((x$18 instanceof Array)&&(x$18[0]==="check")))){return ["send",["symbol","getChecker"],["data",["data",tag$0]]];}else{if(((x$19=ph$16$0),((x$19 instanceof Array)&&(x$19[0]==="project")))){return ["send",["symbol","getProjector"],["data",["data",tag$0]]];}else{m$15$0=expr$6;if((($$8368$0=Array.isArray(m$15$0))&&((t0$64=m$15$0.length),((t0$64===1)&&(m$15$0[0]==="void"))))){return ["data",tag$0];}else{if(($$8368$0&&((t0$64>=1)&&(m$15$0[0]==="data")))){args$4=Array.prototype.slice.call(m$15$0,1);return ["data",tag$0].concat(args$4);}else{other$12=m$15$0;return ["send",["data",tag$0],other$12];}}}}}});return ["macro",f$1];});t0$65=getProjector(mac$0("#"))($targ$21);if(t0$65[0]){hash_mac$0=t0$65[1];}else{___match_error($targ$21,"mac{\"#\"}! hash_mac{context, _, form, #data{#void{}, #symbol{var tag}}}");}$targ$22=(function(temp$36$0,temp$37$0,form$21,temp$38$0){let x$20;let t0$66;let t1$35;if(((x$20=temp$36$0),((x$20 instanceof Array)&&(x$20[0]==="pattern")))){}else{___match_error(temp$36$0);}t0$66=temp$38$0;if((Array.isArray(t0$66)&&((t1$35=t0$66.length),((t1$35===1)&&(t0$66[0]==="void"))))){}else{___match_error(temp$38$0);}return ["ignore"];});t0$67=getProjector(mac$0("_"))($targ$22);if(t0$67[0]){placeholder_mac$0=t0$67[1];}else{___match_error($targ$22,"mac{\"_\"}! placeholder_mac{#pattern, _, form, #void{}}");}return exports$0;});(module["exports"]=$targ$0);(void 0);
//# sourceMappingURL=core.js.map

